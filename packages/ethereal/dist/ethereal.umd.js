var Nm=Object.defineProperty;var Sm=(oe,ze,Le)=>ze in oe?Nm(oe,ze,{enumerable:!0,configurable:!0,writable:!0,value:Le}):oe[ze]=Le;var z=(oe,ze,Le)=>(Sm(oe,typeof ze!="symbol"?ze+"":ze,Le),Le);(function(oe,ze){typeof exports=="object"&&typeof module!="undefined"?ze(exports):typeof define=="function"&&define.amd?define(["exports"],ze):(oe=typeof globalThis!="undefined"?globalThis:oe||self,ze(oe.Ethereal={}))})(this,function(oe){var Em,Om,zm;"use strict";class ze{constructor(e=0,t=0){this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,r=this.y,n=e.elements;return this.x=n[0]*t+n[3]*r+n[6],this.y=n[1]*t+n[4]*r+n[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t,r){return r!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const r=Math.cos(t),n=Math.sin(t),s=this.x-e.x,c=this.y-e.y;return this.x=s*r-c*n+e.x,this.y=s*n+c*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}ze.prototype.isVector2=!0;const Le=[];for(let i=0;i<256;i++)Le[i]=(i<16?"0":"")+i.toString(16);let Zi=1234567;const Ae=Math.PI/180,Ge=180/Math.PI;function Ro(){const i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(Le[i&255]+Le[i>>8&255]+Le[i>>16&255]+Le[i>>24&255]+"-"+Le[e&255]+Le[e>>8&255]+"-"+Le[e>>16&15|64]+Le[e>>24&255]+"-"+Le[t&63|128]+Le[t>>8&255]+"-"+Le[t>>16&255]+Le[t>>24&255]+Le[r&255]+Le[r>>8&255]+Le[r>>16&255]+Le[r>>24&255]).toLowerCase()}function at(i,e,t){return Math.max(e,Math.min(t,i))}function jn(i,e){return(i%e+e)%e}function Po(i,e,t,r,n){return r+(i-e)*(n-r)/(t-e)}function ko(i,e,t){return i!==e?(t-i)/(e-i):0}function dr(i,e,t){return(1-t)*i+t*e}function Lo(i,e,t,r){return dr(i,e,1-Math.exp(-t*r))}function Uo(i,e=1){return e-Math.abs(jn(i,e*2)-e)}function $o(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*(3-2*i))}function qo(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*i*(i*(i*6-15)+10))}function Vo(i,e){return i+Math.floor(Math.random()*(e-i+1))}function jo(i,e){return i+Math.random()*(e-i)}function Ho(i){return i*(.5-Math.random())}function Go(i){i!==void 0&&(Zi=i);let e=Zi+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function Wo(i){return i*Ae}function Yo(i){return i*Ge}function Zo(i){return(i&i-1)===0&&i!==0}function Jo(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function Qo(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function Xo(i,e,t,r,n){const s=Math.cos,c=Math.sin,l=s(t/2),h=c(t/2),f=s((e+r)/2),o=c((e+r)/2),a=s((e-r)/2),u=c((e-r)/2),p=s((r-e)/2),m=c((r-e)/2);switch(n){case"XYX":i.set(l*o,h*a,h*u,l*f);break;case"YZY":i.set(h*u,l*o,h*a,l*f);break;case"ZXZ":i.set(h*a,h*u,l*o,l*f);break;case"XZX":i.set(l*o,h*m,h*p,l*f);break;case"YXY":i.set(h*p,l*o,h*m,l*f);break;case"ZYZ":i.set(h*m,h*p,l*o,l*f);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}}function Ko(i,e){switch(e.constructor){case Float32Array:return i;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function eu(i,e){switch(e.constructor){case Float32Array:return i;case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}var tu=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",DEG2RAD:Ae,RAD2DEG:Ge,generateUUID:Ro,clamp:at,euclideanModulo:jn,mapLinear:Po,inverseLerp:ko,lerp:dr,damp:Lo,pingpong:Uo,smoothstep:$o,smootherstep:qo,randInt:Vo,randFloat:jo,randFloatSpread:Ho,seededRandom:Go,degToRad:Wo,radToDeg:Yo,isPowerOfTwo:Zo,ceilPowerOfTwo:Jo,floorPowerOfTwo:Qo,setQuaternionFromProperEuler:Xo,normalize:eu,denormalize:Ko});class He{constructor(e=0,t=0,r=0,n=1){this._x=e,this._y=t,this._z=r,this._w=n}static slerp(e,t,r,n){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),r.slerpQuaternions(e,t,n)}static slerpFlat(e,t,r,n,s,c,l){let h=r[n+0],f=r[n+1],o=r[n+2],a=r[n+3];const u=s[c+0],p=s[c+1],m=s[c+2],d=s[c+3];if(l===0){e[t+0]=h,e[t+1]=f,e[t+2]=o,e[t+3]=a;return}if(l===1){e[t+0]=u,e[t+1]=p,e[t+2]=m,e[t+3]=d;return}if(a!==d||h!==u||f!==p||o!==m){let w=1-l;const v=h*u+f*p+o*m+a*d,x=v>=0?1:-1,g=1-v*v;if(g>Number.EPSILON){const M=Math.sqrt(g),_=Math.atan2(M,v*x);w=Math.sin(w*_)/M,l=Math.sin(l*_)/M}const b=l*x;if(h=h*w+u*b,f=f*w+p*b,o=o*w+m*b,a=a*w+d*b,w===1-l){const M=1/Math.sqrt(h*h+f*f+o*o+a*a);h*=M,f*=M,o*=M,a*=M}}e[t]=h,e[t+1]=f,e[t+2]=o,e[t+3]=a}static multiplyQuaternionsFlat(e,t,r,n,s,c){const l=r[n],h=r[n+1],f=r[n+2],o=r[n+3],a=s[c],u=s[c+1],p=s[c+2],m=s[c+3];return e[t]=l*m+o*a+h*p-f*u,e[t+1]=h*m+o*u+f*a-l*p,e[t+2]=f*m+o*p+l*u-h*a,e[t+3]=o*m-l*a-h*u-f*p,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!(e&&e.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const r=e._x,n=e._y,s=e._z,c=e._order,l=Math.cos,h=Math.sin,f=l(r/2),o=l(n/2),a=l(s/2),u=h(r/2),p=h(n/2),m=h(s/2);switch(c){case"XYZ":this._x=u*o*a+f*p*m,this._y=f*p*a-u*o*m,this._z=f*o*m+u*p*a,this._w=f*o*a-u*p*m;break;case"YXZ":this._x=u*o*a+f*p*m,this._y=f*p*a-u*o*m,this._z=f*o*m-u*p*a,this._w=f*o*a+u*p*m;break;case"ZXY":this._x=u*o*a-f*p*m,this._y=f*p*a+u*o*m,this._z=f*o*m+u*p*a,this._w=f*o*a-u*p*m;break;case"ZYX":this._x=u*o*a-f*p*m,this._y=f*p*a+u*o*m,this._z=f*o*m-u*p*a,this._w=f*o*a+u*p*m;break;case"YZX":this._x=u*o*a+f*p*m,this._y=f*p*a+u*o*m,this._z=f*o*m-u*p*a,this._w=f*o*a-u*p*m;break;case"XZY":this._x=u*o*a-f*p*m,this._y=f*p*a-u*o*m,this._z=f*o*m+u*p*a,this._w=f*o*a+u*p*m;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+c)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,n=Math.sin(r);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],n=t[4],s=t[8],c=t[1],l=t[5],h=t[9],f=t[2],o=t[6],a=t[10],u=r+l+a;if(u>0){const p=.5/Math.sqrt(u+1);this._w=.25/p,this._x=(o-h)*p,this._y=(s-f)*p,this._z=(c-n)*p}else if(r>l&&r>a){const p=2*Math.sqrt(1+r-l-a);this._w=(o-h)/p,this._x=.25*p,this._y=(n+c)/p,this._z=(s+f)/p}else if(l>a){const p=2*Math.sqrt(1+l-r-a);this._w=(s-f)/p,this._x=(n+c)/p,this._y=.25*p,this._z=(h+o)/p}else{const p=2*Math.sqrt(1+a-r-l);this._w=(c-n)/p,this._x=(s+f)/p,this._y=(h+o)/p,this._z=.25*p}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(at(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(r===0)return this;const n=Math.min(1,t/r);return this.slerp(e,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,t){return t!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,n=e._y,s=e._z,c=e._w,l=t._x,h=t._y,f=t._z,o=t._w;return this._x=r*o+c*l+n*f-s*h,this._y=n*o+c*h+s*l-r*f,this._z=s*o+c*f+r*h-n*l,this._w=c*o-r*l-n*h-s*f,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const r=this._x,n=this._y,s=this._z,c=this._w;let l=c*e._w+r*e._x+n*e._y+s*e._z;if(l<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,l=-l):this.copy(e),l>=1)return this._w=c,this._x=r,this._y=n,this._z=s,this;const h=1-l*l;if(h<=Number.EPSILON){const p=1-t;return this._w=p*c+t*this._w,this._x=p*r+t*this._x,this._y=p*n+t*this._y,this._z=p*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const f=Math.sqrt(h),o=Math.atan2(f,l),a=Math.sin((1-t)*o)/f,u=Math.sin(t*o)/f;return this._w=c*a+this._w*u,this._x=r*a+this._x*u,this._y=n*a+this._y*u,this._z=s*a+this._z*u,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){const e=Math.random(),t=Math.sqrt(1-e),r=Math.sqrt(e),n=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(n),r*Math.sin(s),r*Math.cos(s),t*Math.sin(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}He.prototype.isQuaternion=!0;class G{constructor(e=0,t=0,r=0){this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e,t){return t!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Ji.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Ji.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,n=this.z,s=e.elements;return this.x=s[0]*t+s[3]*r+s[6]*n,this.y=s[1]*t+s[4]*r+s[7]*n,this.z=s[2]*t+s[5]*r+s[8]*n,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,n=this.z,s=e.elements,c=1/(s[3]*t+s[7]*r+s[11]*n+s[15]);return this.x=(s[0]*t+s[4]*r+s[8]*n+s[12])*c,this.y=(s[1]*t+s[5]*r+s[9]*n+s[13])*c,this.z=(s[2]*t+s[6]*r+s[10]*n+s[14])*c,this}applyQuaternion(e){const t=this.x,r=this.y,n=this.z,s=e.x,c=e.y,l=e.z,h=e.w,f=h*t+c*n-l*r,o=h*r+l*t-s*n,a=h*n+s*r-c*t,u=-s*t-c*r-l*n;return this.x=f*h+u*-s+o*-l-a*-c,this.y=o*h+u*-c+a*-s-f*-l,this.z=a*h+u*-l+f*-c-o*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,n=this.z,s=e.elements;return this.x=s[0]*t+s[4]*r+s[8]*n,this.y=s[1]*t+s[5]*r+s[9]*n,this.z=s[2]*t+s[6]*r+s[10]*n,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e,t){return t!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,n=e.y,s=e.z,c=t.x,l=t.y,h=t.z;return this.x=n*h-s*l,this.y=s*c-r*h,this.z=r*l-n*c,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return Hn.copy(this).projectOnVector(e),this.sub(Hn)}reflect(e){return this.sub(Hn.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(at(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return t*t+r*r+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const n=Math.sin(t)*e;return this.x=n*Math.sin(r),this.y=Math.cos(t)*e,this.z=n*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=n,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t,r){return r!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(t),this.y=r*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}G.prototype.isVector3=!0;const Hn=new G,Ji=new He;class Qi{constructor(e=0,t=0,r=0,n=1){this.x=e,this.y=t,this.z=r,this.w=n}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,n){return this.x=e,this.y=t,this.z=r,this.w=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,r=this.y,n=this.z,s=this.w,c=e.elements;return this.x=c[0]*t+c[4]*r+c[8]*n+c[12]*s,this.y=c[1]*t+c[5]*r+c[9]*n+c[13]*s,this.z=c[2]*t+c[6]*r+c[10]*n+c[14]*s,this.w=c[3]*t+c[7]*r+c[11]*n+c[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,n,s;const h=e.elements,f=h[0],o=h[4],a=h[8],u=h[1],p=h[5],m=h[9],d=h[2],w=h[6],v=h[10];if(Math.abs(o-u)<.01&&Math.abs(a-d)<.01&&Math.abs(m-w)<.01){if(Math.abs(o+u)<.1&&Math.abs(a+d)<.1&&Math.abs(m+w)<.1&&Math.abs(f+p+v-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const g=(f+1)/2,b=(p+1)/2,M=(v+1)/2,_=(o+u)/4,N=(a+d)/4,O=(m+w)/4;return g>b&&g>M?g<.01?(r=0,n=.707106781,s=.707106781):(r=Math.sqrt(g),n=_/r,s=N/r):b>M?b<.01?(r=.707106781,n=0,s=.707106781):(n=Math.sqrt(b),r=_/n,s=O/n):M<.01?(r=.707106781,n=.707106781,s=0):(s=Math.sqrt(M),r=N/s,n=O/s),this.set(r,n,s,t),this}let x=Math.sqrt((w-m)*(w-m)+(a-d)*(a-d)+(u-o)*(u-o));return Math.abs(x)<.001&&(x=1),this.x=(w-m)/x,this.y=(a-d)/x,this.z=(u-o)/x,this.w=Math.acos((f+p+v-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t,r){return r!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}Qi.prototype.isVector4=!0;class xe{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,t,r,n,s,c,l,h,f,o,a,u,p,m,d,w){const v=this.elements;return v[0]=e,v[4]=t,v[8]=r,v[12]=n,v[1]=s,v[5]=c,v[9]=l,v[13]=h,v[2]=f,v[6]=o,v[10]=a,v[14]=u,v[3]=p,v[7]=m,v[11]=d,v[15]=w,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new xe().fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,r=e.elements,n=1/mr.setFromMatrixColumn(e,0).length(),s=1/mr.setFromMatrixColumn(e,1).length(),c=1/mr.setFromMatrixColumn(e,2).length();return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=0,t[4]=r[4]*s,t[5]=r[5]*s,t[6]=r[6]*s,t[7]=0,t[8]=r[8]*c,t[9]=r[9]*c,t[10]=r[10]*c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const t=this.elements,r=e.x,n=e.y,s=e.z,c=Math.cos(r),l=Math.sin(r),h=Math.cos(n),f=Math.sin(n),o=Math.cos(s),a=Math.sin(s);if(e.order==="XYZ"){const u=c*o,p=c*a,m=l*o,d=l*a;t[0]=h*o,t[4]=-h*a,t[8]=f,t[1]=p+m*f,t[5]=u-d*f,t[9]=-l*h,t[2]=d-u*f,t[6]=m+p*f,t[10]=c*h}else if(e.order==="YXZ"){const u=h*o,p=h*a,m=f*o,d=f*a;t[0]=u+d*l,t[4]=m*l-p,t[8]=c*f,t[1]=c*a,t[5]=c*o,t[9]=-l,t[2]=p*l-m,t[6]=d+u*l,t[10]=c*h}else if(e.order==="ZXY"){const u=h*o,p=h*a,m=f*o,d=f*a;t[0]=u-d*l,t[4]=-c*a,t[8]=m+p*l,t[1]=p+m*l,t[5]=c*o,t[9]=d-u*l,t[2]=-c*f,t[6]=l,t[10]=c*h}else if(e.order==="ZYX"){const u=c*o,p=c*a,m=l*o,d=l*a;t[0]=h*o,t[4]=m*f-p,t[8]=u*f+d,t[1]=h*a,t[5]=d*f+u,t[9]=p*f-m,t[2]=-f,t[6]=l*h,t[10]=c*h}else if(e.order==="YZX"){const u=c*h,p=c*f,m=l*h,d=l*f;t[0]=h*o,t[4]=d-u*a,t[8]=m*a+p,t[1]=a,t[5]=c*o,t[9]=-l*o,t[2]=-f*o,t[6]=p*a+m,t[10]=u-d*a}else if(e.order==="XZY"){const u=c*h,p=c*f,m=l*h,d=l*f;t[0]=h*o,t[4]=-a,t[8]=f*o,t[1]=u*a+d,t[5]=c*o,t[9]=p*a-m,t[2]=m*a-p,t[6]=l*o,t[10]=d*a+u}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(ru,e,nu)}lookAt(e,t,r){const n=this.elements;return dt.subVectors(e,t),dt.lengthSq()===0&&(dt.z=1),dt.normalize(),$t.crossVectors(r,dt),$t.lengthSq()===0&&(Math.abs(r.z)===1?dt.x+=1e-4:dt.z+=1e-4,dt.normalize(),$t.crossVectors(r,dt)),$t.normalize(),en.crossVectors(dt,$t),n[0]=$t.x,n[4]=en.x,n[8]=dt.x,n[1]=$t.y,n[5]=en.y,n[9]=dt.y,n[2]=$t.z,n[6]=en.z,n[10]=dt.z,this}multiply(e,t){return t!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,n=t.elements,s=this.elements,c=r[0],l=r[4],h=r[8],f=r[12],o=r[1],a=r[5],u=r[9],p=r[13],m=r[2],d=r[6],w=r[10],v=r[14],x=r[3],g=r[7],b=r[11],M=r[15],_=n[0],N=n[4],O=n[8],E=n[12],F=n[1],B=n[5],I=n[9],j=n[13],q=n[2],H=n[6],k=n[10],S=n[14],J=n[3],A=n[7],ie=n[11],de=n[15];return s[0]=c*_+l*F+h*q+f*J,s[4]=c*N+l*B+h*H+f*A,s[8]=c*O+l*I+h*k+f*ie,s[12]=c*E+l*j+h*S+f*de,s[1]=o*_+a*F+u*q+p*J,s[5]=o*N+a*B+u*H+p*A,s[9]=o*O+a*I+u*k+p*ie,s[13]=o*E+a*j+u*S+p*de,s[2]=m*_+d*F+w*q+v*J,s[6]=m*N+d*B+w*H+v*A,s[10]=m*O+d*I+w*k+v*ie,s[14]=m*E+d*j+w*S+v*de,s[3]=x*_+g*F+b*q+M*J,s[7]=x*N+g*B+b*H+M*A,s[11]=x*O+g*I+b*k+M*ie,s[15]=x*E+g*j+b*S+M*de,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],n=e[8],s=e[12],c=e[1],l=e[5],h=e[9],f=e[13],o=e[2],a=e[6],u=e[10],p=e[14],m=e[3],d=e[7],w=e[11],v=e[15];return m*(+s*h*a-n*f*a-s*l*u+r*f*u+n*l*p-r*h*p)+d*(+t*h*p-t*f*u+s*c*u-n*c*p+n*f*o-s*h*o)+w*(+t*f*a-t*l*p-s*c*a+r*c*p+s*l*o-r*f*o)+v*(-n*l*o-t*h*a+t*l*u+n*c*a-r*c*u+r*h*o)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=t,n[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],n=e[2],s=e[3],c=e[4],l=e[5],h=e[6],f=e[7],o=e[8],a=e[9],u=e[10],p=e[11],m=e[12],d=e[13],w=e[14],v=e[15],x=a*w*f-d*u*f+d*h*p-l*w*p-a*h*v+l*u*v,g=m*u*f-o*w*f-m*h*p+c*w*p+o*h*v-c*u*v,b=o*d*f-m*a*f+m*l*p-c*d*p-o*l*v+c*a*v,M=m*a*h-o*d*h-m*l*u+c*d*u+o*l*w-c*a*w,_=t*x+r*g+n*b+s*M;if(_===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const N=1/_;return e[0]=x*N,e[1]=(d*u*s-a*w*s-d*n*p+r*w*p+a*n*v-r*u*v)*N,e[2]=(l*w*s-d*h*s+d*n*f-r*w*f-l*n*v+r*h*v)*N,e[3]=(a*h*s-l*u*s-a*n*f+r*u*f+l*n*p-r*h*p)*N,e[4]=g*N,e[5]=(o*w*s-m*u*s+m*n*p-t*w*p-o*n*v+t*u*v)*N,e[6]=(m*h*s-c*w*s-m*n*f+t*w*f+c*n*v-t*h*v)*N,e[7]=(c*u*s-o*h*s+o*n*f-t*u*f-c*n*p+t*h*p)*N,e[8]=b*N,e[9]=(m*a*s-o*d*s-m*r*p+t*d*p+o*r*v-t*a*v)*N,e[10]=(c*d*s-m*l*s+m*r*f-t*d*f-c*r*v+t*l*v)*N,e[11]=(o*l*s-c*a*s-o*r*f+t*a*f+c*r*p-t*l*p)*N,e[12]=M*N,e[13]=(o*d*n-m*a*n+m*r*u-t*d*u-o*r*w+t*a*w)*N,e[14]=(m*l*n-c*d*n-m*r*h+t*d*h+c*r*w-t*l*w)*N,e[15]=(c*a*n-o*l*n+o*r*h-t*a*h-c*r*u+t*l*u)*N,this}scale(e){const t=this.elements,r=e.x,n=e.y,s=e.z;return t[0]*=r,t[4]*=n,t[8]*=s,t[1]*=r,t[5]*=n,t[9]*=s,t[2]*=r,t[6]*=n,t[10]*=s,t[3]*=r,t[7]*=n,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,n))}makeTranslation(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),n=Math.sin(t),s=1-r,c=e.x,l=e.y,h=e.z,f=s*c,o=s*l;return this.set(f*c+r,f*l-n*h,f*h+n*l,0,f*l+n*h,o*l+r,o*h-n*c,0,f*h-n*l,o*h+n*c,s*h*h+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,n,s,c){return this.set(1,r,s,0,e,1,c,0,t,n,1,0,0,0,0,1),this}compose(e,t,r){const n=this.elements,s=t._x,c=t._y,l=t._z,h=t._w,f=s+s,o=c+c,a=l+l,u=s*f,p=s*o,m=s*a,d=c*o,w=c*a,v=l*a,x=h*f,g=h*o,b=h*a,M=r.x,_=r.y,N=r.z;return n[0]=(1-(d+v))*M,n[1]=(p+b)*M,n[2]=(m-g)*M,n[3]=0,n[4]=(p-b)*_,n[5]=(1-(u+v))*_,n[6]=(w+x)*_,n[7]=0,n[8]=(m+g)*N,n[9]=(w-x)*N,n[10]=(1-(u+d))*N,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this}decompose(e,t,r){const n=this.elements;let s=mr.set(n[0],n[1],n[2]).length();const c=mr.set(n[4],n[5],n[6]).length(),l=mr.set(n[8],n[9],n[10]).length();this.determinant()<0&&(s=-s),e.x=n[12],e.y=n[13],e.z=n[14],Mt.copy(this);const f=1/s,o=1/c,a=1/l;return Mt.elements[0]*=f,Mt.elements[1]*=f,Mt.elements[2]*=f,Mt.elements[4]*=o,Mt.elements[5]*=o,Mt.elements[6]*=o,Mt.elements[8]*=a,Mt.elements[9]*=a,Mt.elements[10]*=a,t.setFromRotationMatrix(Mt),r.x=s,r.y=c,r.z=l,this}makePerspective(e,t,r,n,s,c){c===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const l=this.elements,h=2*s/(t-e),f=2*s/(r-n),o=(t+e)/(t-e),a=(r+n)/(r-n),u=-(c+s)/(c-s),p=-2*c*s/(c-s);return l[0]=h,l[4]=0,l[8]=o,l[12]=0,l[1]=0,l[5]=f,l[9]=a,l[13]=0,l[2]=0,l[6]=0,l[10]=u,l[14]=p,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,r,n,s,c){const l=this.elements,h=1/(t-e),f=1/(r-n),o=1/(c-s),a=(t+e)*h,u=(r+n)*f,p=(c+s)*o;return l[0]=2*h,l[4]=0,l[8]=0,l[12]=-a,l[1]=0,l[5]=2*f,l[9]=0,l[13]=-u,l[2]=0,l[6]=0,l[10]=-2*o,l[14]=-p,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let n=0;n<16;n++)if(t[n]!==r[n])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}xe.prototype.isMatrix4=!0;const mr=new G,Mt=new xe,ru=new G(0,0,0),nu=new G(1,1,1),$t=new G,en=new G,dt=new G,Xi=new xe,Ki=new He;class er{constructor(e=0,t=0,r=0,n=er.DefaultOrder){this._x=e,this._y=t,this._z=r,this._order=n}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,n=this._order){return this._x=e,this._y=t,this._z=r,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){const n=e.elements,s=n[0],c=n[4],l=n[8],h=n[1],f=n[5],o=n[9],a=n[2],u=n[6],p=n[10];switch(t){case"XYZ":this._y=Math.asin(at(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-o,p),this._z=Math.atan2(-c,s)):(this._x=Math.atan2(u,f),this._z=0);break;case"YXZ":this._x=Math.asin(-at(o,-1,1)),Math.abs(o)<.9999999?(this._y=Math.atan2(l,p),this._z=Math.atan2(h,f)):(this._y=Math.atan2(-a,s),this._z=0);break;case"ZXY":this._x=Math.asin(at(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(-a,p),this._z=Math.atan2(-c,f)):(this._y=0,this._z=Math.atan2(h,s));break;case"ZYX":this._y=Math.asin(-at(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(u,p),this._z=Math.atan2(h,s)):(this._x=0,this._z=Math.atan2(-c,f));break;case"YZX":this._z=Math.asin(at(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-o,f),this._y=Math.atan2(-a,s)):(this._x=0,this._y=Math.atan2(l,p));break;case"XZY":this._z=Math.asin(-at(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(u,f),this._y=Math.atan2(l,s)):(this._x=Math.atan2(-o,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return Xi.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Xi,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return Ki.setFromEuler(this),this.setFromQuaternion(Ki,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}er.prototype.isEuler=!0,er.DefaultOrder="XYZ",er.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];const It="srgb",tr="srgb-linear";function tn(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function rn(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}const Gn={[It]:{[tr]:tn},[tr]:{[It]:rn}},_t={legacyMode:!0,get workingColorSpace(){return tr},set workingColorSpace(i){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(i,e,t){if(this.legacyMode||e===t||!e||!t)return i;if(Gn[e]&&Gn[e][t]!==void 0){const r=Gn[e][t];return i.r=r(i.r),i.g=r(i.g),i.b=r(i.b),i}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(i,e){return this.convert(i,this.workingColorSpace,e)},toWorkingColorSpace:function(i,e){return this.convert(i,e,this.workingColorSpace)}},es={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Je={r:0,g:0,b:0},Nt={h:0,s:0,l:0},nn={h:0,s:0,l:0};function Wn(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*6*(2/3-t):i}function sn(i,e){return e.r=i.r,e.g=i.g,e.b=i.b,e}class qt{constructor(e,t,r){return t===void 0&&r===void 0?this.set(e):this.setRGB(e,t,r)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=It){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,_t.toWorkingColorSpace(this,t),this}setRGB(e,t,r,n=tr){return this.r=e,this.g=t,this.b=r,_t.toWorkingColorSpace(this,n),this}setHSL(e,t,r,n=tr){if(e=jn(e,1),t=at(t,0,1),r=at(r,0,1),t===0)this.r=this.g=this.b=r;else{const s=r<=.5?r*(1+t):r+t-r*t,c=2*r-s;this.r=Wn(c,s,e+1/3),this.g=Wn(c,s,e),this.b=Wn(c,s,e-1/3)}return _t.toWorkingColorSpace(this,n),this}setStyle(e,t=It){function r(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let s;const c=n[1],l=n[2];switch(c){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return this.r=Math.min(255,parseInt(s[1],10))/255,this.g=Math.min(255,parseInt(s[2],10))/255,this.b=Math.min(255,parseInt(s[3],10))/255,_t.toWorkingColorSpace(this,t),r(s[4]),this;if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return this.r=Math.min(100,parseInt(s[1],10))/100,this.g=Math.min(100,parseInt(s[2],10))/100,this.b=Math.min(100,parseInt(s[3],10))/100,_t.toWorkingColorSpace(this,t),r(s[4]),this;break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l)){const h=parseFloat(s[1])/360,f=parseInt(s[2],10)/100,o=parseInt(s[3],10)/100;return r(s[4]),this.setHSL(h,f,o,t)}break}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=n[1],c=s.length;if(c===3)return this.r=parseInt(s.charAt(0)+s.charAt(0),16)/255,this.g=parseInt(s.charAt(1)+s.charAt(1),16)/255,this.b=parseInt(s.charAt(2)+s.charAt(2),16)/255,_t.toWorkingColorSpace(this,t),this;if(c===6)return this.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,this.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,this.b=parseInt(s.charAt(4)+s.charAt(5),16)/255,_t.toWorkingColorSpace(this,t),this}return e&&e.length>0?this.setColorName(e,t):this}setColorName(e,t=It){const r=es[e.toLowerCase()];return r!==void 0?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=tn(e.r),this.g=tn(e.g),this.b=tn(e.b),this}copyLinearToSRGB(e){return this.r=rn(e.r),this.g=rn(e.g),this.b=rn(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=It){return _t.fromWorkingColorSpace(sn(this,Je),e),at(Je.r*255,0,255)<<16^at(Je.g*255,0,255)<<8^at(Je.b*255,0,255)<<0}getHexString(e=It){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=tr){_t.fromWorkingColorSpace(sn(this,Je),t);const r=Je.r,n=Je.g,s=Je.b,c=Math.max(r,n,s),l=Math.min(r,n,s);let h,f;const o=(l+c)/2;if(l===c)h=0,f=0;else{const a=c-l;switch(f=o<=.5?a/(c+l):a/(2-c-l),c){case r:h=(n-s)/a+(n<s?6:0);break;case n:h=(s-r)/a+2;break;case s:h=(r-n)/a+4;break}h/=6}return e.h=h,e.s=f,e.l=o,e}getRGB(e,t=tr){return _t.fromWorkingColorSpace(sn(this,Je),t),e.r=Je.r,e.g=Je.g,e.b=Je.b,e}getStyle(e=It){return _t.fromWorkingColorSpace(sn(this,Je),e),e!==It?`color(${e} ${Je.r} ${Je.g} ${Je.b})`:`rgb(${Je.r*255|0},${Je.g*255|0},${Je.b*255|0})`}offsetHSL(e,t,r){return this.getHSL(Nt),Nt.h+=e,Nt.s+=t,Nt.l+=r,this.setHSL(Nt.h,Nt.s,Nt.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(Nt),e.getHSL(nn);const r=dr(Nt.h,nn.h,t),n=dr(Nt.s,nn.s,t),s=dr(Nt.l,nn.l,t);return this.setHSL(r,n,s),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),e.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}qt.NAMES=es,qt.prototype.isColor=!0,qt.prototype.r=1,qt.prototype.g=1,qt.prototype.b=1;const ts=new ze;class vr{constructor(e=new ze(1/0,1/0),t=new ze(-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=ts.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return ts.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}vr.prototype.isBox2=!0;class tt{constructor(e=new G(1/0,1/0,1/0),t=new G(-1/0,-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,r=1/0,n=1/0,s=-1/0,c=-1/0,l=-1/0;for(let h=0,f=e.length;h<f;h+=3){const o=e[h],a=e[h+1],u=e[h+2];o<t&&(t=o),a<r&&(r=a),u<n&&(n=u),o>s&&(s=o),a>c&&(c=a),u>l&&(l=u)}return this.min.set(t,r,n),this.max.set(s,c,l),this}setFromBufferAttribute(e){let t=1/0,r=1/0,n=1/0,s=-1/0,c=-1/0,l=-1/0;for(let h=0,f=e.count;h<f;h++){const o=e.getX(h),a=e.getY(h),u=e.getZ(h);o<t&&(t=o),a<r&&(r=a),u<n&&(n=u),o>s&&(s=o),a>c&&(c=a),u>l&&(l=u)}return this.min.set(t,r,n),this.max.set(s,c,l),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=rr.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(r!==void 0)if(t&&r.attributes!=null&&r.attributes.position!==void 0){const s=r.attributes.position;for(let c=0,l=s.count;c<l;c++)rr.fromBufferAttribute(s,c).applyMatrix4(e.matrixWorld),this.expandByPoint(rr)}else r.boundingBox===null&&r.computeBoundingBox(),Yn.copy(r.boundingBox),Yn.applyMatrix4(e.matrixWorld),this.union(Yn);const n=e.children;for(let s=0,c=n.length;s<c;s++)this.expandByObject(n[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,rr),rr.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Dr),an.subVectors(this.max,Dr),gr.subVectors(e.a,Dr),yr.subVectors(e.b,Dr),wr.subVectors(e.c,Dr),Vt.subVectors(yr,gr),jt.subVectors(wr,yr),nr.subVectors(gr,wr);let t=[0,-Vt.z,Vt.y,0,-jt.z,jt.y,0,-nr.z,nr.y,Vt.z,0,-Vt.x,jt.z,0,-jt.x,nr.z,0,-nr.x,-Vt.y,Vt.x,0,-jt.y,jt.x,0,-nr.y,nr.x,0];return!Zn(t,gr,yr,wr,an)||(t=[1,0,0,0,1,0,0,0,1],!Zn(t,gr,yr,wr,an))?!1:(on.crossVectors(Vt,jt),t=[on.x,on.y,on.z],Zn(t,gr,yr,wr,an))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return rr.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=this.getSize(rr).length()*.5,e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Bt[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Bt[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Bt[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Bt[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Bt[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Bt[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Bt[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Bt[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Bt),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}tt.prototype.isBox3=!0;const Bt=[new G,new G,new G,new G,new G,new G,new G,new G],rr=new G,Yn=new tt,gr=new G,yr=new G,wr=new G,Vt=new G,jt=new G,nr=new G,Dr=new G,an=new G,on=new G,ir=new G;function Zn(i,e,t,r,n){for(let s=0,c=i.length-3;s<=c;s+=3){ir.fromArray(i,s);const l=n.x*Math.abs(ir.x)+n.y*Math.abs(ir.y)+n.z*Math.abs(ir.z),h=e.dot(ir),f=t.dot(ir),o=r.dot(ir);if(Math.max(-Math.max(h,f,o),Math.min(h,f,o))>l)return!1}return!0}const Rt=new G,Jn=new G,un=new G,Ht=new G,Qn=new G,cn=new G,Xn=new G;class iu{constructor(e=new G,t=new G(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Rt)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(r).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Rt.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Rt.copy(this.direction).multiplyScalar(t).add(this.origin),Rt.distanceToSquared(e))}distanceSqToSegment(e,t,r,n){Jn.copy(e).add(t).multiplyScalar(.5),un.copy(t).sub(e).normalize(),Ht.copy(this.origin).sub(Jn);const s=e.distanceTo(t)*.5,c=-this.direction.dot(un),l=Ht.dot(this.direction),h=-Ht.dot(un),f=Ht.lengthSq(),o=Math.abs(1-c*c);let a,u,p,m;if(o>0)if(a=c*h-l,u=c*l-h,m=s*o,a>=0)if(u>=-m)if(u<=m){const d=1/o;a*=d,u*=d,p=a*(a+c*u+2*l)+u*(c*a+u+2*h)+f}else u=s,a=Math.max(0,-(c*u+l)),p=-a*a+u*(u+2*h)+f;else u=-s,a=Math.max(0,-(c*u+l)),p=-a*a+u*(u+2*h)+f;else u<=-m?(a=Math.max(0,-(-c*s+l)),u=a>0?-s:Math.min(Math.max(-s,-h),s),p=-a*a+u*(u+2*h)+f):u<=m?(a=0,u=Math.min(Math.max(-s,-h),s),p=u*(u+2*h)+f):(a=Math.max(0,-(c*s+l)),u=a>0?s:Math.min(Math.max(-s,-h),s),p=-a*a+u*(u+2*h)+f);else u=c>0?-s:s,a=Math.max(0,-(c*u+l)),p=-a*a+u*(u+2*h)+f;return r&&r.copy(this.direction).multiplyScalar(a).add(this.origin),n&&n.copy(un).multiplyScalar(u).add(Jn),p}intersectSphere(e,t){Rt.subVectors(e.center,this.origin);const r=Rt.dot(this.direction),n=Rt.dot(Rt)-r*r,s=e.radius*e.radius;if(n>s)return null;const c=Math.sqrt(s-n),l=r-c,h=r+c;return l<0&&h<0?null:l<0?this.at(h,t):this.at(l,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){const r=this.distanceToPlane(e);return r===null?null:this.at(r,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,n,s,c,l,h;const f=1/this.direction.x,o=1/this.direction.y,a=1/this.direction.z,u=this.origin;return f>=0?(r=(e.min.x-u.x)*f,n=(e.max.x-u.x)*f):(r=(e.max.x-u.x)*f,n=(e.min.x-u.x)*f),o>=0?(s=(e.min.y-u.y)*o,c=(e.max.y-u.y)*o):(s=(e.max.y-u.y)*o,c=(e.min.y-u.y)*o),r>c||s>n||((s>r||r!==r)&&(r=s),(c<n||n!==n)&&(n=c),a>=0?(l=(e.min.z-u.z)*a,h=(e.max.z-u.z)*a):(l=(e.max.z-u.z)*a,h=(e.min.z-u.z)*a),r>h||l>n)||((l>r||r!==r)&&(r=l),(h<n||n!==n)&&(n=h),n<0)?null:this.at(r>=0?r:n,t)}intersectsBox(e){return this.intersectBox(e,Rt)!==null}intersectTriangle(e,t,r,n,s){Qn.subVectors(t,e),cn.subVectors(r,e),Xn.crossVectors(Qn,cn);let c=this.direction.dot(Xn),l;if(c>0){if(n)return null;l=1}else if(c<0)l=-1,c=-c;else return null;Ht.subVectors(this.origin,e);const h=l*this.direction.dot(cn.crossVectors(Ht,cn));if(h<0)return null;const f=l*this.direction.dot(Qn.cross(Ht));if(f<0||h+f>c)return null;const o=-l*Ht.dot(Xn);return o<0?null:this.at(o/c,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}const rs=new G,hn=new G;class su{constructor(e=new G,t=new G){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){rs.subVectors(e,this.start),hn.subVectors(this.end,this.start);const r=hn.dot(hn);let s=hn.dot(rs)/r;return t&&(s=at(s,0,1)),s}closestPointToPoint(e,t,r){const n=this.closestPointToPointParameter(e,t);return this.delta(r).multiplyScalar(n).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}class Kn{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,t,r,n,s,c,l,h,f){const o=this.elements;return o[0]=e,o[1]=n,o[2]=l,o[3]=t,o[4]=s,o[5]=h,o[6]=r,o[7]=c,o[8]=f,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,n=t.elements,s=this.elements,c=r[0],l=r[3],h=r[6],f=r[1],o=r[4],a=r[7],u=r[2],p=r[5],m=r[8],d=n[0],w=n[3],v=n[6],x=n[1],g=n[4],b=n[7],M=n[2],_=n[5],N=n[8];return s[0]=c*d+l*x+h*M,s[3]=c*w+l*g+h*_,s[6]=c*v+l*b+h*N,s[1]=f*d+o*x+a*M,s[4]=f*w+o*g+a*_,s[7]=f*v+o*b+a*N,s[2]=u*d+p*x+m*M,s[5]=u*w+p*g+m*_,s[8]=u*v+p*b+m*N,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],n=e[2],s=e[3],c=e[4],l=e[5],h=e[6],f=e[7],o=e[8];return t*c*o-t*l*f-r*s*o+r*l*h+n*s*f-n*c*h}invert(){const e=this.elements,t=e[0],r=e[1],n=e[2],s=e[3],c=e[4],l=e[5],h=e[6],f=e[7],o=e[8],a=o*c-l*f,u=l*h-o*s,p=f*s-c*h,m=t*a+r*u+n*p;if(m===0)return this.set(0,0,0,0,0,0,0,0,0);const d=1/m;return e[0]=a*d,e[1]=(n*f-o*r)*d,e[2]=(l*r-n*c)*d,e[3]=u*d,e[4]=(o*t-n*h)*d,e[5]=(n*s-l*t)*d,e[6]=p*d,e[7]=(r*h-f*t)*d,e[8]=(c*t-r*s)*d,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,n,s,c,l){const h=Math.cos(s),f=Math.sin(s);return this.set(r*h,r*f,-r*(h*c+f*l)+c+e,-n*f,n*h,-n*(-f*c+h*l)+l+t,0,0,1),this}scale(e,t){const r=this.elements;return r[0]*=e,r[3]*=e,r[6]*=e,r[1]*=t,r[4]*=t,r[7]*=t,this}rotate(e){const t=Math.cos(e),r=Math.sin(e),n=this.elements,s=n[0],c=n[3],l=n[6],h=n[1],f=n[4],o=n[7];return n[0]=t*s+r*h,n[3]=t*c+r*f,n[6]=t*l+r*o,n[1]=-r*s+t*h,n[4]=-r*c+t*f,n[7]=-r*l+t*o,this}translate(e,t){const r=this.elements;return r[0]+=e*r[2],r[3]+=e*r[5],r[6]+=e*r[8],r[1]+=t*r[2],r[4]+=t*r[5],r[7]+=t*r[8],this}equals(e){const t=this.elements,r=e.elements;for(let n=0;n<9;n++)if(t[n]!==r[n])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}Kn.prototype.isMatrix3=!0;const ei=new G,au=new G,ou=new Kn;class ns{constructor(e=new G(1,0,0),t=0){this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,n){return this.normal.set(e,t,r),this.constant=n,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){const n=ei.subVectors(r,t).cross(au.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(n,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const r=e.delta(ei),n=this.normal.dot(r);if(n===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/n;return s<0||s>1?null:t.copy(r).multiplyScalar(s).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const r=t||ou.getNormalMatrix(e),n=this.coplanarPoint(ei).applyMatrix4(e),s=this.normal.applyMatrix3(r).normalize();return this.constant=-n.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}ns.prototype.isPlane=!0;const is=Object.freeze(new ze(0,0)),uu=Object.freeze(new ze(1,1)),mt=Object.freeze(new G(0,0,0)),cu=Object.freeze(new G(1,0,0)),hu=Object.freeze(new G(0,1,0)),lu=Object.freeze(new G(0,0,1)),ti=Object.freeze(new G(1,1,1)),ri=Object.freeze(new He),Ir={RIGHT:Object.freeze(new G(1,0,0)),UP:Object.freeze(new G(0,1,0)),NEAR:Object.freeze(new G(0,0,1)),LEFT:Object.freeze(new G(-1,0,0)),DOWN:Object.freeze(new G(0,-1,0)),FAR:Object.freeze(new G(0,0,-1))};function ni(i,e){return typeof i=="number"?fu(i,e):"isVector3"in i?pu(i,e):"isVector2"in i?du(i,e):"isBox3"in i?mu(i,e):"isQuaternion"in i?vu(i,e):"isColor"in i?gu(i,e):1/0}function fu(i,e){if(e===i)return 0;const t=Math.abs(e-i),r=(Math.abs(e)+Math.abs(i))/2;return t/r}function pu(i,e){if(e.equals(i))return 0;const t=e.distanceTo(i),r=(e.length()+i.length())/2;return t/r}function du(i,e){if(e.equals(i))return 0;const t=e.distanceTo(i),r=(e.length()+i.length())/2;return t/r}function mu(i,e){if(i.equals(e))return 0;const t=ss,r=e.min.distanceTo(i.min),n=e.max.distanceTo(i.max),s=(r+n)/2,c=(e.getSize(t).length()+i.getSize(t).length())/2;return s/c}const ss=new G;function vu(i,e){return i.equals(e)?0:i.angleTo(e)/Math.PI}function gu(i,e){return i.equals(e)?0:ss.set(Math.abs(e.r-i.r),Math.abs(e.g-i.g),Math.abs(e.b-i.b)).length()/yu}const yu=Math.sqrt(3),Br=(i=1)=>{var e=Math.random();return(e%1e-8>5e-9?1:-1)*Math.sqrt(-Math.log(Math.max(1e-9,e)))*i},ii=(i=1)=>{const e=Math.sqrt(Math.sqrt(1/(2*i)));return 1/Br(e)**2},ln=(()=>{const i=Math.PI*2,e=new G(0,0,1),t=new He,r=new He,n=new G,s=new He;return function(l=1,h=1){var f=(Math.random()-.5)*i*l,o=Math.random()*i,a=Math.random()*Math.PI*h;return n.set(1,0,0).applyAxisAngle(e,o),t.setFromAxisAngle(e,f),r.setFromAxisAngle(n,a),s.multiplyQuaternions(r,t)}})();function as(i,e){let t=0;for(let n=0;n<i.length;n++)t+=(e==null?void 0:e[n])||1;const r=Math.random()*t;t=0;for(let n=0;n<i.length;n++)if(t+=(e==null?void 0:e[n])||1,t>r)return i[n];return i[0]}const wu=(()=>{const i=new G;return function(t,r,n){const s=i.set(t.x,t.y,t.z),c=r.dot(s),l=i.copy(r).multiplyScalar(c),h=n.set(l.x,l.y,l.z,t.w).normalize();return c<0&&(h.x=-h.x,h.y=-h.y,h.z=-h.z,h.w=-h.w),h}})();class fn{constructor(){z(this,"callbacks",[])}memoize(e,...t){t.push(this);const r=xu(e);for(const n of t)n.callbacks.push(r);return r}invalidateAll(){const e=this.callbacks;for(let t=0;t<this.callbacks.length;t++)e[t].needsUpdate=!0}isFullyInvalid(){const e=this.callbacks;for(let t=0;t<this.callbacks.length;t++)if(!e[t].needsUpdate)return!1;return!0}}const os=void 0;function xu(i){let e=os;const t=()=>{if(t.needsUpdate&&(t.needsUpdate=!1,e=i()),e===os)throw new Error("Possible recursive memoization detected");return e};return t.needsUpdate=!0,t}const pn=Symbol("current"),dn=Symbol("target"),us=Symbol("previousTarget");class cs{constructor(e,t){this.mode=e,this.metrics=t}}const Tr=class extends cs{constructor(e,t){super(e,t);z(this,"_cache",new fn);z(this,"opacity",1);z(this,"_parent",null);z(this,"_localMatrix",new xe);z(this,"_worldMatrix",new xe);z(this,"_worldMatrixInverse",new xe);z(this,"_worldPosition",new G);z(this,"_worldOrientation",new He);z(this,"_worldOrientationInverse",new He);z(this,"_worldScale",new G(1,1,1));z(this,"_worldRotation",new xe);z(this,"_worldRotationInverse",new xe);z(this,"_relativePosition",new G);z(this,"_relativeOrientation",new He);z(this,"_relativeScale",new G(1,1,1));z(this,"_cachedWorldCenter",this._cache.memoize(()=>this._worldCenter.copy(this.metrics.innerCenter).applyMatrix4(this.worldMatrix)));z(this,"_worldCenter",new G);z(this,"_cachedSpatialMatrix",this._cache.memoize(()=>{const e=this._worldFromSpatial.compose(this.outerOrigin,this.worldOrientation,ti);this._spatialFromWorld.copy(this._worldFromSpatial).invert(),this._localFromSpatial.multiplyMatrices(this.worldMatrixInverse,e),this._spatialFromLocal.copy(this._localFromSpatial).invert();const t=this.referenceState;return t?this._spatialFromReference.multiplyMatrices(this._spatialFromWorld,t.worldMatrix):this._spatialFromReference.copy(this._spatialFromWorld),e}));z(this,"_worldFromSpatial",new xe);z(this,"_spatialFromWorld",new xe);z(this,"_localFromSpatial",new xe);z(this,"_spatialFromLocal",new xe);z(this,"_spatialFromReference",new xe);z(this,"_cachedSpatialBounds",this._cache.memoize(()=>{this._spatialBounds.copy(this.metrics.innerBounds);const e=this._spatialBounds.applyMatrix4(this.spatialFromLocal);return e.getCenter(this._spatialCenter),e.getSize(this._spatialSize),e}));z(this,"_spatialBounds",new tt);z(this,"_spatialSize",new G);z(this,"_spatialCenter",new G);z(this,"_cachedOuterBounds",this._cache.memoize(()=>{const e=this._outerBounds,t=this.metrics.system.nodeAdapters.get(this.metrics.node);if(t)e.copy(t.outerBounds[this.mode]);else{const r=this.referenceState;r?e.copy(r.metrics.innerBounds):e.setFromCenterAndSize(mt,mt),e.applyMatrix4(this.spatialFromReference)}return e.getCenter(this._outerCenter),e.getSize(this._outerSize),e}));z(this,"_outerBounds",new tt);z(this,"_outerCenter",new G);z(this,"_outerSize",new G);z(this,"_cachedOuterVisualBounds",this._cache.memoize(()=>{const e=this._outerVisualBounds,t=this.metrics.system.nodeAdapters.get(this.metrics.node);if(t)e.copy(t.outerVisualBounds[this.mode]);else{const r=this.referenceState;r?e.copy(r.visualBounds):e.setFromCenterAndSize(mt,mt)}return e.getCenter(this._outerVisualCenter),e.getSize(this._outerVisualSize),e}));z(this,"_outerVisualBounds",new tt);z(this,"_outerVisualCenter",new G);z(this,"_outerVisualSize",new G);z(this,"_viewFromWorld",new xe);z(this,"_viewFromSpatial",new xe);z(this,"_spatialFromView",new xe);z(this,"_cachedNDCBounds",this._cache.memoize(()=>{if(this.metrics.system.viewNode===this.metrics.node)return this._ndcBounds.min.setScalar(-1),this._ndcBounds.max.setScalar(1),this._ndcBounds;const t=this.metrics.system.viewFrustum.perspectiveProjectionMatrix,r=this.viewFromWorld,n=this._viewProjectionFromWorld.multiplyMatrices(t,r),s=this._ndcBounds.copy(this.metrics.innerBounds).applyMatrix4(n);return s.getCenter(this._ndcCenter),s.getSize(this._ndcSize),(!isFinite(s.min.x)||!isFinite(s.min.y)||!isFinite(s.min.z)||!isFinite(s.max.x)||!isFinite(s.max.y)||!isFinite(s.max.z))&&(s.min.setScalar(-1),s.max.setScalar(1),s.getCenter(this._ndcCenter),s.getSize(this._ndcSize)),s},this._viewState._cache));z(this,"_viewProjectionFromWorld",new xe);z(this,"_ndcBounds",new tt);z(this,"_ndcCenter",new G);z(this,"_ndcSize",new G);z(this,"_cachedVisualBounds",this._cache.memoize(()=>{const e=this.metrics.system,t=e.viewFrustum.perspectiveProjectionMatrix,r=this._inverseProjection.copy(t).invert(),n=this._visualBounds.copy(this.ndcBounds),s=this._v1,c=s.set(0,0,n.min.z).applyMatrix4(r).z,l=s.set(0,0,n.max.z).applyMatrix4(r).z;return n.min.z=l,n.max.z=c,n.min.x*=.5*e.viewResolution.x,n.max.x*=.5*e.viewResolution.x,n.min.y*=.5*e.viewResolution.y,n.max.y*=.5*e.viewResolution.y,n.getCenter(this._visualCenter),n.getSize(this._visualSize),n},this._viewState._cache));z(this,"_visualBounds",new tt);z(this,"_visualCenter",new G);z(this,"_visualSize",new G);z(this,"_v1",new G);z(this,"_inverseProjection",new xe);z(this,"_viewPosition",new G);z(this,"_cachedViewAlignedOrientation",this._cache.memoize(()=>{const e=this._relativeViewMatrix.multiplyMatrices(this.worldMatrixInverse,this._viewState.worldMatrix),t=this._relativeViewRotation.extractRotation(e),r=this._relativeViewOrientation.setFromRotationMatrix(t),n=this._relativeViewForward.set(0,0,1).applyQuaternion(r),s=this._relativeViewUp.set(0,1,0).applyQuaternion(r);let c=1/0,l=1/0,h,f,o;for(o in Ir){const p=Ir[o];var a=s.distanceToSquared(p);a<l&&(l=a,f=p)}for(o in Ir){const p=Ir[o];if(p.x&&f.x||p.y&&f.y||p.z&&f.z)continue;const m=n.distanceToSquared(p);m<c&&(c=m,h=p)}const u=this._orthogonalRotation.identity();return u.lookAt(h,mt,f),this._orthogonalOrientation.setFromRotationMatrix(u)},this._viewState._cache));z(this,"_relativeViewMatrix",new xe);z(this,"_relativeViewRotation",new xe);z(this,"_relativeViewOrientation",new He);z(this,"_relativeViewUp",new G);z(this,"_relativeViewForward",new G);z(this,"_orthogonalRotation",new xe);z(this,"_orthogonalOrientation",new He);z(this,"_computeOcclusion",this._cache.memoize(()=>{this._occludingPercent=0,this._occludedPercent=0;const e=this.metrics;if(e.innerBounds.isEmpty())return;const r=e.system.nodeAdapters.values(),n=this.visualBounds,s=n.min.z,c=Tr._boxA,l=Tr._boxB;c.min.set(n.min.x,n.min.y),c.min.set(n.max.x,n.max.y);const h=c.getSize(Tr._sizeA).length();for(const f of r){const o=f.metrics;if(o===e||!o.isAdaptive||o.innerBounds.isEmpty()||o.containedByNode(f.node))continue;const u=(this.mode==="current"?o.current:o.target).visualBounds;c.min.set(n.min.x,n.min.y),c.min.set(n.max.x,n.max.y),l.min.set(u.min.x,u.min.y),l.min.set(u.max.x,u.max.y);const p=c.intersect(l).getSize(Tr._sizeB).length()/h;p>0&&(s<u.min.z?this._occludingPercent+=p:this._occludedPercent+=p)}},this._viewState._cache));z(this,"_occludingPercent",0);z(this,"_occludedPercent",0)}invalidate(){this._cache.invalidateAll()}get parent(){return this._parent}set parent(e){this._parent!==e&&(this._parent=e,this.invalidate())}get parentState(){var e;return(e=this.metrics.parentMetrics)==null?void 0:e[this.mode]}get localMatrix(){var t;const e=(t=this.parentState)==null?void 0:t.worldMatrixInverse;return e?this._localMatrix.multiplyMatrices(e,this.worldMatrix):this._localMatrix.copy(this.worldMatrix)}get referenceState(){var e;return(e=this.metrics.referenceMetrics)==null?void 0:e[this.mode]}get worldMatrix(){return this._worldMatrix}set worldMatrix(e){if(isNaN(e.elements[0])||isNaN(e.elements[15])||e.elements[0]===0)throw new Error;this._worldMatrix.equals(e)||(this.invalidate(),this._worldMatrix.copy(e),this._worldMatrixInverse.copy(this._worldMatrix).invert(),this._worldMatrix.decompose(this._worldPosition,this._worldOrientation,this._worldScale),this._worldOrientationInverse.copy(this._worldOrientation).invert(),this._worldRotation.makeRotationFromQuaternion(this._worldOrientation),this._worldRotationInverse.makeRotationFromQuaternion(this._worldOrientationInverse))}get relativePosition(){var t;const e=(t=this.referenceState)==null?void 0:t.worldPosition;return e?this._relativePosition.subVectors(this.worldPosition,e):this._relativePosition.copy(this.worldPosition)}get relativeOrientation(){var t;const e=(t=this.referenceState)==null?void 0:t.worldOrientationInverse;return e?this._relativeOrientation.multiplyQuaternions(this.worldOrientation,e):this._relativeOrientation.copy(this.worldOrientation)}get relativeScale(){var t;const e=(t=this.referenceState)==null?void 0:t.worldScale;return e?this._relativeScale.copy(this.worldScale).divide(e):this._relativeScale.copy(this.worldScale)}get worldMatrixInverse(){return this._worldMatrixInverse}get worldPosition(){return this._worldPosition}get worldOrientation(){return this._worldOrientation}get worldScale(){return this._worldScale}get worldOrientationInverse(){return this._worldOrientationInverse}get worldRotation(){return this._worldRotation}get worldRotationInverse(){return this._worldRotationInverse}get worldCenter(){return this._cachedWorldCenter()}get spatialMatrix(){return this._cachedSpatialMatrix()}get spatialMatrixInverse(){return this.spatialMatrix,this._spatialFromWorld}get localFromSpatial(){return this.spatialMatrix,this._localFromSpatial}get spatialFromLocal(){return this.spatialMatrix,this._spatialFromLocal}get spatialFromReference(){return this.spatialMatrix,this._spatialFromReference}get spatialBounds(){return this._cachedSpatialBounds()}get spatialSize(){return this.spatialBounds,this._spatialSize}get spatialCenter(){return this.spatialBounds,this._spatialCenter}get outerBounds(){return this._cachedOuterBounds()}get outerCenter(){return this.outerBounds,this._outerCenter}get outerSize(){return this.outerBounds,this._outerSize}get outerOrigin(){return this.metrics.outerOrigin[this.mode]()}get outerOrientation(){var t,r;const e=this.metrics.system.nodeAdapters.get(this.metrics.node);return e?e.outerOrientation[this.mode]:(r=(t=this.referenceState)==null?void 0:t.worldOrientation)!=null?r:ri}get outerVisualBounds(){return this._cachedOuterVisualBounds()}get outerVisualCenter(){return this.outerVisualBounds,this._outerVisualCenter}get outerVisualSize(){return this.outerVisualBounds,this._outerVisualSize}get _viewState(){if(this.metrics.system.viewNode===this.metrics.node)return this;const e=this.metrics.system.viewMetrics;return this.mode==="current"?e[pn]:e[dn]}get viewFromWorld(){return this._viewFromWorld.multiplyMatrices(this._viewState.worldMatrixInverse,this.worldMatrix)}get viewFromSpatial(){return this._viewFromSpatial.multiplyMatrices(this._viewState.worldMatrixInverse,this.spatialMatrix)}get spatialFromView(){return this._spatialFromView.copy(this.viewFromSpatial).invert()}get ndcBounds(){return this._cachedNDCBounds()}get ndcCenter(){return this._cachedNDCBounds(),this._ndcCenter}get ndcSize(){return this._cachedNDCBounds(),this._ndcSize}get visualBounds(){return this._cachedVisualBounds()}get visualCenter(){return this._cachedVisualBounds(),this._visualCenter}get visualSize(){return this._cachedVisualBounds(),this._visualSize}get relativeViewPosition(){return this._viewPosition.copy(this._viewState.worldPosition).applyMatrix4(this.worldMatrixInverse)}get viewAlignedOrientation(){return this._cachedViewAlignedOrientation()}get occludingPercent(){return this._computeOcclusion(),this._occludingPercent}get occludedPercent(){return this._computeOcclusion(),this._occludedPercent}visualAverageEdgeLength(){}};let Pt=Tr;z(Pt,"_boxA",new vr),z(Pt,"_boxB",new vr),z(Pt,"_sizeA",new ze),z(Pt,"_sizeB",new ze);class bu{constructor(e,t){this.system=e,this.node=t}}class hs extends bu{constructor(e,t){super(e,t);z(this,"_cache",new fn);z(this,"needsUpdate",!0);z(this,"parentNode");z(this,"parentMetrics");z(this,"referenceMetrics");z(this,"_adapter");z(this,"_cachedInnerBounds",this._cache.memoize(()=>{const e=this._innerBounds;if(!this.raw.parent)return e.makeEmpty();if(this.node!==this.system.viewNode){e.copy(this.intrinsicBounds);const n=this._childBounds;for(const s of this.boundingChildMetrics)s.update(),n.copy(s.innerBounds),n.applyMatrix4(s.raw.relativeMatrix),e.union(n)}const t=e.getCenter(this._innerCenter),r=e.getSize(this._innerSize);if(r.length()>0){const n=this.system.epsillonMeters;Math.abs(r.x)<=n&&(r.x=(Math.sign(r.x)||1)*n*1e3),Math.abs(r.y)<=n&&(r.y=(Math.sign(r.y)||1)*n*1e3),Math.abs(r.z)<=n&&(r.z=(Math.sign(r.z)||1)*n*1e3,t.z-=n*1e3/2),e.setFromCenterAndSize(t,r)}return e}));z(this,"_childBounds",new tt);z(this,"_innerBounds",new tt);z(this,"_innerCenter",new G);z(this,"_innerSize",new G);z(this,"_intrinsicBoundsNeedsUpdate",!0);z(this,"_intrinsicBounds",new tt);z(this,"_intrinsicCenter",new G);z(this,"_intrinsicSize",new G);z(this,"_cachedNodeChildren",this._cache.memoize(()=>(this.system.bindings.getChildren(this,this._nodeChildren),this._nodeChildren)));z(this,"_nodeChildren",new Array);z(this,"_computeState",(()=>{const e=new xe,t=new He,r=new xe,n=new G,s=new He,c=new G,l=new G,h=new G,f=new G,o=new G;return function(u){var v;u.parent=this.raw.parent;const p=this._adapter,m=(v=this.referenceMetrics)==null?void 0:v[u.mode];t.copy((p==null?void 0:p.orientation.enabled)&&(p==null?void 0:p.orientation[u.mode])||this.raw.relativeOrientation);const d=(p==null?void 0:p.bounds.enabled)&&(p==null?void 0:p.bounds[u.mode]);if(d){d.getCenter(l),d.getSize(h);const x=this.innerCenter,g=this.innerSize,b=this.system.epsillonMeters;Math.abs(h.x)<=b&&(h.x=(Math.sign(h.x)||1)*b*10),Math.abs(h.y)<=b&&(h.y=(Math.sign(h.y)||1)*b*10),Math.abs(h.z)<=b&&(h.z=(Math.sign(h.z)||1)*b*10),c.copy(h),Math.abs(g.x)>=b&&(c.x/=g.x),Math.abs(g.y)>=b&&(c.y/=g.y),Math.abs(g.z)>=b&&(c.z/=g.z),s.multiplyQuaternions(u.outerOrientation,t).normalize(),f.copy(l).applyQuaternion(s),o.copy(x).multiply(c).applyQuaternion(s),n.copy(u.outerOrigin).add(f).sub(o),r.compose(n,s,c),u.worldMatrix=r}else e.compose(this.raw.relativePosition,t,this.raw.relativeScale),u.worldMatrix=(m==null?void 0:m.worldMatrix)?r.multiplyMatrices(m==null?void 0:m.worldMatrix,e):e;const w=(p==null?void 0:p.opacity.enabled)&&(p==null?void 0:p.opacity[u.mode]);return u.opacity=typeof w=="number"?w:1,u}})());z(this,"raw",{parent:null,worldMatrix:new xe,relativeMatrix:new xe,opacity:0,worldPosition:new G,worldOrientation:new He,worldScale:new G,relativePosition:new G,relativeOrientation:new He,relativeScale:new G,spatialBounds:new tt,worldFromSpatial:new xe,localFromSpatial:new xe,spatialFromLocal:new xe});z(this,"outerOrigin",{current:()=>this._getOuterOrigin("current"),target:()=>this._getOuterOrigin("target")});z(this,"_cachedCurrentState",this._cache.memoize(()=>this._computeState(this[pn])));z(this,Em,new Pt("current",this));z(this,"_cachedTargetState",this._cache.memoize(()=>this._computeState(this[dn])));z(this,Om,new Pt("target",this));z(this,zm,new Pt("target",this));z(this,"_cachedBoundsChildren",this._cache.memoize(()=>{const e=this.nodeChildren,t=this._boundingChildren;t.length=0;for(const r of e){const n=this.system.getMetrics(r);n.isAdaptive||t.push(n)}return t}));z(this,"_boundingChildren",[])}update(){var e,t;if(this.needsUpdate){this.needsUpdate=!1;const r=this._adapter=this.system.nodeAdapters.get(this.node);this.parentNode=this.raw.parent,this.parentMetrics=this.parentNode&&this.system.getMetrics(this.parentNode);const n=((e=r==null?void 0:r.activeLayout)==null?void 0:e.referenceNode)||(r==null?void 0:r.referenceNode)||this.parentNode;this.referenceMetrics=n&&this.system.getMetrics(n),(t=this.referenceMetrics)==null||t.update(),r?r._update():(this.invalidateInnerBounds(),this.invalidateStates(),this.updateRawState())}}get innerBounds(){return this._cachedInnerBounds()}get innerCenter(){return this.innerBounds,this._innerCenter}get innerSize(){return this.innerBounds,this._innerSize}get intrinsicBounds(){return this._intrinsicBoundsNeedsUpdate&&(this._intrinsicBoundsNeedsUpdate=!1,this.system.bindings.getIntrinsicBounds(this,this._intrinsicBounds),this._intrinsicBounds.getCenter(this._intrinsicCenter),this._intrinsicBounds.getSize(this._intrinsicSize)),this._intrinsicBounds}get intrinsicCenter(){return this.intrinsicBounds,this._intrinsicCenter}get intrinsicSize(){return this.intrinsicBounds,this._intrinsicSize}invalidateIntrinsicBounds(){this._intrinsicBoundsNeedsUpdate=!0;for(const e of this.boundingChildMetrics)e.invalidateIntrinsicBounds()}invalidateInnerBounds(){if(!this._cachedInnerBounds.needsUpdate){this._cachedNodeChildren.needsUpdate=!0,this._cachedBoundsChildren.needsUpdate=!0,this._cachedInnerBounds.needsUpdate=!0;for(const e of this.boundingChildMetrics)e.invalidateInnerBounds()}}containsNode(e){this.update();let t=this.system.getMetrics(e);for(;t;){if(t.parentMetrics===this)return t.node;t=t.parentMetrics}return!1}containedByNode(e){this.update();let t=this.parentMetrics;for(;t;){if(t.node===e)return t.node;t=t.parentMetrics}return!1}get nodeChildren(){return this._cachedNodeChildren()}invalidateStates(){this._cachedCurrentState.needsUpdate=!0,this._cachedTargetState.needsUpdate=!0,this[pn].invalidate(),this[dn].invalidate()}updateRawState(){this.system.bindings.getState(this);const e=this.raw;e.worldMatrix.decompose(e.worldPosition,e.worldOrientation,e.worldScale),e.relativeMatrix.decompose(e.relativePosition,e.relativeOrientation,e.relativeScale),e.worldFromSpatial.compose(this.outerOrigin.target(),e.worldOrientation,ti),e.localFromSpatial.copy(e.worldMatrix).invert().multiply(e.worldFromSpatial),e.spatialFromLocal.copy(e.localFromSpatial).invert(),e.spatialBounds.copy(this.innerBounds).applyMatrix4(e.spatialFromLocal)}_getOuterOrigin(e){var r,n,s;const t=this.system.nodeAdapters.get(this.node);return t?t.outerOrigin[e]:(s=(n=(r=this.referenceMetrics)==null?void 0:r[e])==null?void 0:n.worldCenter)!=null?s:mt}get current(){return this.update(),this._cachedCurrentState()}get target(){return this.update(),this._cachedTargetState()}get previousTarget(){return this.update(),this[us]}get boundingChildMetrics(){return this._cachedBoundsChildren()}get isAdaptive(){return this.system.nodeAdapters.has(this.node)}}Em=pn,Om=dn,zm=us;class mn{constructor(e){z(this,"relativeTolerance");z(this,"stepSizeMin");z(this,"stepSizeMax");z(this,"stepSizeStart");z(this,"minFeasibleTime");z(this,"maxInfeasibleTime");z(this,"maxIterationsPerFrame");z(this,"swarmSize");z(this,"pulseRate");z(this,"pulseFrequencyMin");z(this,"pulseFrequencyMax");e&&Object.assign(this,e)}}class ls{constructor(e){z(this,"_config",new mn);z(this,"_prevOrientation",new He);z(this,"_prevBounds",new tt);z(this,"_scratchSolution",new vt);z(this,"_scratchBestSolution",new vt);this.system=e}_setConfig(e){var r,n,s,c,l,h,f,o,a,u;const t=this.system.optimize;this._config.minFeasibleTime=(r=e.minFeasibleTime)!=null?r:t.minFeasibleTime,this._config.maxInfeasibleTime=(n=e.maxInfeasibleTime)!=null?n:t.maxInfeasibleTime,this._config.pulseRate=(s=e.pulseRate)!=null?s:t.pulseRate,this._config.maxIterationsPerFrame=(c=e.maxIterationsPerFrame)!=null?c:t.maxIterationsPerFrame,this._config.swarmSize=(l=e.swarmSize)!=null?l:t.swarmSize,this._config.pulseFrequencyMin=(h=e.pulseFrequencyMin)!=null?h:t.pulseFrequencyMin,this._config.pulseFrequencyMax=(f=e.pulseFrequencyMax)!=null?f:t.pulseFrequencyMax,this._config.stepSizeMax=(o=e.stepSizeMax)!=null?o:t.stepSizeMax,this._config.stepSizeMin=(a=e.stepSizeMin)!=null?a:t.stepSizeMin,this._config.stepSizeStart=(u=e.stepSizeStart)!=null?u:t.stepSizeStart}update(e){if(e.layouts.length===0||e.metrics.innerBounds.isEmpty())return e.activeLayout=null,!1;const t=this._prevOrientation.copy(e.orientation.target),r=this._prevBounds.copy(e.bounds.target);for(const c of e.layouts)this._setConfig(c),this._updateLayout(e,c);let n,s;for(const c of e.layouts){const l=c.solutions[0];if((!s||!s.isFeasible&&l.isFeasible)&&(s=l,n=c,s.isFeasible))break}return e.layoutFeasibleTime+=e.system.deltaTime,e.layoutInfeasibleTime+=e.system.deltaTime,(s==null?void 0:s.isFeasible)||(e.layoutFeasibleTime=0),s&&s.isFeasible&&e.layoutFeasibleTime>=this._config.minFeasibleTime||e.layoutInfeasibleTime>=this._config.maxInfeasibleTime?(e.layoutInfeasibleTime=0,s.apply(!1)):(e.orientation.target=t,e.bounds.target=r,e.metrics.invalidateStates()),e.activeLayout=n,!0}_updateLayout(e,t){var o;e.measureBoundsCache.clear(),t.processObjectives();const r=t.solutions,n=this._config,s=this._scratchSolution,c=this._scratchBestSolution,l=1.5,h=1.5**(-1/4);let f=n.maxIterationsPerFrame;((o=t.solutions[0])==null?void 0:o.isFeasible)&&(f=1),this._manageSolutionPopulation(e,t,n.swarmSize,n.stepSizeStart),r[0].apply();for(let a=0;a<f;a++){t.iteration++,c.copy(r[0]);let u=!1;for(let p=0;p<r.length;p++){const m=r[p];s.copy(m),s.mutationStrategies=m.mutationStrategies;let d;if(Math.random()<n.pulseRate){const v=c!==m?c:r[1];let x;if(r.length>2)do x=r[Math.floor(Math.random()*r.length)];while(x===m);s.moveTowards(v,n.pulseFrequencyMin,n.pulseFrequencyMax),x&&t.compareSolutions(x,m)<=0&&s.moveTowards(x,n.pulseFrequencyMin,n.pulseFrequencyMax)}else d=s.perturb();s.apply();const w=t.compareSolutions(s,m)<0;if(w&&(m.copy(s),m!==r[0]&&t.compareSolutions(m,r[0])<0&&r[0].copy(m),u=!0),d)if(d.stepSize*=w?l:h,!w&&d.stepSize<n.stepSizeMin||d.stepSize>n.stepSizeMax){for(const v of m.mutationStrategies)v.stepSize=n.stepSizeStart;m!==r[0]&&(t.restartRate=.001+(1-.001)*t.restartRate,m.randomize(1),m.apply(),u=!0)}else m!==r[0]&&(t.restartRate=(1-.001)*t.restartRate)}u&&t.sortSolutions(),t.compareSolutions(c,r[0])<=0?t.successRate=(1-.005)*t.successRate:t.successRate=.005+(1-.005)*t.successRate}}_manageSolutionPopulation(e,t,r,n){if(r<=1)throw new Error("Swarm size must be larger than 1");if(t.solutions.length<r)for(;t.solutions.length<r;){const s=new vt(t);for(const c of s.mutationStrategies)c.stepSize=n;s.randomize(1),t.solutions.push(s)}else if(t.solutions.length>r)for(;t.solutions.length>r;)t.solutions.pop()}}class sr{constructor(e){z(this,"type","ratio");z(this,"sortBlame",0);z(this,"relativeTolerance");z(this,"absoluteTolerance");z(this,"computedAbsoluteTolerance",-1/0);z(this,"computedRelativeTolerance",-1/0);z(this,"priority",0);z(this,"index",-1);z(this,"layout");z(this,"reduceFromOneOrManySpec",(e,t,r)=>{if(t===void 0)return 0;if(t instanceof Array){let n=-1/0;for(const s of t)n=Math.max(r(e,s),n);return n}return r(e,t)});z(this,"_getNumberScoreSingle",(e,t)=>{let r=0;if(typeof t!="object"){const n=this.layout.adapter.system.measureNumber(t);r=-Math.abs(e-n)}else{const n="gt"in t?this.layout.adapter.system.measureNumber(t.gt):void 0,s="lt"in t?this.layout.adapter.system.measureNumber(t.lt):void 0;n!==void 0&&e<n?r=e-n:s!==void 0&&e>s&&(r=s-e)}return r});z(this,"_getVector3ScoreSingle",(e,t)=>{const r="x"in t&&typeof t.x!="undefined"?this.getNumberScore(e.x,t.x):0,n="y"in t&&typeof t.y!="undefined"?this.getNumberScore(e.y,t.y):0,s="z"in t&&typeof t.z!="undefined"?this.getNumberScore(e.z,t.z):0,c="magnitude"in t&&typeof t.magnitude!="undefined"?this.getNumberScore(e.length(),t.magnitude):0;return r+n+s+c});z(this,"_quat",new He);z(this,"_euler",new er);z(this,"_getQuaternionScoreSingle",(e,t)=>{var r,n;if(t===void 0)return 0;if("x"in t)return-this._quat.copy(t).angleTo(e)*Ge;if("swingRange"in t){const s=this._euler.setFromQuaternion(e),c=s.x*Ge,l=s.y*Ge,h=s.z*Ge,f=this.layout.adapter.system,o=f.mathScope.degree;let a=((r=t.swingRange)==null?void 0:r.x)?f.measureNumber(t.swingRange.x,o):0,u=((n=t.swingRange)==null?void 0:n.y)?f.measureNumber(t.swingRange.y,o):0;a=Math.max(a,.01),u=Math.max(u,.01);const p=t.twistRange?f.measureNumber(t.twistRange,o):0,m=1-(c/a)**2-(l/u)**2,d=p-Math.abs(h);return(m>0?0:m)+(d>0?0:d)}return 0});z(this,"_getBoundsMeasureScoreSingle",(e,t,r,n)=>{if(t===void 0)return 0;if(typeof t=="object"){if("gt"in t){const s=this.layout.adapter.measureBounds(t.gt,r,n);if(e<s)return e-s}if("lt"in t){const s=this.layout.adapter.measureBounds(t.lt,r,n);if(e>s)return s-e}return 0}return-Math.abs(e-this.layout.adapter.measureBounds(t,r,n))});this.layout=e}static isDiscreteSpec(e){const t=typeof e;return t==="string"||t==="number"}static isContinuousSpec(e){return e!==void 0&&!(e instanceof Array)&&typeof e=="object"&&("gt"in e||"lt"in e)}get bestScore(){return this.layout.solutions[0].scores[this.index]}getNumberScore(e,t){return this.reduceFromOneOrManySpec(e,t,this._getNumberScoreSingle)}getVector3Score(e,t){return this.reduceFromOneOrManySpec(e,t,this._getVector3ScoreSingle)}getQuaternionScore(e,t){return this.reduceFromOneOrManySpec(e,t,this._getQuaternionScoreSingle)}getBoundsScore(e,t){if(e===void 0)return 0;let r=0;for(const n in e){if(n==="absolute")continue;let s=n;if(s==="size"||s==="center"){const c=e[s];for(const l of Nu){let h=l;t!=="spatial"&&(this.type==="meter"&&h!=="z"||this.type==="pixel"&&h==="z")||(r+=this.getBoundsMeasureScore(c==null?void 0:c[h],t,s+h))}}else{if(t!=="spatial"&&(this.type==="meter"&&s!=="back"&&s!=="front"||this.type==="pixel"&&(s==="back"||s==="front")))continue;r+=this.getBoundsMeasureScore(e[s],t,s)}}return r}getBoundsMeasureScore(e,t,r){if(e===void 0)return 0;const n=this.layout.adapter.metrics.target;let s,c,l;switch(t){case"spatial":s=n.spatialBounds,c=n.spatialCenter,l=n.spatialSize;break;case"visual":case"view":s=n.visualBounds,c=n.visualCenter,l=n.visualSize;break;default:throw new Error(`Unknown measure type "${t}.${r}" in spec:
 "${e}"`)}let h=0;switch(r){case"left":h=s.min.x;break;case"right":h=s.max.x;break;case"bottom":h=s.min.y;break;case"top":h=s.max.y;break;case"back":h=s.min.z;break;case"front":h=s.max.z;break;case"centerx":h=c.x;break;case"centery":h=c.y;break;case"centerz":h=c.z;break;case"centerdistance":h=t==="spatial"?c.length():Math.sqrt(c.x**2+l.y**2);break;case"sizex":h=l.x;break;case"sizey":h=l.y;break;case"sizez":h=l.z;break;case"sizediagonal":h=t==="spatial"?l.length():Math.sqrt(l.x**2+l.y**2);break;default:throw new Error(`Unknown measure subtype ${t}.${r} in spec "${e}"`)}if(e instanceof Array){let f=-1/0;for(const o of e)f=Math.max(this._getBoundsMeasureScoreSingle(h,o,t,r),f);return f}return this._getBoundsMeasureScoreSingle(h,e,t,r)}attenuateVisualScore(e){let t=0;const r=this.layout.getComputedAbsoluteTolerance("pixel"),n=this.layout.adapter,s=n.system.viewResolution,c=n.system.viewFrustum,l=s.x,h=s.y,f=s.length(),o=n.metrics.target.visualBounds,a=o.min.x- -l/2+r,u=o.max.x-l/2-r,p=o.min.y- -h/2+r,m=o.max.y-h/2-r,d=o.max.z+c.nearMeters;return a<0&&(t+=Math.abs(a/l)),u>0&&(t+=Math.abs(u/l)),p<0&&(t+=Math.abs(p/h)),m>0&&(t+=Math.abs(m/h)),d>0&&(t+=d*10),e-Math.abs(f)*t}}class fs extends sr{constructor(e){super(e);z(this,"spec");this.type="degree"}evaluate(){const e=this.layout.adapter.metrics.target;return this.getQuaternionScore(e.relativeOrientation,this.spec)}}class Mu extends sr{constructor(e){super(e);z(this,"spec");this.type="ratio"}evaluate(){const e=this.layout.adapter.metrics.target;return this.getVector3Score(e.worldScale,this.spec)}}class _u extends sr{constructor(e){super(e);z(this,"mode","xyz");z(this,"_scale",new G);this.type="ratio"}evaluate(){const e=this.layout.adapter.metrics.target,t=this.mode;if(!t)return 0;const r=this._scale.copy(e.worldScale),n=t==="xyz"?Math.max(Math.abs(r.x),Math.abs(r.y),Math.abs(r.z)):Math.max(Math.abs(r.x),Math.abs(r.y)),s=r.divideScalar(n);return-(1/s.x)+1+-(1/s.y)+1+(t==="xyz"?-(1/s.z)+1:s.z>1?1-s.z:0)}}const Nu=["x","y","z","diagonal","distance"];class Su extends sr{constructor(e){super(e);z(this,"spec");this.type="meter"}evaluate(){return this.getBoundsScore(this.spec,"spatial")}}class ps extends sr{constructor(e){super(e);z(this,"spec");z(this,"pixelTolerance");z(this,"meterTolerance");this.type="pixel"}evaluate(){var e;return this.type==="meter"&&(this.absoluteTolerance=this.meterTolerance),this.type==="pixel"&&(this.absoluteTolerance=this.pixelTolerance),this.getBoundsScore(this.spec,"visual")+this.getBoundsScore((e=this.spec)==null?void 0:e.absolute,"view")}}class Eu extends sr{constructor(e){super(e);z(this,"minAreaPercent",0);this.type="pixel"}evaluate(){var h;const e=this.layout.adapter.metrics.target,t=e.visualSize,r=this.layout.adapter.system.viewResolution,n=Math.min(t.x*t.y,r.x*r.y),s=((h=e.referenceState)==null?void 0:h.visualSize)||r,c=s.x*s.y;return this.attenuateVisualScore(n)-c*this.minAreaPercent}}class ds extends sr{constructor(e){super(e);this.type="meter",this.absoluteTolerance=1e10}evaluate(){return-this.layout.adapter.metrics.target.visualCenter.length()}}const ms=new G;class vs extends mn{constructor(e){super();z(this,"absoluteTolerance",{meter:"10mm",pixel:"4px",degree:"0.002deg",ratio:.002});z(this,"successRate",0);z(this,"restartRate",0);z(this,"objectives",new Array);z(this,"referenceNode",null);z(this,"maximizeObjective");z(this,"orientationConstraint");z(this,"keepAspectConstraint");z(this,"scaleConstraint");z(this,"boundsConstraint");z(this,"visualBoundsMeterConstraint");z(this,"visualBoundsPixelConstraint");z(this,"magnetizeObjective");z(this,"minimizeOcclusionObjective");z(this,"solutions",new Array);z(this,"iteration",0);z(this,"bestSolution");z(this,"compareSolutions",(e,t)=>{const r=this.objectives;if(e.scores.length<r.length)return 1;if(t.scores.length<r.length)return-1;if(e.boundsCenterDistance>1e20)return 1;if(t.boundsCenterDistance>1e10)return-1;if(e.boundsManhattanLength>1e20)return 1;if(t.boundsManhattanLength>1e10)return-1;const n=e.isFeasible,s=t.isFeasible;if(n&&!s)return-1;if(s&&!n)return 1;let c=0;const l=this.solutions[0].scores;for(let h=0;h<r.length;h++){const f=e.scores[h],o=t.scores[h];if(isNaN(f))return 1;if(isNaN(o))return-1;const a=r[h],u=a.computedRelativeTolerance,p=a.computedAbsoluteTolerance,m=Math.max(l[h],f,o),d=Math.min(m-Math.abs(m)*u,-p);if(f<d||o<d)return a.sortBlame++,o-f;o-f!==0&&(c=o-f)}return c});this.adapter=e}getComputedAbsoluteTolerance(e){return this.adapter.system.measureNumber(this.absoluteTolerance[e],e)}poseRelativeTo(e){return this.referenceNode=e,this}maximize(e){var r;const t=this.maximizeObjective=(r=this.maximizeObjective)!=null?r:new Eu(this);return t.priority=-1e3,t.relativeTolerance=.1,this.addObjective(t,e)}orientation(e,t){var n;const r=this.orientationConstraint=(n=this.orientationConstraint)!=null?n:new fs(this);return r.spec=e,r.priority=-999,this.addObjective(r,t)}keepAspect(e="xyz",t){var n;const r=this.keepAspectConstraint=(n=this.keepAspectConstraint)!=null?n:new _u(this);return r.mode=e,r.priority=-998,this.addObjective(r,t)}scale(e,t){var n;const r=this.scaleConstraint=(n=this.scaleConstraint)!=null?n:new Mu(this);return r.spec=e,r.priority=-2,this.addObjective(r,t)}bounds(e,t){var n;const r=this.boundsConstraint=(n=this.boundsConstraint)!=null?n:new Su(this);return r.spec=e,this.addObjective(r,t)}visualOrientation(e,t){var n;const r=this.orientationConstraint=(n=this.orientationConstraint)!=null?n:new fs(this);return r.spec=e,r.priority=-999,this.addObjective(r,t)}visualBounds(e,t){var s,c;const r=this.visualBoundsMeterConstraint=(s=this.visualBoundsMeterConstraint)!=null?s:new ps(this),n=this.visualBoundsPixelConstraint=(c=this.visualBoundsPixelConstraint)!=null?c:new ps(this);return r.spec=e,r.type="meter",n.spec=e,n.type="pixel",this.addObjective(r,t).addObjective(n,t)}magnetize(e){var r;const t=this.magnetizeObjective=(r=this.magnetizeObjective)!=null?r:new ds(this);return t.priority=-900,t.relativeTolerance=.95,this.addObjective(t,e)}avoidOcclusion(e){var r;const t=this.minimizeOcclusionObjective=(r=this.minimizeOcclusionObjective)!=null?r:new ds(this);return t.priority=11,this.addObjective(t,e)}addObjective(e,t){return Object.assign(e,t),this.objectives.indexOf(e)===-1&&this.objectives.push(e),this.processObjectives(),this}get hasValidSolution(){var e;return((e=this.solutions[0])==null?void 0:e.isFeasible)===!0}processObjectives(){var n,s;const e=this.adapter.system,t=this.objectives;let r=0;for(const c of t)c.index=r++,c.computedAbsoluteTolerance=c.absoluteTolerance!==void 0?e.measureNumber(c.absoluteTolerance,e.mathScope[c.type]):this.getComputedAbsoluteTolerance(c.type),c.computedRelativeTolerance=(s=(n=c.relativeTolerance)!=null?n:this.relativeTolerance)!=null?s:this.adapter.system.optimize.relativeTolerance}sortSolutions(){this.solutions.sort(this.compareSolutions),this.bestSolution=this.solutions[0]}}const et=class{constructor(e){z(this,"layout");z(this,"orientation",new He);z(this,"bounds",new tt);z(this,"scores",[]);z(this,"isFeasible",!1);z(this,"mutationStrategies",[{type:"rotate",stepSize:.1},{type:"center",stepSize:.1},{type:"size",stepSize:.1},{type:"minmax",stepSize:.1}]);z(this,"_mutationWeights",[]);z(this,"boundsManhattanLength");z(this,"boundsCenterDistance");e&&(this.layout=e)}get aspectPenalty(){return this.scores[this.layout.objectives.indexOf(this.layout.keepAspectConstraint)]||0}get orientationPenalty(){return this.scores[this.layout.objectives.indexOf(this.layout.orientationConstraint)]||0}get spatialBoundsPenalty(){return this.scores[this.layout.objectives.indexOf(this.layout.boundsConstraint)]||0}_selectStrategy(){const e=this.mutationStrategies,t=this._mutationWeights,r=this.layout.orientationConstraint,n=this.layout.keepAspectConstraint;for(let s=0;s<e.length;s++)t[s]=e[s].stepSize,r&&e[s].type=="rotate"&&this.orientationPenalty>-r.computedAbsoluteTolerance&&(t[s]*=.01),n&&e[s].type=="size"&&this.aspectPenalty<-n.computedAbsoluteTolerance&&(t[s]*=100);return as(e,t)}copy(e){this.layout=e.layout,this.orientation.copy(e.orientation),this.bounds.copy(e.bounds),this.scores.length=0;for(let t=0;t<e.scores.length;t++)this.scores[t]=e.scores[t];return this.isFeasible=e.isFeasible,this}randomize(e){const t=ii(e),r=et._scratchV1.set(0,0,-t),n=this.layout.adapter.system.viewMetrics.target;r.applyMatrix4(n.worldMatrix);const s=this.layout.adapter.metrics.target.parentState;s&&r.applyMatrix4(s.worldMatrixInverse),this.orientation.copy(n.worldOrientation),s&&this.orientation.multiply(s.worldOrientationInverse);const c=this.layout.adapter.metrics.innerBounds,l=c.isEmpty()?et._scratchV2.set(1,1,1):c.getSize(et._scratchV2);return l.normalize(),l.multiplyScalar(t*2*Math.tan(5*Ae)),this.bounds.setFromCenterAndSize(r,l),this}moveTowards(e,t,r){const n=this.bounds.getCenter(et._center),s=this.bounds.getSize(et._size),c=e.bounds,l=c.getCenter(et._otherCenter),h=c.getSize(et._otherSize);this.orientation.slerp(e.orientation,et.generatePulseFrequency(t,r)).normalize(),Math.random()<.5?(n.lerp(l,et.generatePulseFrequency(t,r)),s.lerp(h,et.generatePulseFrequency(t,r)),this.bounds.setFromCenterAndSize(n,s)):(this.bounds.min.lerp(c.min,et.generatePulseFrequency(t,r)),this.bounds.max.lerp(c.max,et.generatePulseFrequency(t,r)))}perturb(){var f;const e=this._selectStrategy(),t=e.type;let r=e.stepSize;if(t==="rotate"||Math.random()<.001){const o=(f=this.layout.orientationConstraint)==null?void 0:f.spec;if((o==null?void 0:o.isQuaternion)&&this.orientationPenalty<o.computedAbsoluteTolerance&&Math.random()<.01)this.orientation.copy(o);else{const a=Math.min(ii(Math.min(r,1)*1e-4),1);this.orientation.multiply(ln(a,a)).normalize()}}const n=this.bounds,s=n.getCenter(et._center),c=n.getSize(et._size);if(t==="center"){const o=et._direction.set(0,0,1).applyQuaternion(ln(1,1));o.setLength(Br(r)).multiplyScalar(c.length()),s.add(o)}if(t==="size"){const o=2**Br(r);c.multiplyScalar(o)}if(c.clampScalar(this.layout.adapter.system.epsillonMeters/10,1e20),n.setFromCenterAndSize(s,c),t==="minmax"){const o=et._direction.set(0,0,1).applyQuaternion(ln(1,1));o.setLength(Br(r)).multiply(c),Math.random()<.5,n.min.add(o)}const l=n.min,h=n.max;return l.x>h.x&&this._swap(l,h,"x"),l.y>h.y&&this._swap(l,h,"y"),l.z>h.z&&this._swap(l,h,"z"),e}_swap(e,t,r){const n=e[r],s=t[r];e[r]=s,t[r]=n}static generatePulseFrequency(e,t){return e+Math.random()*(t-e)}apply(e=!0){const t=this.layout,r=t.adapter;if(r.orientation.target=this.orientation,r.bounds.target=this.bounds,r.metrics.invalidateStates(),e){this.isFeasible=!0;for(let n=0;n<t.objectives.length;n++){const s=t.objectives[n],c=this.scores[n]=s.evaluate();(c<-s.computedAbsoluteTolerance||!isFinite(c))&&(this.isFeasible=!1)}}this.boundsManhattanLength=this.bounds.getSize(ms).manhattanLength(),this.boundsCenterDistance=this.bounds.getCenter(ms).length()}};let vt=et;z(vt,"_scratchV1",new G),z(vt,"_scratchV2",new G),z(vt,"_direction",new G),z(vt,"_center",new G),z(vt,"_size",new G),z(vt,"_otherCenter",new G),z(vt,"_otherSize",new G);var gs=1.525,Rr=function(i){return function(e){return 1-i(1-e)}},Pr=function(i){return function(e){return e<=.5?i(2*e)/2:(2-i(2*(1-e)))/2}},Ou=Rr,zu=Pr,ys=function(i){return function(e){return Math.pow(e,i)}},si=function(i){return function(e){return e*e*((i+1)*e-i)}},ws=function(i){var e=si(i);return function(t){return(t*=2)<1?.5*e(t):.5*(2-Math.pow(2,-10*(t-1)))}},Au=function(i){return i},ai=ys(2),Cu=Rr(ai),Tu=Pr(ai),xs=function(i){return 1-Math.sin(Math.acos(i))},bs=Rr(xs),Fu=Pr(bs),oi=si(gs),Du=Rr(oi),Iu=Pr(oi),Bu=ws(gs),Ru=4/11,Pu=8/11,ku=9/10,Lu=4356/361,Uu=35442/1805,$u=16061/1805,vn=function(i){var e=i*i;return i<Ru?7.5625*e:i<Pu?9.075*e-9.9*i+3.4:i<ku?Lu*e-Uu*i+$u:10.8*i*i-20.52*i+10.72},qu=function(i){return 1-vn(1-i)},Vu=function(i){return i<.5?.5*(1-vn(1-i*2)):.5*vn(i*2-1)+.5},ju=8,Hu=.001,Gu=1e-7,Wu=10,kr=11,gn=1/(kr-1),Yu=typeof Float32Array!="undefined",Ms=function(i,e){return 1-3*e+3*i},_s=function(i,e){return 3*e-6*i},Ns=function(i){return 3*i},Ss=function(i,e,t){return 3*Ms(e,t)*i*i+2*_s(e,t)*i+Ns(e)},yn=function(i,e,t){return((Ms(e,t)*i+_s(e,t))*i+Ns(e))*i};function Zu(i,e,t,r){var n=Yu?new Float32Array(kr):new Array(kr),s=function(o,a,u){var p=0,m,d;do d=a+(u-a)/2,m=yn(d,i,t)-o,m>0?u=d:a=d;while(Math.abs(m)>Gu&&++p<Wu);return d},c=function(o,a){for(var u=0,p=0,m;u<ju;++u){if(p=Ss(a,i,t),p===0)return a;m=yn(a,i,t)-o,a-=m/p}return a},l=function(){for(var o=0;o<kr;++o)n[o]=yn(o*gn,i,t)},h=function(o){for(var a=0,u=1,p=kr-1,m=0,d=0,w=0;u!==p&&n[u]<=o;++u)a+=gn;return--u,m=(o-n[u])/(n[u+1]-n[u]),d=a+m*gn,w=Ss(d,i,t),w>=Hu?c(o,d):w===0?d:s(o,a,a+gn)};l();var f=function(o){var a;return i===e&&t===r?a=o:o===0?a=0:o===1?a=1:a=yn(h(o),e,r),a};return f}var Ju=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",reversed:Rr,mirrored:Pr,createReversedEasing:Ou,createMirroredEasing:zu,createExpoIn:ys,createBackIn:si,createAnticipateEasing:ws,linear:Au,easeIn:ai,easeOut:Cu,easeInOut:Tu,circIn:xs,circOut:bs,circInOut:Fu,backIn:oi,backOut:Du,backInOut:Iu,anticipate:Bu,bounceOut:vn,bounceIn:qu,bounceInOut:Vu,cubicBezier:Zu});const Es=Ju;class Os{constructor(e){z(this,"target");z(this,"duration");z(this,"easing");z(this,"blend");z(this,"elapsed");e&&Object.assign(this,e)}}class Lr{constructor(e){z(this,"multiplier");z(this,"duration");z(this,"easing");z(this,"threshold");z(this,"delay");z(this,"debounce");z(this,"maxWait");z(this,"blend");e&&Object.assign(this,e)}}const Qu=new ze,Xu=new G,Ku=new He,zs=new tt,ec=new qt,tc=new qt(0,0,0);class kt extends Lr{constructor(e,t,r,n=e.transition){super(r);z(this,"needsUpdate",!1);z(this,"_size",new G);z(this,"_start");z(this,"_current");z(this,"_reference");z(this,"_target");z(this,"queue",[]);z(this,"enabled",!1);z(this,"forceWait",!1);z(this,"_forceCommit",!1);z(this,"_resolvedConfig",new Lr);z(this,"delayTime",0);z(this,"debounceTime",0);z(this,"_previousStatus","unchanged");z(this,"_status","unchanged");z(this,"_previousTarget");z(this,"_syncGroup");this.system=e,this.parentConfig=n,this.reset(t),this._previousTarget=this._copy(this._previousTarget,this.target)}_copy(e,t){if(typeof t=="undefined")return;if(typeof t=="number")return t;const r=e?e.copy(t):t.clone();if(r&&"isBox3"in r){const n=r,s=n.getSize(this._size);(n.isEmpty()||!isFinite(s.x)||!isFinite(s.y)||!isFinite(s.z))&&n.setFromCenterAndSize(mt,mt)}return r}_isEqual(e,t){return e===void 0||t===void 0?!1:e===t?!0:typeof e=="number"?e===t:(e==null?void 0:e.equals(t))||!1}reset(e){this._start=this._copy(this._start,e),this._current=this._copy(this._current,e),this._target=this._copy(this._target,e),this.queue.length=0}set start(e){this._start=this._copy(this._start,e)}get start(){return this._start}set current(e){this._current=this._copy(this._current,e)}get current(){return this._current}set reference(e){this._reference=this._copy(this._reference,e)}get reference(){return this._reference}set target(e){this.enabled=!0,this._target=this._copy(this._target,e)}get target(){return this._target}get progress(){if(!this.enabled)return 1;if(this.queue.length>0){const e=this.queue[this.queue.length-1];return e.duration===0?0:e.elapsed/e.duration}return 1}get forceCommit(){return this._forceCommit}set forceCommit(e){this._forceCommit!==e&&(this._forceCommit=e)}get relativeDifference(){var t,r;const e=(r=(t=this.queue[this.queue.length-1])==null?void 0:t.target)!=null?r:this.start;return typeof this.target!="undefined"?ni(e,this.target):0}get referenceRelativeDifference(){return typeof this.reference!="undefined"&&typeof this.target!="undefined"?ni(this.reference,this.target):1/0}get resolvedConfig(){var n,s,c,l,h,f,o,a,u,p,m,d,w,v,x,g;const e=this._resolvedConfig,t=this.parentConfig,r=this.system.transition;return e.multiplier=(s=(n=this.multiplier)!=null?n:t==null?void 0:t.multiplier)!=null?s:r.multiplier,e.duration=(l=(c=this.duration)!=null?c:t==null?void 0:t.duration)!=null?l:r.duration,e.easing=(f=(h=this.easing)!=null?h:t==null?void 0:t.easing)!=null?f:r.easing,e.threshold=(a=(o=this.threshold)!=null?o:t==null?void 0:t.threshold)!=null?a:r.threshold,e.delay=(p=(u=this.delay)!=null?u:t==null?void 0:t.delay)!=null?p:r.delay,e.debounce=(d=(m=this.debounce)!=null?m:t==null?void 0:t.debounce)!=null?d:r.debounce,e.maxWait=(v=(w=this.maxWait)!=null?w:t==null?void 0:t.maxWait)!=null?v:r.maxWait,e.blend=(g=(x=this.blend)!=null?x:t==null?void 0:t.blend)!=null?g:r.blend,e}get previousStatus(){return this._previousStatus}get status(){return this.needsUpdate&&(this._previousStatus=this._status,this._status=this._computeStatus()),this._status}_computeStatus(){if(this.forceCommit)return"committing";const e=this.resolvedConfig,t=e.threshold,r=this.system.deltaTime*e.multiplier,n=this.delayTime+r,s=this.debounceTime+r;return this.relativeDifference>t?!this.forceWait&&(n>=e.delay&&s>=e.debounce||n>=e.maxWait)?"committing":this.referenceRelativeDifference<t?"settling":"changed":"unchanged"}_updateTransitionable(){var l,h,f,o,a;const e=this.system.deltaTime,t=this.resolvedConfig,r=this.queue,n=this.status,s=e*t.multiplier;for(;r.length&&r[0].elapsed>=r[0].duration;)this.start=r.shift().target;this.current=this.start;let c=this.start;for(let u=0;u<r.length;u++){const p=r[u];if(this._addTransitionToCurrent(c,p,s),c=p.target,!p.blend)break}switch(this.debounceTime+=s,n){case"settling":break;case"changed":this.delayTime+=s,this.reference=this.target;break;case"unchanged":this.reference=void 0,this.delayTime=0;break;case"committing":this.delayTime=0,this.debounceTime=0;const u=typeof this.forceCommit=="object"?this.forceCommit:new Os;u.target=(l=u.target)!=null?l:this._copy(void 0,this.target),u.duration=(h=u.duration)!=null?h:t.duration,u.easing=(f=u.easing)!=null?f:t.easing,u.blend=(o=u.blend)!=null?o:t.blend,u.elapsed=(a=u.elapsed)!=null?a:0,r.push(u),this.forceCommit=!1;break}this.forceWait=!1}_addTransitionToCurrent(e,t,r){const n=this._current,s=t.duration>0?t.easing(Math.min(t.elapsed/t.duration,1)):1,c=t.target;if(t.elapsed+=r,typeof c=="number"){this._current=n+dr(c-e,0,1-s);return}if("isVector3"in c){const l=n,h=e,f=c,o=Xu.copy(f).sub(h).lerp(mt,1-s);this._current=l.add(o);return}if("isVector2"in c){const l=n,h=e,f=c,o=Qu.copy(f).sub(h).lerp(is,1-s);this._current=l.add(o);return}if("isQuaternion"in c){const l=n,h=e,f=c,o=Ku.copy(h).invert().multiply(f).slerp(ri,1-s);this._current=l.multiply(o).normalize();return}if("isColor"in c){const l=n,h=e,f=c,o=ec.copy(f).sub(h).lerp(tc,1-s);this._current=l.add(o);return}if("isBox3"in c){const l=n,h=e,f=c,o=zs.min.copy(f.min).sub(h.min).lerp(mt,1-s),a=zs.max.copy(f.max).sub(h.max).lerp(mt,1-s);l.min.add(o),l.max.add(a),this._current=l;return}}_swap(e,t,r){const n=e[r],s=t[r];e[r]=s,t[r]=n}update(e=!1){if(!this.needsUpdate&&!e||(this._isEqual(this._previousTarget,this.target)||(this._target=this._target,this.enabled=!0),this._previousTarget=this._copy(this._previousTarget,this.target),!this.enabled))return;const t=this.syncGroup;if(!this.forceCommit&&t){for(const r of t)if(r.enabled&&r.status==="committing"){for(const n of t)n.needsUpdate&&n.forceCommit===!1&&n.relativeDifference>n.resolvedConfig.threshold&&(n.forceCommit=!0);break}}this._updateTransitionable(),this.needsUpdate=!1}set syncGroup(e){this._syncGroup&&this._syncGroup.delete(this),this._syncGroup=e,e==null||e.add(this)}get syncGroup(){return this._syncGroup}}class As{constructor(e,t){z(this,"measureBoundsCache",new Map);z(this,"metrics");z(this,"transition",new Lr);z(this,"referenceNode");z(this,"_outerOrigin");z(this,"_outerOrientation");z(this,"_outerBounds");z(this,"_outerVisualBounds");z(this,"_parentAdapter",null);z(this,"_orientation");z(this,"_bounds");z(this,"_opacity");z(this,"layouts",new Array);z(this,"layoutFeasibleTime",0);z(this,"layoutInfeasibleTime",0);z(this,"_prevLayout",null);z(this,"_activeLayout",null);z(this,"_progress",1);z(this,"_hasValidContext",!1);z(this,"onUpdate");z(this,"onPostUpdate");z(this,"_prevNodeOrientation",new He);z(this,"_prevNodeBounds",new tt);this.system=e,this.node=t,this.metrics=this.system.getMetrics(this.node);const r=this.metrics.target;this._orientation=new kt(this.system,r.relativeOrientation,void 0,this.transition),this._bounds=new kt(this.system,r.spatialBounds,void 0,this.transition),this._opacity=new kt(this.system,r.opacity,void 0,this.transition),this._outerOrigin=new kt(this.system,r.outerCenter,void 0,this.transition),this._outerOrientation=new kt(this.system,r.outerOrientation,void 0,this.transition),this._outerBounds=new kt(this.system,r.outerBounds,void 0,this.transition),this._outerVisualBounds=new kt(this.system,r.outerVisualBounds,void 0,this.transition),this._outerOrigin.debounce=0,this._outerOrigin.delay=0,this._outerOrientation.debounce=0,this._outerOrientation.delay=0,this._outerBounds.debounce=0,this._outerBounds.delay=0,this._outerVisualBounds.debounce=0,this._outerVisualBounds.delay=0,this._orientation.syncGroup=this._bounds.syncGroup=this._opacity.syncGroup=new Set}measureBounds(e,t,r){var v,x,g;const n=this.system,s=n.mathScope,c=n.math,l=t==="spatial"||r==="front"||r==="back"||r==="centerz"||r==="sizez"?s.meter:s.pixel,h=l===s.meter?"m":"px";typeof e=="number"&&(e=""+e+h);const f=t+"-"+r+" = "+e;if((v=this.measureBoundsCache)==null?void 0:v.has(f))return this.measureBoundsCache.get(f);if(!n.mathCompiledExpressions.has(e)){const M=c.parse(e.replace("%","percent")).compile();n.mathCompiledExpressions.set(e,M)}const o=n.mathCompiledExpressions.get(e),a=n.viewMetrics.target,u=this.metrics.target;let p,m;switch(t){case"spatial":p=u.outerBounds,m=u.outerCenter;break;case"visual":p=u.outerVisualBounds,m=u.outerVisualCenter;break;case"view":p=a.visualBounds,m=a.visualCenter;break;default:throw new Error(`Unknown measure type "${t}.${r}"`)}if(e.includes("%")){const b=t==="spatial"?u.outerSize:(x=u.outerVisualSize)!=null?x:a.visualSize;let M=0;switch(r){case"left":case"centerx":case"right":case"sizex":M=c.unit(b.x/100,h);break;case"bottom":case"centery":case"top":case"sizey":M=c.unit(b.y/100,h);break;case"back":case"centerz":case"front":case"sizez":M=c.unit(b.z/100,"m");break;case"sizediagonal":M=t==="spatial"?c.unit(b.length()/100,"m"):c.unit(Math.sqrt(b.x**2+b.y**2)/100,"px");break;default:throw new Error(`Invalid measure subtype "${t}.${r}" for percentage units`)}s.percent=M}let d;switch(r){case"left":d=p.min.x;break;case"centerx":d=m.x;break;case"right":d=p.max.x;break;case"bottom":d=p.min.y;break;case"centery":d=m.y;break;case"top":d=p.max.y;break;case"front":d=p.max.z;break;case"centerz":d=m.z;break;case"back":d=p.min.z;break;case"centerdistance":default:d=0}let w=o.evaluate(s);return typeof w=="object"&&(w=c.number(w,l)),d+=w,s.percent=void 0,(g=this.measureBoundsCache)==null||g.set(f,d),d}get outerOrigin(){return this._outerOrigin}get outerOrientation(){return this._outerOrientation}get outerBounds(){return this._outerBounds}get outerVisualBounds(){return this._outerVisualBounds}get parentAdapter(){return this._parentAdapter}_computeParentAdapter(){let e=this.metrics;for(;e=e.parentMetrics;){const t=this.system.nodeAdapters.get(e.node);if(t)return t}return null}get orientation(){return this._orientation}get bounds(){return this._bounds}get opacity(){return this._opacity}get previousLayout(){return this._prevLayout}set activeLayout(e){this._prevLayout=this._activeLayout,this._activeLayout=e}get activeLayout(){return this._activeLayout}get progress(){return this._progress}_computeProgress(){return Math.min(this.orientation.progress,this.bounds.progress,this.opacity.progress)}createLayout(){const e=new vs(this);return this.layouts.push(e),e}get hasValidContext(){return this._hasValidContext}_computeHasValidContext(){var t;const e=this.parentAdapter;return e?e.hasValidContext?!!(e.layouts.length===0||((t=e.activeLayout)==null?void 0:t.hasValidSolution)):!1:!0}_update(){var t;this._parentAdapter=this._computeParentAdapter(),this._hasValidContext=this._computeHasValidContext();const e=this.metrics;if(e.referenceMetrics&&(this.outerOrigin.target=e.referenceMetrics.target.worldCenter,this.outerOrientation.target=e.referenceMetrics.target.worldOrientation,this.outerBounds.target=e.referenceMetrics.innerBounds,this.outerBounds.target.applyMatrix4(e.target.spatialFromReference),this.outerVisualBounds.target=e.referenceMetrics.target.visualBounds),this.outerOrigin.update(),this.outerOrientation.update(),this.outerBounds.update(),this.outerVisualBounds.update(),this.onUpdate){this.onUpdate(),e.invalidateIntrinsicBounds(),e.invalidateInnerBounds(),e.invalidateStates(),e.updateRawState();const r=e.raw;if(!this.system.optimizer.update(this)){const n=this.orientation.current,s=this.orientation.target,c=r.relativeOrientation;s.angleTo(c)>this.system.epsillonRadians&&n.angleTo(c)>this.system.epsillonRadians&&(this.orientation.target=c);const l=this.bounds.current,h=this.bounds.target,f=r.spatialBounds;(h.min.distanceTo(f.min)>this.system.epsillonMeters||h.max.distanceTo(f.max)>this.system.epsillonMeters)&&(l.min.distanceTo(f.min)>this.system.epsillonMeters||l.max.distanceTo(f.max)>this.system.epsillonMeters)&&(this.bounds.target=f)}}else e.invalidateIntrinsicBounds(),e.invalidateInnerBounds(),e.invalidateStates(),this.system.optimizer.update(this);this.opacity.update(),this.orientation.update(),this.bounds.update(),this._progress=this._computeProgress(),e.invalidateStates(),this.system.bindings.apply(e,e.current),e.invalidateStates(),(t=this.onPostUpdate)==null||t.call(this)}}class Cs{constructor(){z(this,"_cache",new fn);z(this,"isLayoutFrustum",!0);z(this,"_leftDegrees",-20);z(this,"_rightDegrees",20);z(this,"_bottomDegrees",-20);z(this,"_topDegrees",20);z(this,"_nearMeters",.5);z(this,"_farMeters",1e3);z(this,"_size",new ze);z(this,"_center",new ze);z(this,"_v1",new G);z(this,"_inverseProjection",new xe);z(this,"_forwardDirection",new G(0,0,-1));z(this,"_fullNDC",new tt(new G(-1,-1,-1),new G(1,1,1)));z(this,"_cachedPerspectiveProjectionMatrix",this._cache.memoize(()=>{const e=this.nearMeters,t=this.farMeters,r=e*Math.tan(this.leftDegrees*Ae),n=e*Math.tan(this.rightDegrees*Ae),s=e*Math.tan(this.topDegrees*Ae),c=e*Math.tan(this.bottomDegrees*Ae);return this._perspective.makePerspective(r,n,s,c,e,t)}));z(this,"_perspective",new xe);z(this,"_boxA",new vr);z(this,"_boxB",new vr);z(this,"_overlapSize",new ze)}get leftDegrees(){return this._leftDegrees}set leftDegrees(e){e!==this._leftDegrees&&(this._leftDegrees=e,this._cache.invalidateAll())}get rightDegrees(){return this._rightDegrees}set rightDegrees(e){e!==this._rightDegrees&&(this._rightDegrees=e,this._cache.invalidateAll())}get bottomDegrees(){return this._bottomDegrees}set bottomDegrees(e){e!==this._bottomDegrees&&(this._bottomDegrees=e,this._cache.invalidateAll())}get topDegrees(){return this._topDegrees}set topDegrees(e){e!==this._topDegrees&&(this._topDegrees=e,this._cache.invalidateAll())}get nearMeters(){return this._nearMeters}set nearMeters(e){e!==this._nearMeters&&(this._nearMeters=e,this._cache.invalidateAll())}get farMeters(){return this._farMeters}set farMeters(e){e!==this._farMeters&&(this._farMeters=e,this._cache.invalidateAll())}get sizeDegrees(){return this._size.set(this.rightDegrees-this.leftDegrees,this.topDegrees-this.bottomDegrees),this._size}get diagonalDegrees(){const e=this.sizeDegrees;return Math.acos(Math.cos(e.x*Ae)*Math.cos(e.y*Ae))*Ge}get centerDegrees(){const e=this.sizeDegrees;return this._center.set(this.leftDegrees+e.x/2,this.bottomDegrees+e.y/2)}get angleToCenter(){const e=this.centerDegrees;return Math.acos(Math.cos(e.x*Ae)*Math.cos(e.y*Ae))*Ge}get angleToTopLeft(){return Math.acos(Math.cos(this.leftDegrees*Ae)*Math.cos(this.topDegrees*Ae))*Ge}get angleToTopRight(){return Math.acos(Math.cos(this.rightDegrees*Ae)*Math.cos(this.topDegrees*Ae))*Ge}get angleToBottomLeft(){return Math.acos(Math.cos(this.leftDegrees*Ae)*Math.cos(this.bottomDegrees*Ae))*Ge}get angleToBottomRight(){return Math.acos(Math.cos(this.rightDegrees*Ae)*Math.cos(this.bottomDegrees*Ae))*Ge}get angleToClosestPoint(){const e=Math.min(Math.max(0,this.leftDegrees),this.rightDegrees),t=Math.min(Math.max(0,this.bottomDegrees),this.topDegrees);return Math.acos(Math.cos(e*Ae)*Math.cos(t*Ae))*Ge}get angleToFarthestPoint(){return Math.max(this.angleToTopLeft,this.angleToTopRight,this.angleToBottomLeft,this.angleToBottomRight)}get depth(){return this.farMeters-this.nearMeters}get distance(){return this.nearMeters+this.depth/2}get aspectRatio(){const e=this.nearMeters,t=e*Math.tan(this.leftDegrees*Ae),r=e*Math.tan(this.rightDegrees*Ae),n=e*Math.tan(this.topDegrees*Ae),s=e*Math.tan(this.bottomDegrees*Ae);return(n-s)/(r-t)}setFromPerspectiveProjectionMatrix(e,t=this._fullNDC){const r=this._inverseProjection.copy(e).invert(),n=this._v1,s=this._forwardDirection,c=Math.sign(t.min.x)*n.set(t.min.x,0,-1).applyMatrix4(r).angleTo(s)*Ge,l=Math.sign(t.max.x)*n.set(t.max.x,0,-1).applyMatrix4(r).angleTo(s)*Ge,h=Math.sign(t.max.y)*n.set(0,t.max.y,-1).applyMatrix4(r).angleTo(s)*Ge,f=Math.sign(t.min.y)*n.set(0,t.min.y,-1).applyMatrix4(r).angleTo(s)*Ge,o=-n.set(0,0,t.min.z).applyMatrix4(r).z,a=-n.set(0,0,t.max.z).applyMatrix4(r).z;return this.leftDegrees=c,this.rightDegrees=l,this.topDegrees=h,this.bottomDegrees=f,this.nearMeters=o,this.farMeters=a,this}get perspectiveProjectionMatrix(){return this._cachedPerspectiveProjectionMatrix()}overlapPercent(e){return this._boxA.min.x=this.leftDegrees,this._boxA.max.x=this.rightDegrees,this._boxA.min.y=this.bottomDegrees,this._boxA.max.y=this.topDegrees,this._boxB.min.x=e.leftDegrees,this._boxB.max.x=e.rightDegrees,this._boxB.min.y=e.bottomDegrees,this._boxB.max.y=e.topDegrees,this._boxA.intersect(this._boxB).getSize(this._overlapSize).length()/this.sizeDegrees.length()}}var Ts={epsilon:1e-12,matrix:"Matrix",number:"number",precision:64,predictable:!1,randomSeed:null};function Ue(i){return typeof i=="number"}function Ie(i){return i&&i.constructor.prototype.isBigNumber===!0||!1}function Lt(i){return i&&typeof i=="object"&&Object.getPrototypeOf(i).isComplex===!0||!1}function Ur(i){return i&&typeof i=="object"&&Object.getPrototypeOf(i).isFraction===!0||!1}function ar(i){return i&&i.constructor.prototype.isUnit===!0||!1}function zt(i){return typeof i=="string"}var $e=Array.isArray;function We(i){return i&&i.constructor.prototype.isMatrix===!0||!1}function ui(i){return Array.isArray(i)||We(i)}function Fs(i){return i&&i.isDenseMatrix&&i.constructor.prototype.isMatrix===!0||!1}function Ds(i){return i&&i.isSparseMatrix&&i.constructor.prototype.isMatrix===!0||!1}function ci(i){return i&&i.constructor.prototype.isRange===!0||!1}function xr(i){return i&&i.constructor.prototype.isIndex===!0||!1}function Is(i){return typeof i=="boolean"}function hi(i){return i&&i.constructor.prototype.isResultSet===!0||!1}function li(i){return i&&i.constructor.prototype.isHelp===!0||!1}function Bs(i){return typeof i=="function"}function Rs(i){return i instanceof Date}function Ps(i){return i instanceof RegExp}function ks(i){return!!(i&&typeof i=="object"&&i.constructor===Object&&!Lt(i)&&!Ur(i))}function Ls(i){return i===null}function Us(i){return i===void 0}function or(i){return i&&i.isAccessorNode===!0&&i.constructor.prototype.isNode===!0||!1}function fi(i){return i&&i.isArrayNode===!0&&i.constructor.prototype.isNode===!0||!1}function $s(i){return i&&i.isAssignmentNode===!0&&i.constructor.prototype.isNode===!0||!1}function qs(i){return i&&i.isBlockNode===!0&&i.constructor.prototype.isNode===!0||!1}function Vs(i){return i&&i.isConditionalNode===!0&&i.constructor.prototype.isNode===!0||!1}function ur(i){return i&&i.isConstantNode===!0&&i.constructor.prototype.isNode===!0||!1}function pi(i){return i&&i.isFunctionAssignmentNode===!0&&i.constructor.prototype.isNode===!0||!1}function wn(i){return i&&i.isFunctionNode===!0&&i.constructor.prototype.isNode===!0||!1}function $r(i){return i&&i.isIndexNode===!0&&i.constructor.prototype.isNode===!0||!1}function Pe(i){return i&&i.isNode===!0&&i.constructor.prototype.isNode===!0||!1}function di(i){return i&&i.isObjectNode===!0&&i.constructor.prototype.isNode===!0||!1}function mi(i){return i&&i.isOperatorNode===!0&&i.constructor.prototype.isNode===!0||!1}function vi(i){return i&&i.isParenthesisNode===!0&&i.constructor.prototype.isNode===!0||!1}function gi(i){return i&&i.isRangeNode===!0&&i.constructor.prototype.isNode===!0||!1}function lt(i){return i&&i.isSymbolNode===!0&&i.constructor.prototype.isNode===!0||!1}function yi(i){return i&&i.constructor.prototype.isChain===!0||!1}function ot(i){var e=typeof i;return e==="object"?i===null?"null":Array.isArray(i)?"Array":i instanceof Date?"Date":i instanceof RegExp?"RegExp":Ie(i)?"BigNumber":Lt(i)?"Complex":Ur(i)?"Fraction":We(i)?"Matrix":ar(i)?"Unit":xr(i)?"Index":ci(i)?"Range":hi(i)?"ResultSet":Pe(i)?i.type:yi(i)?"Chain":li(i)?"Help":"Object":e==="function"?"Function":e}function Ee(i){var e=typeof i;if(e==="number"||e==="string"||e==="boolean"||i===null||i===void 0)return i;if(typeof i.clone=="function")return i.clone();if(Array.isArray(i))return i.map(function(t){return Ee(t)});if(i instanceof Date)return new Date(i.valueOf());if(Ie(i))return i;if(i instanceof RegExp)throw new TypeError("Cannot clone "+i);return qr(i,Ee)}function qr(i,e){var t={};for(var r in i)ae(i,r)&&(t[r]=e(i[r]));return t}function wi(i,e){for(var t in e)ae(e,t)&&(i[t]=e[t]);return i}function js(i,e){if(Array.isArray(e))throw new TypeError("Arrays are not supported by deepExtend");for(var t in e)if(ae(e,t)&&!(t in Object.prototype)&&!(t in Function.prototype))if(e[t]&&e[t].constructor===Object)i[t]===void 0&&(i[t]={}),i[t]&&i[t].constructor===Object?js(i[t],e[t]):i[t]=e[t];else{if(Array.isArray(e[t]))throw new TypeError("Arrays are not supported by deepExtend");i[t]=e[t]}return i}function br(i,e){var t,r,n;if(Array.isArray(i)){if(!Array.isArray(e)||i.length!==e.length)return!1;for(r=0,n=i.length;r<n;r++)if(!br(i[r],e[r]))return!1;return!0}else{if(typeof i=="function")return i===e;if(i instanceof Object){if(Array.isArray(e)||!(e instanceof Object))return!1;for(t in i)if(!(t in e)||!br(i[t],e[t]))return!1;for(t in e)if(!(t in i)||!br(i[t],e[t]))return!1;return!0}else return i===e}}function rc(i){var e={};return Hs(i,e),e}function Hs(i,e){for(var t in i)if(ae(i,t)){var r=i[t];typeof r=="object"&&r!==null?Hs(r,e):e[t]=r}}function xi(i,e,t){var r=!0,n;Object.defineProperty(i,e,{get:function(){return r&&(n=t(),r=!1),n},set:function(c){n=c,r=!1},configurable:!0,enumerable:!0})}function ae(i,e){return i&&Object.hasOwnProperty.call(i,e)}function nc(i){return i&&typeof i.factory=="function"}function ic(i,e){for(var t={},r=0;r<e.length;r++){var n=e[r],s=i[n];s!==void 0&&(t[n]=s)}return t}function Gs(i){return Object.keys(i).map(e=>i[e])}var Ws=["Matrix","Array"],Ys=["number","BigNumber","Fraction"];function sc(i,e){function t(r){if(r){var n=qr(i,Ee);Zs(r,"matrix",Ws),Zs(r,"number",Ys),js(i,r);var s=qr(i,Ee),c=qr(r,Ee);return e("config",s,n,c),s}else return qr(i,Ee)}return t.MATRIX_OPTIONS=Ws,t.NUMBER_OPTIONS=Ys,Object.keys(Ts).forEach(r=>{Object.defineProperty(t,r,{get:()=>i[r],enumerable:!0,configurable:!0})}),t}function ac(i,e){return i.indexOf(e)!==-1}function Zs(i,e,t){i[e]!==void 0&&!ac(t,i[e])&&console.warn('Warning: Unknown value "'+i[e]+'" for configuration option "'+e+'". Available options: '+t.map(r=>JSON.stringify(r)).join(", ")+".")}var oc=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Js(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Qs={exports:{}};(function(i,e){(function(t,r){i.exports=r()})(oc,function(){function t(){return!0}function r(){return!1}function n(){}function s(){var c=[{name:"number",test:function(C){return typeof C=="number"}},{name:"string",test:function(C){return typeof C=="string"}},{name:"boolean",test:function(C){return typeof C=="boolean"}},{name:"Function",test:function(C){return typeof C=="function"}},{name:"Array",test:Array.isArray},{name:"Date",test:function(C){return C instanceof Date}},{name:"RegExp",test:function(C){return C instanceof RegExp}},{name:"Object",test:function(C){return typeof C=="object"&&C!==null&&C.constructor===Object}},{name:"null",test:function(C){return C===null}},{name:"undefined",test:function(C){return C===void 0}}],l={name:"any",test:t},h=[],f=[],o={types:c,conversions:f,ignore:h};function a(C){var P=Be(o.types,function(L){return L.name===C});if(P)return P;if(C==="any")return l;var U=Be(o.types,function(L){return L.name.toLowerCase()===C.toLowerCase()});throw new TypeError('Unknown type "'+C+'"'+(U?'. Did you mean "'+U.name+'"?':""))}function u(C){return C===l?999:o.types.indexOf(C)}function p(C){var P=Be(o.types,function(U){return U.test(C)});if(P)return P.name;throw new TypeError("Value has unknown type. Value: "+C)}function m(C,P){if(!C.signatures)throw new TypeError("Function is no typed-function");var U;if(typeof P=="string"){U=P.split(",");for(var L=0;L<U.length;L++)U[L]=U[L].trim()}else if(Array.isArray(P))U=P;else throw new TypeError("String array or a comma separated string expected");var W=U.join(","),re=C.signatures[W];if(re)return re;throw new TypeError("Signature not found (signature: "+(C.name||"unnamed")+"("+U.join(", ")+"))")}function d(C,P){var U=p(C);if(P===U)return C;for(var L=0;L<o.conversions.length;L++){var W=o.conversions[L];if(W.from===U&&W.to===P)return W.convert(C)}throw new Error("Cannot convert from "+U+" to "+P)}function w(C){return C.map(function(P){var U=P.types.map(E);return(P.restParam?"...":"")+U.join("|")}).join(",")}function v(C,P){var U=C.indexOf("...")===0,L=U?C.length>3?C.slice(3):"any":C,W=L.split("|").map(Se).filter(se).filter(Ne),re=S(P,W),ne=W.map(function(ee){var le=a(ee);return{name:ee,typeIndex:u(le),test:le.test,conversion:null,conversionIndex:-1}}),te=re.map(function(ee){var le=a(ee.from);return{name:ee.from,typeIndex:u(le),test:le.test,conversion:ee,conversionIndex:P.indexOf(ee)}});return{types:ne.concat(te),restParam:U}}function x(C,P,U){var L=[];return C.trim()!==""&&(L=C.split(",").map(Se).map(function(W,re,ne){var te=v(W,U);if(te.restParam&&re!==ne.length-1)throw new SyntaxError('Unexpected rest parameter "'+W+'": only allowed for the last parameter');return te})),L.some(Ve)?null:{params:L,fn:P}}function g(C){var P=fe(C);return P?P.restParam:!1}function b(C){return C.types.some(function(P){return P.conversion!=null})}function M(C){if(!C||C.types.length===0)return t;if(C.types.length===1)return a(C.types[0].name).test;if(C.types.length===2){var P=a(C.types[0].name).test,U=a(C.types[1].name).test;return function(re){return P(re)||U(re)}}else{var L=C.types.map(function(W){return a(W.name).test});return function(re){for(var ne=0;ne<L.length;ne++)if(L[ne](re))return!0;return!1}}}function _(C){var P,U,L;if(g(C)){P=we(C).map(M);var W=P.length,re=M(fe(C)),ne=function(te){for(var ee=W;ee<te.length;ee++)if(!re(te[ee]))return!1;return!0};return function(ee){for(var le=0;le<P.length;le++)if(!P[le](ee[le]))return!1;return ne(ee)&&ee.length>=W+1}}else return C.length===0?function(ee){return ee.length===0}:C.length===1?(U=M(C[0]),function(ee){return U(ee[0])&&ee.length===1}):C.length===2?(U=M(C[0]),L=M(C[1]),function(ee){return U(ee[0])&&L(ee[1])&&ee.length===2}):(P=C.map(M),function(ee){for(var le=0;le<P.length;le++)if(!P[le](ee[le]))return!1;return ee.length===P.length})}function N(C,P){return P<C.params.length?C.params[P]:g(C.params)?fe(C.params):null}function O(C,P,U){var L=N(C,P),W=L?U?L.types.filter(F):L.types:[];return W.map(E)}function E(C){return C.name}function F(C){return C.conversion===null||C.conversion===void 0}function B(C,P){var U=T(R(C,function(L){return O(L,P,!1)}));return U.indexOf("any")!==-1?["any"]:U}function I(C,P,U){var L,W,re=C||"unnamed",ne=U,te;for(te=0;te<P.length;te++){var ee=ne.filter(function(it){var Ft=M(N(it,te));return(te<it.params.length||g(it.params))&&Ft(P[te])});if(ee.length===0){if(W=B(ne,te),W.length>0){var le=p(P[te]);return L=new TypeError("Unexpected type of argument in function "+re+" (expected: "+W.join(" or ")+", actual: "+le+", index: "+te+")"),L.data={category:"wrongType",fn:re,index:te,actual:le,expected:W},L}}else ne=ee}var je=ne.map(function(it){return g(it.params)?1/0:it.params.length});if(P.length<Math.min.apply(null,je))return W=B(ne,te),L=new TypeError("Too few arguments in function "+re+" (expected: "+W.join(" or ")+", index: "+P.length+")"),L.data={category:"tooFewArgs",fn:re,index:P.length,expected:W},L;var Ke=Math.max.apply(null,je);return P.length>Ke?(L=new TypeError("Too many arguments in function "+re+" (expected: "+Ke+", actual: "+P.length+")"),L.data={category:"tooManyArgs",fn:re,index:P.length,expectedLength:Ke},L):(L=new TypeError('Arguments of type "'+P.join(", ")+'" do not match any of the defined signatures of function '+re+"."),L.data={category:"mismatch",actual:P.map(p)},L)}function j(C){for(var P=999,U=0;U<C.types.length;U++)F(C.types[U])&&(P=Math.min(P,C.types[U].typeIndex));return P}function q(C){for(var P=999,U=0;U<C.types.length;U++)F(C.types[U])||(P=Math.min(P,C.types[U].conversionIndex));return P}function H(C,P){var U;return U=C.restParam-P.restParam,U!==0||(U=b(C)-b(P),U!==0)||(U=j(C)-j(P),U!==0)?U:q(C)-q(P)}function k(C,P){var U=Math.min(C.params.length,P.params.length),L,W;if(W=C.params.some(b)-P.params.some(b),W!==0)return W;for(L=0;L<U;L++)if(W=b(C.params[L])-b(P.params[L]),W!==0)return W;for(L=0;L<U;L++)if(W=H(C.params[L],P.params[L]),W!==0)return W;return C.params.length-P.params.length}function S(C,P){var U={};return C.forEach(function(L){P.indexOf(L.from)===-1&&P.indexOf(L.to)!==-1&&!U[L.from]&&(U[L.from]=L)}),Object.keys(U).map(function(L){return U[L]})}function J(C,P){var U=P;if(C.some(b)){var L=g(C),W=C.map(A);U=function(){for(var ee=[],le=L?arguments.length-1:arguments.length,je=0;je<le;je++)ee[je]=W[je](arguments[je]);return L&&(ee[le]=arguments[le].map(W[le])),P.apply(this,ee)}}var re=U;if(g(C)){var ne=C.length-1;re=function(){return U.apply(this,Te(arguments,0,ne).concat([Te(arguments,ne)]))}}return re}function A(C){var P,U,L,W,re=[],ne=[];switch(C.types.forEach(function(te){te.conversion&&(re.push(a(te.conversion.from).test),ne.push(te.conversion.convert))}),ne.length){case 0:return function(ee){return ee};case 1:return P=re[0],L=ne[0],function(ee){return P(ee)?L(ee):ee};case 2:return P=re[0],U=re[1],L=ne[0],W=ne[1],function(ee){return P(ee)?L(ee):U(ee)?W(ee):ee};default:return function(ee){for(var le=0;le<ne.length;le++)if(re[le](ee))return ne[le](ee);return ee}}}function ie(C){var P={};return C.forEach(function(U){U.params.some(b)||de(U.params,!0).forEach(function(L){P[w(L)]=U.fn})}),P}function de(C,P){function U(L,W,re){if(W<L.length){var ne=L[W],te=P?ne.types.filter(F):ne.types,ee;if(ne.restParam){var le=te.filter(F);ee=le.length<te.length?[le,te]:[te]}else ee=te.map(function(Ke){return[Ke]});return R(ee,function(Ke){return U(L,W+1,re.concat([Ke]))})}else{var je=re.map(function(Ke,it){return{types:Ke,restParam:it===L.length-1&&g(L)}});return[je]}}return U(C,0,[])}function ue(C,P){for(var U=Math.max(C.params.length,P.params.length),L=0;L<U;L++){var W=O(C,L,!0),re=O(P,L,!0);if(!Me(W,re))return!1}var ne=C.params.length,te=P.params.length,ee=g(C.params),le=g(P.params);return ee?le?ne===te:te>=ne:le?ne>=te:ne===te}function V(C,P){if(Object.keys(P).length===0)throw new SyntaxError("No signatures provided");var U=[];Object.keys(P).map(function(Re){return x(Re,P[Re],o.conversions)}).filter(me).forEach(function(Re){var st=Be(U,function(Dt){return ue(Dt,Re)});if(st)throw new TypeError('Conflicting signatures "'+w(st.params)+'" and "'+w(Re.params)+'".');U.push(Re)});var L=R(U,function(Re){var st=Re?de(Re.params,!1):[];return st.map(function(Dt){return{params:Dt,fn:Re.fn}})}).filter(me);L.sort(k);var W=L[0]&&L[0].params.length<=2&&!g(L[0].params),re=L[1]&&L[1].params.length<=2&&!g(L[1].params),ne=L[2]&&L[2].params.length<=2&&!g(L[2].params),te=L[3]&&L[3].params.length<=2&&!g(L[3].params),ee=L[4]&&L[4].params.length<=2&&!g(L[4].params),le=L[5]&&L[5].params.length<=2&&!g(L[5].params),je=W&&re&&ne&&te&&ee&&le,Ke=L.map(function(Re){return _(Re.params)}),it=W?M(L[0].params[0]):r,Ft=re?M(L[1].params[0]):r,Fr=ne?M(L[2].params[0]):r,Xt=te?M(L[3].params[0]):r,De=ee?M(L[4].params[0]):r,Kt=le?M(L[5].params[0]):r,y=W?M(L[0].params[1]):r,D=re?M(L[1].params[1]):r,$=ne?M(L[2].params[1]):r,X=te?M(L[3].params[1]):r,ge=ee?M(L[4].params[1]):r,_e=le?M(L[5].params[1]):r,ht=L.map(function(Re){return J(Re.params,Re.fn)}),Wi=W?ht[0]:n,hm=re?ht[1]:n,lm=ne?ht[2]:n,fm=te?ht[3]:n,pm=ee?ht[4]:n,dm=le?ht[5]:n,mm=W?L[0].params.length:-1,vm=re?L[1].params.length:-1,gm=ne?L[2].params.length:-1,ym=te?L[3].params.length:-1,wm=ee?L[4].params.length:-1,xm=le?L[5].params.length:-1,bm=je?6:0,Mm=L.length,_m=function(){for(var st=bm;st<Mm;st++)if(Ke[st](arguments))return ht[st].apply(this,arguments);throw I(C,arguments,L)},Yi=function Re(st,Dt){return arguments.length===mm&&it(st)&&y(Dt)?Wi.apply(Re,arguments):arguments.length===vm&&Ft(st)&&D(Dt)?hm.apply(Re,arguments):arguments.length===gm&&Fr(st)&&$(Dt)?lm.apply(Re,arguments):arguments.length===ym&&Xt(st)&&X(Dt)?fm.apply(Re,arguments):arguments.length===wm&&De(st)&&ge(Dt)?pm.apply(Re,arguments):arguments.length===xm&&Kt(st)&&_e(Dt)?dm.apply(Re,arguments):_m.apply(Re,arguments)};try{Object.defineProperty(Yi,"name",{value:C})}catch{}return Yi.signatures=ie(L),Yi}function Ne(C){return o.ignore.indexOf(C)===-1}function Se(C){return C.trim()}function se(C){return!!C}function me(C){return C!==null}function Ve(C){return C.types.length===0}function we(C){return C.slice(0,C.length-1)}function fe(C){return C[C.length-1]}function Te(C,P,U){return Array.prototype.slice.call(C,P,U)}function Fe(C,P){return C.indexOf(P)!==-1}function Me(C,P){for(var U=0;U<C.length;U++)if(Fe(P,C[U]))return!0;return!1}function Be(C,P){for(var U=0;U<C.length;U++)if(P(C[U]))return C[U]}function T(C){for(var P={},U=0;U<C.length;U++)P[C[U]]=!0;return Object.keys(P)}function R(C,P){return Array.prototype.concat.apply([],C.map(P))}function Y(C){for(var P="",U=0;U<C.length;U++){var L=C[U];if((typeof L.signatures=="object"||typeof L.signature=="string")&&L.name!==""){if(P==="")P=L.name;else if(P!==L.name){var W=new Error("Function names do not match (expected: "+P+", actual: "+L.name+")");throw W.data={actual:L.name,expected:P},W}}}return P}function Q(C){var P,U={};function L(te,ee){if(U.hasOwnProperty(te)&&ee!==U[te])throw P=new Error('Signature "'+te+'" is defined twice'),P.data={signature:te},P}for(var W=0;W<C.length;W++){var re=C[W];if(typeof re.signatures=="object")for(var ne in re.signatures)re.signatures.hasOwnProperty(ne)&&(L(ne,re.signatures[ne]),U[ne]=re.signatures[ne]);else if(typeof re.signature=="string")L(re.signature,re),U[re.signature]=re;else throw P=new TypeError("Function is no typed-function (index: "+W+")"),P.data={index:W},P}return U}return o=V("typed",{"string, Object":V,Object:function(C){var P=[];for(var U in C)C.hasOwnProperty(U)&&P.push(C[U]);var L=Y(P);return V(L,C)},"...Function":function(C){return V(Y(C),Q(C))},"string, ...Function":function(C,P){return V(C,Q(P))}}),o.create=s,o.types=c,o.conversions=f,o.ignore=h,o.convert=d,o.find=m,o.addType=function(C,P){if(!C||typeof C.name!="string"||typeof C.test!="function")throw new TypeError("Object with properties {name: string, test: function} expected");if(P!==!1){for(var U=0;U<o.types.length;U++)if(o.types[U].name==="Object"){o.types.splice(U,0,C);return}}o.types.push(C)},o.addConversion=function(C){if(!C||typeof C.from!="string"||typeof C.to!="string"||typeof C.convert!="function")throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");o.conversions.push(C)},o}return s()})})(Qs);var Xs=Qs.exports;function Ye(i){return typeof i=="boolean"?!0:isFinite(i)?i===Math.round(i):!1}var Ks=Math.sign||function(i){return i>0?1:i<0?-1:0};function Mr(i,e){if(typeof e=="function")return e(i);if(i===1/0)return"Infinity";if(i===-1/0)return"-Infinity";if(isNaN(i))return"NaN";var t="auto",r;switch(e&&(e.notation&&(t=e.notation),Ue(e)?r=e:Ue(e.precision)&&(r=e.precision)),t){case"fixed":return ea(i,r);case"exponential":return ta(i,r);case"engineering":return uc(i,r);case"auto":return cc(i,r,e&&e).replace(/((\.\d*?)(0+))($|e)/,function(){var n=arguments[2],s=arguments[4];return n!=="."?n+s:s});default:throw new Error('Unknown notation "'+t+'". Choose "auto", "exponential", or "fixed".')}}function xn(i){var e=String(i).toLowerCase().match(/^0*?(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!e)throw new SyntaxError("Invalid number "+i);var t=e[1],r=e[2],n=parseFloat(e[4]||"0"),s=r.indexOf(".");n+=s!==-1?s-1:r.length-1;var c=r.replace(".","").replace(/^0*/,function(l){return n-=l.length,""}).replace(/0*$/,"").split("").map(function(l){return parseInt(l)});return c.length===0&&(c.push(0),n++),{sign:t,coefficients:c,exponent:n}}function uc(i,e){if(isNaN(i)||!isFinite(i))return String(i);var t=xn(i),r=bn(t,e),n=r.exponent,s=r.coefficients,c=n%3===0?n:n<0?n-3-n%3:n-n%3;if(Ue(e))for(;e>s.length||n-c+1>s.length;)s.push(0);else for(var l=Math.abs(n-c)-(s.length-1),h=0;h<l;h++)s.push(0);for(var f=Math.abs(n-c),o=1;f>0;)o++,f--;var a=s.slice(o).join(""),u=Ue(e)&&a.length||a.match(/[1-9]/)?"."+a:"",p=s.slice(0,o).join("")+u+"e"+(n>=0?"+":"")+c.toString();return r.sign+p}function ea(i,e){if(isNaN(i)||!isFinite(i))return String(i);var t=xn(i),r=typeof e=="number"?bn(t,t.exponent+1+e):t,n=r.coefficients,s=r.exponent+1,c=s+(e||0);return n.length<c&&(n=n.concat(_r(c-n.length))),s<0&&(n=_r(-s+1).concat(n),s=1),s<n.length&&n.splice(s,0,s===0?"0.":"."),r.sign+n.join("")}function ta(i,e){if(isNaN(i)||!isFinite(i))return String(i);var t=xn(i),r=e?bn(t,e):t,n=r.coefficients,s=r.exponent;n.length<e&&(n=n.concat(_r(e-n.length)));var c=n.shift();return r.sign+c+(n.length>0?"."+n.join(""):"")+"e"+(s>=0?"+":"")+s}function cc(i,e,t){if(isNaN(i)||!isFinite(i))return String(i);var r=t&&t.lowerExp!==void 0?t.lowerExp:-3,n=t&&t.upperExp!==void 0?t.upperExp:5,s=xn(i),c=e?bn(s,e):s;if(c.exponent<r||c.exponent>=n)return ta(i,e);var l=c.coefficients,h=c.exponent;l.length<e&&(l=l.concat(_r(e-l.length))),l=l.concat(_r(h-l.length+1+(l.length<e?e-l.length:0))),l=_r(-h).concat(l);var f=h>0?h:0;return f<l.length-1&&l.splice(f+1,0,"."),c.sign+l.join("")}function bn(i,e){for(var t={sign:i.sign,coefficients:i.coefficients,exponent:i.exponent},r=t.coefficients;e<=0;)r.unshift(0),t.exponent++,e++;if(r.length>e){var n=r.splice(e,r.length-e);if(n[0]>=5){var s=e-1;for(r[s]++;r[s]===10;)r.pop(),s===0&&(r.unshift(0),t.exponent++,s++),s--,r[s]++}}return t}function _r(i){for(var e=[],t=0;t<i;t++)e.push(0);return e}function hc(i){return i.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length}var lc=Number.EPSILON||2220446049250313e-31;function At(i,e,t){if(t==null)return i===e;if(i===e)return!0;if(isNaN(i)||isNaN(e))return!1;if(isFinite(i)&&isFinite(e)){var r=Math.abs(i-e);return r<lc?!0:r<=Math.max(Math.abs(i),Math.abs(e))*t}return!1}function fc(i,e){if(typeof e=="function")return e(i);if(!i.isFinite())return i.isNaN()?"NaN":i.gt(0)?"Infinity":"-Infinity";var t="auto",r;switch(e!==void 0&&(e.notation&&(t=e.notation),typeof e=="number"?r=e:e.precision&&(r=e.precision)),t){case"fixed":return dc(i,r);case"exponential":return ra(i,r);case"engineering":return pc(i,r);case"auto":{var n=e&&e.lowerExp!==void 0?e.lowerExp:-3,s=e&&e.upperExp!==void 0?e.upperExp:5;if(i.isZero())return"0";var c,l=i.toSignificantDigits(r),h=l.e;return h>=n&&h<s?c=l.toFixed():c=ra(i,r),c.replace(/((\.\d*?)(0+))($|e)/,function(){var f=arguments[2],o=arguments[4];return f!=="."?f+o:o})}default:throw new Error('Unknown notation "'+t+'". Choose "auto", "exponential", or "fixed".')}}function pc(i,e){var t=i.e,r=t%3===0?t:t<0?t-3-t%3:t-t%3,n=i.mul(Math.pow(10,-r)),s=n.toPrecision(e);return s.indexOf("e")!==-1&&(s=n.toString()),s+"e"+(t>=0?"+":"")+r.toString()}function ra(i,e){return e!==void 0?i.toExponential(e-1):i.toExponential()}function dc(i,e){return i.toFixed(e)}function mc(i,e){var t=i.length-e.length,r=i.length;return i.substring(t,r)===e}function qe(i,e){if(typeof i=="number")return Mr(i,e);if(Ie(i))return fc(i,e);if(vc(i))return!e||e.fraction!=="decimal"?i.s*i.n+"/"+i.d:i.toString();if(Array.isArray(i))return na(i,e);if(zt(i))return'"'+i+'"';if(typeof i=="function")return i.syntax?String(i.syntax):"function";if(i&&typeof i=="object"){if(typeof i.format=="function")return i.format(e);if(i&&i.toString(e)!=={}.toString())return i.toString(e);var t=Object.keys(i).map(r=>'"'+r+'": '+qe(i[r],e));return"{"+t.join(", ")+"}"}return String(i)}function Mn(i){for(var e=String(i),t="",r=0;r<e.length;){var n=e.charAt(r);n==="\\"?(t+=n,r++,n=e.charAt(r),(n===""||'"\\/bfnrtu'.indexOf(n)===-1)&&(t+="\\"),t+=n):n==='"'?t+='\\"':t+=n,r++}return'"'+t+'"'}function gt(i){var e=String(i);return e=e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),e}function na(i,e){if(Array.isArray(i)){for(var t="[",r=i.length,n=0;n<r;n++)n!==0&&(t+=", "),t+=na(i[n],e);return t+="]",t}else return qe(i,e)}function vc(i){return i&&typeof i=="object"&&typeof i.s=="number"&&typeof i.n=="number"&&typeof i.d=="number"||!1}function ye(i,e,t){if(!(this instanceof ye))throw new SyntaxError("Constructor must be called with the new operator");this.actual=i,this.expected=e,this.relation=t,this.message="Dimension mismatch ("+(Array.isArray(i)?"["+i.join(", ")+"]":i)+" "+(this.relation||"!=")+" "+(Array.isArray(e)?"["+e.join(", ")+"]":e)+")",this.stack=new Error().stack}ye.prototype=new RangeError,ye.prototype.constructor=RangeError,ye.prototype.name="DimensionError",ye.prototype.isDimensionError=!0;function Gt(i,e,t){if(!(this instanceof Gt))throw new SyntaxError("Constructor must be called with the new operator");this.index=i,arguments.length<3?(this.min=0,this.max=e):(this.min=e,this.max=t),this.min!==void 0&&this.index<this.min?this.message="Index out of range ("+this.index+" < "+this.min+")":this.max!==void 0&&this.index>=this.max?this.message="Index out of range ("+this.index+" > "+(this.max-1)+")":this.message="Index out of range ("+this.index+")",this.stack=new Error().stack}Gt.prototype=new RangeError,Gt.prototype.constructor=RangeError,Gt.prototype.name="IndexError",Gt.prototype.isIndexError=!0;function yt(i){for(var e=[];Array.isArray(i);)e.push(i.length),i=i[0];return e}function ia(i,e,t){var r,n=i.length;if(n!==e[t])throw new ye(n,e[t]);if(t<e.length-1){var s=t+1;for(r=0;r<n;r++){var c=i[r];if(!Array.isArray(c))throw new ye(e.length-1,e.length,"<");ia(i[r],e,s)}}else for(r=0;r<n;r++)if(Array.isArray(i[r]))throw new ye(e.length+1,e.length,">")}function sa(i,e){var t=e.length===0;if(t){if(Array.isArray(i))throw new ye(i.length,0)}else ia(i,e,0)}function ke(i,e){if(!Ue(i)||!Ye(i))throw new TypeError("Index must be an integer (value: "+i+")");if(i<0||typeof e=="number"&&i>=e)throw new Gt(i,e)}function _n(i,e,t){if(!Array.isArray(i)||!Array.isArray(e))throw new TypeError("Array expected");if(e.length===0)throw new Error("Resizing to scalar is not supported");e.forEach(function(n){if(!Ue(n)||!Ye(n)||n<0)throw new TypeError("Invalid size, must contain positive integers (size: "+qe(e)+")")});var r=t!==void 0?t:0;return bi(i,e,0,r),i}function bi(i,e,t,r){var n,s,c=i.length,l=e[t],h=Math.min(c,l);if(i.length=l,t<e.length-1){var f=t+1;for(n=0;n<h;n++)s=i[n],Array.isArray(s)||(s=[s],i[n]=s),bi(s,e,f,r);for(n=h;n<l;n++)s=[],i[n]=s,bi(s,e,f,r)}else{for(n=0;n<h;n++)for(;Array.isArray(i[n]);)i[n]=i[n][0];for(n=h;n<l;n++)i[n]=r}}function gc(i,e){var t=wc(i),r;function n(l){return l.reduce((h,f)=>h*f)}if(!Array.isArray(i)||!Array.isArray(e))throw new TypeError("Array expected");if(e.length===0)throw new ye(0,n(yt(i)),"!=");for(var s=1,c=0;c<e.length;c++)s*=e[c];if(t.length!==s)throw new ye(n(e),n(yt(i)),"!=");try{r=yc(t,e)}catch(l){throw l instanceof ye?new ye(n(e),n(yt(i)),"!="):l}return r}function yc(i,e){for(var t=i,r,n=e.length-1;n>0;n--){var s=e[n];r=[];for(var c=t.length/s,l=0;l<c;l++)r.push(t.slice(l*s,(l+1)*s));t=r}return t}function aa(i,e,t,r){var n=r||yt(i);if(t)for(var s=0;s<t;s++)i=[i],n.unshift(1);for(i=oa(i,e,0);n.length<e;)n.push(1);return i}function oa(i,e,t){var r,n;if(Array.isArray(i)){var s=t+1;for(r=0,n=i.length;r<n;r++)i[r]=oa(i[r],e,s)}else for(var c=t;c<e;c++)i=[i];return i}function wc(i){if(!Array.isArray(i))return i;var e=[];return i.forEach(function t(r){Array.isArray(r)?r.forEach(t):e.push(r)}),e}function wt(i,e){return Array.prototype.map.call(i,e)}function ua(i,e){Array.prototype.forEach.call(i,e)}function ca(i,e){return Array.prototype.join.call(i,e)}function Nn(i,e){for(var t,r=0,n=0;n<i.length;n++){var s=i[n],c=Array.isArray(s);if(n===0&&c&&(r=s.length),c&&s.length!==r)return;var l=c?Nn(s,e):e(s);if(t===void 0)t=l;else if(t!==l)return"mixed"}return t}function ha(i,e){return i.indexOf(e)!==-1}function K(i,e,t,r){function n(s){var c=ic(s,e.map(la));return xc(i,e,s),t(c)}return n.isFactory=!0,n.fn=i,n.dependencies=e.slice().sort(),r&&(n.meta=r),n}function Vr(i){return typeof i=="function"&&typeof i.fn=="string"&&Array.isArray(i.dependencies)}function xc(i,e,t){var r=e.filter(s=>!bc(s)).every(s=>t[s]!==void 0);if(!r){var n=e.filter(s=>t[s]===void 0);throw new Error('Cannot create function "'.concat(i,'", ')+"some dependencies are missing: ".concat(n.map(s=>'"'.concat(s,'"')).join(", "),"."))}}function bc(i){return i&&i[0]==="?"}function la(i){return i&&i[0]==="?"?i.slice(1):i}var fa=function(){return fa=Xs.create,Xs},Mc=["?BigNumber","?Complex","?DenseMatrix","?Fraction"],_c=K("typed",Mc,function(e){var{BigNumber:t,Complex:r,DenseMatrix:n,Fraction:s}=e,c=fa();return c.types=[{name:"number",test:Ue},{name:"Complex",test:Lt},{name:"BigNumber",test:Ie},{name:"Fraction",test:Ur},{name:"Unit",test:ar},{name:"string",test:zt},{name:"Chain",test:yi},{name:"Array",test:$e},{name:"Matrix",test:We},{name:"DenseMatrix",test:Fs},{name:"SparseMatrix",test:Ds},{name:"Range",test:ci},{name:"Index",test:xr},{name:"boolean",test:Is},{name:"ResultSet",test:hi},{name:"Help",test:li},{name:"function",test:Bs},{name:"Date",test:Rs},{name:"RegExp",test:Ps},{name:"null",test:Ls},{name:"undefined",test:Us},{name:"AccessorNode",test:or},{name:"ArrayNode",test:fi},{name:"AssignmentNode",test:$s},{name:"BlockNode",test:qs},{name:"ConditionalNode",test:Vs},{name:"ConstantNode",test:ur},{name:"FunctionNode",test:wn},{name:"FunctionAssignmentNode",test:pi},{name:"IndexNode",test:$r},{name:"Node",test:Pe},{name:"ObjectNode",test:di},{name:"OperatorNode",test:mi},{name:"ParenthesisNode",test:vi},{name:"RangeNode",test:gi},{name:"SymbolNode",test:lt},{name:"Object",test:ks}],c.conversions=[{from:"number",to:"BigNumber",convert:function(h){if(t||Mi(h),hc(h)>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+h+"). Use function bignumber(x) to convert to BigNumber.");return new t(h)}},{from:"number",to:"Complex",convert:function(h){return r||Sn(h),new r(h,0)}},{from:"number",to:"string",convert:function(h){return h+""}},{from:"BigNumber",to:"Complex",convert:function(h){return r||Sn(h),new r(h.toNumber(),0)}},{from:"Fraction",to:"BigNumber",convert:function(h){throw new TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(h){return r||Sn(h),new r(h.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(h){s||_i(h);var f=new s(h);if(f.valueOf()!==h)throw new TypeError("Cannot implicitly convert a number to a Fraction when there will be a loss of precision (value: "+h+"). Use function fraction(x) to convert to Fraction.");return f}},{from:"string",to:"number",convert:function(h){var f=Number(h);if(isNaN(f))throw new Error('Cannot convert "'+h+'" to a number');return f}},{from:"string",to:"BigNumber",convert:function(h){t||Mi(h);try{return new t(h)}catch{throw new Error('Cannot convert "'+h+'" to BigNumber')}}},{from:"string",to:"Fraction",convert:function(h){s||_i(h);try{return new s(h)}catch{throw new Error('Cannot convert "'+h+'" to Fraction')}}},{from:"string",to:"Complex",convert:function(h){r||Sn(h);try{return new r(h)}catch{throw new Error('Cannot convert "'+h+'" to Complex')}}},{from:"boolean",to:"number",convert:function(h){return+h}},{from:"boolean",to:"BigNumber",convert:function(h){return t||Mi(h),new t(+h)}},{from:"boolean",to:"Fraction",convert:function(h){return s||_i(h),new s(+h)}},{from:"boolean",to:"string",convert:function(h){return String(h)}},{from:"Array",to:"Matrix",convert:function(h){return n||Nc(),new n(h)}},{from:"Matrix",to:"Array",convert:function(h){return h.valueOf()}}],c});function Mi(i){throw new Error("Cannot convert value ".concat(i," into a BigNumber: no class 'BigNumber' provided"))}function Sn(i){throw new Error("Cannot convert value ".concat(i," into a Complex number: no class 'Complex' provided"))}function Nc(){throw new Error("Cannot convert array into a Matrix: no class 'DenseMatrix' provided")}function _i(i){throw new Error("Cannot convert value ".concat(i," into a Fraction, no class 'Fraction' provided."))}var Sc="ResultSet",Ec=[],Oc=K(Sc,Ec,()=>{function i(e){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");this.entries=e||[]}return i.prototype.type="ResultSet",i.prototype.isResultSet=!0,i.prototype.valueOf=function(){return this.entries},i.prototype.toString=function(){return"["+this.entries.join(", ")+"]"},i.prototype.toJSON=function(){return{mathjs:"ResultSet",entries:this.entries}},i.fromJSON=function(e){return new i(e.entries)},i},{isClass:!0}),Nr=9e15,Wt=1e9,Ni="0123456789abcdef",En="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",On="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",Si={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-Nr,maxE:Nr,crypto:!1},pa,Ut,pe=!0,zn="[DecimalError] ",cr=zn+"Invalid argument: ",da=zn+"Precision limit exceeded",ma=zn+"crypto unavailable",nt=Math.floor,Qe=Math.pow,zc=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Ac=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Cc=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,Tc=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,St=1e7,he=7,Fc=9007199254740991,Dc=En.length-1,Ei=On.length-1,Z={name:"[object Decimal]"};Z.absoluteValue=Z.abs=function(){var i=new this.constructor(this);return i.s<0&&(i.s=1),ce(i)},Z.ceil=function(){return ce(new this.constructor(this),this.e+1,2)},Z.comparedTo=Z.cmp=function(i){var e,t,r,n,s=this,c=s.d,l=(i=new s.constructor(i)).d,h=s.s,f=i.s;if(!c||!l)return!h||!f?NaN:h!==f?h:c===l?0:!c^h<0?1:-1;if(!c[0]||!l[0])return c[0]?h:l[0]?-f:0;if(h!==f)return h;if(s.e!==i.e)return s.e>i.e^h<0?1:-1;for(r=c.length,n=l.length,e=0,t=r<n?r:n;e<t;++e)if(c[e]!==l[e])return c[e]>l[e]^h<0?1:-1;return r===n?0:r>n^h<0?1:-1},Z.cosine=Z.cos=function(){var i,e,t=this,r=t.constructor;return t.d?t.d[0]?(i=r.precision,e=r.rounding,r.precision=i+Math.max(t.e,t.sd())+he,r.rounding=1,t=Ic(r,Ma(r,t)),r.precision=i,r.rounding=e,ce(Ut==2||Ut==3?t.neg():t,i,e,!0)):new r(1):new r(NaN)},Z.cubeRoot=Z.cbrt=function(){var i,e,t,r,n,s,c,l,h,f,o=this,a=o.constructor;if(!o.isFinite()||o.isZero())return new a(o);for(pe=!1,s=o.s*Qe(o.s*o,1/3),!s||Math.abs(s)==1/0?(t=rt(o.d),i=o.e,(s=(i-t.length+1)%3)&&(t+=s==1||s==-2?"0":"00"),s=Qe(t,1/3),i=nt((i+1)/3)-(i%3==(i<0?-1:2)),s==1/0?t="5e"+i:(t=s.toExponential(),t=t.slice(0,t.indexOf("e")+1)+i),r=new a(t),r.s=o.s):r=new a(s.toString()),c=(i=a.precision)+3;;)if(l=r,h=l.times(l).times(l),f=h.plus(o),r=Ce(f.plus(o).times(l),f.plus(h),c+2,1),rt(l.d).slice(0,c)===(t=rt(r.d)).slice(0,c))if(t=t.slice(c-3,c+1),t=="9999"||!n&&t=="4999"){if(!n&&(ce(l,i+1,0),l.times(l).times(l).eq(o))){r=l;break}c+=4,n=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(ce(r,i+1,1),e=!r.times(r).times(r).eq(o));break}return pe=!0,ce(r,i,a.rounding,e)},Z.decimalPlaces=Z.dp=function(){var i,e=this.d,t=NaN;if(e){if(i=e.length-1,t=(i-nt(this.e/he))*he,i=e[i],i)for(;i%10==0;i/=10)t--;t<0&&(t=0)}return t},Z.dividedBy=Z.div=function(i){return Ce(this,new this.constructor(i))},Z.dividedToIntegerBy=Z.divToInt=function(i){var e=this,t=e.constructor;return ce(Ce(e,new t(i),0,1,1),t.precision,t.rounding)},Z.equals=Z.eq=function(i){return this.cmp(i)===0},Z.floor=function(){return ce(new this.constructor(this),this.e+1,3)},Z.greaterThan=Z.gt=function(i){return this.cmp(i)>0},Z.greaterThanOrEqualTo=Z.gte=function(i){var e=this.cmp(i);return e==1||e===0},Z.hyperbolicCosine=Z.cosh=function(){var i,e,t,r,n,s=this,c=s.constructor,l=new c(1);if(!s.isFinite())return new c(s.s?1/0:NaN);if(s.isZero())return l;t=c.precision,r=c.rounding,c.precision=t+Math.max(s.e,s.sd())+4,c.rounding=1,n=s.d.length,n<32?(i=Math.ceil(n/3),e=(1/Fn(4,i)).toString()):(i=16,e="2.3283064365386962890625e-10"),s=Sr(c,1,s.times(e),new c(1),!0);for(var h,f=i,o=new c(8);f--;)h=s.times(s),s=l.minus(h.times(o.minus(h.times(o))));return ce(s,c.precision=t,c.rounding=r,!0)},Z.hyperbolicSine=Z.sinh=function(){var i,e,t,r,n=this,s=n.constructor;if(!n.isFinite()||n.isZero())return new s(n);if(e=s.precision,t=s.rounding,s.precision=e+Math.max(n.e,n.sd())+4,s.rounding=1,r=n.d.length,r<3)n=Sr(s,2,n,n,!0);else{i=1.4*Math.sqrt(r),i=i>16?16:i|0,n=n.times(1/Fn(5,i)),n=Sr(s,2,n,n,!0);for(var c,l=new s(5),h=new s(16),f=new s(20);i--;)c=n.times(n),n=n.times(l.plus(c.times(h.times(c).plus(f))))}return s.precision=e,s.rounding=t,ce(n,e,t,!0)},Z.hyperbolicTangent=Z.tanh=function(){var i,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(i=r.precision,e=r.rounding,r.precision=i+7,r.rounding=1,Ce(t.sinh(),t.cosh(),r.precision=i,r.rounding=e)):new r(t.s)},Z.inverseCosine=Z.acos=function(){var i,e=this,t=e.constructor,r=e.abs().cmp(1),n=t.precision,s=t.rounding;return r!==-1?r===0?e.isNeg()?Et(t,n,s):new t(0):new t(NaN):e.isZero()?Et(t,n+4,s).times(.5):(t.precision=n+6,t.rounding=1,e=e.asin(),i=Et(t,n+4,s).times(.5),t.precision=n,t.rounding=s,i.minus(e))},Z.inverseHyperbolicCosine=Z.acosh=function(){var i,e,t=this,r=t.constructor;return t.lte(1)?new r(t.eq(1)?0:NaN):t.isFinite()?(i=r.precision,e=r.rounding,r.precision=i+Math.max(Math.abs(t.e),t.sd())+4,r.rounding=1,pe=!1,t=t.times(t).minus(1).sqrt().plus(t),pe=!0,r.precision=i,r.rounding=e,t.ln()):new r(t)},Z.inverseHyperbolicSine=Z.asinh=function(){var i,e,t=this,r=t.constructor;return!t.isFinite()||t.isZero()?new r(t):(i=r.precision,e=r.rounding,r.precision=i+2*Math.max(Math.abs(t.e),t.sd())+6,r.rounding=1,pe=!1,t=t.times(t).plus(1).sqrt().plus(t),pe=!0,r.precision=i,r.rounding=e,t.ln())},Z.inverseHyperbolicTangent=Z.atanh=function(){var i,e,t,r,n=this,s=n.constructor;return n.isFinite()?n.e>=0?new s(n.abs().eq(1)?n.s/0:n.isZero()?n:NaN):(i=s.precision,e=s.rounding,r=n.sd(),Math.max(r,i)<2*-n.e-1?ce(new s(n),i,e,!0):(s.precision=t=r-n.e,n=Ce(n.plus(1),new s(1).minus(n),t+i,1),s.precision=i+4,s.rounding=1,n=n.ln(),s.precision=i,s.rounding=e,n.times(.5))):new s(NaN)},Z.inverseSine=Z.asin=function(){var i,e,t,r,n=this,s=n.constructor;return n.isZero()?new s(n):(e=n.abs().cmp(1),t=s.precision,r=s.rounding,e!==-1?e===0?(i=Et(s,t+4,r).times(.5),i.s=n.s,i):new s(NaN):(s.precision=t+6,s.rounding=1,n=n.div(new s(1).minus(n.times(n)).sqrt().plus(1)).atan(),s.precision=t,s.rounding=r,n.times(2)))},Z.inverseTangent=Z.atan=function(){var i,e,t,r,n,s,c,l,h,f=this,o=f.constructor,a=o.precision,u=o.rounding;if(f.isFinite()){if(f.isZero())return new o(f);if(f.abs().eq(1)&&a+4<=Ei)return c=Et(o,a+4,u).times(.25),c.s=f.s,c}else{if(!f.s)return new o(NaN);if(a+4<=Ei)return c=Et(o,a+4,u).times(.5),c.s=f.s,c}for(o.precision=l=a+10,o.rounding=1,t=Math.min(28,l/he+2|0),i=t;i;--i)f=f.div(f.times(f).plus(1).sqrt().plus(1));for(pe=!1,e=Math.ceil(l/he),r=1,h=f.times(f),c=new o(f),n=f;i!==-1;)if(n=n.times(h),s=c.minus(n.div(r+=2)),n=n.times(h),c=s.plus(n.div(r+=2)),c.d[e]!==void 0)for(i=e;c.d[i]===s.d[i]&&i--;);return t&&(c=c.times(2<<t-1)),pe=!0,ce(c,o.precision=a,o.rounding=u,!0)},Z.isFinite=function(){return!!this.d},Z.isInteger=Z.isInt=function(){return!!this.d&&nt(this.e/he)>this.d.length-2},Z.isNaN=function(){return!this.s},Z.isNegative=Z.isNeg=function(){return this.s<0},Z.isPositive=Z.isPos=function(){return this.s>0},Z.isZero=function(){return!!this.d&&this.d[0]===0},Z.lessThan=Z.lt=function(i){return this.cmp(i)<0},Z.lessThanOrEqualTo=Z.lte=function(i){return this.cmp(i)<1},Z.logarithm=Z.log=function(i){var e,t,r,n,s,c,l,h,f=this,o=f.constructor,a=o.precision,u=o.rounding,p=5;if(i==null)i=new o(10),e=!0;else{if(i=new o(i),t=i.d,i.s<0||!t||!t[0]||i.eq(1))return new o(NaN);e=i.eq(10)}if(t=f.d,f.s<0||!t||!t[0]||f.eq(1))return new o(t&&!t[0]?-1/0:f.s!=1?NaN:t?0:1/0);if(e)if(t.length>1)s=!0;else{for(n=t[0];n%10===0;)n/=10;s=n!==1}if(pe=!1,l=a+p,c=Zt(f,l),r=e?Tn(o,l+10):Zt(i,l),h=Ce(c,r,l,1),jr(h.d,n=a,u))do if(l+=10,c=Zt(f,l),r=e?Tn(o,l+10):Zt(i,l),h=Ce(c,r,l,1),!s){+rt(h.d).slice(n+1,n+15)+1==1e14&&(h=ce(h,a+1,0));break}while(jr(h.d,n+=10,u));return pe=!0,ce(h,a,u)},Z.minus=Z.sub=function(i){var e,t,r,n,s,c,l,h,f,o,a,u,p=this,m=p.constructor;if(i=new m(i),!p.d||!i.d)return!p.s||!i.s?i=new m(NaN):p.d?i.s=-i.s:i=new m(i.d||p.s!==i.s?p:NaN),i;if(p.s!=i.s)return i.s=-i.s,p.plus(i);if(f=p.d,u=i.d,l=m.precision,h=m.rounding,!f[0]||!u[0]){if(u[0])i.s=-i.s;else if(f[0])i=new m(p);else return new m(h===3?-0:0);return pe?ce(i,l,h):i}if(t=nt(i.e/he),o=nt(p.e/he),f=f.slice(),s=o-t,s){for(a=s<0,a?(e=f,s=-s,c=u.length):(e=u,t=o,c=f.length),r=Math.max(Math.ceil(l/he),c)+2,s>r&&(s=r,e.length=1),e.reverse(),r=s;r--;)e.push(0);e.reverse()}else{for(r=f.length,c=u.length,a=r<c,a&&(c=r),r=0;r<c;r++)if(f[r]!=u[r]){a=f[r]<u[r];break}s=0}for(a&&(e=f,f=u,u=e,i.s=-i.s),c=f.length,r=u.length-c;r>0;--r)f[c++]=0;for(r=u.length;r>s;){if(f[--r]<u[r]){for(n=r;n&&f[--n]===0;)f[n]=St-1;--f[n],f[r]+=St}f[r]-=u[r]}for(;f[--c]===0;)f.pop();for(;f[0]===0;f.shift())--t;return f[0]?(i.d=f,i.e=Cn(f,t),pe?ce(i,l,h):i):new m(h===3?-0:0)},Z.modulo=Z.mod=function(i){var e,t=this,r=t.constructor;return i=new r(i),!t.d||!i.s||i.d&&!i.d[0]?new r(NaN):!i.d||t.d&&!t.d[0]?ce(new r(t),r.precision,r.rounding):(pe=!1,r.modulo==9?(e=Ce(t,i.abs(),0,3,1),e.s*=i.s):e=Ce(t,i,0,r.modulo,1),e=e.times(i),pe=!0,t.minus(e))},Z.naturalExponential=Z.exp=function(){return Oi(this)},Z.naturalLogarithm=Z.ln=function(){return Zt(this)},Z.negated=Z.neg=function(){var i=new this.constructor(this);return i.s=-i.s,ce(i)},Z.plus=Z.add=function(i){var e,t,r,n,s,c,l,h,f,o,a=this,u=a.constructor;if(i=new u(i),!a.d||!i.d)return!a.s||!i.s?i=new u(NaN):a.d||(i=new u(i.d||a.s===i.s?a:NaN)),i;if(a.s!=i.s)return i.s=-i.s,a.minus(i);if(f=a.d,o=i.d,l=u.precision,h=u.rounding,!f[0]||!o[0])return o[0]||(i=new u(a)),pe?ce(i,l,h):i;if(s=nt(a.e/he),r=nt(i.e/he),f=f.slice(),n=s-r,n){for(n<0?(t=f,n=-n,c=o.length):(t=o,r=s,c=f.length),s=Math.ceil(l/he),c=s>c?s+1:c+1,n>c&&(n=c,t.length=1),t.reverse();n--;)t.push(0);t.reverse()}for(c=f.length,n=o.length,c-n<0&&(n=c,t=o,o=f,f=t),e=0;n;)e=(f[--n]=f[n]+o[n]+e)/St|0,f[n]%=St;for(e&&(f.unshift(e),++r),c=f.length;f[--c]==0;)f.pop();return i.d=f,i.e=Cn(f,r),pe?ce(i,l,h):i},Z.precision=Z.sd=function(i){var e,t=this;if(i!==void 0&&i!==!!i&&i!==1&&i!==0)throw Error(cr+i);return t.d?(e=va(t.d),i&&t.e+1>e&&(e=t.e+1)):e=NaN,e},Z.round=function(){var i=this,e=i.constructor;return ce(new e(i),i.e+1,e.rounding)},Z.sine=Z.sin=function(){var i,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(i=r.precision,e=r.rounding,r.precision=i+Math.max(t.e,t.sd())+he,r.rounding=1,t=Rc(r,Ma(r,t)),r.precision=i,r.rounding=e,ce(Ut>2?t.neg():t,i,e,!0)):new r(NaN)},Z.squareRoot=Z.sqrt=function(){var i,e,t,r,n,s,c=this,l=c.d,h=c.e,f=c.s,o=c.constructor;if(f!==1||!l||!l[0])return new o(!f||f<0&&(!l||l[0])?NaN:l?c:1/0);for(pe=!1,f=Math.sqrt(+c),f==0||f==1/0?(e=rt(l),(e.length+h)%2==0&&(e+="0"),f=Math.sqrt(e),h=nt((h+1)/2)-(h<0||h%2),f==1/0?e="5e"+h:(e=f.toExponential(),e=e.slice(0,e.indexOf("e")+1)+h),r=new o(e)):r=new o(f.toString()),t=(h=o.precision)+3;;)if(s=r,r=s.plus(Ce(c,s,t+2,1)).times(.5),rt(s.d).slice(0,t)===(e=rt(r.d)).slice(0,t))if(e=e.slice(t-3,t+1),e=="9999"||!n&&e=="4999"){if(!n&&(ce(s,h+1,0),s.times(s).eq(c))){r=s;break}t+=4,n=1}else{(!+e||!+e.slice(1)&&e.charAt(0)=="5")&&(ce(r,h+1,1),i=!r.times(r).eq(c));break}return pe=!0,ce(r,h,o.rounding,i)},Z.tangent=Z.tan=function(){var i,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(i=r.precision,e=r.rounding,r.precision=i+10,r.rounding=1,t=t.sin(),t.s=1,t=Ce(t,new r(1).minus(t.times(t)).sqrt(),i+10,0),r.precision=i,r.rounding=e,ce(Ut==2||Ut==4?t.neg():t,i,e,!0)):new r(NaN)},Z.times=Z.mul=function(i){var e,t,r,n,s,c,l,h,f,o=this,a=o.constructor,u=o.d,p=(i=new a(i)).d;if(i.s*=o.s,!u||!u[0]||!p||!p[0])return new a(!i.s||u&&!u[0]&&!p||p&&!p[0]&&!u?NaN:!u||!p?i.s/0:i.s*0);for(t=nt(o.e/he)+nt(i.e/he),h=u.length,f=p.length,h<f&&(s=u,u=p,p=s,c=h,h=f,f=c),s=[],c=h+f,r=c;r--;)s.push(0);for(r=f;--r>=0;){for(e=0,n=h+r;n>r;)l=s[n]+p[r]*u[n-r-1]+e,s[n--]=l%St|0,e=l/St|0;s[n]=(s[n]+e)%St|0}for(;!s[--c];)s.pop();return e?++t:s.shift(),i.d=s,i.e=Cn(s,t),pe?ce(i,a.precision,a.rounding):i},Z.toBinary=function(i,e){return zi(this,2,i,e)},Z.toDecimalPlaces=Z.toDP=function(i,e){var t=this,r=t.constructor;return t=new r(t),i===void 0?t:(ft(i,0,Wt),e===void 0?e=r.rounding:ft(e,0,8),ce(t,i+t.e+1,e))},Z.toExponential=function(i,e){var t,r=this,n=r.constructor;return i===void 0?t=Ct(r,!0):(ft(i,0,Wt),e===void 0?e=n.rounding:ft(e,0,8),r=ce(new n(r),i+1,e),t=Ct(r,!0,i+1)),r.isNeg()&&!r.isZero()?"-"+t:t},Z.toFixed=function(i,e){var t,r,n=this,s=n.constructor;return i===void 0?t=Ct(n):(ft(i,0,Wt),e===void 0?e=s.rounding:ft(e,0,8),r=ce(new s(n),i+n.e+1,e),t=Ct(r,!1,i+r.e+1)),n.isNeg()&&!n.isZero()?"-"+t:t},Z.toFraction=function(i){var e,t,r,n,s,c,l,h,f,o,a,u,p=this,m=p.d,d=p.constructor;if(!m)return new d(p);if(f=t=new d(1),r=h=new d(0),e=new d(r),s=e.e=va(m)-p.e-1,c=s%he,e.d[0]=Qe(10,c<0?he+c:c),i==null)i=s>0?e:f;else{if(l=new d(i),!l.isInt()||l.lt(f))throw Error(cr+l);i=l.gt(e)?s>0?e:f:l}for(pe=!1,l=new d(rt(m)),o=d.precision,d.precision=s=m.length*he*2;a=Ce(l,e,0,1,1),n=t.plus(a.times(r)),n.cmp(i)!=1;)t=r,r=n,n=f,f=h.plus(a.times(n)),h=n,n=e,e=l.minus(a.times(n)),l=n;return n=Ce(i.minus(t),r,0,1,1),h=h.plus(n.times(f)),t=t.plus(n.times(r)),h.s=f.s=p.s,u=Ce(f,r,s,1).minus(p).abs().cmp(Ce(h,t,s,1).minus(p).abs())<1?[f,r]:[h,t],d.precision=o,pe=!0,u},Z.toHexadecimal=Z.toHex=function(i,e){return zi(this,16,i,e)},Z.toNearest=function(i,e){var t=this,r=t.constructor;if(t=new r(t),i==null){if(!t.d)return t;i=new r(1),e=r.rounding}else{if(i=new r(i),e===void 0?e=r.rounding:ft(e,0,8),!t.d)return i.s?t:i;if(!i.d)return i.s&&(i.s=t.s),i}return i.d[0]?(pe=!1,t=Ce(t,i,0,e,1).times(i),pe=!0,ce(t)):(i.s=t.s,t=i),t},Z.toNumber=function(){return+this},Z.toOctal=function(i,e){return zi(this,8,i,e)},Z.toPower=Z.pow=function(i){var e,t,r,n,s,c,l=this,h=l.constructor,f=+(i=new h(i));if(!l.d||!i.d||!l.d[0]||!i.d[0])return new h(Qe(+l,f));if(l=new h(l),l.eq(1))return l;if(r=h.precision,s=h.rounding,i.eq(1))return ce(l,r,s);if(e=nt(i.e/he),e>=i.d.length-1&&(t=f<0?-f:f)<=Fc)return n=ga(h,l,t,r),i.s<0?new h(1).div(n):ce(n,r,s);if(c=l.s,c<0){if(e<i.d.length-1)return new h(NaN);if((i.d[e]&1)==0&&(c=1),l.e==0&&l.d[0]==1&&l.d.length==1)return l.s=c,l}return t=Qe(+l,f),e=t==0||!isFinite(t)?nt(f*(Math.log("0."+rt(l.d))/Math.LN10+l.e+1)):new h(t+"").e,e>h.maxE+1||e<h.minE-1?new h(e>0?c/0:0):(pe=!1,h.rounding=l.s=1,t=Math.min(12,(e+"").length),n=Oi(i.times(Zt(l,r+t)),r),n.d&&(n=ce(n,r+5,1),jr(n.d,r,s)&&(e=r+10,n=ce(Oi(i.times(Zt(l,e+t)),e),e+5,1),+rt(n.d).slice(r+1,r+15)+1==1e14&&(n=ce(n,r+1,0)))),n.s=c,pe=!0,h.rounding=s,ce(n,r,s))},Z.toPrecision=function(i,e){var t,r=this,n=r.constructor;return i===void 0?t=Ct(r,r.e<=n.toExpNeg||r.e>=n.toExpPos):(ft(i,1,Wt),e===void 0?e=n.rounding:ft(e,0,8),r=ce(new n(r),i,e),t=Ct(r,i<=r.e||r.e<=n.toExpNeg,i)),r.isNeg()&&!r.isZero()?"-"+t:t},Z.toSignificantDigits=Z.toSD=function(i,e){var t=this,r=t.constructor;return i===void 0?(i=r.precision,e=r.rounding):(ft(i,1,Wt),e===void 0?e=r.rounding:ft(e,0,8)),ce(new r(t),i,e)},Z.toString=function(){var i=this,e=i.constructor,t=Ct(i,i.e<=e.toExpNeg||i.e>=e.toExpPos);return i.isNeg()&&!i.isZero()?"-"+t:t},Z.truncated=Z.trunc=function(){return ce(new this.constructor(this),this.e+1,1)},Z.valueOf=Z.toJSON=function(){var i=this,e=i.constructor,t=Ct(i,i.e<=e.toExpNeg||i.e>=e.toExpPos);return i.isNeg()?"-"+t:t};function rt(i){var e,t,r,n=i.length-1,s="",c=i[0];if(n>0){for(s+=c,e=1;e<n;e++)r=i[e]+"",t=he-r.length,t&&(s+=Yt(t)),s+=r;c=i[e],r=c+"",t=he-r.length,t&&(s+=Yt(t))}else if(c===0)return"0";for(;c%10===0;)c/=10;return s+c}function ft(i,e,t){if(i!==~~i||i<e||i>t)throw Error(cr+i)}function jr(i,e,t,r){var n,s,c,l;for(s=i[0];s>=10;s/=10)--e;return--e<0?(e+=he,n=0):(n=Math.ceil((e+1)/he),e%=he),s=Qe(10,he-e),l=i[n]%s|0,r==null?e<3?(e==0?l=l/100|0:e==1&&(l=l/10|0),c=t<4&&l==99999||t>3&&l==49999||l==5e4||l==0):c=(t<4&&l+1==s||t>3&&l+1==s/2)&&(i[n+1]/s/100|0)==Qe(10,e-2)-1||(l==s/2||l==0)&&(i[n+1]/s/100|0)==0:e<4?(e==0?l=l/1e3|0:e==1?l=l/100|0:e==2&&(l=l/10|0),c=(r||t<4)&&l==9999||!r&&t>3&&l==4999):c=((r||t<4)&&l+1==s||!r&&t>3&&l+1==s/2)&&(i[n+1]/s/1e3|0)==Qe(10,e-3)-1,c}function An(i,e,t){for(var r,n=[0],s,c=0,l=i.length;c<l;){for(s=n.length;s--;)n[s]*=e;for(n[0]+=Ni.indexOf(i.charAt(c++)),r=0;r<n.length;r++)n[r]>t-1&&(n[r+1]===void 0&&(n[r+1]=0),n[r+1]+=n[r]/t|0,n[r]%=t)}return n.reverse()}function Ic(i,e){var t,r,n=e.d.length;n<32?(t=Math.ceil(n/3),r=(1/Fn(4,t)).toString()):(t=16,r="2.3283064365386962890625e-10"),i.precision+=t,e=Sr(i,1,e.times(r),new i(1));for(var s=t;s--;){var c=e.times(e);e=c.times(c).minus(c).times(8).plus(1)}return i.precision-=t,e}var Ce=function(){function i(r,n,s){var c,l=0,h=r.length;for(r=r.slice();h--;)c=r[h]*n+l,r[h]=c%s|0,l=c/s|0;return l&&r.unshift(l),r}function e(r,n,s,c){var l,h;if(s!=c)h=s>c?1:-1;else for(l=h=0;l<s;l++)if(r[l]!=n[l]){h=r[l]>n[l]?1:-1;break}return h}function t(r,n,s,c){for(var l=0;s--;)r[s]-=l,l=r[s]<n[s]?1:0,r[s]=l*c+r[s]-n[s];for(;!r[0]&&r.length>1;)r.shift()}return function(r,n,s,c,l,h){var f,o,a,u,p,m,d,w,v,x,g,b,M,_,N,O,E,F,B,I,j=r.constructor,q=r.s==n.s?1:-1,H=r.d,k=n.d;if(!H||!H[0]||!k||!k[0])return new j(!r.s||!n.s||(H?k&&H[0]==k[0]:!k)?NaN:H&&H[0]==0||!k?q*0:q/0);for(h?(p=1,o=r.e-n.e):(h=St,p=he,o=nt(r.e/p)-nt(n.e/p)),B=k.length,E=H.length,v=new j(q),x=v.d=[],a=0;k[a]==(H[a]||0);a++);if(k[a]>(H[a]||0)&&o--,s==null?(_=s=j.precision,c=j.rounding):l?_=s+(r.e-n.e)+1:_=s,_<0)x.push(1),m=!0;else{if(_=_/p+2|0,a=0,B==1){for(u=0,k=k[0],_++;(a<E||u)&&_--;a++)N=u*h+(H[a]||0),x[a]=N/k|0,u=N%k|0;m=u||a<E}else{for(u=h/(k[0]+1)|0,u>1&&(k=i(k,u,h),H=i(H,u,h),B=k.length,E=H.length),O=B,g=H.slice(0,B),b=g.length;b<B;)g[b++]=0;I=k.slice(),I.unshift(0),F=k[0],k[1]>=h/2&&++F;do u=0,f=e(k,g,B,b),f<0?(M=g[0],B!=b&&(M=M*h+(g[1]||0)),u=M/F|0,u>1?(u>=h&&(u=h-1),d=i(k,u,h),w=d.length,b=g.length,f=e(d,g,w,b),f==1&&(u--,t(d,B<w?I:k,w,h))):(u==0&&(f=u=1),d=k.slice()),w=d.length,w<b&&d.unshift(0),t(g,d,b,h),f==-1&&(b=g.length,f=e(k,g,B,b),f<1&&(u++,t(g,B<b?I:k,b,h))),b=g.length):f===0&&(u++,g=[0]),x[a++]=u,f&&g[0]?g[b++]=H[O]||0:(g=[H[O]],b=1);while((O++<E||g[0]!==void 0)&&_--);m=g[0]!==void 0}x[0]||x.shift()}if(p==1)v.e=o,pa=m;else{for(a=1,u=x[0];u>=10;u/=10)a++;v.e=a+o*p-1,ce(v,l?s+v.e+1:s,c,m)}return v}}();function ce(i,e,t,r){var n,s,c,l,h,f,o,a,u,p=i.constructor;e:if(e!=null){if(a=i.d,!a)return i;for(n=1,l=a[0];l>=10;l/=10)n++;if(s=e-n,s<0)s+=he,c=e,o=a[u=0],h=o/Qe(10,n-c-1)%10|0;else if(u=Math.ceil((s+1)/he),l=a.length,u>=l)if(r){for(;l++<=u;)a.push(0);o=h=0,n=1,s%=he,c=s-he+1}else break e;else{for(o=l=a[u],n=1;l>=10;l/=10)n++;s%=he,c=s-he+n,h=c<0?0:o/Qe(10,n-c-1)%10|0}if(r=r||e<0||a[u+1]!==void 0||(c<0?o:o%Qe(10,n-c-1)),f=t<4?(h||r)&&(t==0||t==(i.s<0?3:2)):h>5||h==5&&(t==4||r||t==6&&(s>0?c>0?o/Qe(10,n-c):0:a[u-1])%10&1||t==(i.s<0?8:7)),e<1||!a[0])return a.length=0,f?(e-=i.e+1,a[0]=Qe(10,(he-e%he)%he),i.e=-e||0):a[0]=i.e=0,i;if(s==0?(a.length=u,l=1,u--):(a.length=u+1,l=Qe(10,he-s),a[u]=c>0?(o/Qe(10,n-c)%Qe(10,c)|0)*l:0),f)for(;;)if(u==0){for(s=1,c=a[0];c>=10;c/=10)s++;for(c=a[0]+=l,l=1;c>=10;c/=10)l++;s!=l&&(i.e++,a[0]==St&&(a[0]=1));break}else{if(a[u]+=l,a[u]!=St)break;a[u--]=0,l=1}for(s=a.length;a[--s]===0;)a.pop()}return pe&&(i.e>p.maxE?(i.d=null,i.e=NaN):i.e<p.minE&&(i.e=0,i.d=[0])),i}function Ct(i,e,t){if(!i.isFinite())return xa(i);var r,n=i.e,s=rt(i.d),c=s.length;return e?(t&&(r=t-c)>0?s=s.charAt(0)+"."+s.slice(1)+Yt(r):c>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(i.e<0?"e":"e+")+i.e):n<0?(s="0."+Yt(-n-1)+s,t&&(r=t-c)>0&&(s+=Yt(r))):n>=c?(s+=Yt(n+1-c),t&&(r=t-n-1)>0&&(s=s+"."+Yt(r))):((r=n+1)<c&&(s=s.slice(0,r)+"."+s.slice(r)),t&&(r=t-c)>0&&(n+1===c&&(s+="."),s+=Yt(r))),s}function Cn(i,e){var t=i[0];for(e*=he;t>=10;t/=10)e++;return e}function Tn(i,e,t){if(e>Dc)throw pe=!0,t&&(i.precision=t),Error(da);return ce(new i(En),e,1,!0)}function Et(i,e,t){if(e>Ei)throw Error(da);return ce(new i(On),e,t,!0)}function va(i){var e=i.length-1,t=e*he+1;if(e=i[e],e){for(;e%10==0;e/=10)t--;for(e=i[0];e>=10;e/=10)t++}return t}function Yt(i){for(var e="";i--;)e+="0";return e}function ga(i,e,t,r){var n,s=new i(1),c=Math.ceil(r/he+4);for(pe=!1;;){if(t%2&&(s=s.times(e),_a(s.d,c)&&(n=!0)),t=nt(t/2),t===0){t=s.d.length-1,n&&s.d[t]===0&&++s.d[t];break}e=e.times(e),_a(e.d,c)}return pe=!0,s}function ya(i){return i.d[i.d.length-1]&1}function wa(i,e,t){for(var r,n=new i(e[0]),s=0;++s<e.length;)if(r=new i(e[s]),r.s)n[t](r)&&(n=r);else{n=r;break}return n}function Oi(i,e){var t,r,n,s,c,l,h,f=0,o=0,a=0,u=i.constructor,p=u.rounding,m=u.precision;if(!i.d||!i.d[0]||i.e>17)return new u(i.d?i.d[0]?i.s<0?0:1/0:1:i.s?i.s<0?0:i:0/0);for(e==null?(pe=!1,h=m):h=e,l=new u(.03125);i.e>-2;)i=i.times(l),a+=5;for(r=Math.log(Qe(2,a))/Math.LN10*2+5|0,h+=r,t=s=c=new u(1),u.precision=h;;){if(s=ce(s.times(i),h,1),t=t.times(++o),l=c.plus(Ce(s,t,h,1)),rt(l.d).slice(0,h)===rt(c.d).slice(0,h)){for(n=a;n--;)c=ce(c.times(c),h,1);if(e==null)if(f<3&&jr(c.d,h-r,p,f))u.precision=h+=10,t=s=l=new u(1),o=0,f++;else return ce(c,u.precision=m,p,pe=!0);else return u.precision=m,c}c=l}}function Zt(i,e){var t,r,n,s,c,l,h,f,o,a,u,p=1,m=10,d=i,w=d.d,v=d.constructor,x=v.rounding,g=v.precision;if(d.s<0||!w||!w[0]||!d.e&&w[0]==1&&w.length==1)return new v(w&&!w[0]?-1/0:d.s!=1?NaN:w?0:d);if(e==null?(pe=!1,o=g):o=e,v.precision=o+=m,t=rt(w),r=t.charAt(0),Math.abs(s=d.e)<15e14){for(;r<7&&r!=1||r==1&&t.charAt(1)>3;)d=d.times(i),t=rt(d.d),r=t.charAt(0),p++;s=d.e,r>1?(d=new v("0."+t),s++):d=new v(r+"."+t.slice(1))}else return f=Tn(v,o+2,g).times(s+""),d=Zt(new v(r+"."+t.slice(1)),o-m).plus(f),v.precision=g,e==null?ce(d,g,x,pe=!0):d;for(a=d,h=c=d=Ce(d.minus(1),d.plus(1),o,1),u=ce(d.times(d),o,1),n=3;;){if(c=ce(c.times(u),o,1),f=h.plus(Ce(c,new v(n),o,1)),rt(f.d).slice(0,o)===rt(h.d).slice(0,o))if(h=h.times(2),s!==0&&(h=h.plus(Tn(v,o+2,g).times(s+""))),h=Ce(h,new v(p),o,1),e==null)if(jr(h.d,o-m,x,l))v.precision=o+=m,f=c=d=Ce(a.minus(1),a.plus(1),o,1),u=ce(d.times(d),o,1),n=l=1;else return ce(h,v.precision=g,x,pe=!0);else return v.precision=g,h;h=f,n+=2}}function xa(i){return String(i.s*i.s/0)}function ba(i,e){var t,r,n;for((t=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(t<0&&(t=r),t+=+e.slice(r+1),e=e.substring(0,r)):t<0&&(t=e.length),r=0;e.charCodeAt(r)===48;r++);for(n=e.length;e.charCodeAt(n-1)===48;--n);if(e=e.slice(r,n),e){if(n-=r,i.e=t=t-r-1,i.d=[],r=(t+1)%he,t<0&&(r+=he),r<n){for(r&&i.d.push(+e.slice(0,r)),n-=he;r<n;)i.d.push(+e.slice(r,r+=he));e=e.slice(r),r=he-e.length}else r-=n;for(;r--;)e+="0";i.d.push(+e),pe&&(i.e>i.constructor.maxE?(i.d=null,i.e=NaN):i.e<i.constructor.minE&&(i.e=0,i.d=[0]))}else i.e=0,i.d=[0];return i}function Bc(i,e){var t,r,n,s,c,l,h,f,o;if(e==="Infinity"||e==="NaN")return+e||(i.s=NaN),i.e=NaN,i.d=null,i;if(Ac.test(e))t=16,e=e.toLowerCase();else if(zc.test(e))t=2;else if(Cc.test(e))t=8;else throw Error(cr+e);for(s=e.search(/p/i),s>0?(h=+e.slice(s+1),e=e.substring(2,s)):e=e.slice(2),s=e.indexOf("."),c=s>=0,r=i.constructor,c&&(e=e.replace(".",""),l=e.length,s=l-s,n=ga(r,new r(t),s,s*2)),f=An(e,t,St),o=f.length-1,s=o;f[s]===0;--s)f.pop();return s<0?new r(i.s*0):(i.e=Cn(f,o),i.d=f,pe=!1,c&&(i=Ce(i,n,l*4)),h&&(i=i.times(Math.abs(h)<54?Qe(2,h):hr.pow(2,h))),pe=!0,i)}function Rc(i,e){var t,r=e.d.length;if(r<3)return Sr(i,2,e,e);t=1.4*Math.sqrt(r),t=t>16?16:t|0,e=e.times(1/Fn(5,t)),e=Sr(i,2,e,e);for(var n,s=new i(5),c=new i(16),l=new i(20);t--;)n=e.times(e),e=e.times(s.plus(n.times(c.times(n).minus(l))));return e}function Sr(i,e,t,r,n){var s,c,l,h,f=i.precision,o=Math.ceil(f/he);for(pe=!1,h=t.times(t),l=new i(r);;){if(c=Ce(l.times(h),new i(e++*e++),f,1),l=n?r.plus(c):r.minus(c),r=Ce(c.times(h),new i(e++*e++),f,1),c=l.plus(r),c.d[o]!==void 0){for(s=o;c.d[s]===l.d[s]&&s--;);if(s==-1)break}s=l,l=r,r=c,c=s}return pe=!0,c.d.length=o+1,c}function Fn(i,e){for(var t=i;--e;)t*=i;return t}function Ma(i,e){var t,r=e.s<0,n=Et(i,i.precision,1),s=n.times(.5);if(e=e.abs(),e.lte(s))return Ut=r?4:1,e;if(t=e.divToInt(n),t.isZero())Ut=r?3:2;else{if(e=e.minus(t.times(n)),e.lte(s))return Ut=ya(t)?r?2:3:r?4:1,e;Ut=ya(t)?r?1:4:r?3:2}return e.minus(n).abs()}function zi(i,e,t,r){var n,s,c,l,h,f,o,a,u,p=i.constructor,m=t!==void 0;if(m?(ft(t,1,Wt),r===void 0?r=p.rounding:ft(r,0,8)):(t=p.precision,r=p.rounding),!i.isFinite())o=xa(i);else{for(o=Ct(i),c=o.indexOf("."),m?(n=2,e==16?t=t*4-3:e==8&&(t=t*3-2)):n=e,c>=0&&(o=o.replace(".",""),u=new p(1),u.e=o.length-c,u.d=An(Ct(u),10,n),u.e=u.d.length),a=An(o,10,n),s=h=a.length;a[--h]==0;)a.pop();if(!a[0])o=m?"0p+0":"0";else{if(c<0?s--:(i=new p(i),i.d=a,i.e=s,i=Ce(i,u,t,r,0,n),a=i.d,s=i.e,f=pa),c=a[t],l=n/2,f=f||a[t+1]!==void 0,f=r<4?(c!==void 0||f)&&(r===0||r===(i.s<0?3:2)):c>l||c===l&&(r===4||f||r===6&&a[t-1]&1||r===(i.s<0?8:7)),a.length=t,f)for(;++a[--t]>n-1;)a[t]=0,t||(++s,a.unshift(1));for(h=a.length;!a[h-1];--h);for(c=0,o="";c<h;c++)o+=Ni.charAt(a[c]);if(m){if(h>1)if(e==16||e==8){for(c=e==16?4:3,--h;h%c;h++)o+="0";for(a=An(o,n,e),h=a.length;!a[h-1];--h);for(c=1,o="1.";c<h;c++)o+=Ni.charAt(a[c])}else o=o.charAt(0)+"."+o.slice(1);o=o+(s<0?"p":"p+")+s}else if(s<0){for(;++s;)o="0"+o;o="0."+o}else if(++s>h)for(s-=h;s--;)o+="0";else s<h&&(o=o.slice(0,s)+"."+o.slice(s))}o=(e==16?"0x":e==2?"0b":e==8?"0o":"")+o}return i.s<0?"-"+o:o}function _a(i,e){if(i.length>e)return i.length=e,!0}function Pc(i){return new this(i).abs()}function kc(i){return new this(i).acos()}function Lc(i){return new this(i).acosh()}function Uc(i,e){return new this(i).plus(e)}function $c(i){return new this(i).asin()}function qc(i){return new this(i).asinh()}function Vc(i){return new this(i).atan()}function jc(i){return new this(i).atanh()}function Hc(i,e){i=new this(i),e=new this(e);var t,r=this.precision,n=this.rounding,s=r+4;return!i.s||!e.s?t=new this(NaN):!i.d&&!e.d?(t=Et(this,s,1).times(e.s>0?.25:.75),t.s=i.s):!e.d||i.isZero()?(t=e.s<0?Et(this,r,n):new this(0),t.s=i.s):!i.d||e.isZero()?(t=Et(this,s,1).times(.5),t.s=i.s):e.s<0?(this.precision=s,this.rounding=1,t=this.atan(Ce(i,e,s,1)),e=Et(this,s,1),this.precision=r,this.rounding=n,t=i.s<0?t.minus(e):t.plus(e)):t=this.atan(Ce(i,e,s,1)),t}function Gc(i){return new this(i).cbrt()}function Wc(i){return ce(i=new this(i),i.e+1,2)}function Yc(i){if(!i||typeof i!="object")throw Error(zn+"Object expected");var e,t,r,n=i.defaults===!0,s=["precision",1,Wt,"rounding",0,8,"toExpNeg",-Nr,0,"toExpPos",0,Nr,"maxE",0,Nr,"minE",-Nr,0,"modulo",0,9];for(e=0;e<s.length;e+=3)if(t=s[e],n&&(this[t]=Si[t]),(r=i[t])!==void 0)if(nt(r)===r&&r>=s[e+1]&&r<=s[e+2])this[t]=r;else throw Error(cr+t+": "+r);if(t="crypto",n&&(this[t]=Si[t]),(r=i[t])!==void 0)if(r===!0||r===!1||r===0||r===1)if(r)if(typeof crypto!="undefined"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[t]=!0;else throw Error(ma);else this[t]=!1;else throw Error(cr+t+": "+r);return this}function Zc(i){return new this(i).cos()}function Jc(i){return new this(i).cosh()}function Na(i){var e,t,r;function n(s){var c,l,h,f=this;if(!(f instanceof n))return new n(s);if(f.constructor=n,s instanceof n){f.s=s.s,pe?!s.d||s.e>n.maxE?(f.e=NaN,f.d=null):s.e<n.minE?(f.e=0,f.d=[0]):(f.e=s.e,f.d=s.d.slice()):(f.e=s.e,f.d=s.d?s.d.slice():s.d);return}if(h=typeof s,h==="number"){if(s===0){f.s=1/s<0?-1:1,f.e=0,f.d=[0];return}if(s<0?(s=-s,f.s=-1):f.s=1,s===~~s&&s<1e7){for(c=0,l=s;l>=10;l/=10)c++;pe?c>n.maxE?(f.e=NaN,f.d=null):c<n.minE?(f.e=0,f.d=[0]):(f.e=c,f.d=[s]):(f.e=c,f.d=[s]);return}else if(s*0!==0){s||(f.s=NaN),f.e=NaN,f.d=null;return}return ba(f,s.toString())}else if(h!=="string")throw Error(cr+s);return(l=s.charCodeAt(0))===45?(s=s.slice(1),f.s=-1):(l===43&&(s=s.slice(1)),f.s=1),Tc.test(s)?ba(f,s):Bc(f,s)}if(n.prototype=Z,n.ROUND_UP=0,n.ROUND_DOWN=1,n.ROUND_CEIL=2,n.ROUND_FLOOR=3,n.ROUND_HALF_UP=4,n.ROUND_HALF_DOWN=5,n.ROUND_HALF_EVEN=6,n.ROUND_HALF_CEIL=7,n.ROUND_HALF_FLOOR=8,n.EUCLID=9,n.config=n.set=Yc,n.clone=Na,n.isDecimal=th,n.abs=Pc,n.acos=kc,n.acosh=Lc,n.add=Uc,n.asin=$c,n.asinh=qc,n.atan=Vc,n.atanh=jc,n.atan2=Hc,n.cbrt=Gc,n.ceil=Wc,n.cos=Zc,n.cosh=Jc,n.div=Qc,n.exp=Xc,n.floor=Kc,n.hypot=eh,n.ln=rh,n.log=nh,n.log10=sh,n.log2=ih,n.max=ah,n.min=oh,n.mod=uh,n.mul=ch,n.pow=hh,n.random=lh,n.round=fh,n.sign=ph,n.sin=dh,n.sinh=mh,n.sqrt=vh,n.sub=gh,n.tan=yh,n.tanh=wh,n.trunc=xh,i===void 0&&(i={}),i&&i.defaults!==!0)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],e=0;e<r.length;)i.hasOwnProperty(t=r[e++])||(i[t]=this[t]);return n.config(i),n}function Qc(i,e){return new this(i).div(e)}function Xc(i){return new this(i).exp()}function Kc(i){return ce(i=new this(i),i.e+1,3)}function eh(){var i,e,t=new this(0);for(pe=!1,i=0;i<arguments.length;)if(e=new this(arguments[i++]),e.d)t.d&&(t=t.plus(e.times(e)));else{if(e.s)return pe=!0,new this(1/0);t=e}return pe=!0,t.sqrt()}function th(i){return i instanceof hr||i&&i.name==="[object Decimal]"||!1}function rh(i){return new this(i).ln()}function nh(i,e){return new this(i).log(e)}function ih(i){return new this(i).log(2)}function sh(i){return new this(i).log(10)}function ah(){return wa(this,arguments,"lt")}function oh(){return wa(this,arguments,"gt")}function uh(i,e){return new this(i).mod(e)}function ch(i,e){return new this(i).mul(e)}function hh(i,e){return new this(i).pow(e)}function lh(i){var e,t,r,n,s=0,c=new this(1),l=[];if(i===void 0?i=this.precision:ft(i,1,Wt),r=Math.ceil(i/he),this.crypto)if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(r));s<r;)n=e[s],n>=429e7?e[s]=crypto.getRandomValues(new Uint32Array(1))[0]:l[s++]=n%1e7;else if(crypto.randomBytes){for(e=crypto.randomBytes(r*=4);s<r;)n=e[s]+(e[s+1]<<8)+(e[s+2]<<16)+((e[s+3]&127)<<24),n>=214e7?crypto.randomBytes(4).copy(e,s):(l.push(n%1e7),s+=4);s=r/4}else throw Error(ma);else for(;s<r;)l[s++]=Math.random()*1e7|0;for(r=l[--s],i%=he,r&&i&&(n=Qe(10,he-i),l[s]=(r/n|0)*n);l[s]===0;s--)l.pop();if(s<0)t=0,l=[0];else{for(t=-1;l[0]===0;t-=he)l.shift();for(r=1,n=l[0];n>=10;n/=10)r++;r<he&&(t-=he-r)}return c.e=t,c.d=l,c}function fh(i){return ce(i=new this(i),i.e+1,this.rounding)}function ph(i){return i=new this(i),i.d?i.d[0]?i.s:0*i.s:i.s||NaN}function dh(i){return new this(i).sin()}function mh(i){return new this(i).sinh()}function vh(i){return new this(i).sqrt()}function gh(i,e){return new this(i).sub(e)}function yh(i){return new this(i).tan()}function wh(i){return new this(i).tanh()}function xh(i){return ce(i=new this(i),i.e+1,1)}Z[Symbol.for("nodejs.util.inspect.custom")]=Z.toString,Z[Symbol.toStringTag]="Decimal";var hr=Na(Si);En=new hr(En),On=new hr(On);var bh="BigNumber",Mh=["?on","config"],_h=K(bh,Mh,i=>{var{on:e,config:t}=i,r=9,n=hr.clone({precision:t.precision,modulo:r});return n.prototype.type="BigNumber",n.prototype.isBigNumber=!0,n.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},n.fromJSON=function(s){return new n(s.value)},e&&e("config",function(s,c){s.precision!==c.precision&&n.config({precision:s.precision})}),n},{isClass:!0}),Sa={exports:{}};/**
 * @license Complex.js v2.0.13 12/05/2020
 *
 * Copyright (c) 2020, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/(function(i,e){(function(t){var r=function(a){return(Math.exp(a)+Math.exp(-a))*.5},n=function(a){return(Math.exp(a)-Math.exp(-a))*.5},s=function(a){var u=Math.PI/4;if(a<-u||a>u)return Math.cos(a)-1;var p=a*a;return p*(-.5+p*(.041666666666666664+p*(-.001388888888888889+p*(248015873015873e-19+p*(-2755731922398589e-22+p*(20876763089615634e-26+p*(-11470745597729725e-27+p*4779477332387385e-29)))))))},c=function(a,u){var p=Math.abs(a),m=Math.abs(u);return p<3e3&&m<3e3?Math.sqrt(p*p+m*m):(p<m?(p=m,m=a/u):m=u/a,p*Math.sqrt(1+m*m))},l=function(){throw SyntaxError("Invalid Param")};function h(a,u){var p=Math.abs(a),m=Math.abs(u);return a===0?Math.log(m):u===0?Math.log(p):p<3e3&&m<3e3?Math.log(a*a+u*u)*.5:Math.log(a/Math.cos(Math.atan2(u,a)))}var f=function(a,u){var p={re:0,im:0};if(a==null)p.re=p.im=0;else if(u!==void 0)p.re=a,p.im=u;else switch(typeof a){case"object":if("im"in a&&"re"in a)p.re=a.re,p.im=a.im;else if("abs"in a&&"arg"in a){if(!Number.isFinite(a.abs)&&Number.isFinite(a.arg))return o.INFINITY;p.re=a.abs*Math.cos(a.arg),p.im=a.abs*Math.sin(a.arg)}else if("r"in a&&"phi"in a){if(!Number.isFinite(a.r)&&Number.isFinite(a.phi))return o.INFINITY;p.re=a.r*Math.cos(a.phi),p.im=a.r*Math.sin(a.phi)}else a.length===2?(p.re=a[0],p.im=a[1]):l();break;case"string":p.im=p.re=0;var m=a.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),d=1,w=0;m===null&&l();for(var v=0;v<m.length;v++){var x=m[v];x===" "||x==="	"||x===`
`||(x==="+"?d++:x==="-"?w++:x==="i"||x==="I"?(d+w===0&&l(),m[v+1]!==" "&&!isNaN(m[v+1])?(p.im+=parseFloat((w%2?"-":"")+m[v+1]),v++):p.im+=parseFloat((w%2?"-":"")+"1"),d=w=0):((d+w===0||isNaN(x))&&l(),m[v+1]==="i"||m[v+1]==="I"?(p.im+=parseFloat((w%2?"-":"")+x),v++):p.re+=parseFloat((w%2?"-":"")+x),d=w=0))}d+w>0&&l();break;case"number":p.im=0,p.re=a;break;default:l()}return isNaN(p.re)||isNaN(p.im),p};function o(a,u){if(!(this instanceof o))return new o(a,u);var p=f(a,u);this.re=p.re,this.im=p.im}o.prototype={re:0,im:0,sign:function(){var a=this.abs();return new o(this.re/a,this.im/a)},add:function(a,u){var p=new o(a,u);return this.isInfinite()&&p.isInfinite()?o.NAN:this.isInfinite()||p.isInfinite()?o.INFINITY:new o(this.re+p.re,this.im+p.im)},sub:function(a,u){var p=new o(a,u);return this.isInfinite()&&p.isInfinite()?o.NAN:this.isInfinite()||p.isInfinite()?o.INFINITY:new o(this.re-p.re,this.im-p.im)},mul:function(a,u){var p=new o(a,u);return this.isInfinite()&&p.isZero()||this.isZero()&&p.isInfinite()?o.NAN:this.isInfinite()||p.isInfinite()?o.INFINITY:p.im===0&&this.im===0?new o(this.re*p.re,0):new o(this.re*p.re-this.im*p.im,this.re*p.im+this.im*p.re)},div:function(a,u){var p=new o(a,u);if(this.isZero()&&p.isZero()||this.isInfinite()&&p.isInfinite())return o.NAN;if(this.isInfinite()||p.isZero())return o.INFINITY;if(this.isZero()||p.isInfinite())return o.ZERO;a=this.re,u=this.im;var m=p.re,d=p.im,w,v;return d===0?new o(a/m,u/m):Math.abs(m)<Math.abs(d)?(v=m/d,w=m*v+d,new o((a*v+u)/w,(u*v-a)/w)):(v=d/m,w=d*v+m,new o((a+u*v)/w,(u-a*v)/w))},pow:function(a,u){var p=new o(a,u);if(a=this.re,u=this.im,p.isZero())return o.ONE;if(p.im===0){if(u===0&&a>0)return new o(Math.pow(a,p.re),0);if(a===0)switch((p.re%4+4)%4){case 0:return new o(Math.pow(u,p.re),0);case 1:return new o(0,Math.pow(u,p.re));case 2:return new o(-Math.pow(u,p.re),0);case 3:return new o(0,-Math.pow(u,p.re))}}if(a===0&&u===0&&p.re>0&&p.im>=0)return o.ZERO;var m=Math.atan2(u,a),d=h(a,u);return a=Math.exp(p.re*d-p.im*m),u=p.im*d+p.re*m,new o(a*Math.cos(u),a*Math.sin(u))},sqrt:function(){var a=this.re,u=this.im,p=this.abs(),m,d;if(a>=0){if(u===0)return new o(Math.sqrt(a),0);m=.5*Math.sqrt(2*(p+a))}else m=Math.abs(u)/Math.sqrt(2*(p-a));return a<=0?d=.5*Math.sqrt(2*(p-a)):d=Math.abs(u)/Math.sqrt(2*(p+a)),new o(m,u<0?-d:d)},exp:function(){var a=Math.exp(this.re);return this.im===0,new o(a*Math.cos(this.im),a*Math.sin(this.im))},expm1:function(){var a=this.re,u=this.im;return new o(Math.expm1(a)*Math.cos(u)+s(u),Math.exp(a)*Math.sin(u))},log:function(){var a=this.re,u=this.im;return new o(h(a,u),Math.atan2(u,a))},abs:function(){return c(this.re,this.im)},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var a=this.re,u=this.im;return new o(Math.sin(a)*r(u),Math.cos(a)*n(u))},cos:function(){var a=this.re,u=this.im;return new o(Math.cos(a)*r(u),-Math.sin(a)*n(u))},tan:function(){var a=2*this.re,u=2*this.im,p=Math.cos(a)+r(u);return new o(Math.sin(a)/p,n(u)/p)},cot:function(){var a=2*this.re,u=2*this.im,p=Math.cos(a)-r(u);return new o(-Math.sin(a)/p,n(u)/p)},sec:function(){var a=this.re,u=this.im,p=.5*r(2*u)+.5*Math.cos(2*a);return new o(Math.cos(a)*r(u)/p,Math.sin(a)*n(u)/p)},csc:function(){var a=this.re,u=this.im,p=.5*r(2*u)-.5*Math.cos(2*a);return new o(Math.sin(a)*r(u)/p,-Math.cos(a)*n(u)/p)},asin:function(){var a=this.re,u=this.im,p=new o(u*u-a*a+1,-2*a*u).sqrt(),m=new o(p.re-u,p.im+a).log();return new o(m.im,-m.re)},acos:function(){var a=this.re,u=this.im,p=new o(u*u-a*a+1,-2*a*u).sqrt(),m=new o(p.re-u,p.im+a).log();return new o(Math.PI/2-m.im,m.re)},atan:function(){var a=this.re,u=this.im;if(a===0){if(u===1)return new o(0,1/0);if(u===-1)return new o(0,-1/0)}var p=a*a+(1-u)*(1-u),m=new o((1-u*u-a*a)/p,-2*a/p).log();return new o(-.5*m.im,.5*m.re)},acot:function(){var a=this.re,u=this.im;if(u===0)return new o(Math.atan2(1,a),0);var p=a*a+u*u;return p!==0?new o(a/p,-u/p).atan():new o(a!==0?a/0:0,u!==0?-u/0:0).atan()},asec:function(){var a=this.re,u=this.im;if(a===0&&u===0)return new o(0,1/0);var p=a*a+u*u;return p!==0?new o(a/p,-u/p).acos():new o(a!==0?a/0:0,u!==0?-u/0:0).acos()},acsc:function(){var a=this.re,u=this.im;if(a===0&&u===0)return new o(Math.PI/2,1/0);var p=a*a+u*u;return p!==0?new o(a/p,-u/p).asin():new o(a!==0?a/0:0,u!==0?-u/0:0).asin()},sinh:function(){var a=this.re,u=this.im;return new o(n(a)*Math.cos(u),r(a)*Math.sin(u))},cosh:function(){var a=this.re,u=this.im;return new o(r(a)*Math.cos(u),n(a)*Math.sin(u))},tanh:function(){var a=2*this.re,u=2*this.im,p=r(a)+Math.cos(u);return new o(n(a)/p,Math.sin(u)/p)},coth:function(){var a=2*this.re,u=2*this.im,p=r(a)-Math.cos(u);return new o(n(a)/p,-Math.sin(u)/p)},csch:function(){var a=this.re,u=this.im,p=Math.cos(2*u)-r(2*a);return new o(-2*n(a)*Math.cos(u)/p,2*r(a)*Math.sin(u)/p)},sech:function(){var a=this.re,u=this.im,p=Math.cos(2*u)+r(2*a);return new o(2*r(a)*Math.cos(u)/p,-2*n(a)*Math.sin(u)/p)},asinh:function(){var a=this.im;this.im=-this.re,this.re=a;var u=this.asin();return this.re=-this.im,this.im=a,a=u.re,u.re=-u.im,u.im=a,u},acosh:function(){var a=this.acos();if(a.im<=0){var u=a.re;a.re=-a.im,a.im=u}else{var u=a.im;a.im=-a.re,a.re=u}return a},atanh:function(){var a=this.re,u=this.im,p=a>1&&u===0,m=1-a,d=1+a,w=m*m+u*u,v=w!==0?new o((d*m-u*u)/w,(u*m+d*u)/w):new o(a!==-1?a/0:0,u!==0?u/0:0),x=v.re;return v.re=h(v.re,v.im)/2,v.im=Math.atan2(v.im,x)/2,p&&(v.im=-v.im),v},acoth:function(){var a=this.re,u=this.im;if(a===0&&u===0)return new o(0,Math.PI/2);var p=a*a+u*u;return p!==0?new o(a/p,-u/p).atanh():new o(a!==0?a/0:0,u!==0?-u/0:0).atanh()},acsch:function(){var a=this.re,u=this.im;if(u===0)return new o(a!==0?Math.log(a+Math.sqrt(a*a+1)):1/0,0);var p=a*a+u*u;return p!==0?new o(a/p,-u/p).asinh():new o(a!==0?a/0:0,u!==0?-u/0:0).asinh()},asech:function(){var a=this.re,u=this.im;if(this.isZero())return o.INFINITY;var p=a*a+u*u;return p!==0?new o(a/p,-u/p).acosh():new o(a!==0?a/0:0,u!==0?-u/0:0).acosh()},inverse:function(){if(this.isZero())return o.INFINITY;if(this.isInfinite())return o.ZERO;var a=this.re,u=this.im,p=a*a+u*u;return new o(a/p,-u/p)},conjugate:function(){return new o(this.re,-this.im)},neg:function(){return new o(-this.re,-this.im)},ceil:function(a){return a=Math.pow(10,a||0),new o(Math.ceil(this.re*a)/a,Math.ceil(this.im*a)/a)},floor:function(a){return a=Math.pow(10,a||0),new o(Math.floor(this.re*a)/a,Math.floor(this.im*a)/a)},round:function(a){return a=Math.pow(10,a||0),new o(Math.round(this.re*a)/a,Math.round(this.im*a)/a)},equals:function(a,u){var p=new o(a,u);return Math.abs(p.re-this.re)<=o.EPSILON&&Math.abs(p.im-this.im)<=o.EPSILON},clone:function(){return new o(this.re,this.im)},toString:function(){var a=this.re,u=this.im,p="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(a)<o.EPSILON&&(a=0),Math.abs(u)<o.EPSILON&&(u=0),u===0?p+a:(a!==0?(p+=a,p+=" ",u<0?(u=-u,p+="-"):p+="+",p+=" "):u<0&&(u=-u,p+="-"),u!==1&&(p+=u),p+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return this.im===0?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return this.im===0&&this.re===0},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!(this.isNaN()||this.isFinite())}},o.ZERO=new o(0,0),o.ONE=new o(1,0),o.I=new o(0,1),o.PI=new o(Math.PI,0),o.E=new o(Math.E,0),o.INFINITY=new o(1/0,1/0),o.NAN=new o(NaN,NaN),o.EPSILON=1e-15,Object.defineProperty(o,"__esModule",{value:!0}),o.default=o,o.Complex=o,i.exports=o})()})(Sa);var pt=Js(Sa.exports),Nh="Complex",Sh=[],Eh=K(Nh,Sh,()=>(pt.prototype.type="Complex",pt.prototype.isComplex=!0,pt.prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},pt.prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},pt.prototype.format=function(i){var e="",t=this.im,r=this.re,n=Mr(this.re,i),s=Mr(this.im,i),c=Ue(i)?i:i?i.precision:null;if(c!==null){var l=Math.pow(10,-c);Math.abs(r/t)<l&&(r=0),Math.abs(t/r)<l&&(t=0)}return t===0?e=n:r===0?t===1?e="i":t===-1?e="-i":e=s+"i":t<0?t===-1?e=n+" - i":e=n+" - "+s.substring(1)+"i":t===1?e=n+" + i":e=n+" + "+s+"i",e},pt.fromPolar=function(i){switch(arguments.length){case 1:{var e=arguments[0];if(typeof e=="object")return pt(e);throw new TypeError("Input has to be an object with r and phi keys.")}case 2:{var t=arguments[0],r=arguments[1];if(Ue(t)){if(ar(r)&&r.hasBase("ANGLE")&&(r=r.toNumber("rad")),Ue(r))return new pt({r:t,phi:r});throw new TypeError("Phi is not a number nor an angle unit.")}else throw new TypeError("Radius r is not a number.")}default:throw new SyntaxError("Wrong number of arguments in function fromPolar")}},pt.prototype.valueOf=pt.prototype.toString,pt.fromJSON=function(i){return new pt(i)},pt.compare=function(i,e){return i.re>e.re?1:i.re<e.re?-1:i.im>e.im?1:i.im<e.im?-1:0},pt),{isClass:!0}),Ea={exports:{}};/**
 * @license Fraction.js v4.1.1 23/05/2021
 * https://www.xarg.org/2014/03/rational-numbers-in-javascript/
 *
 * Copyright (c) 2021, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/(function(i,e){(function(t){var r=2e3,n={s:1,n:0,d:1};function s(v){function x(){var b=Error.apply(this,arguments);b.name=this.name=v,this.stack=b.stack,this.message=b.message}function g(){}return g.prototype=Error.prototype,x.prototype=new g,x}var c=w.DivisionByZero=s("DivisionByZero"),l=w.InvalidParameter=s("InvalidParameter");function h(v,x){return isNaN(v=parseInt(v,10))&&f(),v*x}function f(){throw new l}function o(v){for(var x={},g=v,b=2,M=4;M<=g;){for(;g%b===0;)g/=b,x[b]=(x[b]||0)+1;M+=1+2*b++}return g!==v?g>1&&(x[g]=(x[g]||0)+1):x[v]=(x[v]||0)+1,x}var a=function(v,x){var g=0,b=1,M=1,_=0,N=0,O=0,E=1,F=1,B=0,I=1,j=1,q=1,H=1e7,k;if(v!=null)if(x!==void 0)g=v,b=x,M=g*b;else switch(typeof v){case"object":{"d"in v&&"n"in v?(g=v.n,b=v.d,"s"in v&&(g*=v.s)):0 in v?(g=v[0],1 in v&&(b=v[1])):f(),M=g*b;break}case"number":{if(v<0&&(M=v,v=-v),v%1===0)g=v;else if(v>0){for(v>=1&&(F=Math.pow(10,Math.floor(1+Math.log(v)/Math.LN10)),v/=F);I<=H&&q<=H;)if(k=(B+j)/(I+q),v===k){I+q<=H?(g=B+j,b=I+q):q>I?(g=j,b=q):(g=B,b=I);break}else v>k?(B+=j,I+=q):(j+=B,q+=I),I>H?(g=j,b=q):(g=B,b=I);g*=F}else(isNaN(v)||isNaN(x))&&(b=g=NaN);break}case"string":if(I=v.match(/\d+|./g),I===null&&f(),I[B]==="-"?(M=-1,B++):I[B]==="+"&&B++,I.length===B+1?N=h(I[B++],M):I[B+1]==="."||I[B]==="."?(I[B]!=="."&&(_=h(I[B++],M)),B++,(B+1===I.length||I[B+1]==="("&&I[B+3]===")"||I[B+1]==="'"&&I[B+3]==="'")&&(N=h(I[B],M),E=Math.pow(10,I[B].length),B++),(I[B]==="("&&I[B+2]===")"||I[B]==="'"&&I[B+2]==="'")&&(O=h(I[B+1],M),F=Math.pow(10,I[B+1].length)-1,B+=3)):I[B+1]==="/"||I[B+1]===":"?(N=h(I[B],M),E=h(I[B+2],1),B+=3):I[B+3]==="/"&&I[B+1]===" "&&(_=h(I[B],M),N=h(I[B+2],M),E=h(I[B+4],1),B+=5),I.length<=B){b=E*F,M=g=O+b*_+F*N;break}default:f()}if(b===0)throw new c;n.s=M<0?-1:1,n.n=Math.abs(g),n.d=Math.abs(b)};function u(v,x,g){for(var b=1;x>0;v=v*v%g,x>>=1)x&1&&(b=b*v%g);return b}function p(v,x){for(;x%2===0;x/=2);for(;x%5===0;x/=5);if(x===1)return 0;for(var g=10%x,b=1;g!==1;b++)if(g=g*10%x,b>r)return 0;return b}function m(v,x,g){for(var b=1,M=u(10,g,x),_=0;_<300;_++){if(b===M)return _;b=b*10%x,M=M*10%x}return 0}function d(v,x){if(!v)return x;if(!x)return v;for(;;){if(v%=x,!v)return x;if(x%=v,!x)return v}}function w(v,x){if(!(this instanceof w))return new w(v,x);a(v,x),w.REDUCE?v=d(n.d,n.n):v=1,this.s=n.s,this.n=n.n/v,this.d=n.d/v}w.REDUCE=1,w.prototype={s:1,n:0,d:1,abs:function(){return new w(this.n,this.d)},neg:function(){return new w(-this.s*this.n,this.d)},add:function(v,x){return a(v,x),new w(this.s*this.n*n.d+n.s*this.d*n.n,this.d*n.d)},sub:function(v,x){return a(v,x),new w(this.s*this.n*n.d-n.s*this.d*n.n,this.d*n.d)},mul:function(v,x){return a(v,x),new w(this.s*n.s*this.n*n.n,this.d*n.d)},div:function(v,x){return a(v,x),new w(this.s*n.s*this.n*n.d,this.d*n.n)},clone:function(){return new w(this)},mod:function(v,x){return isNaN(this.n)||isNaN(this.d)?new w(NaN):v===void 0?new w(this.s*this.n%this.d,1):(a(v,x),n.n===0&&this.d===0&&w(0,0),new w(this.s*(n.d*this.n)%(n.n*this.d),n.d*this.d))},gcd:function(v,x){return a(v,x),new w(d(n.n,this.n)*d(n.d,this.d),n.d*this.d)},lcm:function(v,x){return a(v,x),n.n===0&&this.n===0?new w:new w(n.n*this.n,d(n.n,this.n)*d(n.d,this.d))},ceil:function(v){return v=Math.pow(10,v||0),isNaN(this.n)||isNaN(this.d)?new w(NaN):new w(Math.ceil(v*this.s*this.n/this.d),v)},floor:function(v){return v=Math.pow(10,v||0),isNaN(this.n)||isNaN(this.d)?new w(NaN):new w(Math.floor(v*this.s*this.n/this.d),v)},round:function(v){return v=Math.pow(10,v||0),isNaN(this.n)||isNaN(this.d)?new w(NaN):new w(Math.round(v*this.s*this.n/this.d),v)},inverse:function(){return new w(this.s*this.d,this.n)},pow:function(v,x){if(a(v,x),n.d===1)return n.s<0?new w(Math.pow(this.s*this.d,n.n),Math.pow(this.n,n.n)):new w(Math.pow(this.s*this.n,n.n),Math.pow(this.d,n.n));if(this.s<0)return null;var g=o(this.n),b=o(this.d),M=1,_=1;for(var N in g)if(N!=="1"){if(N==="0"){M=0;break}if(g[N]*=n.n,g[N]%n.d===0)g[N]/=n.d;else return null;M*=Math.pow(N,g[N])}for(var N in b)if(N!=="1"){if(b[N]*=n.n,b[N]%n.d===0)b[N]/=n.d;else return null;_*=Math.pow(N,b[N])}return n.s<0?new w(_,M):new w(M,_)},equals:function(v,x){return a(v,x),this.s*this.n*n.d===n.s*n.n*this.d},compare:function(v,x){a(v,x);var g=this.s*this.n*n.d-n.s*n.n*this.d;return(0<g)-(g<0)},simplify:function(v){if(isNaN(this.n)||isNaN(this.d))return this;var x=this.abs().toContinued();v=v||.001;function g(_){return _.length===1?new w(_[0]):g(_.slice(1)).inverse().add(_[0])}for(var b=0;b<x.length;b++){var M=g(x.slice(0,b+1));if(M.sub(this.abs()).abs().valueOf()<v)return M.mul(this.s)}return this},divisible:function(v,x){return a(v,x),!(!(n.n*this.d)||this.n*n.d%(n.n*this.d))},valueOf:function(){return this.s*this.n/this.d},toFraction:function(v){var x,g="",b=this.n,M=this.d;return this.s<0&&(g+="-"),M===1?g+=b:(v&&(x=Math.floor(b/M))>0&&(g+=x,g+=" ",b%=M),g+=b,g+="/",g+=M),g},toLatex:function(v){var x,g="",b=this.n,M=this.d;return this.s<0&&(g+="-"),M===1?g+=b:(v&&(x=Math.floor(b/M))>0&&(g+=x,b%=M),g+="\\frac{",g+=b,g+="}{",g+=M,g+="}"),g},toContinued:function(){var v,x=this.n,g=this.d,b=[];if(isNaN(x)||isNaN(g))return b;do b.push(Math.floor(x/g)),v=x%g,x=g,g=v;while(x!==1);return b},toString:function(v){var x,g=this.n,b=this.d;if(isNaN(g)||isNaN(b))return"NaN";w.REDUCE||(x=d(g,b),g/=x,b/=x),v=v||15;var M=p(g,b),_=m(g,b,M),N=this.s===-1?"-":"";if(N+=g/b|0,g%=b,g*=10,g&&(N+="."),M){for(var O=_;O--;)N+=g/b|0,g%=b,g*=10;N+="(";for(var O=M;O--;)N+=g/b|0,g%=b,g*=10;N+=")"}else for(var O=v;g&&O--;)N+=g/b|0,g%=b,g*=10;return N}},Object.defineProperty(w,"__esModule",{value:!0}),w.default=w,w.Fraction=w,i.exports=w})()})(Ea);var Er=Js(Ea.exports),Oh="Fraction",zh=[],Ah=K(Oh,zh,()=>(Er.prototype.type="Fraction",Er.prototype.isFraction=!0,Er.prototype.toJSON=function(){return{mathjs:"Fraction",n:this.s*this.n,d:this.d}},Er.fromJSON=function(i){return new Er(i)},Er),{isClass:!0}),Ch="Range",Th=[],Fh=K(Ch,Th,()=>{function i(e,t,r){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");var n=e!=null,s=t!=null,c=r!=null;if(n){if(Ie(e))e=e.toNumber();else if(typeof e!="number")throw new TypeError("Parameter start must be a number")}if(s){if(Ie(t))t=t.toNumber();else if(typeof t!="number")throw new TypeError("Parameter end must be a number")}if(c){if(Ie(r))r=r.toNumber();else if(typeof r!="number")throw new TypeError("Parameter step must be a number")}this.start=n?parseFloat(e):0,this.end=s?parseFloat(t):0,this.step=c?parseFloat(r):1}return i.prototype.type="Range",i.prototype.isRange=!0,i.parse=function(e){if(typeof e!="string")return null;var t=e.split(":"),r=t.map(function(s){return parseFloat(s)}),n=r.some(function(s){return isNaN(s)});if(n)return null;switch(r.length){case 2:return new i(r[0],r[1]);case 3:return new i(r[0],r[2],r[1]);default:return null}},i.prototype.clone=function(){return new i(this.start,this.end,this.step)},i.prototype.size=function(){var e=0,t=this.start,r=this.step,n=this.end,s=n-t;return Ks(r)===Ks(s)?e=Math.ceil(s/r):s===0&&(e=0),isNaN(e)&&(e=0),[e]},i.prototype.min=function(){var e=this.size()[0];if(e>0)return this.step>0?this.start:this.start+(e-1)*this.step},i.prototype.max=function(){var e=this.size()[0];if(e>0)return this.step>0?this.start+(e-1)*this.step:this.start},i.prototype.forEach=function(e){var t=this.start,r=this.step,n=this.end,s=0;if(r>0)for(;t<n;)e(t,[s],this),t+=r,s++;else if(r<0)for(;t>n;)e(t,[s],this),t+=r,s++},i.prototype.map=function(e){var t=[];return this.forEach(function(r,n,s){t[n[0]]=e(r,n,s)}),t},i.prototype.toArray=function(){var e=[];return this.forEach(function(t,r){e[r[0]]=t}),e},i.prototype.valueOf=function(){return this.toArray()},i.prototype.format=function(e){var t=Mr(this.start,e);return this.step!==1&&(t+=":"+Mr(this.step,e)),t+=":"+Mr(this.end,e),t},i.prototype.toString=function(){return this.format()},i.prototype.toJSON=function(){return{mathjs:"Range",start:this.start,end:this.end,step:this.step}},i.fromJSON=function(e){return new i(e.start,e.end,e.step)},i},{isClass:!0}),Dh="Matrix",Ih=[],Bh=K(Dh,Ih,()=>{function i(){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator")}return i.prototype.type="Matrix",i.prototype.isMatrix=!0,i.prototype.storage=function(){throw new Error("Cannot invoke storage on a Matrix interface")},i.prototype.datatype=function(){throw new Error("Cannot invoke datatype on a Matrix interface")},i.prototype.create=function(e,t){throw new Error("Cannot invoke create on a Matrix interface")},i.prototype.subset=function(e,t,r){throw new Error("Cannot invoke subset on a Matrix interface")},i.prototype.get=function(e){throw new Error("Cannot invoke get on a Matrix interface")},i.prototype.set=function(e,t,r){throw new Error("Cannot invoke set on a Matrix interface")},i.prototype.resize=function(e,t){throw new Error("Cannot invoke resize on a Matrix interface")},i.prototype.reshape=function(e,t){throw new Error("Cannot invoke reshape on a Matrix interface")},i.prototype.clone=function(){throw new Error("Cannot invoke clone on a Matrix interface")},i.prototype.size=function(){throw new Error("Cannot invoke size on a Matrix interface")},i.prototype.map=function(e,t){throw new Error("Cannot invoke map on a Matrix interface")},i.prototype.forEach=function(e){throw new Error("Cannot invoke forEach on a Matrix interface")},i.prototype.toArray=function(){throw new Error("Cannot invoke toArray on a Matrix interface")},i.prototype.valueOf=function(){throw new Error("Cannot invoke valueOf on a Matrix interface")},i.prototype.format=function(e){throw new Error("Cannot invoke format on a Matrix interface")},i.prototype.toString=function(){throw new Error("Cannot invoke toString on a Matrix interface")},i},{isClass:!0}),Rh="DenseMatrix",Ph=["Matrix"],kh=K(Rh,Ph,i=>{var{Matrix:e}=i;function t(o,a){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");if(a&&!zt(a))throw new Error("Invalid datatype: "+a);if(We(o))o.type==="DenseMatrix"?(this._data=Ee(o._data),this._size=Ee(o._size),this._datatype=a||o._datatype):(this._data=o.toArray(),this._size=o.size(),this._datatype=a||o._datatype);else if(o&&$e(o.data)&&$e(o.size))this._data=o.data,this._size=o.size,sa(this._data,this._size),this._datatype=a||o.datatype;else if($e(o))this._data=f(o),this._size=yt(this._data),sa(this._data,this._size),this._datatype=a;else{if(o)throw new TypeError("Unsupported type of data ("+ot(o)+")");this._data=[],this._size=[0],this._datatype=a}}t.prototype=new e,t.prototype.createDenseMatrix=function(o,a){return new t(o,a)},t.prototype.type="DenseMatrix",t.prototype.isDenseMatrix=!0,t.prototype.getDataType=function(){return Nn(this._data,ot)},t.prototype.storage=function(){return"dense"},t.prototype.datatype=function(){return this._datatype},t.prototype.create=function(o,a){return new t(o,a)},t.prototype.subset=function(o,a,u){switch(arguments.length){case 1:return r(this,o);case 2:case 3:return s(this,o,a,u);default:throw new SyntaxError("Wrong number of arguments")}},t.prototype.get=function(o){if(!$e(o))throw new TypeError("Array expected");if(o.length!==this._size.length)throw new ye(o.length,this._size.length);for(var a=0;a<o.length;a++)ke(o[a],this._size[a]);for(var u=this._data,p=0,m=o.length;p<m;p++){var d=o[p];ke(d,u.length),u=u[d]}return u},t.prototype.set=function(o,a,u){if(!$e(o))throw new TypeError("Array expected");if(o.length<this._size.length)throw new ye(o.length,this._size.length,"<");var p,m,d,w=o.map(function(x){return x+1});h(this,w,u);var v=this._data;for(p=0,m=o.length-1;p<m;p++)d=o[p],ke(d,v.length),v=v[d];return d=o[o.length-1],ke(d,v.length),v[d]=a,this};function r(o,a){if(!xr(a))throw new TypeError("Invalid index");var u=a.isScalar();if(u)return o.get(a.min());var p=a.size();if(p.length!==o._size.length)throw new ye(p.length,o._size.length);for(var m=a.min(),d=a.max(),w=0,v=o._size.length;w<v;w++)ke(m[w],o._size[w]),ke(d[w],o._size[w]);return new t(n(o._data,a,p.length,0),o._datatype)}function n(o,a,u,p){var m=p===u-1,d=a.dimension(p);return m?d.map(function(w){return ke(w,o.length),o[w]}).valueOf():d.map(function(w){ke(w,o.length);var v=o[w];return n(v,a,u,p+1)}).valueOf()}function s(o,a,u,p){if(!a||a.isIndex!==!0)throw new TypeError("Invalid index");var m=a.size(),d=a.isScalar(),w;if(We(u)?(w=u.size(),u=u.valueOf()):w=yt(u),d){if(w.length!==0)throw new TypeError("Scalar expected");o.set(a.min(),u,p)}else{if(m.length<o._size.length)throw new ye(m.length,o._size.length,"<");if(w.length<m.length){for(var v=0,x=0;m[v]===1&&w[v]===1;)v++;for(;m[v]===1;)x++,v++;u=aa(u,m.length,x,w)}if(!br(m,w))throw new ye(m,w,">");var g=a.max().map(function(_){return _+1});h(o,g,p);var b=m.length,M=0;c(o._data,a,u,b,M)}return o}function c(o,a,u,p,m){var d=m===p-1,w=a.dimension(m);d?w.forEach(function(v,x){ke(v),o[v]=u[x[0]]}):w.forEach(function(v,x){ke(v),c(o[v],a,u[x[0]],p,m+1)})}t.prototype.resize=function(o,a,u){if(!ui(o))throw new TypeError("Array or Matrix expected");var p=o.valueOf().map(d=>Array.isArray(d)&&d.length===1?d[0]:d),m=u?this.clone():this;return l(m,p,a)};function l(o,a,u){if(a.length===0){for(var p=o._data;$e(p);)p=p[0];return p}return o._size=a.slice(0),o._data=_n(o._data,o._size,u),o}t.prototype.reshape=function(o,a){var u=a?this.clone():this;return u._data=gc(u._data,o),u._size=o.slice(0),u};function h(o,a,u){for(var p=o._size.slice(0),m=!1;p.length<a.length;)p.push(0),m=!0;for(var d=0,w=a.length;d<w;d++)a[d]>p[d]&&(p[d]=a[d],m=!0);m&&l(o,p,u)}t.prototype.clone=function(){var o=new t({data:Ee(this._data),size:Ee(this._size),datatype:this._datatype});return o},t.prototype.size=function(){return this._size.slice(0)},t.prototype.map=function(o){var a=this,u=function d(w,v){return $e(w)?w.map(function(x,g){return d(x,v.concat(g))}):o(w,v,a)},p=u(this._data,[]),m=this._datatype!==void 0?Nn(p,ot):void 0;return new t(p,m)},t.prototype.forEach=function(o){var a=this,u=function p(m,d){$e(m)?m.forEach(function(w,v){p(w,d.concat(v))}):o(m,d,a)};u(this._data,[])},t.prototype.toArray=function(){return Ee(this._data)},t.prototype.valueOf=function(){return this._data},t.prototype.format=function(o){return qe(this._data,o)},t.prototype.toString=function(){return qe(this._data)},t.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},t.prototype.diagonal=function(o){if(o){if(Ie(o)&&(o=o.toNumber()),!Ue(o)||!Ye(o))throw new TypeError("The parameter k must be an integer number")}else o=0;for(var a=o>0?o:0,u=o<0?-o:0,p=this._size[0],m=this._size[1],d=Math.min(p-u,m-a),w=[],v=0;v<d;v++)w[v]=this._data[v+u][v+a];return new t({data:w,size:[d],datatype:this._datatype})},t.diagonal=function(o,a,u,p){if(!$e(o))throw new TypeError("Array expected, size parameter");if(o.length!==2)throw new Error("Only two dimensions matrix are supported");if(o=o.map(function(N){if(Ie(N)&&(N=N.toNumber()),!Ue(N)||!Ye(N)||N<1)throw new Error("Size values must be positive integers");return N}),u){if(Ie(u)&&(u=u.toNumber()),!Ue(u)||!Ye(u))throw new TypeError("The parameter k must be an integer number")}else u=0;var m=u>0?u:0,d=u<0?-u:0,w=o[0],v=o[1],x=Math.min(w-d,v-m),g;if($e(a)){if(a.length!==x)throw new Error("Invalid value array length");g=function(O){return a[O]}}else if(We(a)){var b=a.size();if(b.length!==1||b[0]!==x)throw new Error("Invalid matrix length");g=function(O){return a.get([O])}}else g=function(){return a};p||(p=Ie(g(0))?g(0).mul(0):0);var M=[];if(o.length>0){M=_n(M,o,p);for(var _=0;_<x;_++)M[_+d][_+m]=g(_)}return new t({data:M,size:[w,v]})},t.fromJSON=function(o){return new t(o)},t.prototype.swapRows=function(o,a){if(!Ue(o)||!Ye(o)||!Ue(a)||!Ye(a))throw new Error("Row index must be positive integers");if(this._size.length!==2)throw new Error("Only two dimensional matrix is supported");return ke(o,this._size[0]),ke(a,this._size[0]),t._swapRows(o,a,this._data),this},t._swapRows=function(o,a,u){var p=u[o];u[o]=u[a],u[a]=p};function f(o){for(var a=0,u=o.length;a<u;a++){var p=o[a];$e(p)?o[a]=f(p):p&&p.isMatrix===!0&&(o[a]=f(p.valueOf()))}return o}return t},{isClass:!0});function Xe(i,e,t){return i&&typeof i.map=="function"?i.map(function(r){return Xe(r,e)}):e(i)}var Ai="number",Hr="number, number";function Oa(i){return Math.abs(i)}Oa.signature=Ai;function za(i,e){return i+e}za.signature=Hr;function Aa(i,e){return i*e}Aa.signature=Hr;function Ca(i){return-i}Ca.signature=Ai;function Ta(i){return Math.ceil(i)}Ta.signature=Ai;function Fa(i,e){if(e>0)return i-e*Math.floor(i/e);if(e===0)return i;throw new Error("Cannot calculate mod for a negative divisor")}Fa.signature=Hr;function Da(i,e){return i*i<1&&e===1/0||i*i>1&&e===-1/0?0:Math.pow(i,e)}Da.signature=Hr;function Ci(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return parseFloat(ea(i,e))}Ci.signature=Hr;var Ia="isNumeric",Lh=["typed"],Uh=K(Ia,Lh,i=>{var{typed:e}=i;return e(Ia,{"number | BigNumber | Fraction | boolean":function(){return!0},"Complex | Unit | string | null | undefined | Node":function(){return!1},"Array | Matrix":function(r){return Xe(r,this)}})});function lr(i,e,t){if(t==null)return i.eq(e);if(i.eq(e))return!0;if(i.isNaN()||e.isNaN())return!1;if(i.isFinite()&&e.isFinite()){var r=i.minus(e).abs();if(r.isZero())return!0;var n=i.constructor.max(i.abs(),e.abs());return r.lte(n.times(t))}return!1}function $h(i,e,t){return At(i.re,e.re,t)&&At(i.im,e.im,t)}var Dn="equalScalar",qh=["typed","config"],Vh=K(Dn,qh,i=>{var{typed:e,config:t}=i;return e(Dn,{"boolean, boolean":function(n,s){return n===s},"number, number":function(n,s){return At(n,s,t.epsilon)},"BigNumber, BigNumber":function(n,s){return n.eq(s)||lr(n,s,t.epsilon)},"Fraction, Fraction":function(n,s){return n.equals(s)},"Complex, Complex":function(n,s){return $h(n,s,t.epsilon)},"Unit, Unit":function(n,s){if(!n.equalBase(s))throw new Error("Cannot compare units with different base");return this(n.value,s.value)}})});K(Dn,["typed","config"],i=>{var{typed:e,config:t}=i;return e(Dn,{"number, number":function(n,s){return At(n,s,t.epsilon)}})});var jh="SparseMatrix",Hh=["typed","equalScalar","Matrix"],Gh=K(jh,Hh,i=>{var{typed:e,equalScalar:t,Matrix:r}=i;function n(d,w){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(w&&!zt(w))throw new Error("Invalid datatype: "+w);if(We(d))s(this,d,w);else if(d&&$e(d.index)&&$e(d.ptr)&&$e(d.size))this._values=d.values,this._index=d.index,this._ptr=d.ptr,this._size=d.size,this._datatype=w||d.datatype;else if($e(d))c(this,d,w);else{if(d)throw new TypeError("Unsupported type of data ("+ot(d)+")");this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=w}}function s(d,w,v){w.type==="SparseMatrix"?(d._values=w._values?Ee(w._values):void 0,d._index=Ee(w._index),d._ptr=Ee(w._ptr),d._size=Ee(w._size),d._datatype=v||w._datatype):c(d,w.valueOf(),v||w._datatype)}function c(d,w,v){d._values=[],d._index=[],d._ptr=[],d._datatype=v;var x=w.length,g=0,b=t,M=0;if(zt(v)&&(b=e.find(t,[v,v])||t,M=e.convert(0,v)),x>0){var _=0;do{d._ptr.push(d._index.length);for(var N=0;N<x;N++){var O=w[N];if($e(O)){if(_===0&&g<O.length&&(g=O.length),_<O.length){var E=O[_];b(E,M)||(d._values.push(E),d._index.push(N))}}else _===0&&g<1&&(g=1),b(O,M)||(d._values.push(O),d._index.push(N))}_++}while(_<g)}d._ptr.push(d._index.length),d._size=[x,g]}n.prototype=new r,n.prototype.createSparseMatrix=function(d,w){return new n(d,w)},n.prototype.type="SparseMatrix",n.prototype.isSparseMatrix=!0,n.prototype.getDataType=function(){return Nn(this._values,ot)},n.prototype.storage=function(){return"sparse"},n.prototype.datatype=function(){return this._datatype},n.prototype.create=function(d,w){return new n(d,w)},n.prototype.density=function(){var d=this._size[0],w=this._size[1];return d!==0&&w!==0?this._index.length/(d*w):0},n.prototype.subset=function(d,w,v){if(!this._values)throw new Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return l(this,d);case 2:case 3:return h(this,d,w,v);default:throw new SyntaxError("Wrong number of arguments")}};function l(d,w){if(!xr(w))throw new TypeError("Invalid index");var v=w.isScalar();if(v)return d.get(w.min());var x=w.size();if(x.length!==d._size.length)throw new ye(x.length,d._size.length);var g,b,M,_,N=w.min(),O=w.max();for(g=0,b=d._size.length;g<b;g++)ke(N[g],d._size[g]),ke(O[g],d._size[g]);var E=d._values,F=d._index,B=d._ptr,I=w.dimension(0),j=w.dimension(1),q=[],H=[];I.forEach(function(A,ie){H[A]=ie[0],q[A]=!0});var k=E?[]:void 0,S=[],J=[];return j.forEach(function(A){for(J.push(S.length),M=B[A],_=B[A+1];M<_;M++)g=F[M],q[g]===!0&&(S.push(H[g]),k&&k.push(E[M]))}),J.push(S.length),new n({values:k,index:S,ptr:J,size:x,datatype:d._datatype})}function h(d,w,v,x){if(!w||w.isIndex!==!0)throw new TypeError("Invalid index");var g=w.size(),b=w.isScalar(),M;if(We(v)?(M=v.size(),v=v.toArray()):M=yt(v),b){if(M.length!==0)throw new TypeError("Scalar expected");d.set(w.min(),v,x)}else{if(g.length!==1&&g.length!==2)throw new ye(g.length,d._size.length,"<");if(M.length<g.length){for(var _=0,N=0;g[_]===1&&M[_]===1;)_++;for(;g[_]===1;)N++,_++;v=aa(v,g.length,N,M)}if(!br(g,M))throw new ye(g,M,">");for(var O=w.min()[0],E=w.min()[1],F=M[0],B=M[1],I=0;I<F;I++)for(var j=0;j<B;j++){var q=v[I][j];d.set([I+O,j+E],q,x)}}return d}n.prototype.get=function(d){if(!$e(d))throw new TypeError("Array expected");if(d.length!==this._size.length)throw new ye(d.length,this._size.length);if(!this._values)throw new Error("Cannot invoke get on a Pattern only matrix");var w=d[0],v=d[1];ke(w,this._size[0]),ke(v,this._size[1]);var x=f(w,this._ptr[v],this._ptr[v+1],this._index);return x<this._ptr[v+1]&&this._index[x]===w?this._values[x]:0},n.prototype.set=function(d,w,v){if(!$e(d))throw new TypeError("Array expected");if(d.length!==this._size.length)throw new ye(d.length,this._size.length);if(!this._values)throw new Error("Cannot invoke set on a Pattern only matrix");var x=d[0],g=d[1],b=this._size[0],M=this._size[1],_=t,N=0;zt(this._datatype)&&(_=e.find(t,[this._datatype,this._datatype])||t,N=e.convert(0,this._datatype)),(x>b-1||g>M-1)&&(u(this,Math.max(x+1,b),Math.max(g+1,M),v),b=this._size[0],M=this._size[1]),ke(x,b),ke(g,M);var O=f(x,this._ptr[g],this._ptr[g+1],this._index);return O<this._ptr[g+1]&&this._index[O]===x?_(w,N)?o(O,g,this._values,this._index,this._ptr):this._values[O]=w:a(O,x,g,w,this._values,this._index,this._ptr),this};function f(d,w,v,x){if(v-w===0)return v;for(var g=w;g<v;g++)if(x[g]===d)return g;return w}function o(d,w,v,x,g){v.splice(d,1),x.splice(d,1);for(var b=w+1;b<g.length;b++)g[b]--}function a(d,w,v,x,g,b,M){g.splice(d,0,x),b.splice(d,0,w);for(var _=v+1;_<M.length;_++)M[_]++}n.prototype.resize=function(d,w,v){if(!ui(d))throw new TypeError("Array or Matrix expected");var x=d.valueOf().map(b=>Array.isArray(b)&&b.length===1?b[0]:b);if(x.length!==2)throw new Error("Only two dimensions matrix are supported");x.forEach(function(b){if(!Ue(b)||!Ye(b)||b<0)throw new TypeError("Invalid size, must contain positive integers (size: "+qe(x)+")")});var g=v?this.clone():this;return u(g,x[0],x[1],w)};function u(d,w,v,x){var g=x||0,b=t,M=0;zt(d._datatype)&&(b=e.find(t,[d._datatype,d._datatype])||t,M=e.convert(0,d._datatype),g=e.convert(g,d._datatype));var _=!b(g,M),N=d._size[0],O=d._size[1],E,F,B;if(v>O){for(F=O;F<v;F++)if(d._ptr[F]=d._values.length,_)for(E=0;E<N;E++)d._values.push(g),d._index.push(E);d._ptr[v]=d._values.length}else v<O&&(d._ptr.splice(v+1,O-v),d._values.splice(d._ptr[v],d._values.length),d._index.splice(d._ptr[v],d._index.length));if(O=v,w>N){if(_){var I=0;for(F=0;F<O;F++){d._ptr[F]=d._ptr[F]+I,B=d._ptr[F+1]+I;var j=0;for(E=N;E<w;E++,j++)d._values.splice(B+j,0,g),d._index.splice(B+j,0,E),I++}d._ptr[O]=d._values.length}}else if(w<N){var q=0;for(F=0;F<O;F++){d._ptr[F]=d._ptr[F]-q;var H=d._ptr[F],k=d._ptr[F+1]-q;for(B=H;B<k;B++)E=d._index[B],E>w-1&&(d._values.splice(B,1),d._index.splice(B,1),q++)}d._ptr[F]=d._values.length}return d._size[0]=w,d._size[1]=v,d}n.prototype.reshape=function(d,w){if(!$e(d))throw new TypeError("Array expected");if(d.length!==2)throw new Error("Sparse matrices can only be reshaped in two dimensions");if(d.forEach(function(S){if(!Ue(S)||!Ye(S)||S<0)throw new TypeError("Invalid size, must contain positive integers (size: "+qe(d)+")")}),this._size[0]*this._size[1]!==d[0]*d[1])throw new Error("Reshaping sparse matrix will result in the wrong number of elements");var v=w?this.clone():this;if(this._size[0]===d[0]&&this._size[1]===d[1])return v;for(var x=[],g=0;g<v._ptr.length;g++)for(var b=0;b<v._ptr[g+1]-v._ptr[g];b++)x.push(g);for(var M=v._values.slice(),_=v._index.slice(),N=0;N<v._index.length;N++){var O=_[N],E=x[N],F=O*v._size[1]+E;x[N]=F%d[1],_[N]=Math.floor(F/d[1])}v._values.length=0,v._index.length=0,v._ptr.length=d[1]+1,v._size=d.slice();for(var B=0;B<v._ptr.length;B++)v._ptr[B]=0;for(var I=0;I<M.length;I++){var j=_[I],q=x[I],H=M[I],k=f(j,v._ptr[q],v._ptr[q+1],v._index);a(k,j,q,H,v._values,v._index,v._ptr)}return v},n.prototype.clone=function(){var d=new n({values:this._values?Ee(this._values):void 0,index:Ee(this._index),ptr:Ee(this._ptr),size:Ee(this._size),datatype:this._datatype});return d},n.prototype.size=function(){return this._size.slice(0)},n.prototype.map=function(d,w){if(!this._values)throw new Error("Cannot invoke map on a Pattern only matrix");var v=this,x=this._size[0],g=this._size[1],b=function(_,N,O){return d(_,[N,O],v)};return p(this,0,x-1,0,g-1,b,w)};function p(d,w,v,x,g,b,M){var _=[],N=[],O=[],E=t,F=0;zt(d._datatype)&&(E=e.find(t,[d._datatype,d._datatype])||t,F=e.convert(0,d._datatype));for(var B=function(V,Ne,Se){V=b(V,Ne,Se),E(V,F)||(_.push(V),N.push(Ne))},I=x;I<=g;I++){O.push(_.length);var j=d._ptr[I],q=d._ptr[I+1];if(M)for(var H=j;H<q;H++){var k=d._index[H];k>=w&&k<=v&&B(d._values[H],k-w,I-x)}else{for(var S={},J=j;J<q;J++){var A=d._index[J];S[A]=d._values[J]}for(var ie=w;ie<=v;ie++){var de=ie in S?S[ie]:0;B(de,ie-w,I-x)}}}return O.push(_.length),new n({values:_,index:N,ptr:O,size:[v-w+1,g-x+1]})}n.prototype.forEach=function(d,w){if(!this._values)throw new Error("Cannot invoke forEach on a Pattern only matrix");for(var v=this,x=this._size[0],g=this._size[1],b=0;b<g;b++){var M=this._ptr[b],_=this._ptr[b+1];if(w)for(var N=M;N<_;N++){var O=this._index[N];d(this._values[N],[O,b],v)}else{for(var E={},F=M;F<_;F++){var B=this._index[F];E[B]=this._values[F]}for(var I=0;I<x;I++){var j=I in E?E[I]:0;d(j,[I,b],v)}}}},n.prototype.toArray=function(){return m(this._values,this._index,this._ptr,this._size,!0)},n.prototype.valueOf=function(){return m(this._values,this._index,this._ptr,this._size,!1)};function m(d,w,v,x,g){var b=x[0],M=x[1],_=[],N,O;for(N=0;N<b;N++)for(_[N]=[],O=0;O<M;O++)_[N][O]=0;for(O=0;O<M;O++)for(var E=v[O],F=v[O+1],B=E;B<F;B++)N=w[B],_[N][O]=d?g?Ee(d[B]):d[B]:1;return _}return n.prototype.format=function(d){for(var w=this._size[0],v=this._size[1],x=this.density(),g="Sparse Matrix ["+qe(w,d)+" x "+qe(v,d)+"] density: "+qe(x,d)+`
`,b=0;b<v;b++)for(var M=this._ptr[b],_=this._ptr[b+1],N=M;N<_;N++){var O=this._index[N];g+=`
    (`+qe(O,d)+", "+qe(b,d)+") ==> "+(this._values?qe(this._values[N],d):"X")}return g},n.prototype.toString=function(){return qe(this.toArray())},n.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},n.prototype.diagonal=function(d){if(d){if(Ie(d)&&(d=d.toNumber()),!Ue(d)||!Ye(d))throw new TypeError("The parameter k must be an integer number")}else d=0;var w=d>0?d:0,v=d<0?-d:0,x=this._size[0],g=this._size[1],b=Math.min(x-v,g-w),M=[],_=[],N=[];N[0]=0;for(var O=w;O<g&&M.length<b;O++)for(var E=this._ptr[O],F=this._ptr[O+1],B=E;B<F;B++){var I=this._index[B];if(I===O-w+v){M.push(this._values[B]),_[M.length-1]=I-v;break}}return N.push(M.length),new n({values:M,index:_,ptr:N,size:[b,1]})},n.fromJSON=function(d){return new n(d)},n.diagonal=function(d,w,v,x,g){if(!$e(d))throw new TypeError("Array expected, size parameter");if(d.length!==2)throw new Error("Only two dimensions matrix are supported");if(d=d.map(function(A){if(Ie(A)&&(A=A.toNumber()),!Ue(A)||!Ye(A)||A<1)throw new Error("Size values must be positive integers");return A}),v){if(Ie(v)&&(v=v.toNumber()),!Ue(v)||!Ye(v))throw new TypeError("The parameter k must be an integer number")}else v=0;var b=t,M=0;zt(g)&&(b=e.find(t,[g,g])||t,M=e.convert(0,g));var _=v>0?v:0,N=v<0?-v:0,O=d[0],E=d[1],F=Math.min(O-N,E-_),B;if($e(w)){if(w.length!==F)throw new Error("Invalid value array length");B=function(ie){return w[ie]}}else if(We(w)){var I=w.size();if(I.length!==1||I[0]!==F)throw new Error("Invalid matrix length");B=function(ie){return w.get([ie])}}else B=function(){return w};for(var j=[],q=[],H=[],k=0;k<E;k++){H.push(j.length);var S=k-_;if(S>=0&&S<F){var J=B(S);b(J,M)||(q.push(S+N),j.push(J))}}return H.push(j.length),new n({values:j,index:q,ptr:H,size:[O,E]})},n.prototype.swapRows=function(d,w){if(!Ue(d)||!Ye(d)||!Ue(w)||!Ye(w))throw new Error("Row index must be positive integers");if(this._size.length!==2)throw new Error("Only two dimensional matrix is supported");return ke(d,this._size[0]),ke(w,this._size[0]),n._swapRows(d,w,this._size[1],this._values,this._index,this._ptr),this},n._forEachRow=function(d,w,v,x,g){for(var b=x[d],M=x[d+1],_=b;_<M;_++)g(v[_],w[_])},n._swapRows=function(d,w,v,x,g,b){for(var M=0;M<v;M++){var _=b[M],N=b[M+1],O=f(d,_,N,g),E=f(w,_,N,g);if(O<N&&E<N&&g[O]===d&&g[E]===w){if(x){var F=x[O];x[O]=x[E],x[E]=F}continue}if(O<N&&g[O]===d&&(E>=N||g[E]!==w)){var B=x?x[O]:void 0;g.splice(E,0,w),x&&x.splice(E,0,B),g.splice(E<=O?O+1:O,1),x&&x.splice(E<=O?O+1:O,1);continue}if(E<N&&g[E]===w&&(O>=N||g[O]!==d)){var I=x?x[E]:void 0;g.splice(O,0,d),x&&x.splice(O,0,I),g.splice(O<=E?E+1:E,1),x&&x.splice(O<=E?E+1:E,1)}}},n},{isClass:!0}),Wh="number",Yh=["typed"],Zh=K(Wh,Yh,i=>{var{typed:e}=i,t=e("number",{"":function(){return 0},number:function(n){return n},string:function(n){if(n==="NaN")return NaN;var s=Number(n);if(isNaN(s))throw new SyntaxError('String "'+n+'" is no valid number');if(["0b","0o","0x"].includes(n.substring(0,2))){if(s>2**32-1)throw new SyntaxError('String "'.concat(n,'" is out of range'));s&2147483648&&(s=-1*~(s-1))}return s},BigNumber:function(n){return n.toNumber()},Fraction:function(n){return n.valueOf()},Unit:function(n){throw new Error("Second argument with valueless unit expected")},null:function(n){return 0},"Unit, string | Unit":function(n,s){return n.toNumber(s)},"Array | Matrix":function(n){return Xe(n,this)}});return t.fromJSON=function(r){return parseFloat(r.value)},t}),Jh="bignumber",Qh=["typed","BigNumber"],Xh=K(Jh,Qh,i=>{var{typed:e,BigNumber:t}=i;return e("bignumber",{"":function(){return new t(0)},number:function(n){return new t(n+"")},string:function(n){return new t(n)},BigNumber:function(n){return n},Fraction:function(n){return new t(n.n).div(n.d).times(n.s)},null:function(n){return new t(0)},"Array | Matrix":function(n){return Xe(n,this)}})}),Kh="fraction",el=["typed","Fraction"],tl=K(Kh,el,i=>{var{typed:e,Fraction:t}=i;return e("fraction",{number:function(n){if(!isFinite(n)||isNaN(n))throw new Error(n+" cannot be represented as a fraction");return new t(n)},string:function(n){return new t(n)},"number, number":function(n,s){return new t(n,s)},null:function(n){return new t(0)},BigNumber:function(n){return new t(n.toString())},Fraction:function(n){return n},Object:function(n){return new t(n)},"Array | Matrix":function(n){return Xe(n,this)}})}),Ba="matrix",rl=["typed","Matrix","DenseMatrix","SparseMatrix"],nl=K(Ba,rl,i=>{var{typed:e,Matrix:t,DenseMatrix:r,SparseMatrix:n}=i;return e(Ba,{"":function(){return s([])},string:function(l){return s([],l)},"string, string":function(l,h){return s([],l,h)},Array:function(l){return s(l)},Matrix:function(l){return s(l,l.storage())},"Array | Matrix, string":s,"Array | Matrix, string, string":s});function s(c,l,h){if(l==="dense"||l==="default"||l===void 0)return new r(c,h);if(l==="sparse")return new n(c,h);throw new TypeError("Unknown matrix type "+JSON.stringify(l)+".")}}),Ra="unaryMinus",il=["typed"],sl=K(Ra,il,i=>{var{typed:e}=i;return e(Ra,{number:Ca,Complex:function(r){return r.neg()},BigNumber:function(r){return r.neg()},Fraction:function(r){return r.neg()},Unit:function(r){var n=r.clone();return n.value=this(r.value),n},"Array | Matrix":function(r){return Xe(r,this)}})}),Pa="abs",al=["typed"],ol=K(Pa,al,i=>{var{typed:e}=i;return e(Pa,{number:Oa,Complex:function(r){return r.abs()},BigNumber:function(r){return r.abs()},Fraction:function(r){return r.abs()},"Array | Matrix":function(r){return Xe(r,this)},Unit:function(r){return r.abs()}})}),ka="addScalar",ul=["typed"],cl=K(ka,ul,i=>{var{typed:e}=i;return e(ka,{"number, number":za,"Complex, Complex":function(r,n){return r.add(n)},"BigNumber, BigNumber":function(r,n){return r.plus(n)},"Fraction, Fraction":function(r,n){return r.add(n)},"Unit, Unit":function(r,n){if(r.value===null||r.value===void 0)throw new Error("Parameter x contains a unit with undefined value");if(n.value===null||n.value===void 0)throw new Error("Parameter y contains a unit with undefined value");if(!r.equalBase(n))throw new Error("Units do not match");var s=r.clone();return s.value=this(s.value,n.value),s.fixPrefix=!1,s}})}),hl="algorithm11",ll=["typed","equalScalar"],Or=K(hl,ll,i=>{var{typed:e,equalScalar:t}=i;return function(n,s,c,l){var h=n._values,f=n._index,o=n._ptr,a=n._size,u=n._datatype;if(!h)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var p=a[0],m=a[1],d,w=t,v=0,x=c;typeof u=="string"&&(d=u,w=e.find(t,[d,d]),v=e.convert(0,d),s=e.convert(s,d),x=e.find(c,[d,d]));for(var g=[],b=[],M=[],_=0;_<m;_++){M[_]=b.length;for(var N=o[_],O=o[_+1],E=N;E<O;E++){var F=f[E],B=l?x(s,h[E]):x(h[E],s);w(B,v)||(b.push(F),g.push(B))}}return M[m]=b.length,n.createSparseMatrix({values:g,index:b,ptr:M,size:[p,m],datatype:d})}}),fl="algorithm14",pl=["typed"],xt=K(fl,pl,i=>{var{typed:e}=i;return function(n,s,c,l){var h=n._data,f=n._size,o=n._datatype,a,u=c;typeof o=="string"&&(a=o,s=e.convert(s,a),u=e.find(c,[a,a]));var p=f.length>0?t(u,0,f,f[0],h,s,l):[];return n.createDenseMatrix({data:p,size:Ee(f),datatype:a})};function t(r,n,s,c,l,h,f){var o=[];if(n===s.length-1)for(var a=0;a<c;a++)o[a]=f?r(h,l[a]):r(l[a],h);else for(var u=0;u<c;u++)o[u]=t(r,n+1,s,s[n+1],l[u],h,f);return o}}),dl="ceil",ml=["typed","config","round","matrix","equalScalar"],vl=K(dl,ml,i=>{var{typed:e,config:t,round:r,matrix:n,equalScalar:s}=i,c=Or({typed:e,equalScalar:s}),l=xt({typed:e});return e("ceil",{number:function(f){return At(f,r(f),t.epsilon)?r(f):Ta(f)},"number, number":function(f,o){if(At(f,r(f,o),t.epsilon))return r(f,o);var[a,u]="".concat(f,"e").split("e"),p=Math.ceil(Number("".concat(a,"e").concat(Number(u)+o)));return[a,u]="".concat(p,"e").split("e"),Number("".concat(a,"e").concat(Number(u)-o))},Complex:function(f){return f.ceil()},"Complex, number":function(f,o){return f.ceil(o)},BigNumber:function(f){return lr(f,r(f),t.epsilon)?r(f):f.ceil()},"BigNumber, BigNumber":function(f,o){return lr(f,r(f,o),t.epsilon)?r(f,o):f.toDecimalPlaces(o.toNumber(),hr.ROUND_CEIL)},Fraction:function(f){return f.ceil()},"Fraction, number":function(f,o){return f.ceil(o)},"Array | Matrix":function(f){return Xe(f,this)},"Array | Matrix, number":function(f,o){return Xe(f,a=>this(a,o))},"SparseMatrix, number | BigNumber":function(f,o){return c(f,o,this,!1)},"DenseMatrix, number | BigNumber":function(f,o){return l(f,o,this,!1)},"number | Complex | BigNumber, Array":function(f,o){return l(n(o),f,this,!0).valueOf()}})}),gl="fix",yl=["typed","Complex","matrix","ceil","floor"],wl=K(gl,yl,i=>{var{typed:e,Complex:t,matrix:r,ceil:n,floor:s}=i,c=xt({typed:e});return e("fix",{number:function(h){return h>0?s(h):n(h)},"number, number | BigNumber":function(h,f){return h>0?s(h,f):n(h,f)},Complex:function(h){return new t(h.re>0?Math.floor(h.re):Math.ceil(h.re),h.im>0?Math.floor(h.im):Math.ceil(h.im))},"Complex, number | BigNumber":function(h,f){return new t(h.re>0?s(h.re,f):n(h.re,f),h.im>0?s(h.im,f):n(h.im,f))},BigNumber:function(h){return h.isNegative()?n(h):s(h)},"BigNumber, number | BigNumber":function(h,f){return h.isNegative()?n(h,f):s(h,f)},Fraction:function(h){return h.s<0?h.ceil():h.floor()},"Fraction, number | BigNumber":function(h,f){return h.s<0?h.ceil(f):h.floor(f)},"Array | Matrix":function(h){return Xe(h,this)},"Array | Matrix, number | BigNumber":function(h,f){return Xe(h,o=>this(o,f))},"number | Complex | BigNumber, Array":function(h,f){return c(r(f),h,this,!0).valueOf()}})}),xl="floor",bl=["typed","config","round","matrix","equalScalar"],Ml=K(xl,bl,i=>{var{typed:e,config:t,round:r,matrix:n,equalScalar:s}=i,c=Or({typed:e,equalScalar:s}),l=xt({typed:e});return e("floor",{number:function(f){return At(f,r(f),t.epsilon)?r(f):Math.floor(f)},"number, number":function(f,o){if(At(f,r(f,o),t.epsilon))return r(f,o);var[a,u]="".concat(f,"e").split("e"),p=Math.floor(Number("".concat(a,"e").concat(Number(u)+o)));return[a,u]="".concat(p,"e").split("e"),Number("".concat(a,"e").concat(Number(u)-o))},Complex:function(f){return f.floor()},"Complex, number":function(f,o){return f.floor(o)},BigNumber:function(f){return lr(f,r(f),t.epsilon)?r(f):f.floor()},"BigNumber, BigNumber":function(f,o){return lr(f,r(f,o),t.epsilon)?r(f,o):f.toDecimalPlaces(o.toNumber(),hr.ROUND_FLOOR)},Fraction:function(f){return f.floor()},"Fraction, number":function(f,o){return f.floor(o)},"Array | Matrix":function(f){return Xe(f,this)},"Array | Matrix, number":function(f,o){return Xe(f,a=>this(a,o))},"SparseMatrix, number | BigNumber":function(f,o){return c(f,o,this,!1)},"DenseMatrix, number | BigNumber":function(f,o){return l(f,o,this,!1)},"number | Complex | BigNumber, Array":function(f,o){return l(n(o),f,this,!0).valueOf()}})}),_l="algorithm01",Nl=["typed"],La=K(_l,Nl,i=>{var{typed:e}=i;return function(r,n,s,c){var l=r._data,h=r._size,f=r._datatype,o=n._values,a=n._index,u=n._ptr,p=n._size,m=n._datatype;if(h.length!==p.length)throw new ye(h.length,p.length);if(h[0]!==p[0]||h[1]!==p[1])throw new RangeError("Dimension mismatch. Matrix A ("+h+") must match Matrix B ("+p+")");if(!o)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var d=h[0],w=h[1],v=typeof f=="string"&&f===m?f:void 0,x=v?e.find(s,[v,v]):s,g,b,M=[];for(g=0;g<d;g++)M[g]=[];var _=[],N=[];for(b=0;b<w;b++){for(var O=b+1,E=u[b],F=u[b+1],B=E;B<F;B++)g=a[B],_[g]=c?x(o[B],l[g][b]):x(l[g][b],o[B]),N[g]=O;for(g=0;g<d;g++)N[g]===O?M[g][b]=_[g]:M[g][b]=l[g][b]}return r.createDenseMatrix({data:M,size:[d,w],datatype:v})}}),Sl="algorithm04",El=["typed","equalScalar"],Ol=K(Sl,El,i=>{var{typed:e,equalScalar:t}=i;return function(n,s,c){var l=n._values,h=n._index,f=n._ptr,o=n._size,a=n._datatype,u=s._values,p=s._index,m=s._ptr,d=s._size,w=s._datatype;if(o.length!==d.length)throw new ye(o.length,d.length);if(o[0]!==d[0]||o[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+o+") must match Matrix B ("+d+")");var v=o[0],x=o[1],g,b=t,M=0,_=c;typeof a=="string"&&a===w&&(g=a,b=e.find(t,[g,g]),M=e.convert(0,g),_=e.find(c,[g,g]));var N=l&&u?[]:void 0,O=[],E=[],F=l&&u?[]:void 0,B=l&&u?[]:void 0,I=[],j=[],q,H,k,S,J;for(H=0;H<x;H++){E[H]=O.length;var A=H+1;for(S=f[H],J=f[H+1],k=S;k<J;k++)q=h[k],O.push(q),I[q]=A,F&&(F[q]=l[k]);for(S=m[H],J=m[H+1],k=S;k<J;k++)if(q=p[k],I[q]===A){if(F){var ie=_(F[q],u[k]);b(ie,M)?I[q]=null:F[q]=ie}}else O.push(q),j[q]=A,B&&(B[q]=u[k]);if(F&&B)for(k=E[H];k<O.length;)q=O[k],I[q]===A?(N[k]=F[q],k++):j[q]===A?(N[k]=B[q],k++):O.splice(k,1)}return E[x]=O.length,n.createSparseMatrix({values:N,index:O,ptr:E,size:[v,x],datatype:g})}}),zl="algorithm10",Al=["typed","DenseMatrix"],Ua=K(zl,Al,i=>{var{typed:e,DenseMatrix:t}=i;return function(n,s,c,l){var h=n._values,f=n._index,o=n._ptr,a=n._size,u=n._datatype;if(!h)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var p=a[0],m=a[1],d,w=c;typeof u=="string"&&(d=u,s=e.convert(s,d),w=e.find(c,[d,d]));for(var v=[],x=[],g=[],b=0;b<m;b++){for(var M=b+1,_=o[b],N=o[b+1],O=_;O<N;O++){var E=f[O];x[E]=h[O],g[E]=M}for(var F=0;F<p;F++)b===0&&(v[F]=[]),g[F]===M?v[F][b]=l?w(s,x[F]):w(x[F],s):v[F][b]=s}return new t({data:v,size:[p,m],datatype:d})}}),Cl="algorithm13",Tl=["typed"],zr=K(Cl,Tl,i=>{var{typed:e}=i;return function(n,s,c){var l=n._data,h=n._size,f=n._datatype,o=s._data,a=s._size,u=s._datatype,p=[];if(h.length!==a.length)throw new ye(h.length,a.length);for(var m=0;m<h.length;m++){if(h[m]!==a[m])throw new RangeError("Dimension mismatch. Matrix A ("+h+") must match Matrix B ("+a+")");p[m]=h[m]}var d,w=c;typeof f=="string"&&f===u&&(d=f,w=e.find(c,[d,d]));var v=p.length>0?t(w,0,p,p[0],l,o):[];return n.createDenseMatrix({data:v,size:p,datatype:d})};function t(r,n,s,c,l,h){var f=[];if(n===s.length-1)for(var o=0;o<c;o++)f[o]=r(l[o],h[o]);else for(var a=0;a<c;a++)f[a]=t(r,n+1,s,s[n+1],l[a],h[a]);return f}}),Fl="algorithm02",Dl=["typed","equalScalar"],Il=K(Fl,Dl,i=>{var{typed:e,equalScalar:t}=i;return function(n,s,c,l){var h=n._data,f=n._size,o=n._datatype,a=s._values,u=s._index,p=s._ptr,m=s._size,d=s._datatype;if(f.length!==m.length)throw new ye(f.length,m.length);if(f[0]!==m[0]||f[1]!==m[1])throw new RangeError("Dimension mismatch. Matrix A ("+f+") must match Matrix B ("+m+")");if(!a)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var w=f[0],v=f[1],x,g=t,b=0,M=c;typeof o=="string"&&o===d&&(x=o,g=e.find(t,[x,x]),b=e.convert(0,x),M=e.find(c,[x,x]));for(var _=[],N=[],O=[],E=0;E<v;E++){O[E]=N.length;for(var F=p[E],B=p[E+1],I=F;I<B;I++){var j=u[I],q=l?M(a[I],h[j][E]):M(h[j][E],a[I]);g(q,b)||(N.push(j),_.push(q))}}return O[v]=N.length,s.createSparseMatrix({values:_,index:N,ptr:O,size:[w,v],datatype:x})}}),Bl="algorithm03",Rl=["typed"],Gr=K(Bl,Rl,i=>{var{typed:e}=i;return function(r,n,s,c){var l=r._data,h=r._size,f=r._datatype,o=n._values,a=n._index,u=n._ptr,p=n._size,m=n._datatype;if(h.length!==p.length)throw new ye(h.length,p.length);if(h[0]!==p[0]||h[1]!==p[1])throw new RangeError("Dimension mismatch. Matrix A ("+h+") must match Matrix B ("+p+")");if(!o)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var d=h[0],w=h[1],v,x=0,g=s;typeof f=="string"&&f===m&&(v=f,x=e.convert(0,v),g=e.find(s,[v,v]));for(var b=[],M=0;M<d;M++)b[M]=[];for(var _=[],N=[],O=0;O<w;O++){for(var E=O+1,F=u[O],B=u[O+1],I=F;I<B;I++){var j=a[I];_[j]=c?g(o[I],l[j][O]):g(l[j][O],o[I]),N[j]=E}for(var q=0;q<d;q++)N[q]===E?b[q][O]=_[q]:b[q][O]=c?g(x,l[q][O]):g(l[q][O],x)}return r.createDenseMatrix({data:b,size:[d,w],datatype:v})}}),Pl="algorithm05",kl=["typed","equalScalar"],$a=K(Pl,kl,i=>{var{typed:e,equalScalar:t}=i;return function(n,s,c){var l=n._values,h=n._index,f=n._ptr,o=n._size,a=n._datatype,u=s._values,p=s._index,m=s._ptr,d=s._size,w=s._datatype;if(o.length!==d.length)throw new ye(o.length,d.length);if(o[0]!==d[0]||o[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+o+") must match Matrix B ("+d+")");var v=o[0],x=o[1],g,b=t,M=0,_=c;typeof a=="string"&&a===w&&(g=a,b=e.find(t,[g,g]),M=e.convert(0,g),_=e.find(c,[g,g]));var N=l&&u?[]:void 0,O=[],E=[],F=N?[]:void 0,B=N?[]:void 0,I=[],j=[],q,H,k,S;for(H=0;H<x;H++){E[H]=O.length;var J=H+1;for(k=f[H],S=f[H+1];k<S;k++)q=h[k],O.push(q),I[q]=J,F&&(F[q]=l[k]);for(k=m[H],S=m[H+1];k<S;k++)q=p[k],I[q]!==J&&O.push(q),j[q]=J,B&&(B[q]=u[k]);if(N)for(k=E[H];k<O.length;){q=O[k];var A=I[q],ie=j[q];if(A===J||ie===J){var de=A===J?F[q]:M,ue=ie===J?B[q]:M,V=_(de,ue);b(V,M)?O.splice(k,1):(N.push(V),k++)}}}return E[x]=O.length,n.createSparseMatrix({values:N,index:O,ptr:E,size:[v,x],datatype:g})}}),Ll="algorithm12",Ul=["typed","DenseMatrix"],Wr=K(Ll,Ul,i=>{var{typed:e,DenseMatrix:t}=i;return function(n,s,c,l){var h=n._values,f=n._index,o=n._ptr,a=n._size,u=n._datatype;if(!h)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var p=a[0],m=a[1],d,w=c;typeof u=="string"&&(d=u,s=e.convert(s,d),w=e.find(c,[d,d]));for(var v=[],x=[],g=[],b=0;b<m;b++){for(var M=b+1,_=o[b],N=o[b+1],O=_;O<N;O++){var E=f[O];x[E]=h[O],g[E]=M}for(var F=0;F<p;F++)b===0&&(v[F]=[]),g[F]===M?v[F][b]=l?w(s,x[F]):w(x[F],s):v[F][b]=l?w(s,0):w(0,s)}return new t({data:v,size:[p,m],datatype:d})}}),qa="mod",$l=["typed","matrix","equalScalar","DenseMatrix"],ql=K(qa,$l,i=>{var{typed:e,matrix:t,equalScalar:r,DenseMatrix:n}=i,s=Il({typed:e,equalScalar:r}),c=Gr({typed:e}),l=$a({typed:e,equalScalar:r}),h=Or({typed:e,equalScalar:r}),f=Wr({typed:e,DenseMatrix:n}),o=zr({typed:e}),a=xt({typed:e});return e(qa,{"number, number":Fa,"BigNumber, BigNumber":function(p,m){if(m.isNeg())throw new Error("Cannot calculate mod for a negative divisor");return m.isZero()?p:p.mod(m)},"Fraction, Fraction":function(p,m){if(m.compare(0)<0)throw new Error("Cannot calculate mod for a negative divisor");return p.compare(0)>=0?p.mod(m):p.mod(m).add(m).mod(m)},"SparseMatrix, SparseMatrix":function(p,m){return l(p,m,this,!1)},"SparseMatrix, DenseMatrix":function(p,m){return s(m,p,this,!0)},"DenseMatrix, SparseMatrix":function(p,m){return c(p,m,this,!1)},"DenseMatrix, DenseMatrix":function(p,m){return o(p,m,this)},"Array, Array":function(p,m){return this(t(p),t(m)).valueOf()},"Array, Matrix":function(p,m){return this(t(p),m)},"Matrix, Array":function(p,m){return this(p,t(m))},"SparseMatrix, any":function(p,m){return h(p,m,this,!1)},"DenseMatrix, any":function(p,m){return a(p,m,this,!1)},"any, SparseMatrix":function(p,m){return f(m,p,this,!0)},"any, DenseMatrix":function(p,m){return a(m,p,this,!0)},"Array, any":function(p,m){return a(t(p),m,this,!1).valueOf()},"any, Array":function(p,m){return a(t(m),p,this,!0).valueOf()}})}),Vl="multiplyScalar",jl=["typed"],Hl=K(Vl,jl,i=>{var{typed:e}=i;return e("multiplyScalar",{"number, number":Aa,"Complex, Complex":function(r,n){return r.mul(n)},"BigNumber, BigNumber":function(r,n){return r.times(n)},"Fraction, Fraction":function(r,n){return r.mul(n)},"number | Fraction | BigNumber | Complex, Unit":function(r,n){var s=n.clone();return s.value=s.value===null?s._normalize(r):this(s.value,r),s},"Unit, number | Fraction | BigNumber | Complex":function(r,n){var s=r.clone();return s.value=s.value===null?s._normalize(n):this(s.value,n),s},"Unit, Unit":function(r,n){return r.multiply(n)}})}),Va="multiply",Gl=["typed","matrix","addScalar","multiplyScalar","equalScalar","dot"],Wl=K(Va,Gl,i=>{var{typed:e,matrix:t,addScalar:r,multiplyScalar:n,equalScalar:s,dot:c}=i,l=Or({typed:e,equalScalar:s}),h=xt({typed:e});function f(M,_){switch(M.length){case 1:switch(_.length){case 1:if(M[0]!==_[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(M[0]!==_[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+M[0]+") must match Matrix rows ("+_[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+_.length+" dimensions)")}break;case 2:switch(_.length){case 1:if(M[1]!==_[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+M[1]+") must match Vector length ("+_[0]+")");break;case 2:if(M[1]!==_[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+M[1]+") must match Matrix B rows ("+_[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+_.length+" dimensions)")}break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+M.length+" dimensions)")}}function o(M,_,N){if(N===0)throw new Error("Cannot multiply two empty vectors");return c(M,_)}function a(M,_){if(_.storage()!=="dense")throw new Error("Support for SparseMatrix not implemented");return u(M,_)}function u(M,_){var N=M._data,O=M._size,E=M._datatype,F=_._data,B=_._size,I=_._datatype,j=O[0],q=B[1],H,k=r,S=n;E&&I&&E===I&&typeof E=="string"&&(H=E,k=e.find(r,[H,H]),S=e.find(n,[H,H]));for(var J=[],A=0;A<q;A++){for(var ie=S(N[0],F[0][A]),de=1;de<j;de++)ie=k(ie,S(N[de],F[de][A]));J[A]=ie}return M.createDenseMatrix({data:J,size:[q],datatype:H})}var p=e("_multiplyMatrixVector",{"DenseMatrix, any":d,"SparseMatrix, any":x}),m=e("_multiplyMatrixMatrix",{"DenseMatrix, DenseMatrix":w,"DenseMatrix, SparseMatrix":v,"SparseMatrix, DenseMatrix":g,"SparseMatrix, SparseMatrix":b});function d(M,_){var N=M._data,O=M._size,E=M._datatype,F=_._data,B=_._datatype,I=O[0],j=O[1],q,H=r,k=n;E&&B&&E===B&&typeof E=="string"&&(q=E,H=e.find(r,[q,q]),k=e.find(n,[q,q]));for(var S=[],J=0;J<I;J++){for(var A=N[J],ie=k(A[0],F[0]),de=1;de<j;de++)ie=H(ie,k(A[de],F[de]));S[J]=ie}return M.createDenseMatrix({data:S,size:[I],datatype:q})}function w(M,_){var N=M._data,O=M._size,E=M._datatype,F=_._data,B=_._size,I=_._datatype,j=O[0],q=O[1],H=B[1],k,S=r,J=n;E&&I&&E===I&&typeof E=="string"&&(k=E,S=e.find(r,[k,k]),J=e.find(n,[k,k]));for(var A=[],ie=0;ie<j;ie++){var de=N[ie];A[ie]=[];for(var ue=0;ue<H;ue++){for(var V=J(de[0],F[0][ue]),Ne=1;Ne<q;Ne++)V=S(V,J(de[Ne],F[Ne][ue]));A[ie][ue]=V}}return M.createDenseMatrix({data:A,size:[j,H],datatype:k})}function v(M,_){var N=M._data,O=M._size,E=M._datatype,F=_._values,B=_._index,I=_._ptr,j=_._size,q=_._datatype;if(!F)throw new Error("Cannot multiply Dense Matrix times Pattern only Matrix");var H=O[0],k=j[1],S,J=r,A=n,ie=s,de=0;E&&q&&E===q&&typeof E=="string"&&(S=E,J=e.find(r,[S,S]),A=e.find(n,[S,S]),ie=e.find(s,[S,S]),de=e.convert(0,S));for(var ue=[],V=[],Ne=[],Se=_.createSparseMatrix({values:ue,index:V,ptr:Ne,size:[H,k],datatype:S}),se=0;se<k;se++){Ne[se]=V.length;var me=I[se],Ve=I[se+1];if(Ve>me)for(var we=0,fe=0;fe<H;fe++){for(var Te=fe+1,Fe=void 0,Me=me;Me<Ve;Me++){var Be=B[Me];we!==Te?(Fe=A(N[fe][Be],F[Me]),we=Te):Fe=J(Fe,A(N[fe][Be],F[Me]))}we===Te&&!ie(Fe,de)&&(V.push(fe),ue.push(Fe))}}return Ne[k]=V.length,Se}function x(M,_){var N=M._values,O=M._index,E=M._ptr,F=M._datatype;if(!N)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var B=_._data,I=_._datatype,j=M._size[0],q=_._size[0],H=[],k=[],S=[],J,A=r,ie=n,de=s,ue=0;F&&I&&F===I&&typeof F=="string"&&(J=F,A=e.find(r,[J,J]),ie=e.find(n,[J,J]),de=e.find(s,[J,J]),ue=e.convert(0,J));var V=[],Ne=[];S[0]=0;for(var Se=0;Se<q;Se++){var se=B[Se];if(!de(se,ue))for(var me=E[Se],Ve=E[Se+1],we=me;we<Ve;we++){var fe=O[we];Ne[fe]?V[fe]=A(V[fe],ie(se,N[we])):(Ne[fe]=!0,k.push(fe),V[fe]=ie(se,N[we]))}}for(var Te=k.length,Fe=0;Fe<Te;Fe++){var Me=k[Fe];H[Fe]=V[Me]}return S[1]=k.length,M.createSparseMatrix({values:H,index:k,ptr:S,size:[j,1],datatype:J})}function g(M,_){var N=M._values,O=M._index,E=M._ptr,F=M._datatype;if(!N)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var B=_._data,I=_._datatype,j=M._size[0],q=_._size[0],H=_._size[1],k,S=r,J=n,A=s,ie=0;F&&I&&F===I&&typeof F=="string"&&(k=F,S=e.find(r,[k,k]),J=e.find(n,[k,k]),A=e.find(s,[k,k]),ie=e.convert(0,k));for(var de=[],ue=[],V=[],Ne=M.createSparseMatrix({values:de,index:ue,ptr:V,size:[j,H],datatype:k}),Se=[],se=[],me=0;me<H;me++){V[me]=ue.length;for(var Ve=me+1,we=0;we<q;we++){var fe=B[we][me];if(!A(fe,ie))for(var Te=E[we],Fe=E[we+1],Me=Te;Me<Fe;Me++){var Be=O[Me];se[Be]!==Ve?(se[Be]=Ve,ue.push(Be),Se[Be]=J(fe,N[Me])):Se[Be]=S(Se[Be],J(fe,N[Me]))}}for(var T=V[me],R=ue.length,Y=T;Y<R;Y++){var Q=ue[Y];de[Y]=Se[Q]}}return V[H]=ue.length,Ne}function b(M,_){var N=M._values,O=M._index,E=M._ptr,F=M._datatype,B=_._values,I=_._index,j=_._ptr,q=_._datatype,H=M._size[0],k=_._size[1],S=N&&B,J,A=r,ie=n;F&&q&&F===q&&typeof F=="string"&&(J=F,A=e.find(r,[J,J]),ie=e.find(n,[J,J]));for(var de=S?[]:void 0,ue=[],V=[],Ne=M.createSparseMatrix({values:de,index:ue,ptr:V,size:[H,k],datatype:J}),Se=S?[]:void 0,se=[],me,Ve,we,fe,Te,Fe,Me,Be,T=0;T<k;T++){V[T]=ue.length;var R=T+1;for(Te=j[T],Fe=j[T+1],fe=Te;fe<Fe;fe++)if(Be=I[fe],S)for(Ve=E[Be],we=E[Be+1],me=Ve;me<we;me++)Me=O[me],se[Me]!==R?(se[Me]=R,ue.push(Me),Se[Me]=ie(B[fe],N[me])):Se[Me]=A(Se[Me],ie(B[fe],N[me]));else for(Ve=E[Be],we=E[Be+1],me=Ve;me<we;me++)Me=O[me],se[Me]!==R&&(se[Me]=R,ue.push(Me));if(S)for(var Y=V[T],Q=ue.length,C=Y;C<Q;C++){var P=ue[C];de[C]=Se[P]}}return V[k]=ue.length,Ne}return e(Va,wi({"Array, Array":function(_,N){f(yt(_),yt(N));var O=this(t(_),t(N));return We(O)?O.valueOf():O},"Matrix, Matrix":function(_,N){var O=_.size(),E=N.size();return f(O,E),O.length===1?E.length===1?o(_,N,O[0]):a(_,N):E.length===1?p(_,N):m(_,N)},"Matrix, Array":function(_,N){return this(_,t(N))},"Array, Matrix":function(_,N){return this(t(_,N.storage()),N)},"SparseMatrix, any":function(_,N){return l(_,N,n,!1)},"DenseMatrix, any":function(_,N){return h(_,N,n,!1)},"any, SparseMatrix":function(_,N){return l(N,_,n,!0)},"any, DenseMatrix":function(_,N){return h(N,_,n,!0)},"Array, any":function(_,N){return h(t(_),N,n,!1).valueOf()},"any, Array":function(_,N){return h(t(N),_,n,!0).valueOf()},"any, any":n,"any, any, ...any":function(_,N,O){for(var E=this(_,N),F=0;F<O.length;F++)E=this(E,O[F]);return E}},n.signatures))}),ja="subtract",Yl=["typed","matrix","equalScalar","addScalar","unaryMinus","DenseMatrix"],Zl=K(ja,Yl,i=>{var{typed:e,matrix:t,equalScalar:r,addScalar:n,unaryMinus:s,DenseMatrix:c}=i,l=La({typed:e}),h=Gr({typed:e}),f=$a({typed:e,equalScalar:r}),o=Ua({typed:e,DenseMatrix:c}),a=zr({typed:e}),u=xt({typed:e});return e(ja,{"number, number":function(m,d){return m-d},"Complex, Complex":function(m,d){return m.sub(d)},"BigNumber, BigNumber":function(m,d){return m.minus(d)},"Fraction, Fraction":function(m,d){return m.sub(d)},"Unit, Unit":function(m,d){if(m.value===null)throw new Error("Parameter x contains a unit with undefined value");if(d.value===null)throw new Error("Parameter y contains a unit with undefined value");if(!m.equalBase(d))throw new Error("Units do not match");var w=m.clone();return w.value=this(w.value,d.value),w.fixPrefix=!1,w},"SparseMatrix, SparseMatrix":function(m,d){return In(m,d),f(m,d,this)},"SparseMatrix, DenseMatrix":function(m,d){return In(m,d),h(d,m,this,!0)},"DenseMatrix, SparseMatrix":function(m,d){return In(m,d),l(m,d,this,!1)},"DenseMatrix, DenseMatrix":function(m,d){return In(m,d),a(m,d,this)},"Array, Array":function(m,d){return this(t(m),t(d)).valueOf()},"Array, Matrix":function(m,d){return this(t(m),d)},"Matrix, Array":function(m,d){return this(m,t(d))},"SparseMatrix, any":function(m,d){return o(m,s(d),n)},"DenseMatrix, any":function(m,d){return u(m,d,this)},"any, SparseMatrix":function(m,d){return o(d,m,this,!0)},"any, DenseMatrix":function(m,d){return u(d,m,this,!0)},"Array, any":function(m,d){return u(t(m),d,this,!1).valueOf()},"any, Array":function(m,d){return u(t(d),m,this,!0).valueOf()}})});function In(i,e){var t=i.size(),r=e.size();if(t.length!==r.length)throw new ye(t.length,r.length)}var Jl="algorithm07",Ql=["typed","DenseMatrix"],Ti=K(Jl,Ql,i=>{var{typed:e,DenseMatrix:t}=i;return function(s,c,l){var h=s._size,f=s._datatype,o=c._size,a=c._datatype;if(h.length!==o.length)throw new ye(h.length,o.length);if(h[0]!==o[0]||h[1]!==o[1])throw new RangeError("Dimension mismatch. Matrix A ("+h+") must match Matrix B ("+o+")");var u=h[0],p=h[1],m,d=0,w=l;typeof f=="string"&&f===a&&(m=f,d=e.convert(0,m),w=e.find(l,[m,m]));var v,x,g=[];for(v=0;v<u;v++)g[v]=[];var b=[],M=[],_=[],N=[];for(x=0;x<p;x++){var O=x+1;for(r(s,x,_,b,O),r(c,x,N,M,O),v=0;v<u;v++){var E=_[v]===O?b[v]:d,F=N[v]===O?M[v]:d;g[v][x]=w(E,F)}}return new t({data:g,size:[u,p],datatype:m})};function r(n,s,c,l,h){for(var f=n._values,o=n._index,a=n._ptr,u=a[s],p=a[s+1];u<p;u++){var m=o[u];c[m]=h,l[m]=f[u]}}}),Ha="conj",Xl=["typed"],Kl=K(Ha,Xl,i=>{var{typed:e}=i;return e(Ha,{number:function(r){return r},BigNumber:function(r){return r},Complex:function(r){return r.conjugate()},"Array | Matrix":function(r){return Xe(r,this)}})});function ef(i){var e=0,t=1,r=Object.create(null),n=Object.create(null),s=0,c=function(h){var f=n[h];if(!!f&&(delete r[f],delete n[h],--e,t===f)){if(!e){s=0,t=1;return}for(;!hasOwnProperty.call(r,++t););}};return i=Math.abs(i),{hit:function(h){var f=n[h],o=++s;if(r[o]=h,n[h]=o,!f)return++e,e<=i?void 0:(h=r[t],c(h),h);if(delete r[f],t===f)for(;!hasOwnProperty.call(r,++t););},delete:c,clear:function(){e=s=0,t=1,r=Object.create(null),n=Object.create(null)}}}function Yr(i){var{hasher:e,limit:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return t=t==null?Number.POSITIVE_INFINITY:t,e=e==null?JSON.stringify:e,function r(){typeof r.cache!="object"&&(r.cache={values:new Map,lru:ef(t||Number.POSITIVE_INFINITY)});for(var n=[],s=0;s<arguments.length;s++)n[s]=arguments[s];var c=e(n);if(r.cache.values.has(c))return r.cache.lru.hit(c),r.cache.values.get(c);var l=i.apply(i,n);return r.cache.values.set(c,l),r.cache.values.delete(r.cache.lru.hit(c)),l}}var Ga="identity",tf=["typed","config","matrix","BigNumber","DenseMatrix","SparseMatrix"],rf=K(Ga,tf,i=>{var{typed:e,config:t,matrix:r,BigNumber:n,DenseMatrix:s,SparseMatrix:c}=i;return e(Ga,{"":function(){return t.matrix==="Matrix"?r([]):[]},string:function(o){return r(o)},"number | BigNumber":function(o){return h(o,o,t.matrix==="Matrix"?"dense":void 0)},"number | BigNumber, string":function(o,a){return h(o,o,a)},"number | BigNumber, number | BigNumber":function(o,a){return h(o,a,t.matrix==="Matrix"?"dense":void 0)},"number | BigNumber, number | BigNumber, string":function(o,a,u){return h(o,a,u)},Array:function(o){return l(o)},"Array, string":function(o,a){return l(o,a)},Matrix:function(o){return l(o.valueOf(),o.storage())},"Matrix, string":function(o,a){return l(o.valueOf(),a)}});function l(f,o){switch(f.length){case 0:return o?r(o):[];case 1:return h(f[0],f[0],o);case 2:return h(f[0],f[1],o);default:throw new Error("Vector containing two values expected")}}function h(f,o,a){var u=Ie(f)||Ie(o)?n:null;if(Ie(f)&&(f=f.toNumber()),Ie(o)&&(o=o.toNumber()),!Ye(f)||f<1)throw new Error("Parameters in function identity must be positive integers");if(!Ye(o)||o<1)throw new Error("Parameters in function identity must be positive integers");var p=u?new n(1):1,m=u?new u(0):0,d=[f,o];if(a){if(a==="sparse")return c.diagonal(d,p,0,m);if(a==="dense")return s.diagonal(d,p,0,m);throw new TypeError('Unknown matrix type "'.concat(a,'"'))}for(var w=_n([],d,m),v=f<o?f:o,x=0;x<v;x++)w[x][x]=p;return w}});function nf(){throw new Error('No "bignumber" implementation available')}function sf(){throw new Error('No "fraction" implementation available')}function af(){throw new Error('No "matrix" implementation available')}function fr(i,e,t,r){if(!(this instanceof fr))throw new SyntaxError("Constructor must be called with the new operator");this.fn=i,this.count=e,this.min=t,this.max=r,this.message="Wrong number of arguments in function "+i+" ("+e+" provided, "+t+(r!=null?"-"+r:"")+" expected)",this.stack=new Error().stack}fr.prototype=new Error,fr.prototype.constructor=Error,fr.prototype.name="ArgumentsError",fr.prototype.isArgumentsError=!0;var Wa="size",of=["typed","config","?matrix"],uf=K(Wa,of,i=>{var{typed:e,config:t,matrix:r}=i;return e(Wa,{Matrix:function(s){return s.create(s.size())},Array:yt,string:function(s){return t.matrix==="Array"?[s.length]:r([s.length])},"number | Complex | BigNumber | Unit | boolean | null":function(s){return t.matrix==="Array"?[]:r?r([]):af()}})});function ut(i,e){if(Ya(i)&&Fi(i,e))return i[e];throw typeof i[e]=="function"&&Di(i,e)?new Error('Cannot access method "'+e+'" as a property'):new Error('No access to property "'+e+'"')}function pr(i,e,t){if(Ya(i)&&Fi(i,e))return i[e]=t,t;throw new Error('No access to property "'+e+'"')}function Fi(i,e){return!i||typeof i!="object"?!1:ae(hf,e)?!0:!(e in Object.prototype||e in Function.prototype)}function cf(i,e){if(!Di(i,e))throw new Error('No access to method "'+e+'"')}function Di(i,e){return i==null||typeof i[e]!="function"||ae(i,e)&&Object.getPrototypeOf&&e in Object.getPrototypeOf(i)?!1:ae(lf,e)?!0:!(e in Object.prototype||e in Function.prototype)}function Ya(i){return typeof i=="object"&&i&&i.constructor===Object}var hf={length:!0,name:!0},lf={toString:!0,valueOf:!0,toLocaleString:!0},Za="subset",ff=["typed","matrix"],pf=K(Za,ff,i=>{var{typed:e,matrix:t}=i;return e(Za,{"Array, Index":function(n,s){var c=t(n),l=c.subset(s);return s.isScalar()?l:l.valueOf()},"Matrix, Index":function(n,s){return n.subset(s)},"Object, Index":mf,"string, Index":df,"Array, Index, any":function(n,s,c){return t(Ee(n)).subset(s,c,void 0).valueOf()},"Array, Index, any, any":function(n,s,c,l){return t(Ee(n)).subset(s,c,l).valueOf()},"Matrix, Index, any":function(n,s,c){return n.clone().subset(s,c)},"Matrix, Index, any, any":function(n,s,c,l){return n.clone().subset(s,c,l)},"string, Index, string":Ja,"string, Index, string, string":Ja,"Object, Index, any":vf})});function df(i,e){if(!xr(e))throw new TypeError("Index expected");if(e.size().length!==1)throw new ye(e.size().length,1);var t=i.length;ke(e.min()[0],t),ke(e.max()[0],t);var r=e.dimension(0),n="";return r.forEach(function(s){n+=i.charAt(s)}),n}function Ja(i,e,t,r){if(!e||e.isIndex!==!0)throw new TypeError("Index expected");if(e.size().length!==1)throw new ye(e.size().length,1);if(r!==void 0){if(typeof r!="string"||r.length!==1)throw new TypeError("Single character expected as defaultValue")}else r=" ";var n=e.dimension(0),s=n.size()[0];if(s!==t.length)throw new ye(n.size()[0],t.length);var c=i.length;ke(e.min()[0]),ke(e.max()[0]);for(var l=[],h=0;h<c;h++)l[h]=i.charAt(h);if(n.forEach(function(a,u){l[a]=t.charAt(u[0])}),l.length>c)for(var f=c-1,o=l.length;f<o;f++)l[f]||(l[f]=r);return l.join("")}function mf(i,e){if(e.size().length!==1)throw new ye(e.size(),1);var t=e.dimension(0);if(typeof t!="string")throw new TypeError("String expected as index to retrieve an object property");return ut(i,t)}function vf(i,e,t){if(e.size().length!==1)throw new ye(e.size(),1);var r=e.dimension(0);if(typeof r!="string")throw new TypeError("String expected as index to retrieve an object property");var n=Ee(i);return pr(n,r,t),n}var Qa="zeros",gf=["typed","config","matrix","BigNumber"],yf=K(Qa,gf,i=>{var{typed:e,config:t,matrix:r,BigNumber:n}=i;return e(Qa,{"":function(){return t.matrix==="Array"?s([]):s([],"default")},"...number | BigNumber | string":function(f){var o=f[f.length-1];if(typeof o=="string"){var a=f.pop();return s(f,a)}else return t.matrix==="Array"?s(f):s(f,"default")},Array:s,Matrix:function(f){var o=f.storage();return s(f.valueOf(),o)},"Array | Matrix, string":function(f,o){return s(f.valueOf(),o)}});function s(h,f){var o=c(h),a=o?new n(0):0;if(l(h),f){var u=r(f);return h.length>0?u.resize(h,a):u}else{var p=[];return h.length>0?_n(p,h,a):p}}function c(h){var f=!1;return h.forEach(function(o,a,u){Ie(o)&&(f=!0,u[a]=o.toNumber())}),f}function l(h){h.forEach(function(f){if(typeof f!="number"||!Ye(f)||f<0)throw new Error("Parameters in function zeros must be positive integers")})}}),Xa="format",wf=["typed"],xf=K(Xa,wf,i=>{var{typed:e}=i;return e(Xa,{any:qe,"any, Object | function | number":qe})}),bf="numeric",Mf=["number","?bignumber","?fraction"],_f=K(bf,Mf,i=>{var{number:e,bignumber:t,fraction:r}=i,n={string:!0,number:!0,BigNumber:!0,Fraction:!0},s={number:c=>e(c),BigNumber:t?c=>t(c):nf,Fraction:r?c=>r(c):sf};return function(l,h){var f=ot(l);if(!(f in n))throw new TypeError("Cannot convert "+l+' of type "'+f+'"; valid input types are '+Object.keys(n).join(", "));if(!(h in s))throw new TypeError("Cannot convert "+l+' to type "'+h+'"; valid output types are '+Object.keys(s).join(", "));return h===f?l:s[h](l)}}),Ka="divideScalar",Nf=["typed","numeric"],Sf=K(Ka,Nf,i=>{var{typed:e,numeric:t}=i;return e(Ka,{"number, number":function(n,s){return n/s},"Complex, Complex":function(n,s){return n.div(s)},"BigNumber, BigNumber":function(n,s){return n.div(s)},"Fraction, Fraction":function(n,s){return n.div(s)},"Unit, number | Fraction | BigNumber":function(n,s){var c=n.clone(),l=t(1,ot(s));return c.value=this(c.value===null?c._normalize(l):c.value,s),c},"number | Fraction | BigNumber, Unit":function(n,s){var c=s.clone();c=c.pow(-1);var l=t(1,ot(n));return c.value=this(n,s.value===null?s._normalize(l):s.value),c},"Unit, Unit":function(n,s){return n.divide(s)}})}),eo="pow",Ef=["typed","config","identity","multiply","matrix","fraction","number","Complex"],Of=K(eo,Ef,i=>{var{typed:e,config:t,identity:r,multiply:n,matrix:s,number:c,fraction:l,Complex:h}=i;return e(eo,{"number, number":f,"Complex, Complex":function(p,m){return p.pow(m)},"BigNumber, BigNumber":function(p,m){return m.isInteger()||p>=0||t.predictable?p.pow(m):new h(p.toNumber(),0).pow(m.toNumber(),0)},"Fraction, Fraction":function(p,m){if(m.d!==1){if(t.predictable)throw new Error("Function pow does not support non-integer exponents for fractions.");return f(p.valueOf(),m.valueOf())}else return p.pow(m)},"Array, number":o,"Array, BigNumber":function(p,m){return o(p,m.toNumber())},"Matrix, number":a,"Matrix, BigNumber":function(p,m){return a(p,m.toNumber())},"Unit, number | BigNumber":function(p,m){return p.pow(m)}});function f(u,p){if(t.predictable&&!Ye(p)&&u<0)try{var m=l(p),d=c(m);if((p===d||Math.abs((p-d)/p)<1e-14)&&m.d%2===1)return(m.n%2===0?1:-1)*Math.pow(-u,p)}catch{}return t.predictable&&(u<-1&&p===1/0||u>-1&&u<0&&p===-1/0)?NaN:Ye(p)||u>=0||t.predictable?Da(u,p):u*u<1&&p===1/0||u*u>1&&p===-1/0?0:new h(u,0).pow(p,0)}function o(u,p){if(!Ye(p)||p<0)throw new TypeError("For A^b, b must be a positive integer (value is "+p+")");var m=yt(u);if(m.length!==2)throw new Error("For A^b, A must be 2 dimensional (A has "+m.length+" dimensions)");if(m[0]!==m[1])throw new Error("For A^b, A must be square (size is "+m[0]+"x"+m[1]+")");for(var d=r(m[0]).valueOf(),w=u;p>=1;)(p&1)===1&&(d=n(w,d)),p>>=1,w=n(w,w);return d}function a(u,p){return s(o(u.valueOf(),p))}});function to(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(i,n).enumerable})),t.push.apply(t,r)}return t}function ro(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?to(Object(t),!0).forEach(function(r){zf(i,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):to(Object(t)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(t,r))})}return i}function zf(i,e,t){return e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}var Ar="Number of decimals in function round must be an integer",no="round",Af=["typed","matrix","equalScalar","zeros","BigNumber","DenseMatrix"],Cf=K(no,Af,i=>{var{typed:e,matrix:t,equalScalar:r,zeros:n,BigNumber:s,DenseMatrix:c}=i,l=Or({typed:e,equalScalar:r}),h=Wr({typed:e,DenseMatrix:c}),f=xt({typed:e});return e(no,ro(ro({},Tf),{},{Complex:function(a){return a.round()},"Complex, number":function(a,u){if(u%1)throw new TypeError(Ar);return a.round(u)},"Complex, BigNumber":function(a,u){if(!u.isInteger())throw new TypeError(Ar);var p=u.toNumber();return a.round(p)},"number, BigNumber":function(a,u){if(!u.isInteger())throw new TypeError(Ar);return new s(a).toDecimalPlaces(u.toNumber())},BigNumber:function(a){return a.toDecimalPlaces(0)},"BigNumber, BigNumber":function(a,u){if(!u.isInteger())throw new TypeError(Ar);return a.toDecimalPlaces(u.toNumber())},Fraction:function(a){return a.round()},"Fraction, number":function(a,u){if(u%1)throw new TypeError(Ar);return a.round(u)},"Array | Matrix":function(a){return Xe(a,this)},"SparseMatrix, number | BigNumber":function(a,u){return l(a,u,this,!1)},"DenseMatrix, number | BigNumber":function(a,u){return f(a,u,this,!1)},"number | Complex | BigNumber, SparseMatrix":function(a,u){return r(a,0)?n(u.size(),u.storage()):h(u,a,this,!0)},"number | Complex | BigNumber, DenseMatrix":function(a,u){return r(a,0)?n(u.size(),u.storage()):f(u,a,this,!0)},"Array, number | BigNumber":function(a,u){return f(t(a),u,this,!1).valueOf()},"number | Complex | BigNumber, Array":function(a,u){return f(t(u),a,this,!0).valueOf()}}))}),Tf={number:Ci,"number, number":function(e,t){if(!Ye(t))throw new TypeError(Ar);if(t<0||t>15)throw new Error("Number of decimals in function round must be in te range of 0-15");return Ci(e,t)}},Bn="equal",Ff=["typed","matrix","equalScalar","DenseMatrix"],Df=K(Bn,Ff,i=>{var{typed:e,matrix:t,equalScalar:r,DenseMatrix:n}=i,s=Gr({typed:e}),c=Ti({typed:e,DenseMatrix:n}),l=Wr({typed:e,DenseMatrix:n}),h=zr({typed:e}),f=xt({typed:e});return e(Bn,{"any, any":function(a,u){return a===null?u===null:u===null?a===null:a===void 0?u===void 0:u===void 0?a===void 0:r(a,u)},"SparseMatrix, SparseMatrix":function(a,u){return c(a,u,r)},"SparseMatrix, DenseMatrix":function(a,u){return s(u,a,r,!0)},"DenseMatrix, SparseMatrix":function(a,u){return s(a,u,r,!1)},"DenseMatrix, DenseMatrix":function(a,u){return h(a,u,r)},"Array, Array":function(a,u){return this(t(a),t(u)).valueOf()},"Array, Matrix":function(a,u){return this(t(a),u)},"Matrix, Array":function(a,u){return this(a,t(u))},"SparseMatrix, any":function(a,u){return l(a,u,r,!1)},"DenseMatrix, any":function(a,u){return f(a,u,r,!1)},"any, SparseMatrix":function(a,u){return l(u,a,r,!0)},"any, DenseMatrix":function(a,u){return f(u,a,r,!0)},"Array, any":function(a,u){return f(t(a),u,r,!1).valueOf()},"any, Array":function(a,u){return f(t(u),a,r,!0).valueOf()}})});K(Bn,["typed","equalScalar"],i=>{var{typed:e,equalScalar:t}=i;return e(Bn,{"any, any":function(n,s){return n===null?s===null:s===null?n===null:n===void 0?s===void 0:s===void 0?n===void 0:t(n,s)}})});var io="smaller",If=["typed","config","matrix","DenseMatrix"],Bf=K(io,If,i=>{var{typed:e,config:t,matrix:r,DenseMatrix:n}=i,s=Gr({typed:e}),c=Ti({typed:e,DenseMatrix:n}),l=Wr({typed:e,DenseMatrix:n}),h=zr({typed:e}),f=xt({typed:e});return e(io,{"boolean, boolean":function(a,u){return a<u},"number, number":function(a,u){return a<u&&!At(a,u,t.epsilon)},"BigNumber, BigNumber":function(a,u){return a.lt(u)&&!lr(a,u,t.epsilon)},"Fraction, Fraction":function(a,u){return a.compare(u)===-1},"Complex, Complex":function(a,u){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(a,u){if(!a.equalBase(u))throw new Error("Cannot compare units with different base");return this(a.value,u.value)},"SparseMatrix, SparseMatrix":function(a,u){return c(a,u,this)},"SparseMatrix, DenseMatrix":function(a,u){return s(u,a,this,!0)},"DenseMatrix, SparseMatrix":function(a,u){return s(a,u,this,!1)},"DenseMatrix, DenseMatrix":function(a,u){return h(a,u,this)},"Array, Array":function(a,u){return this(r(a),r(u)).valueOf()},"Array, Matrix":function(a,u){return this(r(a),u)},"Matrix, Array":function(a,u){return this(a,r(u))},"SparseMatrix, any":function(a,u){return l(a,u,this,!1)},"DenseMatrix, any":function(a,u){return f(a,u,this,!1)},"any, SparseMatrix":function(a,u){return l(u,a,this,!0)},"any, DenseMatrix":function(a,u){return f(u,a,this,!0)},"Array, any":function(a,u){return f(r(a),u,this,!1).valueOf()},"any, Array":function(a,u){return f(r(u),a,this,!0).valueOf()}})}),so="larger",Rf=["typed","config","matrix","DenseMatrix"],Pf=K(so,Rf,i=>{var{typed:e,config:t,matrix:r,DenseMatrix:n}=i,s=Gr({typed:e}),c=Ti({typed:e,DenseMatrix:n}),l=Wr({typed:e,DenseMatrix:n}),h=zr({typed:e}),f=xt({typed:e});return e(so,{"boolean, boolean":function(a,u){return a>u},"number, number":function(a,u){return a>u&&!At(a,u,t.epsilon)},"BigNumber, BigNumber":function(a,u){return a.gt(u)&&!lr(a,u,t.epsilon)},"Fraction, Fraction":function(a,u){return a.compare(u)===1},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(a,u){if(!a.equalBase(u))throw new Error("Cannot compare units with different base");return this(a.value,u.value)},"SparseMatrix, SparseMatrix":function(a,u){return c(a,u,this)},"SparseMatrix, DenseMatrix":function(a,u){return s(u,a,this,!0)},"DenseMatrix, SparseMatrix":function(a,u){return s(a,u,this,!1)},"DenseMatrix, DenseMatrix":function(a,u){return h(a,u,this)},"Array, Array":function(a,u){return this(r(a),r(u)).valueOf()},"Array, Matrix":function(a,u){return this(r(a),u)},"Matrix, Array":function(a,u){return this(a,r(u))},"SparseMatrix, any":function(a,u){return l(a,u,this,!1)},"DenseMatrix, any":function(a,u){return f(a,u,this,!1)},"any, SparseMatrix":function(a,u){return l(u,a,this,!0)},"any, DenseMatrix":function(a,u){return f(u,a,this,!0)},"Array, any":function(a,u){return f(r(a),u,this,!1).valueOf()},"any, Array":function(a,u){return f(r(u),a,this,!0).valueOf()}})}),kf="FibonacciHeap",Lf=["smaller","larger"],Uf=K(kf,Lf,i=>{var{smaller:e,larger:t}=i,r=1/Math.log((1+Math.sqrt(5))/2);function n(){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");this._minimum=null,this._size=0}n.prototype.type="FibonacciHeap",n.prototype.isFibonacciHeap=!0,n.prototype.insert=function(o,a){var u={key:o,value:a,degree:0};if(this._minimum){var p=this._minimum;u.left=p,u.right=p.right,p.right=u,u.right.left=u,e(o,p.key)&&(this._minimum=u)}else u.left=u,u.right=u,this._minimum=u;return this._size++,u},n.prototype.size=function(){return this._size},n.prototype.clear=function(){this._minimum=null,this._size=0},n.prototype.isEmpty=function(){return this._size===0},n.prototype.extractMinimum=function(){var o=this._minimum;if(o===null)return o;for(var a=this._minimum,u=o.degree,p=o.child;u>0;){var m=p.right;p.left.right=p.right,p.right.left=p.left,p.left=a,p.right=a.right,a.right=p,p.right.left=p,p.parent=null,p=m,u--}return o.left.right=o.right,o.right.left=o.left,o===o.right?a=null:(a=o.right,a=f(a,this._size)),this._size--,this._minimum=a,o},n.prototype.remove=function(o){this._minimum=s(this._minimum,o,-1),this.extractMinimum()};function s(o,a,u){a.key=u;var p=a.parent;return p&&e(a.key,p.key)&&(c(o,a,p),l(o,p)),e(a.key,o.key)&&(o=a),o}function c(o,a,u){a.left.right=a.right,a.right.left=a.left,u.degree--,u.child===a&&(u.child=a.right),u.degree===0&&(u.child=null),a.left=o,a.right=o.right,o.right=a,a.right.left=a,a.parent=null,a.mark=!1}function l(o,a){var u=a.parent;!u||(a.mark?(c(o,a,u),l(u)):a.mark=!0)}var h=function(a,u){a.left.right=a.right,a.right.left=a.left,a.parent=u,u.child?(a.left=u.child,a.right=u.child.right,u.child.right=a,a.right.left=a):(u.child=a,a.right=a,a.left=a),u.degree++,a.mark=!1};function f(o,a){var u=Math.floor(Math.log(a)*r)+1,p=new Array(u),m=0,d=o;if(d)for(m++,d=d.right;d!==o;)m++,d=d.right;for(var w;m>0;){for(var v=d.degree,x=d.right;w=p[v],!!w;){if(t(d.key,w.key)){var g=w;w=d,d=g}h(w,d),p[v]=null,v++}p[v]=d,d=x,m--}o=null;for(var b=0;b<u;b++)w=p[b],!!w&&(o?(w.left.right=w.right,w.right.left=w.left,w.left=o,w.right=o.right,o.right=w,w.right.left=w,e(w.key,o.key)&&(o=w)):o=w);return o}return n},{isClass:!0}),$f="Spa",qf=["addScalar","equalScalar","FibonacciHeap"],Vf=K($f,qf,i=>{var{addScalar:e,equalScalar:t,FibonacciHeap:r}=i;function n(){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");this._values=[],this._heap=new r}return n.prototype.type="Spa",n.prototype.isSpa=!0,n.prototype.set=function(s,c){if(this._values[s])this._values[s].value=c;else{var l=this._heap.insert(s,c);this._values[s]=l}},n.prototype.get=function(s){var c=this._values[s];return c?c.value:0},n.prototype.accumulate=function(s,c){var l=this._values[s];l?l.value=e(l.value,c):(l=this._heap.insert(s,c),this._values[s]=l)},n.prototype.forEach=function(s,c,l){var h=this._heap,f=this._values,o=[],a=h.extractMinimum();for(a&&o.push(a);a&&a.key<=c;)a.key>=s&&(t(a.value,0)||l(a.key,a.value,this)),a=h.extractMinimum(),a&&o.push(a);for(var u=0;u<o.length;u++){var p=o[u];a=h.insert(p.key,p.value),f[a.key]=a}},n.prototype.swap=function(s,c){var l=this._values[s],h=this._values[c];if(!l&&h)l=this._heap.insert(s,h.value),this._heap.remove(h),this._values[s]=l,this._values[c]=void 0;else if(l&&!h)h=this._heap.insert(c,l.value),this._heap.remove(l),this._values[c]=h,this._values[s]=void 0;else if(l&&h){var f=l.value;l.value=h.value,h.value=f}},n},{isClass:!0});Yr(function(i){return new i(1).exp()},{hasher:Rn}),Yr(function(i){return new i(1).plus(new i(5).sqrt()).div(2)},{hasher:Rn});var ao=Yr(function(i){return i.acos(-1)},{hasher:Rn});Yr(function(i){return ao(i).times(2)},{hasher:Rn});function Rn(i){return i[0].precision}function Zr(){return Zr=Object.assign||function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},Zr.apply(this,arguments)}function oo(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(i,n).enumerable})),t.push.apply(t,r)}return t}function Ii(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?oo(Object(t),!0).forEach(function(r){jf(i,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):oo(Object(t)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(t,r))})}return i}function jf(i,e,t){return e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}var Hf="Unit",Gf=["?on","config","addScalar","subtract","multiplyScalar","divideScalar","pow","abs","fix","round","equal","isNumeric","format","number","Complex","BigNumber","Fraction"],Wf=K(Hf,Gf,i=>{var{on:e,config:t,addScalar:r,subtract:n,multiplyScalar:s,divideScalar:c,pow:l,abs:h,fix:f,round:o,equal:a,isNumeric:u,format:p,number:m,Complex:d,BigNumber:w,Fraction:v}=i,x=m;function g(T,R){if(!(this instanceof g))throw new Error("Constructor must be called with the new operator");if(!(T==null||u(T)||Lt(T)))throw new TypeError("First parameter in Unit constructor must be number, BigNumber, Fraction, Complex, or undefined");if(R!==void 0&&(typeof R!="string"||R===""))throw new TypeError("Second parameter in Unit constructor must be a string");if(R!==void 0){var Y=g.parse(R);this.units=Y.units,this.dimensions=Y.dimensions}else{this.units=[{unit:ue,prefix:S.NONE,power:0}],this.dimensions=[];for(var Q=0;Q<J.length;Q++)this.dimensions[Q]=0}this.value=T!=null?this._normalize(T):null,this.fixPrefix=!1,this.skipAutomaticSimplification=!0}g.prototype.type="Unit",g.prototype.isUnit=!0;var b,M,_;function N(){for(;_===" "||_==="	";)F()}function O(T){return T>="0"&&T<="9"||T==="."}function E(T){return T>="0"&&T<="9"}function F(){M++,_=b.charAt(M)}function B(T){M=T,_=b.charAt(M)}function I(){var T="",R=M;if(_==="+"?F():_==="-"&&(T+=_,F()),!O(_))return B(R),null;if(_==="."){if(T+=_,F(),!E(_))return B(R),null}else{for(;E(_);)T+=_,F();_==="."&&(T+=_,F())}for(;E(_);)T+=_,F();if(_==="E"||_==="e"){var Y="",Q=M;if(Y+=_,F(),(_==="+"||_==="-")&&(Y+=_,F()),!E(_))return B(Q),T;for(T=T+Y;E(_);)T+=_,F()}return T}function j(){for(var T="";E(_)||g.isValidAlpha(_);)T+=_,F();var R=T.charAt(0);return g.isValidAlpha(R)?T:null}function q(T){return _===T?(F(),T):null}g.parse=function(T,R){if(R=R||{},b=T,M=-1,_="",typeof b!="string")throw new TypeError("Invalid argument in Unit.parse, string expected");var Y=new g;Y.units=[];var Q=1,C=!1;F(),N();var P=I(),U=null;if(P){if(t.number==="BigNumber")U=new w(P);else if(t.number==="Fraction")try{U=new v(P)}catch{U=parseFloat(P)}else U=parseFloat(P);N(),q("*")?(Q=1,C=!0):q("/")&&(Q=-1,C=!0)}for(var L=[],W=1;;){for(N();_==="(";)L.push(Q),W*=Q,Q=1,F(),N();var re=void 0;if(_){var ne=_;if(re=j(),re===null)throw new SyntaxError('Unexpected "'+ne+'" in "'+b+'" at index '+M.toString())}else break;var te=H(re);if(te===null)throw new SyntaxError('Unit "'+re+'" not found.');var ee=Q*W;if(N(),q("^")){N();var le=I();if(le===null)throw new SyntaxError('In "'+T+'", "^" must be followed by a floating-point number');ee*=le}Y.units.push({unit:te.unit,prefix:te.prefix,power:ee});for(var je=0;je<J.length;je++)Y.dimensions[je]+=(te.unit.dimensions[je]||0)*ee;for(N();_===")";){if(L.length===0)throw new SyntaxError('Unmatched ")" in "'+b+'" at index '+M.toString());W/=L.pop(),F(),N()}if(C=!1,q("*")?(Q=1,C=!0):q("/")?(Q=-1,C=!0):Q=1,te.unit.base){var Ke=te.unit.base.key;se.auto[Ke]={unit:te.unit,prefix:te.prefix}}}if(N(),_)throw new SyntaxError('Could not parse: "'+T+'"');if(C)throw new SyntaxError('Trailing characters: "'+T+'"');if(L.length!==0)throw new SyntaxError('Unmatched "(" in "'+b+'"');if(Y.units.length===0&&!R.allowNoUnits)throw new SyntaxError('"'+T+'" contains no units');return Y.value=U!==void 0?Y._normalize(U):null,Y},g.prototype.clone=function(){var T=new g;T.fixPrefix=this.fixPrefix,T.skipAutomaticSimplification=this.skipAutomaticSimplification,T.value=Ee(this.value),T.dimensions=this.dimensions.slice(0),T.units=[];for(var R=0;R<this.units.length;R++){T.units[R]={};for(var Y in this.units[R])ae(this.units[R],Y)&&(T.units[R][Y]=this.units[R][Y])}return T},g.prototype._isDerived=function(){return this.units.length===0?!1:this.units.length>1||Math.abs(this.units[0].power-1)>1e-15},g.prototype._normalize=function(T){var R,Y,Q,C,P;if(T==null||this.units.length===0)return T;if(this._isDerived()){var U=T;P=g._getNumberConverter(ot(T));for(var L=0;L<this.units.length;L++)R=P(this.units[L].unit.value),C=P(this.units[L].prefix.value),Q=P(this.units[L].power),U=s(U,l(s(R,C),Q));return U}else return P=g._getNumberConverter(ot(T)),R=P(this.units[0].unit.value),Y=P(this.units[0].unit.offset),C=P(this.units[0].prefix.value),s(r(T,Y),s(R,C))},g.prototype._denormalize=function(T,R){var Y,Q,C,P,U;if(T==null||this.units.length===0)return T;if(this._isDerived()){var L=T;U=g._getNumberConverter(ot(T));for(var W=0;W<this.units.length;W++)Y=U(this.units[W].unit.value),P=U(this.units[W].prefix.value),C=U(this.units[W].power),L=c(L,l(s(Y,P),C));return L}else return U=g._getNumberConverter(ot(T)),Y=U(this.units[0].unit.value),P=U(this.units[0].prefix.value),Q=U(this.units[0].unit.offset),R==null?n(c(c(T,Y),P),Q):n(c(c(T,Y),R),Q)};var H=Yr(T=>{if(ae(V,T)){var R=V[T],Y=R.prefixes[""];return{unit:R,prefix:Y}}for(var Q in V)if(ae(V,Q)&&mc(T,Q)){var C=V[Q],P=T.length-Q.length,U=T.substring(0,P),L=ae(C.prefixes,U)?C.prefixes[U]:void 0;if(L!==void 0)return{unit:C,prefix:L}}return null},{hasher:T=>T[0],limit:100});g.isValuelessUnit=function(T){return H(T)!==null},g.prototype.hasBase=function(T){if(typeof T=="string"&&(T=A[T]),!T)return!1;for(var R=0;R<J.length;R++)if(Math.abs((this.dimensions[R]||0)-(T.dimensions[R]||0))>1e-12)return!1;return!0},g.prototype.equalBase=function(T){for(var R=0;R<J.length;R++)if(Math.abs((this.dimensions[R]||0)-(T.dimensions[R]||0))>1e-12)return!1;return!0},g.prototype.equals=function(T){return this.equalBase(T)&&a(this.value,T.value)},g.prototype.multiply=function(T){for(var R=this.clone(),Y=0;Y<J.length;Y++)R.dimensions[Y]=(this.dimensions[Y]||0)+(T.dimensions[Y]||0);for(var Q=0;Q<T.units.length;Q++){var C=Ii({},T.units[Q]);R.units.push(C)}if(this.value!==null||T.value!==null){var P=this.value===null?this._normalize(1):this.value,U=T.value===null?T._normalize(1):T.value;R.value=s(P,U)}else R.value=null;return R.skipAutomaticSimplification=!1,k(R)},g.prototype.divide=function(T){for(var R=this.clone(),Y=0;Y<J.length;Y++)R.dimensions[Y]=(this.dimensions[Y]||0)-(T.dimensions[Y]||0);for(var Q=0;Q<T.units.length;Q++){var C=Ii(Ii({},T.units[Q]),{},{power:-T.units[Q].power});R.units.push(C)}if(this.value!==null||T.value!==null){var P=this.value===null?this._normalize(1):this.value,U=T.value===null?T._normalize(1):T.value;R.value=c(P,U)}else R.value=null;return R.skipAutomaticSimplification=!1,k(R)},g.prototype.pow=function(T){for(var R=this.clone(),Y=0;Y<J.length;Y++)R.dimensions[Y]=(this.dimensions[Y]||0)*T;for(var Q=0;Q<R.units.length;Q++)R.units[Q].power*=T;return R.value!==null?R.value=l(R.value,T):R.value=null,R.skipAutomaticSimplification=!1,k(R)};function k(T){return T.equalBase(A.NONE)&&T.value!==null&&!t.predictable?T.value:T}g.prototype.abs=function(){var T=this.clone();T.value=T.value!==null?h(T.value):null;for(var R in T.units)(T.units[R].unit.name==="VA"||T.units[R].unit.name==="VAR")&&(T.units[R].unit=V.W);return T},g.prototype.to=function(T){var R,Y=this.value===null?this._normalize(1):this.value;if(typeof T=="string"){if(R=g.parse(T),!this.equalBase(R))throw new Error("Units do not match ('".concat(R.toString(),"' != '").concat(this.toString(),"')"));if(R.value!==null)throw new Error("Cannot convert to a unit with a value");return R.value=Ee(Y),R.fixPrefix=!0,R.skipAutomaticSimplification=!0,R}else if(ar(T)){if(!this.equalBase(T))throw new Error("Units do not match ('".concat(T.toString(),"' != '").concat(this.toString(),"')"));if(T.value!==null)throw new Error("Cannot convert to a unit with a value");return R=T.clone(),R.value=Ee(Y),R.fixPrefix=!0,R.skipAutomaticSimplification=!0,R}else throw new Error("String or Unit expected as parameter")},g.prototype.toNumber=function(T){return x(this.toNumeric(T))},g.prototype.toNumeric=function(T){var R;return T?R=this.to(T):R=this.clone(),R._isDerived()||R.units.length===0?R._denormalize(R.value):R._denormalize(R.value,R.units[0].prefix.value)},g.prototype.toString=function(){return this.format()},g.prototype.toJSON=function(){return{mathjs:"Unit",value:this._denormalize(this.value),unit:this.formatUnits(),fixPrefix:this.fixPrefix}},g.fromJSON=function(T){var R=new g(T.value,T.unit);return R.fixPrefix=T.fixPrefix||!1,R},g.prototype.valueOf=g.prototype.toString,g.prototype.simplify=function(){var T=this.clone(),R=[],Y;for(var Q in me)if(ae(me,Q)&&T.hasBase(A[Q])){Y=Q;break}if(Y==="NONE")T.units=[];else{var C;if(Y&&ae(me,Y)&&(C=me[Y]),C)T.units=[{unit:C.unit,prefix:C.prefix,power:1}];else{for(var P=!1,U=0;U<J.length;U++){var L=J[U];Math.abs(T.dimensions[U]||0)>1e-12&&(ae(me,L)?R.push({unit:me[L].unit,prefix:me[L].prefix,power:T.dimensions[U]||0}):P=!0)}R.length<T.units.length&&!P&&(T.units=R)}}return T},g.prototype.toSI=function(){for(var T=this.clone(),R=[],Y=0;Y<J.length;Y++){var Q=J[Y];if(Math.abs(T.dimensions[Y]||0)>1e-12)if(ae(se.si,Q))R.push({unit:se.si[Q].unit,prefix:se.si[Q].prefix,power:T.dimensions[Y]||0});else throw new Error("Cannot express custom unit "+Q+" in SI units")}return T.units=R,T.fixPrefix=!0,T.skipAutomaticSimplification=!0,T},g.prototype.formatUnits=function(){for(var T="",R="",Y=0,Q=0,C=0;C<this.units.length;C++)this.units[C].power>0?(Y++,T+=" "+this.units[C].prefix.name+this.units[C].unit.name,Math.abs(this.units[C].power-1)>1e-15&&(T+="^"+this.units[C].power)):this.units[C].power<0&&Q++;if(Q>0)for(var P=0;P<this.units.length;P++)this.units[P].power<0&&(Y>0?(R+=" "+this.units[P].prefix.name+this.units[P].unit.name,Math.abs(this.units[P].power+1)>1e-15&&(R+="^"+-this.units[P].power)):(R+=" "+this.units[P].prefix.name+this.units[P].unit.name,R+="^"+this.units[P].power));T=T.substr(1),R=R.substr(1),Y>1&&Q>0&&(T="("+T+")"),Q>1&&Y>0&&(R="("+R+")");var U=T;return Y>0&&Q>0&&(U+=" / "),U+=R,U},g.prototype.format=function(T){var R=this.skipAutomaticSimplification||this.value===null?this.clone():this.simplify(),Y=!1;typeof R.value!="undefined"&&R.value!==null&&Lt(R.value)&&(Y=Math.abs(R.value.re)<1e-14);for(var Q in R.units)ae(R.units,Q)&&R.units[Q].unit&&(R.units[Q].unit.name==="VA"&&Y?R.units[Q].unit=V.VAR:R.units[Q].unit.name==="VAR"&&!Y&&(R.units[Q].unit=V.VA));R.units.length===1&&!R.fixPrefix&&Math.abs(R.units[0].power-Math.round(R.units[0].power))<1e-14&&(R.units[0].prefix=R._bestPrefix());var C=R._denormalize(R.value),P=R.value!==null?p(C,T||{}):"",U=R.formatUnits();return R.value&&Lt(R.value)&&(P="("+P+")"),U.length>0&&P.length>0&&(P+=" "),P+=U,P},g.prototype._bestPrefix=function(){if(this.units.length!==1)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");if(Math.abs(this.units[0].power-Math.round(this.units[0].power))>=1e-14)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");var T=this.value!==null?h(this.value):0,R=h(this.units[0].unit.value),Y=this.units[0].prefix;if(T===0)return Y;var Q=this.units[0].power,C=Math.log(T/Math.pow(Y.value*R,Q))/Math.LN10-1.2;if(C>-2.200001&&C<1.800001)return Y;C=Math.abs(C);var P=this.units[0].unit.prefixes;for(var U in P)if(ae(P,U)){var L=P[U];if(L.scientific){var W=Math.abs(Math.log(T/Math.pow(L.value*R,Q))/Math.LN10-1.2);(W<C||W===C&&L.name.length<Y.name.length)&&(Y=L,C=W)}}return Y},g.prototype.splitUnit=function(T){for(var R=this.clone(),Y=[],Q=0;Q<T.length&&(R=R.to(T[Q]),Q!==T.length-1);Q++){var C=R.toNumeric(),P=o(C),U=void 0,L=a(P,C);L?U=P:U=f(R.toNumeric());var W=new g(U,T[Q].toString());Y.push(W),R=n(R,W)}for(var re=0,ne=0;ne<Y.length;ne++)re=r(re,Y[ne].value);return a(re,this.value)&&(R.value=0),Y.push(R),Y};var S={NONE:{"":{name:"",value:1,scientific:!0}},SHORT:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:10,scientific:!1},h:{name:"h",value:100,scientific:!1},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0},d:{name:"d",value:.1,scientific:!1},c:{name:"c",value:.01,scientific:!1},m:{name:"m",value:.001,scientific:!0},u:{name:"u",value:1e-6,scientific:!0},n:{name:"n",value:1e-9,scientific:!0},p:{name:"p",value:1e-12,scientific:!0},f:{name:"f",value:1e-15,scientific:!0},a:{name:"a",value:1e-18,scientific:!0},z:{name:"z",value:1e-21,scientific:!0},y:{name:"y",value:1e-24,scientific:!0}},LONG:{"":{name:"",value:1,scientific:!0},deca:{name:"deca",value:10,scientific:!1},hecto:{name:"hecto",value:100,scientific:!1},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0},deci:{name:"deci",value:.1,scientific:!1},centi:{name:"centi",value:.01,scientific:!1},milli:{name:"milli",value:.001,scientific:!0},micro:{name:"micro",value:1e-6,scientific:!0},nano:{name:"nano",value:1e-9,scientific:!0},pico:{name:"pico",value:1e-12,scientific:!0},femto:{name:"femto",value:1e-15,scientific:!0},atto:{name:"atto",value:1e-18,scientific:!0},zepto:{name:"zepto",value:1e-21,scientific:!0},yocto:{name:"yocto",value:1e-24,scientific:!0}},SQUARED:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:100,scientific:!1},h:{name:"h",value:1e4,scientific:!1},k:{name:"k",value:1e6,scientific:!0},M:{name:"M",value:1e12,scientific:!0},G:{name:"G",value:1e18,scientific:!0},T:{name:"T",value:1e24,scientific:!0},P:{name:"P",value:1e30,scientific:!0},E:{name:"E",value:1e36,scientific:!0},Z:{name:"Z",value:1e42,scientific:!0},Y:{name:"Y",value:1e48,scientific:!0},d:{name:"d",value:.01,scientific:!1},c:{name:"c",value:1e-4,scientific:!1},m:{name:"m",value:1e-6,scientific:!0},u:{name:"u",value:1e-12,scientific:!0},n:{name:"n",value:1e-18,scientific:!0},p:{name:"p",value:1e-24,scientific:!0},f:{name:"f",value:1e-30,scientific:!0},a:{name:"a",value:1e-36,scientific:!0},z:{name:"z",value:1e-42,scientific:!0},y:{name:"y",value:1e-48,scientific:!0}},CUBIC:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:1e3,scientific:!1},h:{name:"h",value:1e6,scientific:!1},k:{name:"k",value:1e9,scientific:!0},M:{name:"M",value:1e18,scientific:!0},G:{name:"G",value:1e27,scientific:!0},T:{name:"T",value:1e36,scientific:!0},P:{name:"P",value:1e45,scientific:!0},E:{name:"E",value:1e54,scientific:!0},Z:{name:"Z",value:1e63,scientific:!0},Y:{name:"Y",value:1e72,scientific:!0},d:{name:"d",value:.001,scientific:!1},c:{name:"c",value:1e-6,scientific:!1},m:{name:"m",value:1e-9,scientific:!0},u:{name:"u",value:1e-18,scientific:!0},n:{name:"n",value:1e-27,scientific:!0},p:{name:"p",value:1e-36,scientific:!0},f:{name:"f",value:1e-45,scientific:!0},a:{name:"a",value:1e-54,scientific:!0},z:{name:"z",value:1e-63,scientific:!0},y:{name:"y",value:1e-72,scientific:!0}},BINARY_SHORT_SI:{"":{name:"",value:1,scientific:!0},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0}},BINARY_SHORT_IEC:{"":{name:"",value:1,scientific:!0},Ki:{name:"Ki",value:1024,scientific:!0},Mi:{name:"Mi",value:Math.pow(1024,2),scientific:!0},Gi:{name:"Gi",value:Math.pow(1024,3),scientific:!0},Ti:{name:"Ti",value:Math.pow(1024,4),scientific:!0},Pi:{name:"Pi",value:Math.pow(1024,5),scientific:!0},Ei:{name:"Ei",value:Math.pow(1024,6),scientific:!0},Zi:{name:"Zi",value:Math.pow(1024,7),scientific:!0},Yi:{name:"Yi",value:Math.pow(1024,8),scientific:!0}},BINARY_LONG_SI:{"":{name:"",value:1,scientific:!0},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0}},BINARY_LONG_IEC:{"":{name:"",value:1,scientific:!0},kibi:{name:"kibi",value:1024,scientific:!0},mebi:{name:"mebi",value:Math.pow(1024,2),scientific:!0},gibi:{name:"gibi",value:Math.pow(1024,3),scientific:!0},tebi:{name:"tebi",value:Math.pow(1024,4),scientific:!0},pebi:{name:"pebi",value:Math.pow(1024,5),scientific:!0},exi:{name:"exi",value:Math.pow(1024,6),scientific:!0},zebi:{name:"zebi",value:Math.pow(1024,7),scientific:!0},yobi:{name:"yobi",value:Math.pow(1024,8),scientific:!0}},BTU:{"":{name:"",value:1,scientific:!0},MM:{name:"MM",value:1e6,scientific:!0}}};S.SHORTLONG=Zr({},S.SHORT,S.LONG),S.BINARY_SHORT=Zr({},S.BINARY_SHORT_SI,S.BINARY_SHORT_IEC),S.BINARY_LONG=Zr({},S.BINARY_LONG_SI,S.BINARY_LONG_IEC);var J=["MASS","LENGTH","TIME","CURRENT","TEMPERATURE","LUMINOUS_INTENSITY","AMOUNT_OF_SUBSTANCE","ANGLE","BIT"],A={NONE:{dimensions:[0,0,0,0,0,0,0,0,0]},MASS:{dimensions:[1,0,0,0,0,0,0,0,0]},LENGTH:{dimensions:[0,1,0,0,0,0,0,0,0]},TIME:{dimensions:[0,0,1,0,0,0,0,0,0]},CURRENT:{dimensions:[0,0,0,1,0,0,0,0,0]},TEMPERATURE:{dimensions:[0,0,0,0,1,0,0,0,0]},LUMINOUS_INTENSITY:{dimensions:[0,0,0,0,0,1,0,0,0]},AMOUNT_OF_SUBSTANCE:{dimensions:[0,0,0,0,0,0,1,0,0]},FORCE:{dimensions:[1,1,-2,0,0,0,0,0,0]},SURFACE:{dimensions:[0,2,0,0,0,0,0,0,0]},VOLUME:{dimensions:[0,3,0,0,0,0,0,0,0]},ENERGY:{dimensions:[1,2,-2,0,0,0,0,0,0]},POWER:{dimensions:[1,2,-3,0,0,0,0,0,0]},PRESSURE:{dimensions:[1,-1,-2,0,0,0,0,0,0]},ELECTRIC_CHARGE:{dimensions:[0,0,1,1,0,0,0,0,0]},ELECTRIC_CAPACITANCE:{dimensions:[-1,-2,4,2,0,0,0,0,0]},ELECTRIC_POTENTIAL:{dimensions:[1,2,-3,-1,0,0,0,0,0]},ELECTRIC_RESISTANCE:{dimensions:[1,2,-3,-2,0,0,0,0,0]},ELECTRIC_INDUCTANCE:{dimensions:[1,2,-2,-2,0,0,0,0,0]},ELECTRIC_CONDUCTANCE:{dimensions:[-1,-2,3,2,0,0,0,0,0]},MAGNETIC_FLUX:{dimensions:[1,2,-2,-1,0,0,0,0,0]},MAGNETIC_FLUX_DENSITY:{dimensions:[1,0,-2,-1,0,0,0,0,0]},FREQUENCY:{dimensions:[0,0,-1,0,0,0,0,0,0]},ANGLE:{dimensions:[0,0,0,0,0,0,0,1,0]},BIT:{dimensions:[0,0,0,0,0,0,0,0,1]}};for(var ie in A)ae(A,ie)&&(A[ie].key=ie);var de={},ue={name:"",base:de,value:1,offset:0,dimensions:J.map(T=>0)},V={meter:{name:"meter",base:A.LENGTH,prefixes:S.LONG,value:1,offset:0},inch:{name:"inch",base:A.LENGTH,prefixes:S.NONE,value:.0254,offset:0},foot:{name:"foot",base:A.LENGTH,prefixes:S.NONE,value:.3048,offset:0},yard:{name:"yard",base:A.LENGTH,prefixes:S.NONE,value:.9144,offset:0},mile:{name:"mile",base:A.LENGTH,prefixes:S.NONE,value:1609.344,offset:0},link:{name:"link",base:A.LENGTH,prefixes:S.NONE,value:.201168,offset:0},rod:{name:"rod",base:A.LENGTH,prefixes:S.NONE,value:5.0292,offset:0},chain:{name:"chain",base:A.LENGTH,prefixes:S.NONE,value:20.1168,offset:0},angstrom:{name:"angstrom",base:A.LENGTH,prefixes:S.NONE,value:1e-10,offset:0},m:{name:"m",base:A.LENGTH,prefixes:S.SHORT,value:1,offset:0},in:{name:"in",base:A.LENGTH,prefixes:S.NONE,value:.0254,offset:0},ft:{name:"ft",base:A.LENGTH,prefixes:S.NONE,value:.3048,offset:0},yd:{name:"yd",base:A.LENGTH,prefixes:S.NONE,value:.9144,offset:0},mi:{name:"mi",base:A.LENGTH,prefixes:S.NONE,value:1609.344,offset:0},li:{name:"li",base:A.LENGTH,prefixes:S.NONE,value:.201168,offset:0},rd:{name:"rd",base:A.LENGTH,prefixes:S.NONE,value:5.02921,offset:0},ch:{name:"ch",base:A.LENGTH,prefixes:S.NONE,value:20.1168,offset:0},mil:{name:"mil",base:A.LENGTH,prefixes:S.NONE,value:254e-7,offset:0},m2:{name:"m2",base:A.SURFACE,prefixes:S.SQUARED,value:1,offset:0},sqin:{name:"sqin",base:A.SURFACE,prefixes:S.NONE,value:64516e-8,offset:0},sqft:{name:"sqft",base:A.SURFACE,prefixes:S.NONE,value:.09290304,offset:0},sqyd:{name:"sqyd",base:A.SURFACE,prefixes:S.NONE,value:.83612736,offset:0},sqmi:{name:"sqmi",base:A.SURFACE,prefixes:S.NONE,value:2589988110336e-6,offset:0},sqrd:{name:"sqrd",base:A.SURFACE,prefixes:S.NONE,value:25.29295,offset:0},sqch:{name:"sqch",base:A.SURFACE,prefixes:S.NONE,value:404.6873,offset:0},sqmil:{name:"sqmil",base:A.SURFACE,prefixes:S.NONE,value:64516e-14,offset:0},acre:{name:"acre",base:A.SURFACE,prefixes:S.NONE,value:4046.86,offset:0},hectare:{name:"hectare",base:A.SURFACE,prefixes:S.NONE,value:1e4,offset:0},m3:{name:"m3",base:A.VOLUME,prefixes:S.CUBIC,value:1,offset:0},L:{name:"L",base:A.VOLUME,prefixes:S.SHORT,value:.001,offset:0},l:{name:"l",base:A.VOLUME,prefixes:S.SHORT,value:.001,offset:0},litre:{name:"litre",base:A.VOLUME,prefixes:S.LONG,value:.001,offset:0},cuin:{name:"cuin",base:A.VOLUME,prefixes:S.NONE,value:16387064e-12,offset:0},cuft:{name:"cuft",base:A.VOLUME,prefixes:S.NONE,value:.028316846592,offset:0},cuyd:{name:"cuyd",base:A.VOLUME,prefixes:S.NONE,value:.764554857984,offset:0},teaspoon:{name:"teaspoon",base:A.VOLUME,prefixes:S.NONE,value:5e-6,offset:0},tablespoon:{name:"tablespoon",base:A.VOLUME,prefixes:S.NONE,value:15e-6,offset:0},drop:{name:"drop",base:A.VOLUME,prefixes:S.NONE,value:5e-8,offset:0},gtt:{name:"gtt",base:A.VOLUME,prefixes:S.NONE,value:5e-8,offset:0},minim:{name:"minim",base:A.VOLUME,prefixes:S.NONE,value:6161152e-14,offset:0},fluiddram:{name:"fluiddram",base:A.VOLUME,prefixes:S.NONE,value:36966911e-13,offset:0},fluidounce:{name:"fluidounce",base:A.VOLUME,prefixes:S.NONE,value:2957353e-11,offset:0},gill:{name:"gill",base:A.VOLUME,prefixes:S.NONE,value:.0001182941,offset:0},cc:{name:"cc",base:A.VOLUME,prefixes:S.NONE,value:1e-6,offset:0},cup:{name:"cup",base:A.VOLUME,prefixes:S.NONE,value:.0002365882,offset:0},pint:{name:"pint",base:A.VOLUME,prefixes:S.NONE,value:.0004731765,offset:0},quart:{name:"quart",base:A.VOLUME,prefixes:S.NONE,value:.0009463529,offset:0},gallon:{name:"gallon",base:A.VOLUME,prefixes:S.NONE,value:.003785412,offset:0},beerbarrel:{name:"beerbarrel",base:A.VOLUME,prefixes:S.NONE,value:.1173478,offset:0},oilbarrel:{name:"oilbarrel",base:A.VOLUME,prefixes:S.NONE,value:.1589873,offset:0},hogshead:{name:"hogshead",base:A.VOLUME,prefixes:S.NONE,value:.238481,offset:0},fldr:{name:"fldr",base:A.VOLUME,prefixes:S.NONE,value:36966911e-13,offset:0},floz:{name:"floz",base:A.VOLUME,prefixes:S.NONE,value:2957353e-11,offset:0},gi:{name:"gi",base:A.VOLUME,prefixes:S.NONE,value:.0001182941,offset:0},cp:{name:"cp",base:A.VOLUME,prefixes:S.NONE,value:.0002365882,offset:0},pt:{name:"pt",base:A.VOLUME,prefixes:S.NONE,value:.0004731765,offset:0},qt:{name:"qt",base:A.VOLUME,prefixes:S.NONE,value:.0009463529,offset:0},gal:{name:"gal",base:A.VOLUME,prefixes:S.NONE,value:.003785412,offset:0},bbl:{name:"bbl",base:A.VOLUME,prefixes:S.NONE,value:.1173478,offset:0},obl:{name:"obl",base:A.VOLUME,prefixes:S.NONE,value:.1589873,offset:0},g:{name:"g",base:A.MASS,prefixes:S.SHORT,value:.001,offset:0},gram:{name:"gram",base:A.MASS,prefixes:S.LONG,value:.001,offset:0},ton:{name:"ton",base:A.MASS,prefixes:S.SHORT,value:907.18474,offset:0},t:{name:"t",base:A.MASS,prefixes:S.SHORT,value:1e3,offset:0},tonne:{name:"tonne",base:A.MASS,prefixes:S.LONG,value:1e3,offset:0},grain:{name:"grain",base:A.MASS,prefixes:S.NONE,value:6479891e-11,offset:0},dram:{name:"dram",base:A.MASS,prefixes:S.NONE,value:.0017718451953125,offset:0},ounce:{name:"ounce",base:A.MASS,prefixes:S.NONE,value:.028349523125,offset:0},poundmass:{name:"poundmass",base:A.MASS,prefixes:S.NONE,value:.45359237,offset:0},hundredweight:{name:"hundredweight",base:A.MASS,prefixes:S.NONE,value:45.359237,offset:0},stick:{name:"stick",base:A.MASS,prefixes:S.NONE,value:.115,offset:0},stone:{name:"stone",base:A.MASS,prefixes:S.NONE,value:6.35029318,offset:0},gr:{name:"gr",base:A.MASS,prefixes:S.NONE,value:6479891e-11,offset:0},dr:{name:"dr",base:A.MASS,prefixes:S.NONE,value:.0017718451953125,offset:0},oz:{name:"oz",base:A.MASS,prefixes:S.NONE,value:.028349523125,offset:0},lbm:{name:"lbm",base:A.MASS,prefixes:S.NONE,value:.45359237,offset:0},cwt:{name:"cwt",base:A.MASS,prefixes:S.NONE,value:45.359237,offset:0},s:{name:"s",base:A.TIME,prefixes:S.SHORT,value:1,offset:0},min:{name:"min",base:A.TIME,prefixes:S.NONE,value:60,offset:0},h:{name:"h",base:A.TIME,prefixes:S.NONE,value:3600,offset:0},second:{name:"second",base:A.TIME,prefixes:S.LONG,value:1,offset:0},sec:{name:"sec",base:A.TIME,prefixes:S.LONG,value:1,offset:0},minute:{name:"minute",base:A.TIME,prefixes:S.NONE,value:60,offset:0},hour:{name:"hour",base:A.TIME,prefixes:S.NONE,value:3600,offset:0},day:{name:"day",base:A.TIME,prefixes:S.NONE,value:86400,offset:0},week:{name:"week",base:A.TIME,prefixes:S.NONE,value:7*86400,offset:0},month:{name:"month",base:A.TIME,prefixes:S.NONE,value:2629800,offset:0},year:{name:"year",base:A.TIME,prefixes:S.NONE,value:31557600,offset:0},decade:{name:"decade",base:A.TIME,prefixes:S.NONE,value:315576e3,offset:0},century:{name:"century",base:A.TIME,prefixes:S.NONE,value:315576e4,offset:0},millennium:{name:"millennium",base:A.TIME,prefixes:S.NONE,value:315576e5,offset:0},hertz:{name:"Hertz",base:A.FREQUENCY,prefixes:S.LONG,value:1,offset:0,reciprocal:!0},Hz:{name:"Hz",base:A.FREQUENCY,prefixes:S.SHORT,value:1,offset:0,reciprocal:!0},rad:{name:"rad",base:A.ANGLE,prefixes:S.SHORT,value:1,offset:0},radian:{name:"radian",base:A.ANGLE,prefixes:S.LONG,value:1,offset:0},deg:{name:"deg",base:A.ANGLE,prefixes:S.SHORT,value:null,offset:0},degree:{name:"degree",base:A.ANGLE,prefixes:S.LONG,value:null,offset:0},grad:{name:"grad",base:A.ANGLE,prefixes:S.SHORT,value:null,offset:0},gradian:{name:"gradian",base:A.ANGLE,prefixes:S.LONG,value:null,offset:0},cycle:{name:"cycle",base:A.ANGLE,prefixes:S.NONE,value:null,offset:0},arcsec:{name:"arcsec",base:A.ANGLE,prefixes:S.NONE,value:null,offset:0},arcmin:{name:"arcmin",base:A.ANGLE,prefixes:S.NONE,value:null,offset:0},A:{name:"A",base:A.CURRENT,prefixes:S.SHORT,value:1,offset:0},ampere:{name:"ampere",base:A.CURRENT,prefixes:S.LONG,value:1,offset:0},K:{name:"K",base:A.TEMPERATURE,prefixes:S.NONE,value:1,offset:0},degC:{name:"degC",base:A.TEMPERATURE,prefixes:S.NONE,value:1,offset:273.15},degF:{name:"degF",base:A.TEMPERATURE,prefixes:S.NONE,value:1/1.8,offset:459.67},degR:{name:"degR",base:A.TEMPERATURE,prefixes:S.NONE,value:1/1.8,offset:0},kelvin:{name:"kelvin",base:A.TEMPERATURE,prefixes:S.NONE,value:1,offset:0},celsius:{name:"celsius",base:A.TEMPERATURE,prefixes:S.NONE,value:1,offset:273.15},fahrenheit:{name:"fahrenheit",base:A.TEMPERATURE,prefixes:S.NONE,value:1/1.8,offset:459.67},rankine:{name:"rankine",base:A.TEMPERATURE,prefixes:S.NONE,value:1/1.8,offset:0},mol:{name:"mol",base:A.AMOUNT_OF_SUBSTANCE,prefixes:S.SHORT,value:1,offset:0},mole:{name:"mole",base:A.AMOUNT_OF_SUBSTANCE,prefixes:S.LONG,value:1,offset:0},cd:{name:"cd",base:A.LUMINOUS_INTENSITY,prefixes:S.SHORT,value:1,offset:0},candela:{name:"candela",base:A.LUMINOUS_INTENSITY,prefixes:S.LONG,value:1,offset:0},N:{name:"N",base:A.FORCE,prefixes:S.SHORT,value:1,offset:0},newton:{name:"newton",base:A.FORCE,prefixes:S.LONG,value:1,offset:0},dyn:{name:"dyn",base:A.FORCE,prefixes:S.SHORT,value:1e-5,offset:0},dyne:{name:"dyne",base:A.FORCE,prefixes:S.LONG,value:1e-5,offset:0},lbf:{name:"lbf",base:A.FORCE,prefixes:S.NONE,value:4.4482216152605,offset:0},poundforce:{name:"poundforce",base:A.FORCE,prefixes:S.NONE,value:4.4482216152605,offset:0},kip:{name:"kip",base:A.FORCE,prefixes:S.LONG,value:4448.2216,offset:0},kilogramforce:{name:"kilogramforce",base:A.FORCE,prefixes:S.NONE,value:9.80665,offset:0},J:{name:"J",base:A.ENERGY,prefixes:S.SHORT,value:1,offset:0},joule:{name:"joule",base:A.ENERGY,prefixes:S.SHORT,value:1,offset:0},erg:{name:"erg",base:A.ENERGY,prefixes:S.NONE,value:1e-7,offset:0},Wh:{name:"Wh",base:A.ENERGY,prefixes:S.SHORT,value:3600,offset:0},BTU:{name:"BTU",base:A.ENERGY,prefixes:S.BTU,value:1055.05585262,offset:0},eV:{name:"eV",base:A.ENERGY,prefixes:S.SHORT,value:1602176565e-28,offset:0},electronvolt:{name:"electronvolt",base:A.ENERGY,prefixes:S.LONG,value:1602176565e-28,offset:0},W:{name:"W",base:A.POWER,prefixes:S.SHORT,value:1,offset:0},watt:{name:"watt",base:A.POWER,prefixes:S.LONG,value:1,offset:0},hp:{name:"hp",base:A.POWER,prefixes:S.NONE,value:745.6998715386,offset:0},VAR:{name:"VAR",base:A.POWER,prefixes:S.SHORT,value:d.I,offset:0},VA:{name:"VA",base:A.POWER,prefixes:S.SHORT,value:1,offset:0},Pa:{name:"Pa",base:A.PRESSURE,prefixes:S.SHORT,value:1,offset:0},psi:{name:"psi",base:A.PRESSURE,prefixes:S.NONE,value:6894.75729276459,offset:0},atm:{name:"atm",base:A.PRESSURE,prefixes:S.NONE,value:101325,offset:0},bar:{name:"bar",base:A.PRESSURE,prefixes:S.SHORTLONG,value:1e5,offset:0},torr:{name:"torr",base:A.PRESSURE,prefixes:S.NONE,value:133.322,offset:0},mmHg:{name:"mmHg",base:A.PRESSURE,prefixes:S.NONE,value:133.322,offset:0},mmH2O:{name:"mmH2O",base:A.PRESSURE,prefixes:S.NONE,value:9.80665,offset:0},cmH2O:{name:"cmH2O",base:A.PRESSURE,prefixes:S.NONE,value:98.0665,offset:0},coulomb:{name:"coulomb",base:A.ELECTRIC_CHARGE,prefixes:S.LONG,value:1,offset:0},C:{name:"C",base:A.ELECTRIC_CHARGE,prefixes:S.SHORT,value:1,offset:0},farad:{name:"farad",base:A.ELECTRIC_CAPACITANCE,prefixes:S.LONG,value:1,offset:0},F:{name:"F",base:A.ELECTRIC_CAPACITANCE,prefixes:S.SHORT,value:1,offset:0},volt:{name:"volt",base:A.ELECTRIC_POTENTIAL,prefixes:S.LONG,value:1,offset:0},V:{name:"V",base:A.ELECTRIC_POTENTIAL,prefixes:S.SHORT,value:1,offset:0},ohm:{name:"ohm",base:A.ELECTRIC_RESISTANCE,prefixes:S.SHORTLONG,value:1,offset:0},henry:{name:"henry",base:A.ELECTRIC_INDUCTANCE,prefixes:S.LONG,value:1,offset:0},H:{name:"H",base:A.ELECTRIC_INDUCTANCE,prefixes:S.SHORT,value:1,offset:0},siemens:{name:"siemens",base:A.ELECTRIC_CONDUCTANCE,prefixes:S.LONG,value:1,offset:0},S:{name:"S",base:A.ELECTRIC_CONDUCTANCE,prefixes:S.SHORT,value:1,offset:0},weber:{name:"weber",base:A.MAGNETIC_FLUX,prefixes:S.LONG,value:1,offset:0},Wb:{name:"Wb",base:A.MAGNETIC_FLUX,prefixes:S.SHORT,value:1,offset:0},tesla:{name:"tesla",base:A.MAGNETIC_FLUX_DENSITY,prefixes:S.LONG,value:1,offset:0},T:{name:"T",base:A.MAGNETIC_FLUX_DENSITY,prefixes:S.SHORT,value:1,offset:0},b:{name:"b",base:A.BIT,prefixes:S.BINARY_SHORT,value:1,offset:0},bits:{name:"bits",base:A.BIT,prefixes:S.BINARY_LONG,value:1,offset:0},B:{name:"B",base:A.BIT,prefixes:S.BINARY_SHORT,value:8,offset:0},bytes:{name:"bytes",base:A.BIT,prefixes:S.BINARY_LONG,value:8,offset:0}},Ne={meters:"meter",inches:"inch",feet:"foot",yards:"yard",miles:"mile",links:"link",rods:"rod",chains:"chain",angstroms:"angstrom",lt:"l",litres:"litre",liter:"litre",liters:"litre",teaspoons:"teaspoon",tablespoons:"tablespoon",minims:"minim",fluiddrams:"fluiddram",fluidounces:"fluidounce",gills:"gill",cups:"cup",pints:"pint",quarts:"quart",gallons:"gallon",beerbarrels:"beerbarrel",oilbarrels:"oilbarrel",hogsheads:"hogshead",gtts:"gtt",grams:"gram",tons:"ton",tonnes:"tonne",grains:"grain",drams:"dram",ounces:"ounce",poundmasses:"poundmass",hundredweights:"hundredweight",sticks:"stick",lb:"lbm",lbs:"lbm",kips:"kip",kgf:"kilogramforce",acres:"acre",hectares:"hectare",sqfeet:"sqft",sqyard:"sqyd",sqmile:"sqmi",sqmiles:"sqmi",mmhg:"mmHg",mmh2o:"mmH2O",cmh2o:"cmH2O",seconds:"second",secs:"second",minutes:"minute",mins:"minute",hours:"hour",hr:"hour",hrs:"hour",days:"day",weeks:"week",months:"month",years:"year",decades:"decade",centuries:"century",millennia:"millennium",hertz:"hertz",radians:"radian",degrees:"degree",gradians:"gradian",cycles:"cycle",arcsecond:"arcsec",arcseconds:"arcsec",arcminute:"arcmin",arcminutes:"arcmin",BTUs:"BTU",watts:"watt",joules:"joule",amperes:"ampere",coulombs:"coulomb",volts:"volt",ohms:"ohm",farads:"farad",webers:"weber",teslas:"tesla",electronvolts:"electronvolt",moles:"mole",bit:"bits",byte:"bytes"};function Se(T){if(T.number==="BigNumber"){var R=ao(w);V.rad.value=new w(1),V.deg.value=R.div(180),V.grad.value=R.div(200),V.cycle.value=R.times(2),V.arcsec.value=R.div(648e3),V.arcmin.value=R.div(10800)}else V.rad.value=1,V.deg.value=Math.PI/180,V.grad.value=Math.PI/200,V.cycle.value=Math.PI*2,V.arcsec.value=Math.PI/648e3,V.arcmin.value=Math.PI/10800;V.radian.value=V.rad.value,V.degree.value=V.deg.value,V.gradian.value=V.grad.value}Se(t),e&&e("config",function(T,R){T.number!==R.number&&Se(T)});var se={si:{NONE:{unit:ue,prefix:S.NONE[""]},LENGTH:{unit:V.m,prefix:S.SHORT[""]},MASS:{unit:V.g,prefix:S.SHORT.k},TIME:{unit:V.s,prefix:S.SHORT[""]},CURRENT:{unit:V.A,prefix:S.SHORT[""]},TEMPERATURE:{unit:V.K,prefix:S.SHORT[""]},LUMINOUS_INTENSITY:{unit:V.cd,prefix:S.SHORT[""]},AMOUNT_OF_SUBSTANCE:{unit:V.mol,prefix:S.SHORT[""]},ANGLE:{unit:V.rad,prefix:S.SHORT[""]},BIT:{unit:V.bits,prefix:S.SHORT[""]},FORCE:{unit:V.N,prefix:S.SHORT[""]},ENERGY:{unit:V.J,prefix:S.SHORT[""]},POWER:{unit:V.W,prefix:S.SHORT[""]},PRESSURE:{unit:V.Pa,prefix:S.SHORT[""]},ELECTRIC_CHARGE:{unit:V.C,prefix:S.SHORT[""]},ELECTRIC_CAPACITANCE:{unit:V.F,prefix:S.SHORT[""]},ELECTRIC_POTENTIAL:{unit:V.V,prefix:S.SHORT[""]},ELECTRIC_RESISTANCE:{unit:V.ohm,prefix:S.SHORT[""]},ELECTRIC_INDUCTANCE:{unit:V.H,prefix:S.SHORT[""]},ELECTRIC_CONDUCTANCE:{unit:V.S,prefix:S.SHORT[""]},MAGNETIC_FLUX:{unit:V.Wb,prefix:S.SHORT[""]},MAGNETIC_FLUX_DENSITY:{unit:V.T,prefix:S.SHORT[""]},FREQUENCY:{unit:V.Hz,prefix:S.SHORT[""]}}};se.cgs=JSON.parse(JSON.stringify(se.si)),se.cgs.LENGTH={unit:V.m,prefix:S.SHORT.c},se.cgs.MASS={unit:V.g,prefix:S.SHORT[""]},se.cgs.FORCE={unit:V.dyn,prefix:S.SHORT[""]},se.cgs.ENERGY={unit:V.erg,prefix:S.NONE[""]},se.us=JSON.parse(JSON.stringify(se.si)),se.us.LENGTH={unit:V.ft,prefix:S.NONE[""]},se.us.MASS={unit:V.lbm,prefix:S.NONE[""]},se.us.TEMPERATURE={unit:V.degF,prefix:S.NONE[""]},se.us.FORCE={unit:V.lbf,prefix:S.NONE[""]},se.us.ENERGY={unit:V.BTU,prefix:S.BTU[""]},se.us.POWER={unit:V.hp,prefix:S.NONE[""]},se.us.PRESSURE={unit:V.psi,prefix:S.NONE[""]},se.auto=JSON.parse(JSON.stringify(se.si));var me=se.auto;g.setUnitSystem=function(T){if(ae(se,T))me=se[T];else throw new Error("Unit system "+T+" does not exist. Choices are: "+Object.keys(se).join(", "))},g.getUnitSystem=function(){for(var T in se)if(ae(se,T)&&se[T]===me)return T},g.typeConverters={BigNumber:function(R){return new w(R+"")},Fraction:function(R){return new v(R)},Complex:function(R){return R},number:function(R){return R}},g._getNumberConverter=function(T){if(!g.typeConverters[T])throw new TypeError('Unsupported type "'+T+'"');return g.typeConverters[T]};for(var Ve in V)if(ae(V,Ve)){var we=V[Ve];we.dimensions=we.base.dimensions}for(var fe in Ne)if(ae(Ne,fe)){var Te=V[Ne[fe]],Fe={};for(var Me in Te)ae(Te,Me)&&(Fe[Me]=Te[Me]);Fe.name=fe,V[fe]=Fe}g.isValidAlpha=function(R){return/^[a-zA-Z]$/.test(R)};function Be(T){for(var R=0;R<T.length;R++){if(_=T.charAt(R),R===0&&!g.isValidAlpha(_))throw new Error('Invalid unit name (must begin with alpha character): "'+T+'"');if(R>0&&!(g.isValidAlpha(_)||E(_)))throw new Error('Invalid unit name (only alphanumeric characters are allowed): "'+T+'"')}}return g.createUnit=function(T,R){if(typeof T!="object")throw new TypeError("createUnit expects first parameter to be of type 'Object'");if(R&&R.override){for(var Y in T)if(ae(T,Y)&&g.deleteUnit(Y),T[Y].aliases)for(var Q=0;Q<T[Y].aliases.length;Q++)g.deleteUnit(T[Y].aliases[Q])}var C;for(var P in T)ae(T,P)&&(C=g.createUnitSingle(P,T[P]));return C},g.createUnitSingle=function(T,R,Y){if((typeof R=="undefined"||R===null)&&(R={}),typeof T!="string")throw new TypeError("createUnitSingle expects first parameter to be of type 'string'");if(ae(V,T))throw new Error('Cannot create unit "'+T+'": a unit with that name already exists');Be(T);var Q=null,C=[],P=0,U,L,W;if(R&&R.type==="Unit")Q=R.clone();else if(typeof R=="string")R!==""&&(U=R);else if(typeof R=="object")U=R.definition,L=R.prefixes,P=R.offset,W=R.baseName,R.aliases&&(C=R.aliases.valueOf());else throw new TypeError('Cannot create unit "'+T+'" from "'+R.toString()+'": expecting "string" or "Unit" or "Object"');if(C){for(var re=0;re<C.length;re++)if(ae(V,C[re]))throw new Error('Cannot create alias "'+C[re]+'": a unit with that name already exists')}if(U&&typeof U=="string"&&!Q)try{Q=g.parse(U,{allowNoUnits:!0})}catch(D){throw D.message='Could not create unit "'+T+'" from "'+U+'": '+D.message,D}else U&&U.type==="Unit"&&(Q=U.clone());C=C||[],P=P||0,L&&L.toUpperCase?L=S[L.toUpperCase()]||S.NONE:L=S.NONE;var ne={};if(Q){ne={name:T,value:Q.value,dimensions:Q.dimensions.slice(0),prefixes:L,offset:P};var je=!1;for(var Ke in A)if(ae(A,Ke)){for(var it=!0,Ft=0;Ft<J.length;Ft++)if(Math.abs((ne.dimensions[Ft]||0)-(A[Ke].dimensions[Ft]||0))>1e-12){it=!1;break}if(it){je=!0,ne.base=A[Ke];break}}if(!je){W=W||T+"_STUFF";var Fr={dimensions:Q.dimensions.slice(0)};Fr.key=W,A[W]=Fr,me[W]={unit:ne,prefix:S.NONE[""]},ne.base=A[W]}}else{if(W=W||T+"_STUFF",J.indexOf(W)>=0)throw new Error('Cannot create new base unit "'+T+'": a base unit with that name already exists (and cannot be overridden)');J.push(W);for(var te in A)ae(A,te)&&(A[te].dimensions[J.length-1]=0);for(var ee={dimensions:[]},le=0;le<J.length;le++)ee.dimensions[le]=0;ee.dimensions[J.length-1]=1,ee.key=W,A[W]=ee,ne={name:T,value:1,dimensions:A[W].dimensions.slice(0),prefixes:L,offset:P,base:A[W]},me[W]={unit:ne,prefix:S.NONE[""]}}g.UNITS[T]=ne;for(var Xt=0;Xt<C.length;Xt++){var De=C[Xt],Kt={};for(var y in ne)ae(ne,y)&&(Kt[y]=ne[y]);Kt.name=De,g.UNITS[De]=Kt}return delete H.cache,new g(null,T)},g.deleteUnit=function(T){delete g.UNITS[T]},g.PREFIXES=S,g.BASE_DIMENSIONS=J,g.BASE_UNITS=A,g.UNIT_SYSTEMS=se,g.UNITS=V,g},{isClass:!0}),uo="unit",Yf=["typed","Unit"],Zf=K(uo,Yf,i=>{var{typed:e,Unit:t}=i;return e(uo,{Unit:function(n){return n.clone()},string:function(n){return t.isValuelessUnit(n)?new t(null,n):t.parse(n,{allowNoUnits:!0})},"number | BigNumber | Fraction | Complex, string":function(n,s){return new t(n,s)},"Array | Matrix":function(n){return Xe(n,this)}})}),co="createUnit",Jf=["typed","Unit"],Qf=K(co,Jf,i=>{var{typed:e,Unit:t}=i;return e(co,{"Object, Object":function(n,s){return t.createUnit(n,s)},Object:function(n){return t.createUnit(n,{})},"string, Unit | string | Object, Object":function(n,s,c){var l={};return l[n]=s,t.createUnit(l,c)},"string, Unit | string | Object":function(n,s){var c={};return c[n]=s,t.createUnit(c,{})},string:function(n){var s={};return s[n]={},t.createUnit(s,{})}})}),ho="add",Xf=["typed","matrix","addScalar","equalScalar","DenseMatrix","SparseMatrix"],Kf=K(ho,Xf,i=>{var{typed:e,matrix:t,addScalar:r,equalScalar:n,DenseMatrix:s,SparseMatrix:c}=i,l=La({typed:e}),h=Ol({typed:e,equalScalar:n}),f=Ua({typed:e,DenseMatrix:s}),o=zr({typed:e}),a=xt({typed:e});return e(ho,wi({"DenseMatrix, DenseMatrix":function(p,m){return o(p,m,r)},"DenseMatrix, SparseMatrix":function(p,m){return l(p,m,r,!1)},"SparseMatrix, DenseMatrix":function(p,m){return l(m,p,r,!0)},"SparseMatrix, SparseMatrix":function(p,m){return h(p,m,r)},"Array, Array":function(p,m){return this(t(p),t(m)).valueOf()},"Array, Matrix":function(p,m){return this(t(p),m)},"Matrix, Array":function(p,m){return this(p,t(m))},"DenseMatrix, any":function(p,m){return a(p,m,r,!1)},"SparseMatrix, any":function(p,m){return f(p,m,r,!1)},"any, DenseMatrix":function(p,m){return a(m,p,r,!0)},"any, SparseMatrix":function(p,m){return f(m,p,r,!0)},"Array, any":function(p,m){return a(t(p),m,r,!1).valueOf()},"any, Array":function(p,m){return a(t(m),p,r,!0).valueOf()},"any, any":r,"any, any, ...any":function(p,m,d){for(var w=this(p,m),v=0;v<d.length;v++)w=this(w,d[v]);return w}},r.signatures))}),lo="dot",ep=["typed","addScalar","multiplyScalar","conj","size"],tp=K(lo,ep,i=>{var{typed:e,addScalar:t,multiplyScalar:r,conj:n,size:s}=i;return e(lo,{"Array | DenseMatrix, Array | DenseMatrix":l,"SparseMatrix, SparseMatrix":h});function c(o,a){var u=f(o),p=f(a),m,d;if(u.length===1)m=u[0];else if(u.length===2&&u[1]===1)m=u[0];else throw new RangeError("Expected a column vector, instead got a matrix of size ("+u.join(", ")+")");if(p.length===1)d=p[0];else if(p.length===2&&p[1]===1)d=p[0];else throw new RangeError("Expected a column vector, instead got a matrix of size ("+p.join(", ")+")");if(m!==d)throw new RangeError("Vectors must have equal length ("+m+" != "+d+")");if(m===0)throw new RangeError("Cannot calculate the dot product of empty vectors");return m}function l(o,a){var u=c(o,a),p=We(o)?o._data:o,m=We(o)?o._datatype:void 0,d=We(a)?a._data:a,w=We(a)?a._datatype:void 0,v=f(o).length===2,x=f(a).length===2,g=t,b=r;if(m&&w&&m===w&&typeof m=="string"){var M=m;g=e.find(t,[M,M]),b=e.find(r,[M,M])}if(!v&&!x){for(var _=b(n(p[0]),d[0]),N=1;N<u;N++)_=g(_,b(n(p[N]),d[N]));return _}if(!v&&x){for(var O=b(n(p[0]),d[0][0]),E=1;E<u;E++)O=g(O,b(n(p[E]),d[E][0]));return O}if(v&&!x){for(var F=b(n(p[0][0]),d[0]),B=1;B<u;B++)F=g(F,b(n(p[B][0]),d[B]));return F}if(v&&x){for(var I=b(n(p[0][0]),d[0][0]),j=1;j<u;j++)I=g(I,b(n(p[j][0]),d[j][0]));return I}}function h(o,a){c(o,a);for(var u=o._index,p=o._values,m=a._index,d=a._values,w=0,v=t,x=r,g=0,b=0;g<u.length&&b<m.length;){var M=u[g],_=m[b];if(M<_){g++;continue}if(M>_){b++;continue}M===_&&(w=v(w,x(p[g],d[b])),g++,b++)}return w}function f(o){return We(o)?o.size():s(o)}}),fo={end:!0},rp="Node",np=["mathWithTransform"],ip=K(rp,np,i=>{var{mathWithTransform:e}=i;function t(){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator")}t.prototype.evaluate=function(n){return this.compile().evaluate(n)},t.prototype.type="Node",t.prototype.isNode=!0,t.prototype.comment="",t.prototype.compile=function(){var n=this._compile(e,{}),s={},c=null;function l(h){var f=h||{};return r(f),n(f,s,c)}return{evaluate:l}},t.prototype._compile=function(n,s){throw new Error("Method _compile should be implemented by type "+this.type)},t.prototype.forEach=function(n){throw new Error("Cannot run forEach on a Node interface")},t.prototype.map=function(n){throw new Error("Cannot run map on a Node interface")},t.prototype._ifNode=function(n){if(!Pe(n))throw new TypeError("Callback function must return a Node");return n},t.prototype.traverse=function(n){n(this,null,null);function s(c,l){c.forEach(function(h,f,o){l(h,f,o),s(h,l)})}s(this,n)},t.prototype.transform=function(n){function s(c,l,h){var f=n(c,l,h);return f!==c?f:c.map(s)}return s(this,null,null)},t.prototype.filter=function(n){var s=[];return this.traverse(function(c,l,h){n(c,l,h)&&s.push(c)}),s},t.prototype.clone=function(){throw new Error("Cannot clone a Node interface")},t.prototype.cloneDeep=function(){return this.map(function(n){return n.cloneDeep()})},t.prototype.equals=function(n){return n?br(this,n):!1},t.prototype.toString=function(n){var s;if(n&&typeof n=="object")switch(typeof n.handler){case"object":case"undefined":break;case"function":s=n.handler(this,n);break;default:throw new TypeError("Object or function expected as callback")}return typeof s!="undefined"?s:this._toString(n)},t.prototype.toJSON=function(){throw new Error("Cannot serialize object: toJSON not implemented by "+this.type)},t.prototype.toHTML=function(n){var s;if(n&&typeof n=="object")switch(typeof n.handler){case"object":case"undefined":break;case"function":s=n.handler(this,n);break;default:throw new TypeError("Object or function expected as callback")}return typeof s!="undefined"?s:this.toHTML(n)},t.prototype._toString=function(){throw new Error("_toString not implemented for "+this.type)},t.prototype.toTex=function(n){var s;if(n&&typeof n=="object")switch(typeof n.handler){case"object":case"undefined":break;case"function":s=n.handler(this,n);break;default:throw new TypeError("Object or function expected as callback")}return typeof s!="undefined"?s:this._toTex(n)},t.prototype._toTex=function(n){throw new Error("_toTex not implemented for "+this.type)},t.prototype.getIdentifier=function(){return this.type},t.prototype.getContent=function(){return this};function r(n){for(var s in n)if(ae(n,s)&&s in fo)throw new Error('Scope contains an illegal symbol, "'+s+'" is a reserved keyword')}return t},{isClass:!0,isNode:!0});function po(i){return i&&i.isIndexError?new Gt(i.index+1,i.min+1,i.max!==void 0?i.max+1:void 0):i}function mo(i){var{subset:e}=i;return function(r,n){try{if(Array.isArray(r))return e(r,n);if(r&&typeof r.subset=="function")return r.subset(n);if(typeof r=="string")return e(r,n);if(typeof r=="object"){if(!n.isObjectProperty())throw new TypeError("Cannot apply a numeric index as object property");return ut(r,n.getObjectProperty())}else throw new TypeError("Cannot apply index: unsupported type of object")}catch(s){throw po(s)}}}var sp="AccessorNode",ap=["subset","Node"],op=K(sp,ap,i=>{var{subset:e,Node:t}=i,r=mo({subset:e});function n(c,l){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(!Pe(c))throw new TypeError('Node expected for parameter "object"');if(!$r(l))throw new TypeError('IndexNode expected for parameter "index"');this.object=c||null,this.index=l,Object.defineProperty(this,"name",{get:function(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}.bind(this),set:function(){throw new Error("Cannot assign a new name, name is read-only")}})}n.prototype=new t,n.prototype.type="AccessorNode",n.prototype.isAccessorNode=!0,n.prototype._compile=function(c,l){var h=this.object._compile(c,l),f=this.index._compile(c,l);if(this.index.isObjectProperty()){var o=this.index.getObjectProperty();return function(u,p,m){return ut(h(u,p,m),o)}}else return function(u,p,m){var d=h(u,p,m),w=f(u,p,d);return r(d,w)}},n.prototype.forEach=function(c){c(this.object,"object",this),c(this.index,"index",this)},n.prototype.map=function(c){return new n(this._ifNode(c(this.object,"object",this)),this._ifNode(c(this.index,"index",this)))},n.prototype.clone=function(){return new n(this.object,this.index)},n.prototype._toString=function(c){var l=this.object.toString(c);return s(this.object)&&(l="("+l+")"),l+this.index.toString(c)},n.prototype.toHTML=function(c){var l=this.object.toHTML(c);return s(this.object)&&(l='<span class="math-parenthesis math-round-parenthesis">(</span>'+l+'<span class="math-parenthesis math-round-parenthesis">)</span>'),l+this.index.toHTML(c)},n.prototype._toTex=function(c){var l=this.object.toTex(c);return s(this.object)&&(l="\\left(' + object + '\\right)"),l+this.index.toTex(c)},n.prototype.toJSON=function(){return{mathjs:"AccessorNode",object:this.object,index:this.index}},n.fromJSON=function(c){return new n(c.object,c.index)};function s(c){return!(or(c)||fi(c)||ur(c)||wn(c)||di(c)||vi(c)||lt(c))}return n},{isClass:!0,isNode:!0}),up="ArrayNode",cp=["Node"],hp=K(up,cp,i=>{var{Node:e}=i;function t(r){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");if(this.items=r||[],!Array.isArray(this.items)||!this.items.every(Pe))throw new TypeError("Array containing Nodes expected")}return t.prototype=new e,t.prototype.type="ArrayNode",t.prototype.isArrayNode=!0,t.prototype._compile=function(r,n){var s=wt(this.items,function(h){return h._compile(r,n)}),c=r.config.matrix!=="Array";if(c){var l=r.matrix;return function(f,o,a){return l(wt(s,function(u){return u(f,o,a)}))}}else return function(f,o,a){return wt(s,function(u){return u(f,o,a)})}},t.prototype.forEach=function(r){for(var n=0;n<this.items.length;n++){var s=this.items[n];r(s,"items["+n+"]",this)}},t.prototype.map=function(r){for(var n=[],s=0;s<this.items.length;s++)n[s]=this._ifNode(r(this.items[s],"items["+s+"]",this));return new t(n)},t.prototype.clone=function(){return new t(this.items.slice(0))},t.prototype._toString=function(r){var n=this.items.map(function(s){return s.toString(r)});return"["+n.join(", ")+"]"},t.prototype.toJSON=function(){return{mathjs:"ArrayNode",items:this.items}},t.fromJSON=function(r){return new t(r.items)},t.prototype.toHTML=function(r){var n=this.items.map(function(s){return s.toHTML(r)});return'<span class="math-parenthesis math-square-parenthesis">[</span>'+n.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-square-parenthesis">]</span>'},t.prototype._toTex=function(r){var n="\\begin{bmatrix}";return this.items.forEach(function(s){s.items?n+=s.items.map(function(c){return c.toTex(r)}).join("&"):n+=s.toTex(r),n+="\\\\"}),n+="\\end{bmatrix}",n},t},{isClass:!0,isNode:!0});function lp(i){var{subset:e,matrix:t}=i;return function(n,s,c){try{if(Array.isArray(n))return t(n).subset(s,c).valueOf();if(n&&typeof n.subset=="function")return n.subset(s,c);if(typeof n=="string")return e(n,s,c);if(typeof n=="object"){if(!s.isObjectProperty())throw TypeError("Cannot apply a numeric index as object property");return pr(n,s.getObjectProperty(),c),n}else throw new TypeError("Cannot apply index: unsupported type of object")}catch(l){throw po(l)}}}var Tt=[{AssignmentNode:{},FunctionAssignmentNode:{}},{ConditionalNode:{latexLeftParens:!1,latexRightParens:!1,latexParens:!1}},{"OperatorNode:or":{associativity:"left",associativeWith:[]}},{"OperatorNode:xor":{associativity:"left",associativeWith:[]}},{"OperatorNode:and":{associativity:"left",associativeWith:[]}},{"OperatorNode:bitOr":{associativity:"left",associativeWith:[]}},{"OperatorNode:bitXor":{associativity:"left",associativeWith:[]}},{"OperatorNode:bitAnd":{associativity:"left",associativeWith:[]}},{"OperatorNode:equal":{associativity:"left",associativeWith:[]},"OperatorNode:unequal":{associativity:"left",associativeWith:[]},"OperatorNode:smaller":{associativity:"left",associativeWith:[]},"OperatorNode:larger":{associativity:"left",associativeWith:[]},"OperatorNode:smallerEq":{associativity:"left",associativeWith:[]},"OperatorNode:largerEq":{associativity:"left",associativeWith:[]},RelationalNode:{associativity:"left",associativeWith:[]}},{"OperatorNode:leftShift":{associativity:"left",associativeWith:[]},"OperatorNode:rightArithShift":{associativity:"left",associativeWith:[]},"OperatorNode:rightLogShift":{associativity:"left",associativeWith:[]}},{"OperatorNode:to":{associativity:"left",associativeWith:[]}},{RangeNode:{}},{"OperatorNode:add":{associativity:"left",associativeWith:["OperatorNode:add","OperatorNode:subtract"]},"OperatorNode:subtract":{associativity:"left",associativeWith:[]}},{"OperatorNode:multiply":{associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","Operator:dotMultiply","Operator:dotDivide"]},"OperatorNode:divide":{associativity:"left",associativeWith:[],latexLeftParens:!1,latexRightParens:!1,latexParens:!1},"OperatorNode:dotMultiply":{associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","OperatorNode:dotMultiply","OperatorNode:doDivide"]},"OperatorNode:dotDivide":{associativity:"left",associativeWith:[]},"OperatorNode:mod":{associativity:"left",associativeWith:[]}},{"OperatorNode:unaryPlus":{associativity:"right"},"OperatorNode:unaryMinus":{associativity:"right"},"OperatorNode:bitNot":{associativity:"right"},"OperatorNode:not":{associativity:"right"}},{"OperatorNode:pow":{associativity:"right",associativeWith:[],latexRightParens:!1},"OperatorNode:dotPow":{associativity:"right",associativeWith:[]}},{"OperatorNode:factorial":{associativity:"left"}},{"OperatorNode:transpose":{associativity:"left"}}];function Oe(i,e){var t=i;e!=="keep"&&(t=i.getContent());for(var r=t.getIdentifier(),n=0;n<Tt.length;n++)if(r in Tt[n])return n;return null}function Jr(i,e){var t=i;e!=="keep"&&(t=i.getContent());var r=t.getIdentifier(),n=Oe(t,e);if(n===null)return null;var s=Tt[n][r];if(ae(s,"associativity")){if(s.associativity==="left")return"left";if(s.associativity==="right")return"right";throw Error("'"+r+"' has the invalid associativity '"+s.associativity+"'.")}return null}function Bi(i,e,t){var r=t!=="keep"?i.getContent():i,n=t!=="keep"?i.getContent():e,s=r.getIdentifier(),c=n.getIdentifier(),l=Oe(r,t);if(l===null)return null;var h=Tt[l][s];if(ae(h,"associativeWith")&&h.associativeWith instanceof Array){for(var f=0;f<h.associativeWith.length;f++)if(h.associativeWith[f]===c)return!0;return!1}return null}var fp="AssignmentNode",pp=["subset","?matrix","Node"],dp=K(fp,pp,i=>{var{subset:e,matrix:t,Node:r}=i,n=mo({subset:e}),s=lp({subset:e,matrix:t});function c(h,f,o){if(!(this instanceof c))throw new SyntaxError("Constructor must be called with the new operator");if(this.object=h,this.index=o?f:null,this.value=o||f,!lt(h)&&!or(h))throw new TypeError('SymbolNode or AccessorNode expected as "object"');if(lt(h)&&h.name==="end")throw new Error('Cannot assign to symbol "end"');if(this.index&&!$r(this.index))throw new TypeError('IndexNode expected as "index"');if(!Pe(this.value))throw new TypeError('Node expected as "value"');Object.defineProperty(this,"name",{get:function(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}.bind(this),set:function(){throw new Error("Cannot assign a new name, name is read-only")}})}c.prototype=new r,c.prototype.type="AssignmentNode",c.prototype.isAssignmentNode=!0,c.prototype._compile=function(h,f){var o=this.object._compile(h,f),a=this.index?this.index._compile(h,f):null,u=this.value._compile(h,f),p=this.object.name;if(this.index)if(this.index.isObjectProperty()){var m=this.index.getObjectProperty();return function(g,b,M){var _=o(g,b,M),N=u(g,b,M);return pr(_,m,N)}}else{if(lt(this.object))return function(g,b,M){var _=o(g,b,M),N=u(g,b,M),O=a(g,b,_);return pr(g,p,s(_,O,N)),N};var d=this.object.object._compile(h,f);if(this.object.index.isObjectProperty()){var w=this.object.index.getObjectProperty();return function(g,b,M){var _=d(g,b,M),N=ut(_,w),O=a(g,b,N),E=u(g,b,M);return pr(_,w,s(N,O,E)),E}}else{var v=this.object.index._compile(h,f);return function(g,b,M){var _=d(g,b,M),N=v(g,b,_),O=n(_,N),E=a(g,b,O),F=u(g,b,M);return s(_,N,s(O,E,F)),F}}}else{if(!lt(this.object))throw new TypeError("SymbolNode expected as object");return function(g,b,M){return pr(g,p,u(g,b,M))}}},c.prototype.forEach=function(h){h(this.object,"object",this),this.index&&h(this.index,"index",this),h(this.value,"value",this)},c.prototype.map=function(h){var f=this._ifNode(h(this.object,"object",this)),o=this.index?this._ifNode(h(this.index,"index",this)):null,a=this._ifNode(h(this.value,"value",this));return new c(f,o,a)},c.prototype.clone=function(){return new c(this.object,this.index,this.value)};function l(h,f){f||(f="keep");var o=Oe(h,f),a=Oe(h.value,f);return f==="all"||a!==null&&a<=o}return c.prototype._toString=function(h){var f=this.object.toString(h),o=this.index?this.index.toString(h):"",a=this.value.toString(h);return l(this,h&&h.parenthesis)&&(a="("+a+")"),f+o+" = "+a},c.prototype.toJSON=function(){return{mathjs:"AssignmentNode",object:this.object,index:this.index,value:this.value}},c.fromJSON=function(h){return new c(h.object,h.index,h.value)},c.prototype.toHTML=function(h){var f=this.object.toHTML(h),o=this.index?this.index.toHTML(h):"",a=this.value.toHTML(h);return l(this,h&&h.parenthesis)&&(a='<span class="math-paranthesis math-round-parenthesis">(</span>'+a+'<span class="math-paranthesis math-round-parenthesis">)</span>'),f+o+'<span class="math-operator math-assignment-operator math-variable-assignment-operator math-binary-operator">=</span>'+a},c.prototype._toTex=function(h){var f=this.object.toTex(h),o=this.index?this.index.toTex(h):"",a=this.value.toTex(h);return l(this,h&&h.parenthesis)&&(a="\\left(".concat(a,"\\right)")),f+o+":="+a},c},{isClass:!0,isNode:!0}),mp="BlockNode",vp=["ResultSet","Node"],gp=K(mp,vp,i=>{var{ResultSet:e,Node:t}=i;function r(n){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if(!Array.isArray(n))throw new Error("Array expected");this.blocks=n.map(function(s){var c=s&&s.node,l=s&&s.visible!==void 0?s.visible:!0;if(!Pe(c))throw new TypeError('Property "node" must be a Node');if(typeof l!="boolean")throw new TypeError('Property "visible" must be a boolean');return{node:c,visible:l}})}return r.prototype=new t,r.prototype.type="BlockNode",r.prototype.isBlockNode=!0,r.prototype._compile=function(n,s){var c=wt(this.blocks,function(l){return{evaluate:l.node._compile(n,s),visible:l.visible}});return function(h,f,o){var a=[];return ua(c,function(p){var m=p.evaluate(h,f,o);p.visible&&a.push(m)}),new e(a)}},r.prototype.forEach=function(n){for(var s=0;s<this.blocks.length;s++)n(this.blocks[s].node,"blocks["+s+"].node",this)},r.prototype.map=function(n){for(var s=[],c=0;c<this.blocks.length;c++){var l=this.blocks[c],h=this._ifNode(n(l.node,"blocks["+c+"].node",this));s[c]={node:h,visible:l.visible}}return new r(s)},r.prototype.clone=function(){var n=this.blocks.map(function(s){return{node:s.node,visible:s.visible}});return new r(n)},r.prototype._toString=function(n){return this.blocks.map(function(s){return s.node.toString(n)+(s.visible?"":";")}).join(`
`)},r.prototype.toJSON=function(){return{mathjs:"BlockNode",blocks:this.blocks}},r.fromJSON=function(n){return new r(n.blocks)},r.prototype.toHTML=function(n){return this.blocks.map(function(s){return s.node.toHTML(n)+(s.visible?"":'<span class="math-separator">;</span>')}).join('<span class="math-separator"><br /></span>')},r.prototype._toTex=function(n){return this.blocks.map(function(s){return s.node.toTex(n)+(s.visible?"":";")}).join(`\\;\\;
`)},r},{isClass:!0,isNode:!0}),yp="ConditionalNode",wp=["Node"],xp=K(yp,wp,i=>{var{Node:e}=i;function t(n,s,c){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");if(!Pe(n))throw new TypeError("Parameter condition must be a Node");if(!Pe(s))throw new TypeError("Parameter trueExpr must be a Node");if(!Pe(c))throw new TypeError("Parameter falseExpr must be a Node");this.condition=n,this.trueExpr=s,this.falseExpr=c}t.prototype=new e,t.prototype.type="ConditionalNode",t.prototype.isConditionalNode=!0,t.prototype._compile=function(n,s){var c=this.condition._compile(n,s),l=this.trueExpr._compile(n,s),h=this.falseExpr._compile(n,s);return function(o,a,u){return r(c(o,a,u))?l(o,a,u):h(o,a,u)}},t.prototype.forEach=function(n){n(this.condition,"condition",this),n(this.trueExpr,"trueExpr",this),n(this.falseExpr,"falseExpr",this)},t.prototype.map=function(n){return new t(this._ifNode(n(this.condition,"condition",this)),this._ifNode(n(this.trueExpr,"trueExpr",this)),this._ifNode(n(this.falseExpr,"falseExpr",this)))},t.prototype.clone=function(){return new t(this.condition,this.trueExpr,this.falseExpr)},t.prototype._toString=function(n){var s=n&&n.parenthesis?n.parenthesis:"keep",c=Oe(this,s),l=this.condition.toString(n),h=Oe(this.condition,s);(s==="all"||this.condition.type==="OperatorNode"||h!==null&&h<=c)&&(l="("+l+")");var f=this.trueExpr.toString(n),o=Oe(this.trueExpr,s);(s==="all"||this.trueExpr.type==="OperatorNode"||o!==null&&o<=c)&&(f="("+f+")");var a=this.falseExpr.toString(n),u=Oe(this.falseExpr,s);return(s==="all"||this.falseExpr.type==="OperatorNode"||u!==null&&u<=c)&&(a="("+a+")"),l+" ? "+f+" : "+a},t.prototype.toJSON=function(){return{mathjs:"ConditionalNode",condition:this.condition,trueExpr:this.trueExpr,falseExpr:this.falseExpr}},t.fromJSON=function(n){return new t(n.condition,n.trueExpr,n.falseExpr)},t.prototype.toHTML=function(n){var s=n&&n.parenthesis?n.parenthesis:"keep",c=Oe(this,s),l=this.condition.toHTML(n),h=Oe(this.condition,s);(s==="all"||this.condition.type==="OperatorNode"||h!==null&&h<=c)&&(l='<span class="math-parenthesis math-round-parenthesis">(</span>'+l+'<span class="math-parenthesis math-round-parenthesis">)</span>');var f=this.trueExpr.toHTML(n),o=Oe(this.trueExpr,s);(s==="all"||this.trueExpr.type==="OperatorNode"||o!==null&&o<=c)&&(f='<span class="math-parenthesis math-round-parenthesis">(</span>'+f+'<span class="math-parenthesis math-round-parenthesis">)</span>');var a=this.falseExpr.toHTML(n),u=Oe(this.falseExpr,s);return(s==="all"||this.falseExpr.type==="OperatorNode"||u!==null&&u<=c)&&(a='<span class="math-parenthesis math-round-parenthesis">(</span>'+a+'<span class="math-parenthesis math-round-parenthesis">)</span>'),l+'<span class="math-operator math-conditional-operator">?</span>'+f+'<span class="math-operator math-conditional-operator">:</span>'+a},t.prototype._toTex=function(n){return"\\begin{cases} {"+this.trueExpr.toTex(n)+"}, &\\quad{\\text{if }\\;"+this.condition.toTex(n)+"}\\\\{"+this.falseExpr.toTex(n)+"}, &\\quad{\\text{otherwise}}\\end{cases}"};function r(n){if(typeof n=="number"||typeof n=="boolean"||typeof n=="string")return!!n;if(n){if(Ie(n))return!n.isZero();if(Lt(n))return!!(n.re||n.im);if(ar(n))return!!n.value}if(n==null)return!1;throw new TypeError('Unsupported type of condition "'+ot(n)+'"')}return t},{isClass:!0,isNode:!0}),Ri=Object.assign||function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},bp={"{":"\\{","}":"\\}","\\":"\\textbackslash{}","#":"\\#",$:"\\$","%":"\\%","&":"\\&","^":"\\textasciicircum{}",_:"\\_","~":"\\textasciitilde{}"},Mp={"\u2013":"\\--","\u2014":"\\---"," ":"~","	":"\\qquad{}","\r\n":"\\newline{}","\n":"\\newline{}"},_p=function(e,t){return Ri({},e,t)},Np=function(i){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.preserveFormatting,r=t===void 0?!1:t,n=e.escapeMapFn,s=n===void 0?_p:n,c=String(i),l="",h=s(Ri({},bp),r?Ri({},Mp):{}),f=Object.keys(h),o=function(){var u=!1;f.forEach(function(p,m){u||c.length>=p.length&&c.slice(0,p.length)===p&&(l+=h[f[m]],c=c.slice(p.length,c.length),u=!0)}),u||(l+=c.slice(0,1),c=c.slice(1,c.length))};c;)o();return l},Sp=Np,Pi={Alpha:"A",alpha:"\\alpha",Beta:"B",beta:"\\beta",Gamma:"\\Gamma",gamma:"\\gamma",Delta:"\\Delta",delta:"\\delta",Epsilon:"E",epsilon:"\\epsilon",varepsilon:"\\varepsilon",Zeta:"Z",zeta:"\\zeta",Eta:"H",eta:"\\eta",Theta:"\\Theta",theta:"\\theta",vartheta:"\\vartheta",Iota:"I",iota:"\\iota",Kappa:"K",kappa:"\\kappa",varkappa:"\\varkappa",Lambda:"\\Lambda",lambda:"\\lambda",Mu:"M",mu:"\\mu",Nu:"N",nu:"\\nu",Xi:"\\Xi",xi:"\\xi",Omicron:"O",omicron:"o",Pi:"\\Pi",pi:"\\pi",varpi:"\\varpi",Rho:"P",rho:"\\rho",varrho:"\\varrho",Sigma:"\\Sigma",sigma:"\\sigma",varsigma:"\\varsigma",Tau:"T",tau:"\\tau",Upsilon:"\\Upsilon",upsilon:"\\upsilon",Phi:"\\Phi",phi:"\\phi",varphi:"\\varphi",Chi:"X",chi:"\\chi",Psi:"\\Psi",psi:"\\psi",Omega:"\\Omega",omega:"\\omega",true:"\\mathrm{True}",false:"\\mathrm{False}",i:"i",inf:"\\infty",Inf:"\\infty",infinity:"\\infty",Infinity:"\\infty",oo:"\\infty",lim:"\\lim",undefined:"\\mathbf{?}"},be={transpose:"^\\top",ctranspose:"^H",factorial:"!",pow:"^",dotPow:".^\\wedge",unaryPlus:"+",unaryMinus:"-",bitNot:"\\~",not:"\\neg",multiply:"\\cdot",divide:"\\frac",dotMultiply:".\\cdot",dotDivide:".:",mod:"\\mod",add:"+",subtract:"-",to:"\\rightarrow",leftShift:"<<",rightArithShift:">>",rightLogShift:">>>",equal:"=",unequal:"\\neq",smaller:"<",larger:">",smallerEq:"\\leq",largerEq:"\\geq",bitAnd:"\\&",bitXor:"\\underline{|}",bitOr:"|",and:"\\wedge",xor:"\\veebar",or:"\\vee"},vo={abs:{1:"\\left|${args[0]}\\right|"},add:{2:"\\left(${args[0]}".concat(be.add,"${args[1]}\\right)")},cbrt:{1:"\\sqrt[3]{${args[0]}}"},ceil:{1:"\\left\\lceil${args[0]}\\right\\rceil"},cube:{1:"\\left(${args[0]}\\right)^3"},divide:{2:"\\frac{${args[0]}}{${args[1]}}"},dotDivide:{2:"\\left(${args[0]}".concat(be.dotDivide,"${args[1]}\\right)")},dotMultiply:{2:"\\left(${args[0]}".concat(be.dotMultiply,"${args[1]}\\right)")},dotPow:{2:"\\left(${args[0]}".concat(be.dotPow,"${args[1]}\\right)")},exp:{1:"\\exp\\left(${args[0]}\\right)"},expm1:"\\left(e".concat(be.pow,"{${args[0]}}-1\\right)"),fix:{1:"\\mathrm{${name}}\\left(${args[0]}\\right)"},floor:{1:"\\left\\lfloor${args[0]}\\right\\rfloor"},gcd:"\\gcd\\left(${args}\\right)",hypot:"\\hypot\\left(${args}\\right)",log:{1:"\\ln\\left(${args[0]}\\right)",2:"\\log_{${args[1]}}\\left(${args[0]}\\right)"},log10:{1:"\\log_{10}\\left(${args[0]}\\right)"},log1p:{1:"\\ln\\left(${args[0]}+1\\right)",2:"\\log_{${args[1]}}\\left(${args[0]}+1\\right)"},log2:"\\log_{2}\\left(${args[0]}\\right)",mod:{2:"\\left(${args[0]}".concat(be.mod,"${args[1]}\\right)")},multiply:{2:"\\left(${args[0]}".concat(be.multiply,"${args[1]}\\right)")},norm:{1:"\\left\\|${args[0]}\\right\\|",2:void 0},nthRoot:{2:"\\sqrt[${args[1]}]{${args[0]}}"},nthRoots:{2:"\\{y : $y^{args[1]} = {${args[0]}}\\}"},pow:{2:"\\left(${args[0]}\\right)".concat(be.pow,"{${args[1]}}")},round:{1:"\\left\\lfloor${args[0]}\\right\\rceil",2:void 0},sign:{1:"\\mathrm{${name}}\\left(${args[0]}\\right)"},sqrt:{1:"\\sqrt{${args[0]}}"},square:{1:"\\left(${args[0]}\\right)^2"},subtract:{2:"\\left(${args[0]}".concat(be.subtract,"${args[1]}\\right)")},unaryMinus:{1:"".concat(be.unaryMinus,"\\left(${args[0]}\\right)")},unaryPlus:{1:"".concat(be.unaryPlus,"\\left(${args[0]}\\right)")},bitAnd:{2:"\\left(${args[0]}".concat(be.bitAnd,"${args[1]}\\right)")},bitNot:{1:be.bitNot+"\\left(${args[0]}\\right)"},bitOr:{2:"\\left(${args[0]}".concat(be.bitOr,"${args[1]}\\right)")},bitXor:{2:"\\left(${args[0]}".concat(be.bitXor,"${args[1]}\\right)")},leftShift:{2:"\\left(${args[0]}".concat(be.leftShift,"${args[1]}\\right)")},rightArithShift:{2:"\\left(${args[0]}".concat(be.rightArithShift,"${args[1]}\\right)")},rightLogShift:{2:"\\left(${args[0]}".concat(be.rightLogShift,"${args[1]}\\right)")},bellNumbers:{1:"\\mathrm{B}_{${args[0]}}"},catalan:{1:"\\mathrm{C}_{${args[0]}}"},stirlingS2:{2:"\\mathrm{S}\\left(${args}\\right)"},arg:{1:"\\arg\\left(${args[0]}\\right)"},conj:{1:"\\left(${args[0]}\\right)^*"},im:{1:"\\Im\\left\\lbrace${args[0]}\\right\\rbrace"},re:{1:"\\Re\\left\\lbrace${args[0]}\\right\\rbrace"},and:{2:"\\left(${args[0]}".concat(be.and,"${args[1]}\\right)")},not:{1:be.not+"\\left(${args[0]}\\right)"},or:{2:"\\left(${args[0]}".concat(be.or,"${args[1]}\\right)")},xor:{2:"\\left(${args[0]}".concat(be.xor,"${args[1]}\\right)")},cross:{2:"\\left(${args[0]}\\right)\\times\\left(${args[1]}\\right)"},ctranspose:{1:"\\left(${args[0]}\\right)".concat(be.ctranspose)},det:{1:"\\det\\left(${args[0]}\\right)"},dot:{2:"\\left(${args[0]}\\cdot${args[1]}\\right)"},expm:{1:"\\exp\\left(${args[0]}\\right)"},inv:{1:"\\left(${args[0]}\\right)^{-1}"},sqrtm:{1:"{${args[0]}}".concat(be.pow,"{\\frac{1}{2}}")},trace:{1:"\\mathrm{tr}\\left(${args[0]}\\right)"},transpose:{1:"\\left(${args[0]}\\right)".concat(be.transpose)},combinations:{2:"\\binom{${args[0]}}{${args[1]}}"},combinationsWithRep:{2:"\\left(\\!\\!{\\binom{${args[0]}}{${args[1]}}}\\!\\!\\right)"},factorial:{1:"\\left(${args[0]}\\right)".concat(be.factorial)},gamma:{1:"\\Gamma\\left(${args[0]}\\right)"},equal:{2:"\\left(${args[0]}".concat(be.equal,"${args[1]}\\right)")},larger:{2:"\\left(${args[0]}".concat(be.larger,"${args[1]}\\right)")},largerEq:{2:"\\left(${args[0]}".concat(be.largerEq,"${args[1]}\\right)")},smaller:{2:"\\left(${args[0]}".concat(be.smaller,"${args[1]}\\right)")},smallerEq:{2:"\\left(${args[0]}".concat(be.smallerEq,"${args[1]}\\right)")},unequal:{2:"\\left(${args[0]}".concat(be.unequal,"${args[1]}\\right)")},erf:{1:"erf\\left(${args[0]}\\right)"},max:"\\max\\left(${args}\\right)",min:"\\min\\left(${args}\\right)",variance:"\\mathrm{Var}\\left(${args}\\right)",acos:{1:"\\cos^{-1}\\left(${args[0]}\\right)"},acosh:{1:"\\cosh^{-1}\\left(${args[0]}\\right)"},acot:{1:"\\cot^{-1}\\left(${args[0]}\\right)"},acoth:{1:"\\coth^{-1}\\left(${args[0]}\\right)"},acsc:{1:"\\csc^{-1}\\left(${args[0]}\\right)"},acsch:{1:"\\mathrm{csch}^{-1}\\left(${args[0]}\\right)"},asec:{1:"\\sec^{-1}\\left(${args[0]}\\right)"},asech:{1:"\\mathrm{sech}^{-1}\\left(${args[0]}\\right)"},asin:{1:"\\sin^{-1}\\left(${args[0]}\\right)"},asinh:{1:"\\sinh^{-1}\\left(${args[0]}\\right)"},atan:{1:"\\tan^{-1}\\left(${args[0]}\\right)"},atan2:{2:"\\mathrm{atan2}\\left(${args}\\right)"},atanh:{1:"\\tanh^{-1}\\left(${args[0]}\\right)"},cos:{1:"\\cos\\left(${args[0]}\\right)"},cosh:{1:"\\cosh\\left(${args[0]}\\right)"},cot:{1:"\\cot\\left(${args[0]}\\right)"},coth:{1:"\\coth\\left(${args[0]}\\right)"},csc:{1:"\\csc\\left(${args[0]}\\right)"},csch:{1:"\\mathrm{csch}\\left(${args[0]}\\right)"},sec:{1:"\\sec\\left(${args[0]}\\right)"},sech:{1:"\\mathrm{sech}\\left(${args[0]}\\right)"},sin:{1:"\\sin\\left(${args[0]}\\right)"},sinh:{1:"\\sinh\\left(${args[0]}\\right)"},tan:{1:"\\tan\\left(${args[0]}\\right)"},tanh:{1:"\\tanh\\left(${args[0]}\\right)"},to:{2:"\\left(${args[0]}".concat(be.to,"${args[1]}\\right)")},numeric:function(e,t){return e.args[0].toTex()},number:{0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"},string:{0:'\\mathtt{""}',1:"\\mathrm{string}\\left(${args[0]}\\right)"},bignumber:{0:"0",1:"\\left(${args[0]}\\right)"},complex:{0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)+".concat(Pi.i,"\\cdot\\left(${args[1]}\\right)\\right)")},matrix:{0:"\\begin{bmatrix}\\end{bmatrix}",1:"\\left(${args[0]}\\right)",2:"\\left(${args[0]}\\right)"},sparse:{0:"\\begin{bsparse}\\end{bsparse}",1:"\\left(${args[0]}\\right)"},unit:{1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"}},Ep="\\mathrm{${name}}\\left(${args}\\right)",go={deg:"^\\circ"};function ki(i){return Sp(i,{preserveFormatting:!0})}function yo(i,e){return e=typeof e=="undefined"?!1:e,e?ae(go,i)?go[i]:"\\mathrm{"+ki(i)+"}":ae(Pi,i)?Pi[i]:ki(i)}var Op="ConstantNode",zp=["Node"],Ap=K(Op,zp,i=>{var{Node:e}=i;function t(r){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");this.value=r}return t.prototype=new e,t.prototype.type="ConstantNode",t.prototype.isConstantNode=!0,t.prototype._compile=function(r,n){var s=this.value;return function(){return s}},t.prototype.forEach=function(r){},t.prototype.map=function(r){return this.clone()},t.prototype.clone=function(){return new t(this.value)},t.prototype._toString=function(r){return qe(this.value,r)},t.prototype.toHTML=function(r){var n=this._toString(r);switch(ot(this.value)){case"number":case"BigNumber":case"Fraction":return'<span class="math-number">'+n+"</span>";case"string":return'<span class="math-string">'+n+"</span>";case"boolean":return'<span class="math-boolean">'+n+"</span>";case"null":return'<span class="math-null-symbol">'+n+"</span>";case"undefined":return'<span class="math-undefined">'+n+"</span>";default:return'<span class="math-symbol">'+n+"</span>"}},t.prototype.toJSON=function(){return{mathjs:"ConstantNode",value:this.value}},t.fromJSON=function(r){return new t(r.value)},t.prototype._toTex=function(r){var n=this._toString(r);switch(ot(this.value)){case"string":return"\\mathtt{"+ki(n)+"}";case"number":case"BigNumber":{if(!isFinite(this.value))return this.value.valueOf()<0?"-\\infty":"\\infty";var s=n.toLowerCase().indexOf("e");if(s!==-1)return n.substring(0,s)+"\\cdot10^{"+n.substring(s+1)+"}"}return n;case"Fraction":return this.value.toLatex();default:return n}},t},{isClass:!0,isNode:!0}),Cp="FunctionAssignmentNode",Tp=["typed","Node"],Fp=K(Cp,Tp,i=>{var{typed:e,Node:t}=i;function r(s,c,l){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if(typeof s!="string")throw new TypeError('String expected for parameter "name"');if(!Array.isArray(c))throw new TypeError('Array containing strings or objects expected for parameter "params"');if(!Pe(l))throw new TypeError('Node expected for parameter "expr"');if(s in fo)throw new Error('Illegal function name, "'+s+'" is a reserved keyword');this.name=s,this.params=c.map(function(h){return h&&h.name||h}),this.types=c.map(function(h){return h&&h.type||"any"}),this.expr=l}r.prototype=new t,r.prototype.type="FunctionAssignmentNode",r.prototype.isFunctionAssignmentNode=!0,r.prototype._compile=function(s,c){var l=Object.create(c);ua(this.params,function(p){l[p]=!0});var h=this.expr._compile(s,l),f=this.name,o=this.params,a=ca(this.types,","),u=f+"("+ca(this.params,", ")+")";return function(m,d,w){var v={};v[a]=function(){for(var g=Object.create(d),b=0;b<o.length;b++)g[o[b]]=arguments[b];return h(m,g,w)};var x=e(f,v);return x.syntax=u,pr(m,f,x),x}},r.prototype.forEach=function(s){s(this.expr,"expr",this)},r.prototype.map=function(s){var c=this._ifNode(s(this.expr,"expr",this));return new r(this.name,this.params.slice(0),c)},r.prototype.clone=function(){return new r(this.name,this.params.slice(0),this.expr)};function n(s,c){var l=Oe(s,c),h=Oe(s.expr,c);return c==="all"||h!==null&&h<=l}return r.prototype._toString=function(s){var c=s&&s.parenthesis?s.parenthesis:"keep",l=this.expr.toString(s);return n(this,c)&&(l="("+l+")"),this.name+"("+this.params.join(", ")+") = "+l},r.prototype.toJSON=function(){var s=this.types;return{mathjs:"FunctionAssignmentNode",name:this.name,params:this.params.map(function(c,l){return{name:c,type:s[l]}}),expr:this.expr}},r.fromJSON=function(s){return new r(s.name,s.params,s.expr)},r.prototype.toHTML=function(s){for(var c=s&&s.parenthesis?s.parenthesis:"keep",l=[],h=0;h<this.params.length;h++)l.push('<span class="math-symbol math-parameter">'+gt(this.params[h])+"</span>");var f=this.expr.toHTML(s);return n(this,c)&&(f='<span class="math-parenthesis math-round-parenthesis">(</span>'+f+'<span class="math-parenthesis math-round-parenthesis">)</span>'),'<span class="math-function">'+gt(this.name)+'</span><span class="math-parenthesis math-round-parenthesis">(</span>'+l.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-round-parenthesis">)</span><span class="math-operator math-assignment-operator math-variable-assignment-operator math-binary-operator">=</span>'+f},r.prototype._toTex=function(s){var c=s&&s.parenthesis?s.parenthesis:"keep",l=this.expr.toTex(s);return n(this,c)&&(l="\\left(".concat(l,"\\right)")),"\\mathrm{"+this.name+"}\\left("+this.params.map(yo).join(",")+"\\right):="+l},r},{isClass:!0,isNode:!0}),Dp="IndexNode",Ip=["Range","Node","size"],Bp=K(Dp,Ip,i=>{var{Range:e,Node:t,size:r}=i;function n(c,l){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(this.dimensions=c,this.dotNotation=l||!1,!Array.isArray(c)||!c.every(Pe))throw new TypeError('Array containing Nodes expected for parameter "dimensions"');if(this.dotNotation&&!this.isObjectProperty())throw new Error("dotNotation only applicable for object properties")}n.prototype=new t,n.prototype.type="IndexNode",n.prototype.isIndexNode=!0,n.prototype._compile=function(c,l){var h=wt(this.dimensions,function(o,a){if(gi(o))if(o.needsEnd()){var u=Object.create(l);u.end=!0;var p=o.start._compile(c,u),m=o.end._compile(c,u),d=o.step?o.step._compile(c,u):function(){return 1};return function(N,O,E){var F=r(E).valueOf(),B=Object.create(O);return B.end=F[a],s(p(N,B,E),m(N,B,E),d(N,B,E))}}else{var w=o.start._compile(c,l),v=o.end._compile(c,l),x=o.step?o.step._compile(c,l):function(){return 1};return function(N,O,E){return s(w(N,O,E),v(N,O,E),x(N,O,E))}}else if(lt(o)&&o.name==="end"){var g=Object.create(l);g.end=!0;var b=o._compile(c,g);return function(N,O,E){var F=r(E).valueOf(),B=Object.create(O);return B.end=F[a],b(N,B,E)}}else{var M=o._compile(c,l);return function(N,O,E){return M(N,O,E)}}}),f=ut(c,"index");return function(a,u,p){var m=wt(h,function(d){return d(a,u,p)});return f(...m)}},n.prototype.forEach=function(c){for(var l=0;l<this.dimensions.length;l++)c(this.dimensions[l],"dimensions["+l+"]",this)},n.prototype.map=function(c){for(var l=[],h=0;h<this.dimensions.length;h++)l[h]=this._ifNode(c(this.dimensions[h],"dimensions["+h+"]",this));return new n(l,this.dotNotation)},n.prototype.clone=function(){return new n(this.dimensions.slice(0),this.dotNotation)},n.prototype.isObjectProperty=function(){return this.dimensions.length===1&&ur(this.dimensions[0])&&typeof this.dimensions[0].value=="string"},n.prototype.getObjectProperty=function(){return this.isObjectProperty()?this.dimensions[0].value:null},n.prototype._toString=function(c){return this.dotNotation?"."+this.getObjectProperty():"["+this.dimensions.join(", ")+"]"},n.prototype.toJSON=function(){return{mathjs:"IndexNode",dimensions:this.dimensions,dotNotation:this.dotNotation}},n.fromJSON=function(c){return new n(c.dimensions,c.dotNotation)},n.prototype.toHTML=function(c){for(var l=[],h=0;h<this.dimensions.length;h++)l[h]=this.dimensions[h].toHTML();return this.dotNotation?'<span class="math-operator math-accessor-operator">.</span><span class="math-symbol math-property">'+gt(this.getObjectProperty())+"</span>":'<span class="math-parenthesis math-square-parenthesis">[</span>'+l.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-square-parenthesis">]</span>'},n.prototype._toTex=function(c){var l=this.dimensions.map(function(h){return h.toTex(c)});return this.dotNotation?"."+this.getObjectProperty():"_{"+l.join(",")+"}"};function s(c,l,h){return new e(Ie(c)?c.toNumber():c,Ie(l)?l.toNumber():l,Ie(h)?h.toNumber():h)}return n},{isClass:!0,isNode:!0}),Rp="ObjectNode",Pp=["Node"],kp=K(Rp,Pp,i=>{var{Node:e}=i;function t(r){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");if(this.properties=r||{},r&&(typeof r!="object"||!Object.keys(r).every(function(n){return Pe(r[n])})))throw new TypeError("Object containing Nodes expected")}return t.prototype=new e,t.prototype.type="ObjectNode",t.prototype.isObjectNode=!0,t.prototype._compile=function(r,n){var s={};for(var c in this.properties)if(ae(this.properties,c)){var l=Mn(c),h=JSON.parse(l);if(!Fi(this.properties,h))throw new Error('No access to property "'+h+'"');s[h]=this.properties[c]._compile(r,n)}return function(o,a,u){var p={};for(var m in s)ae(s,m)&&(p[m]=s[m](o,a,u));return p}},t.prototype.forEach=function(r){for(var n in this.properties)ae(this.properties,n)&&r(this.properties[n],"properties["+Mn(n)+"]",this)},t.prototype.map=function(r){var n={};for(var s in this.properties)ae(this.properties,s)&&(n[s]=this._ifNode(r(this.properties[s],"properties["+Mn(s)+"]",this)));return new t(n)},t.prototype.clone=function(){var r={};for(var n in this.properties)ae(this.properties,n)&&(r[n]=this.properties[n]);return new t(r)},t.prototype._toString=function(r){var n=[];for(var s in this.properties)ae(this.properties,s)&&n.push(Mn(s)+": "+this.properties[s].toString(r));return"{"+n.join(", ")+"}"},t.prototype.toJSON=function(){return{mathjs:"ObjectNode",properties:this.properties}},t.fromJSON=function(r){return new t(r.properties)},t.prototype.toHTML=function(r){var n=[];for(var s in this.properties)ae(this.properties,s)&&n.push('<span class="math-symbol math-property">'+gt(s)+'</span><span class="math-operator math-assignment-operator math-property-assignment-operator math-binary-operator">:</span>'+this.properties[s].toHTML(r));return'<span class="math-parenthesis math-curly-parenthesis">{</span>'+n.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-curly-parenthesis">}</span>'},t.prototype._toTex=function(r){var n=[];for(var s in this.properties)ae(this.properties,s)&&n.push("\\mathbf{"+s+":} & "+this.properties[s].toTex(r)+"\\\\");return"\\left\\{\\begin{array}{ll}".concat(n.join(`
`),"\\end{array}\\right\\}")},t},{isClass:!0,isNode:!0}),Lp="OperatorNode",Up=["Node"],$p=K(Lp,Up,i=>{var{Node:e}=i;function t(n,s,c,l){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");if(typeof n!="string")throw new TypeError('string expected for parameter "op"');if(typeof s!="string")throw new TypeError('string expected for parameter "fn"');if(!Array.isArray(c)||!c.every(Pe))throw new TypeError('Array containing Nodes expected for parameter "args"');this.implicit=l===!0,this.op=n,this.fn=s,this.args=c||[]}t.prototype=new e,t.prototype.type="OperatorNode",t.prototype.isOperatorNode=!0,t.prototype._compile=function(n,s){if(typeof this.fn!="string"||!Di(n,this.fn))throw n[this.fn]?new Error('No access to function "'+this.fn+'"'):new Error("Function "+this.fn+' missing in provided namespace "math"');var c=ut(n,this.fn),l=wt(this.args,function(a){return a._compile(n,s)});if(l.length===1){var h=l[0];return function(u,p,m){return c(h(u,p,m))}}else if(l.length===2){var f=l[0],o=l[1];return function(u,p,m){return c(f(u,p,m),o(u,p,m))}}else return function(u,p,m){return c.apply(null,wt(l,function(d){return d(u,p,m)}))}},t.prototype.forEach=function(n){for(var s=0;s<this.args.length;s++)n(this.args[s],"args["+s+"]",this)},t.prototype.map=function(n){for(var s=[],c=0;c<this.args.length;c++)s[c]=this._ifNode(n(this.args[c],"args["+c+"]",this));return new t(this.op,this.fn,s,this.implicit)},t.prototype.clone=function(){return new t(this.op,this.fn,this.args.slice(0),this.implicit)},t.prototype.isUnary=function(){return this.args.length===1},t.prototype.isBinary=function(){return this.args.length===2};function r(n,s,c,l,h){var f=Oe(n,s),o=Jr(n,s);if(s==="all"||l.length>2&&n.getIdentifier()!=="OperatorNode:add"&&n.getIdentifier()!=="OperatorNode:multiply")return l.map(function(O){switch(O.getContent().type){case"ArrayNode":case"ConstantNode":case"SymbolNode":case"ParenthesisNode":return!1;default:return!0}});var a;switch(l.length){case 0:a=[];break;case 1:{var u=Oe(l[0],s);if(h&&u!==null){var p,m;if(s==="keep"?(p=l[0].getIdentifier(),m=n.getIdentifier()):(p=l[0].getContent().getIdentifier(),m=n.getContent().getIdentifier()),Tt[f][m].latexLeftParens===!1){a=[!1];break}if(Tt[u][p].latexParens===!1){a=[!1];break}}if(u===null){a=[!1];break}if(u<=f){a=[!0];break}a=[!1]}break;case 2:{var d,w=Oe(l[0],s),v=Bi(n,l[0],s);w===null?d=!1:w===f&&o==="right"&&!v||w<f?d=!0:d=!1;var x,g=Oe(l[1],s),b=Bi(n,l[1],s);if(g===null?x=!1:g===f&&o==="left"&&!b||g<f?x=!0:x=!1,h){var M,_,N;s==="keep"?(M=n.getIdentifier(),_=n.args[0].getIdentifier(),N=n.args[1].getIdentifier()):(M=n.getContent().getIdentifier(),_=n.args[0].getContent().getIdentifier(),N=n.args[1].getContent().getIdentifier()),w!==null&&(Tt[f][M].latexLeftParens===!1&&(d=!1),Tt[w][_].latexParens===!1&&(d=!1)),g!==null&&(Tt[f][M].latexRightParens===!1&&(x=!1),Tt[g][N].latexParens===!1&&(x=!1))}a=[d,x]}break;default:(n.getIdentifier()==="OperatorNode:add"||n.getIdentifier()==="OperatorNode:multiply")&&(a=l.map(function(O){var E=Oe(O,s),F=Bi(n,O,s),B=Jr(O,s);return E===null?!1:f===E&&o===B&&!F?!0:E<f}));break}return l.length>=2&&n.getIdentifier()==="OperatorNode:multiply"&&n.implicit&&s==="auto"&&c==="hide"&&(a=l.map(function(O,E){var F=O.getIdentifier()==="ParenthesisNode";return!!(a[E]||F)})),a}return t.prototype._toString=function(n){var s=n&&n.parenthesis?n.parenthesis:"keep",c=n&&n.implicit?n.implicit:"hide",l=this.args,h=r(this,s,c,l,!1);if(l.length===1){var f=Jr(this,s),o=l[0].toString(n);h[0]&&(o="("+o+")");var a=/[a-zA-Z]+/.test(this.op);return f==="right"?this.op+(a?" ":"")+o:f==="left"?o+(a?" ":"")+this.op:o+this.op}else if(l.length===2){var u=l[0].toString(n),p=l[1].toString(n);return h[0]&&(u="("+u+")"),h[1]&&(p="("+p+")"),this.implicit&&this.getIdentifier()==="OperatorNode:multiply"&&c==="hide"?u+" "+p:u+" "+this.op+" "+p}else if(l.length>2&&(this.getIdentifier()==="OperatorNode:add"||this.getIdentifier()==="OperatorNode:multiply")){var m=l.map(function(d,w){return d=d.toString(n),h[w]&&(d="("+d+")"),d});return this.implicit&&this.getIdentifier()==="OperatorNode:multiply"&&c==="hide"?m.join(" "):m.join(" "+this.op+" ")}else return this.fn+"("+this.args.join(", ")+")"},t.prototype.toJSON=function(){return{mathjs:"OperatorNode",op:this.op,fn:this.fn,args:this.args,implicit:this.implicit}},t.fromJSON=function(n){return new t(n.op,n.fn,n.args,n.implicit)},t.prototype.toHTML=function(n){var s=n&&n.parenthesis?n.parenthesis:"keep",c=n&&n.implicit?n.implicit:"hide",l=this.args,h=r(this,s,c,l,!1);if(l.length===1){var f=Jr(this,s),o=l[0].toHTML(n);return h[0]&&(o='<span class="math-parenthesis math-round-parenthesis">(</span>'+o+'<span class="math-parenthesis math-round-parenthesis">)</span>'),f==="right"?'<span class="math-operator math-unary-operator math-lefthand-unary-operator">'+gt(this.op)+"</span>"+o:o+'<span class="math-operator math-unary-operator math-righthand-unary-operator">'+gt(this.op)+"</span>"}else if(l.length===2){var a=l[0].toHTML(n),u=l[1].toHTML(n);return h[0]&&(a='<span class="math-parenthesis math-round-parenthesis">(</span>'+a+'<span class="math-parenthesis math-round-parenthesis">)</span>'),h[1]&&(u='<span class="math-parenthesis math-round-parenthesis">(</span>'+u+'<span class="math-parenthesis math-round-parenthesis">)</span>'),this.implicit&&this.getIdentifier()==="OperatorNode:multiply"&&c==="hide"?a+'<span class="math-operator math-binary-operator math-implicit-binary-operator"></span>'+u:a+'<span class="math-operator math-binary-operator math-explicit-binary-operator">'+gt(this.op)+"</span>"+u}else{var p=l.map(function(m,d){return m=m.toHTML(n),h[d]&&(m='<span class="math-parenthesis math-round-parenthesis">(</span>'+m+'<span class="math-parenthesis math-round-parenthesis">)</span>'),m});return l.length>2&&(this.getIdentifier()==="OperatorNode:add"||this.getIdentifier()==="OperatorNode:multiply")?this.implicit&&this.getIdentifier()==="OperatorNode:multiply"&&c==="hide"?p.join('<span class="math-operator math-binary-operator math-implicit-binary-operator"></span>'):p.join('<span class="math-operator math-binary-operator math-explicit-binary-operator">'+gt(this.op)+"</span>"):'<span class="math-function">'+gt(this.fn)+'</span><span class="math-paranthesis math-round-parenthesis">(</span>'+p.join('<span class="math-separator">,</span>')+'<span class="math-paranthesis math-round-parenthesis">)</span>'}},t.prototype._toTex=function(n){var s=n&&n.parenthesis?n.parenthesis:"keep",c=n&&n.implicit?n.implicit:"hide",l=this.args,h=r(this,s,c,l,!0),f=be[this.fn];if(f=typeof f=="undefined"?this.op:f,l.length===1){var o=Jr(this,s),a=l[0].toTex(n);return h[0]&&(a="\\left(".concat(a,"\\right)")),o==="right"?f+a:a+f}else if(l.length===2){var u=l[0],p=u.toTex(n);h[0]&&(p="\\left(".concat(p,"\\right)"));var m=l[1],d=m.toTex(n);h[1]&&(d="\\left(".concat(d,"\\right)"));var w;switch(s==="keep"?w=u.getIdentifier():w=u.getContent().getIdentifier(),this.getIdentifier()){case"OperatorNode:divide":return f+"{"+p+"}{"+d+"}";case"OperatorNode:pow":switch(p="{"+p+"}",d="{"+d+"}",w){case"ConditionalNode":case"OperatorNode:divide":p="\\left(".concat(p,"\\right)")}break;case"OperatorNode:multiply":if(this.implicit&&c==="hide")return p+"~"+d}return p+f+d}else if(l.length>2&&(this.getIdentifier()==="OperatorNode:add"||this.getIdentifier()==="OperatorNode:multiply")){var v=l.map(function(x,g){return x=x.toTex(n),h[g]&&(x="\\left(".concat(x,"\\right)")),x});return this.getIdentifier()==="OperatorNode:multiply"&&this.implicit?v.join("~"):v.join(f)}else return"\\mathrm{"+this.fn+"}\\left("+l.map(function(x){return x.toTex(n)}).join(",")+"\\right)"},t.prototype.getIdentifier=function(){return this.type+":"+this.fn},t},{isClass:!0,isNode:!0}),qp="ParenthesisNode",Vp=["Node"],jp=K(qp,Vp,i=>{var{Node:e}=i;function t(r){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");if(!Pe(r))throw new TypeError('Node expected for parameter "content"');this.content=r}return t.prototype=new e,t.prototype.type="ParenthesisNode",t.prototype.isParenthesisNode=!0,t.prototype._compile=function(r,n){return this.content._compile(r,n)},t.prototype.getContent=function(){return this.content.getContent()},t.prototype.forEach=function(r){r(this.content,"content",this)},t.prototype.map=function(r){var n=r(this.content,"content",this);return new t(n)},t.prototype.clone=function(){return new t(this.content)},t.prototype._toString=function(r){return!r||r&&!r.parenthesis||r&&r.parenthesis==="keep"?"("+this.content.toString(r)+")":this.content.toString(r)},t.prototype.toJSON=function(){return{mathjs:"ParenthesisNode",content:this.content}},t.fromJSON=function(r){return new t(r.content)},t.prototype.toHTML=function(r){return!r||r&&!r.parenthesis||r&&r.parenthesis==="keep"?'<span class="math-parenthesis math-round-parenthesis">(</span>'+this.content.toHTML(r)+'<span class="math-parenthesis math-round-parenthesis">)</span>':this.content.toHTML(r)},t.prototype._toTex=function(r){return!r||r&&!r.parenthesis||r&&r.parenthesis==="keep"?"\\left(".concat(this.content.toTex(r),"\\right)"):this.content.toTex(r)},t},{isClass:!0,isNode:!0}),Hp="RangeNode",Gp=["Node"],Wp=K(Hp,Gp,i=>{var{Node:e}=i;function t(n,s,c){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");if(!Pe(n))throw new TypeError("Node expected");if(!Pe(s))throw new TypeError("Node expected");if(c&&!Pe(c))throw new TypeError("Node expected");if(arguments.length>3)throw new Error("Too many arguments");this.start=n,this.end=s,this.step=c||null}t.prototype=new e,t.prototype.type="RangeNode",t.prototype.isRangeNode=!0,t.prototype.needsEnd=function(){var n=this.filter(function(s){return lt(s)&&s.name==="end"});return n.length>0},t.prototype._compile=function(n,s){var c=n.range,l=this.start._compile(n,s),h=this.end._compile(n,s);if(this.step){var f=this.step._compile(n,s);return function(a,u,p){return c(l(a,u,p),h(a,u,p),f(a,u,p))}}else return function(a,u,p){return c(l(a,u,p),h(a,u,p))}},t.prototype.forEach=function(n){n(this.start,"start",this),n(this.end,"end",this),this.step&&n(this.step,"step",this)},t.prototype.map=function(n){return new t(this._ifNode(n(this.start,"start",this)),this._ifNode(n(this.end,"end",this)),this.step&&this._ifNode(n(this.step,"step",this)))},t.prototype.clone=function(){return new t(this.start,this.end,this.step&&this.step)};function r(n,s){var c=Oe(n,s),l={},h=Oe(n.start,s);if(l.start=h!==null&&h<=c||s==="all",n.step){var f=Oe(n.step,s);l.step=f!==null&&f<=c||s==="all"}var o=Oe(n.end,s);return l.end=o!==null&&o<=c||s==="all",l}return t.prototype._toString=function(n){var s=n&&n.parenthesis?n.parenthesis:"keep",c=r(this,s),l,h=this.start.toString(n);if(c.start&&(h="("+h+")"),l=h,this.step){var f=this.step.toString(n);c.step&&(f="("+f+")"),l+=":"+f}var o=this.end.toString(n);return c.end&&(o="("+o+")"),l+=":"+o,l},t.prototype.toJSON=function(){return{mathjs:"RangeNode",start:this.start,end:this.end,step:this.step}},t.fromJSON=function(n){return new t(n.start,n.end,n.step)},t.prototype.toHTML=function(n){var s=n&&n.parenthesis?n.parenthesis:"keep",c=r(this,s),l,h=this.start.toHTML(n);if(c.start&&(h='<span class="math-parenthesis math-round-parenthesis">(</span>'+h+'<span class="math-parenthesis math-round-parenthesis">)</span>'),l=h,this.step){var f=this.step.toHTML(n);c.step&&(f='<span class="math-parenthesis math-round-parenthesis">(</span>'+f+'<span class="math-parenthesis math-round-parenthesis">)</span>'),l+='<span class="math-operator math-range-operator">:</span>'+f}var o=this.end.toHTML(n);return c.end&&(o='<span class="math-parenthesis math-round-parenthesis">(</span>'+o+'<span class="math-parenthesis math-round-parenthesis">)</span>'),l+='<span class="math-operator math-range-operator">:</span>'+o,l},t.prototype._toTex=function(n){var s=n&&n.parenthesis?n.parenthesis:"keep",c=r(this,s),l=this.start.toTex(n);if(c.start&&(l="\\left(".concat(l,"\\right)")),this.step){var h=this.step.toTex(n);c.step&&(h="\\left(".concat(h,"\\right)")),l+=":"+h}var f=this.end.toTex(n);return c.end&&(f="\\left(".concat(f,"\\right)")),l+=":"+f,l},t},{isClass:!0,isNode:!0}),Yp="RelationalNode",Zp=["Node"],Jp=K(Yp,Zp,i=>{var{Node:e}=i;function t(r,n){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");if(!Array.isArray(r))throw new TypeError("Parameter conditionals must be an array");if(!Array.isArray(n))throw new TypeError("Parameter params must be an array");if(r.length!==n.length-1)throw new TypeError("Parameter params must contain exactly one more element than parameter conditionals");this.conditionals=r,this.params=n}return t.prototype=new e,t.prototype.type="RelationalNode",t.prototype.isRelationalNode=!0,t.prototype._compile=function(r,n){var s=this,c=this.params.map(l=>l._compile(r,n));return function(h,f,o){for(var a,u=c[0](h,f,o),p=0;p<s.conditionals.length;p++){a=u,u=c[p+1](h,f,o);var m=ut(r,s.conditionals[p]);if(!m(a,u))return!1}return!0}},t.prototype.forEach=function(r){this.params.forEach((n,s)=>r(n,"params["+s+"]",this),this)},t.prototype.map=function(r){return new t(this.conditionals.slice(),this.params.map((n,s)=>this._ifNode(r(n,"params["+s+"]",this)),this))},t.prototype.clone=function(){return new t(this.conditionals,this.params)},t.prototype._toString=function(r){for(var n=r&&r.parenthesis?r.parenthesis:"keep",s=Oe(this,n),c=this.params.map(function(o,a){var u=Oe(o,n);return n==="all"||u!==null&&u<=s?"("+o.toString(r)+")":o.toString(r)}),l={equal:"==",unequal:"!=",smaller:"<",larger:">",smallerEq:"<=",largerEq:">="},h=c[0],f=0;f<this.conditionals.length;f++)h+=" "+l[this.conditionals[f]]+" "+c[f+1];return h},t.prototype.toJSON=function(){return{mathjs:"RelationalNode",conditionals:this.conditionals,params:this.params}},t.fromJSON=function(r){return new t(r.conditionals,r.params)},t.prototype.toHTML=function(r){for(var n=r&&r.parenthesis?r.parenthesis:"keep",s=Oe(this,n),c=this.params.map(function(o,a){var u=Oe(o,n);return n==="all"||u!==null&&u<=s?'<span class="math-parenthesis math-round-parenthesis">(</span>'+o.toHTML(r)+'<span class="math-parenthesis math-round-parenthesis">)</span>':o.toHTML(r)}),l={equal:"==",unequal:"!=",smaller:"<",larger:">",smallerEq:"<=",largerEq:">="},h=c[0],f=0;f<this.conditionals.length;f++)h+='<span class="math-operator math-binary-operator math-explicit-binary-operator">'+gt(l[this.conditionals[f]])+"</span>"+c[f+1];return h},t.prototype._toTex=function(r){for(var n=r&&r.parenthesis?r.parenthesis:"keep",s=Oe(this,n),c=this.params.map(function(f,o){var a=Oe(f,n);return n==="all"||a!==null&&a<=s?"\\left("+f.toTex(r)+"\right)":f.toTex(r)}),l=c[0],h=0;h<this.conditionals.length;h++)l+=be[this.conditionals[h]]+c[h+1];return l},t},{isClass:!0,isNode:!0}),Qp="SymbolNode",Xp=["math","?Unit","Node"],Kp=K(Qp,Xp,i=>{var{math:e,Unit:t,Node:r}=i;function n(l){return t?t.isValuelessUnit(l):!1}function s(l){if(!(this instanceof s))throw new SyntaxError("Constructor must be called with the new operator");if(typeof l!="string")throw new TypeError('String expected for parameter "name"');this.name=l}s.prototype=new r,s.prototype.type="SymbolNode",s.prototype.isSymbolNode=!0,s.prototype._compile=function(l,h){var f=this.name;if(h[f]===!0)return function(a,u,p){return u[f]};if(f in l)return function(a,u,p){return f in a?ut(a,f):ut(l,f)};var o=n(f);return function(a,u,p){return f in a?ut(a,f):o?new t(null,f):c(f)}},s.prototype.forEach=function(l){},s.prototype.map=function(l){return this.clone()};function c(l){throw new Error("Undefined symbol "+l)}return s.prototype.clone=function(){return new s(this.name)},s.prototype._toString=function(l){return this.name},s.prototype.toHTML=function(l){var h=gt(this.name);return h==="true"||h==="false"?'<span class="math-symbol math-boolean">'+h+"</span>":h==="i"?'<span class="math-symbol math-imaginary-symbol">'+h+"</span>":h==="Infinity"?'<span class="math-symbol math-infinity-symbol">'+h+"</span>":h==="NaN"?'<span class="math-symbol math-nan-symbol">'+h+"</span>":h==="null"?'<span class="math-symbol math-null-symbol">'+h+"</span>":h==="undefined"?'<span class="math-symbol math-undefined-symbol">'+h+"</span>":'<span class="math-symbol">'+h+"</span>"},s.prototype.toJSON=function(){return{mathjs:"SymbolNode",name:this.name}},s.fromJSON=function(l){return new s(l.name)},s.prototype._toTex=function(l){var h=!1;typeof e[this.name]=="undefined"&&n(this.name)&&(h=!0);var f=yo(this.name,h);return f[0]==="\\"?f:" "+f},s},{isClass:!0,isNode:!0});function Qr(){return Qr=Object.assign||function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},Qr.apply(this,arguments)}var ed="FunctionNode",td=["math","Node","SymbolNode"],rd=K(ed,td,i=>{var{math:e,Node:t,SymbolNode:r}=i;function n(h,f){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(typeof h=="string"&&(h=new r(h)),!Pe(h))throw new TypeError('Node expected as parameter "fn"');if(!Array.isArray(f)||!f.every(Pe))throw new TypeError('Array containing Nodes expected for parameter "args"');this.fn=h,this.args=f||[],Object.defineProperty(this,"name",{get:function(){return this.fn.name||""}.bind(this),set:function(){throw new Error("Cannot assign a new name, name is read-only")}})}n.prototype=new t,n.prototype.type="FunctionNode",n.prototype.isFunctionNode=!0,n.prototype._compile=function(h,f){if(!(this instanceof n))throw new TypeError("No valid FunctionNode");var o=wt(this.args,function(N){return N._compile(h,f)});if(lt(this.fn)){var a=this.fn.name,u=a in h?ut(h,a):void 0,p=typeof u=="function"&&u.rawArgs===!0;if(p){var m=this.args;return function(O,E,F){return(a in O?ut(O,a):u)(m,h,Qr({},O,E))}}else if(o.length===1){var d=o[0];return function(O,E,F){return(a in O?ut(O,a):u)(d(O,E,F))}}else if(o.length===2){var w=o[0],v=o[1];return function(O,E,F){return(a in O?ut(O,a):u)(w(O,E,F),v(O,E,F))}}else return function(O,E,F){return(a in O?ut(O,a):u).apply(null,wt(o,function(B){return B(O,E,F)}))}}else if(or(this.fn)&&$r(this.fn.index)&&this.fn.index.isObjectProperty()){var x=this.fn.object._compile(h,f),g=this.fn.index.getObjectProperty(),b=this.args;return function(O,E,F){var B=x(O,E,F);cf(B,g);var I=B[g]&&B[g].rawArgs;return I?B[g](b,h,Qr({},O,E)):B[g].apply(B,wt(o,function(j){return j(O,E,F)}))}}else{var M=this.fn._compile(h,f),_=this.args;return function(O,E,F){var B=M(O,E,F),I=B&&B.rawArgs;return I?B(_,h,Qr({},O,E)):B.apply(B,wt(o,function(j){return j(O,E,F)}))}}},n.prototype.forEach=function(h){h(this.fn,"fn",this);for(var f=0;f<this.args.length;f++)h(this.args[f],"args["+f+"]",this)},n.prototype.map=function(h){for(var f=this._ifNode(h(this.fn,"fn",this)),o=[],a=0;a<this.args.length;a++)o[a]=this._ifNode(h(this.args[a],"args["+a+"]",this));return new n(f,o)},n.prototype.clone=function(){return new n(this.fn,this.args.slice(0))};var s=n.prototype.toString;n.prototype.toString=function(h){var f,o=this.fn.toString(h);return h&&typeof h.handler=="object"&&ae(h.handler,o)&&(f=h.handler[o](this,h)),typeof f!="undefined"?f:s.call(this,h)},n.prototype._toString=function(h){var f=this.args.map(function(a){return a.toString(h)}),o=pi(this.fn)?"("+this.fn.toString(h)+")":this.fn.toString(h);return o+"("+f.join(", ")+")"},n.prototype.toJSON=function(){return{mathjs:"FunctionNode",fn:this.fn,args:this.args}},n.fromJSON=function(h){return new n(h.fn,h.args)},n.prototype.toHTML=function(h){var f=this.args.map(function(o){return o.toHTML(h)});return'<span class="math-function">'+gt(this.fn)+'</span><span class="math-paranthesis math-round-parenthesis">(</span>'+f.join('<span class="math-separator">,</span>')+'<span class="math-paranthesis math-round-parenthesis">)</span>'};function c(h,f,o){for(var a="",u=/\$(?:\{([a-z_][a-z_0-9]*)(?:\[([0-9]+)\])?\}|\$)/gi,p=0,m;(m=u.exec(h))!==null;)if(a+=h.substring(p,m.index),p=m.index,m[0]==="$$")a+="$",p++;else{p+=m[0].length;var d=f[m[1]];if(!d)throw new ReferenceError("Template: Property "+m[1]+" does not exist.");if(m[2]===void 0)switch(typeof d){case"string":a+=d;break;case"object":if(Pe(d))a+=d.toTex(o);else if(Array.isArray(d))a+=d.map(function(w,v){if(Pe(w))return w.toTex(o);throw new TypeError("Template: "+m[1]+"["+v+"] is not a Node.")}).join(",");else throw new TypeError("Template: "+m[1]+" has to be a Node, String or array of Nodes");break;default:throw new TypeError("Template: "+m[1]+" has to be a Node, String or array of Nodes")}else if(Pe(d[m[2]]&&d[m[2]]))a+=d[m[2]].toTex(o);else throw new TypeError("Template: "+m[1]+"["+m[2]+"] is not a Node.")}return a+=h.slice(p),a}var l=n.prototype.toTex;return n.prototype.toTex=function(h){var f;return h&&typeof h.handler=="object"&&ae(h.handler,this.name)&&(f=h.handler[this.name](this,h)),typeof f!="undefined"?f:l.call(this,h)},n.prototype._toTex=function(h){var f=this.args.map(function(u){return u.toTex(h)}),o;vo[this.name]&&(o=vo[this.name]),e[this.name]&&(typeof e[this.name].toTex=="function"||typeof e[this.name].toTex=="object"||typeof e[this.name].toTex=="string")&&(o=e[this.name].toTex);var a;switch(typeof o){case"function":a=o(this,h);break;case"string":a=c(o,this,h);break;case"object":switch(typeof o[f.length]){case"function":a=o[f.length](this,h);break;case"string":a=c(o[f.length],this,h);break}}return typeof a!="undefined"?a:c(Ep,this,h)},n.prototype.getIdentifier=function(){return this.type+":"+this.name},n},{isClass:!0,isNode:!0});function Jt(){return Jt=Object.assign||function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},Jt.apply(this,arguments)}var wo="parse",nd=["typed","numeric","config","AccessorNode","ArrayNode","AssignmentNode","BlockNode","ConditionalNode","ConstantNode","FunctionAssignmentNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","ParenthesisNode","RangeNode","RelationalNode","SymbolNode"],id=K(wo,nd,i=>{var{typed:e,numeric:t,config:r,AccessorNode:n,ArrayNode:s,AssignmentNode:c,BlockNode:l,ConditionalNode:h,ConstantNode:f,FunctionAssignmentNode:o,FunctionNode:a,IndexNode:u,ObjectNode:p,OperatorNode:m,ParenthesisNode:d,RangeNode:w,RelationalNode:v,SymbolNode:x}=i,g=e(wo,{string:function(D){return ie(D,{})},"Array | Matrix":function(D){return b(D,{})},"string, Object":function(D,$){var X=$.nodes!==void 0?$.nodes:{};return ie(D,X)},"Array | Matrix, Object":b});function b(y){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},$=D.nodes!==void 0?D.nodes:{};return Xe(y,function(X){if(typeof X!="string")throw new TypeError("String expected");return ie(X,$)})}var M={NULL:0,DELIMITER:1,NUMBER:2,SYMBOL:3,UNKNOWN:4},_={",":!0,"(":!0,")":!0,"[":!0,"]":!0,"{":!0,"}":!0,'"':!0,"'":!0,";":!0,"+":!0,"-":!0,"*":!0,".*":!0,"/":!0,"./":!0,"%":!0,"^":!0,".^":!0,"~":!0,"!":!0,"&":!0,"|":!0,"^|":!0,"=":!0,":":!0,"?":!0,"==":!0,"!=":!0,"<":!0,">":!0,"<=":!0,">=":!0,"<<":!0,">>":!0,">>>":!0},N={mod:!0,to:!0,in:!0,and:!0,xor:!0,or:!0,not:!0},O={true:!0,false:!1,null:null,undefined:void 0},E=["NaN","Infinity"];function F(){return{extraNodes:{},expression:"",comment:"",index:0,token:"",tokenType:M.NULL,nestingLevel:0,conditionalLevel:null}}function B(y,D){return y.expression.substr(y.index,D)}function I(y){return B(y,1)}function j(y){y.index++}function q(y){return y.expression.charAt(y.index-1)}function H(y){return y.expression.charAt(y.index+1)}function k(y){for(y.tokenType=M.NULL,y.token="",y.comment="";g.isWhitespace(I(y),y.nestingLevel);)j(y);if(I(y)==="#")for(;I(y)!==`
`&&I(y)!=="";)y.comment+=I(y),j(y);if(I(y)===""){y.tokenType=M.DELIMITER;return}if(I(y)===`
`&&!y.nestingLevel){y.tokenType=M.DELIMITER,y.token=I(y),j(y);return}var D=I(y),$=B(y,2),X=B(y,3);if(X.length===3&&_[X]){y.tokenType=M.DELIMITER,y.token=X,j(y),j(y),j(y);return}if($.length===2&&_[$]){y.tokenType=M.DELIMITER,y.token=$,j(y),j(y);return}if(_[D]){y.tokenType=M.DELIMITER,y.token=D,j(y);return}if(g.isDigitDot(D)){y.tokenType=M.NUMBER;var ge=B(y,2);if(ge==="0b"||ge==="0o"||ge==="0x"){for(y.token+=I(y),j(y),y.token+=I(y),j(y);g.isHexDigit(I(y));)y.token+=I(y),j(y);return}if(I(y)===".")y.token+=I(y),j(y),g.isDigit(I(y))||(y.tokenType=M.DELIMITER);else{for(;g.isDigit(I(y));)y.token+=I(y),j(y);g.isDecimalMark(I(y),H(y))&&(y.token+=I(y),j(y))}for(;g.isDigit(I(y));)y.token+=I(y),j(y);if(I(y)==="E"||I(y)==="e"){if(g.isDigit(H(y))||H(y)==="-"||H(y)==="+"){if(y.token+=I(y),j(y),(I(y)==="+"||I(y)==="-")&&(y.token+=I(y),j(y)),!g.isDigit(I(y)))throw De(y,'Digit expected, got "'+I(y)+'"');for(;g.isDigit(I(y));)y.token+=I(y),j(y);if(g.isDecimalMark(I(y),H(y)))throw De(y,'Digit expected, got "'+I(y)+'"')}else if(H(y)===".")throw j(y),De(y,'Digit expected, got "'+I(y)+'"')}return}if(g.isAlpha(I(y),q(y),H(y))){for(;g.isAlpha(I(y),q(y),H(y))||g.isDigit(I(y));)y.token+=I(y),j(y);ae(N,y.token)?y.tokenType=M.DELIMITER:y.tokenType=M.SYMBOL;return}for(y.tokenType=M.UNKNOWN;I(y)!=="";)y.token+=I(y),j(y);throw De(y,'Syntax error in part "'+y.token+'"')}function S(y){do k(y);while(y.token===`
`)}function J(y){y.nestingLevel++}function A(y){y.nestingLevel--}g.isAlpha=function(D,$,X){return g.isValidLatinOrGreek(D)||g.isValidMathSymbol(D,X)||g.isValidMathSymbol($,D)},g.isValidLatinOrGreek=function(D){return/^[a-zA-Z_$\u00C0-\u02AF\u0370-\u03FF\u2100-\u214F]$/.test(D)},g.isValidMathSymbol=function(D,$){return/^[\uD835]$/.test(D)&&/^[\uDC00-\uDFFF]$/.test($)&&/^[^\uDC55\uDC9D\uDCA0\uDCA1\uDCA3\uDCA4\uDCA7\uDCA8\uDCAD\uDCBA\uDCBC\uDCC4\uDD06\uDD0B\uDD0C\uDD15\uDD1D\uDD3A\uDD3F\uDD45\uDD47-\uDD49\uDD51\uDEA6\uDEA7\uDFCC\uDFCD]$/.test($)},g.isWhitespace=function(D,$){return D===" "||D==="	"||D===`
`&&$>0},g.isDecimalMark=function(D,$){return D==="."&&$!=="/"&&$!=="*"&&$!=="^"},g.isDigitDot=function(D){return D>="0"&&D<="9"||D==="."},g.isDigit=function(D){return D>="0"&&D<="9"},g.isHexDigit=function(D){return D>="0"&&D<="9"||D>="a"&&D<="f"||D>="A"&&D<="F"};function ie(y,D){var $=F();Jt($,{expression:y,extraNodes:D}),k($);var X=de($);if($.token!=="")throw $.tokenType===M.DELIMITER?Kt($,"Unexpected operator "+$.token):De($,'Unexpected part "'+$.token+'"');return X}function de(y){var D,$=[],X;for(y.token!==""&&y.token!==`
`&&y.token!==";"&&(D=ue(y),D.comment=y.comment);y.token===`
`||y.token===";";)$.length===0&&D&&(X=y.token!==";",$.push({node:D,visible:X})),k(y),y.token!==`
`&&y.token!==";"&&y.token!==""&&(D=ue(y),D.comment=y.comment,X=y.token!==";",$.push({node:D,visible:X}));return $.length>0?new l($):(D||(D=new f(void 0),D.comment=y.comment),D)}function ue(y){var D,$,X,ge,_e=V(y);if(y.token==="="){if(lt(_e))return D=_e.name,S(y),X=ue(y),new c(new x(D),X);if(or(_e))return S(y),X=ue(y),new c(_e.object,_e.index,X);if(wn(_e)&&lt(_e.fn)&&(ge=!0,$=[],D=_e.name,_e.args.forEach(function(ht,Wi){lt(ht)?$[Wi]=ht.name:ge=!1}),ge))return S(y),X=ue(y),new o(D,$,X);throw De(y,"Invalid left hand side of assignment operator =")}return _e}function V(y){for(var D=Ne(y);y.token==="?";){var $=y.conditionalLevel;y.conditionalLevel=y.nestingLevel,S(y);var X=D,ge=ue(y);if(y.token!==":")throw De(y,"False part of conditional expression expected");y.conditionalLevel=null,S(y);var _e=ue(y);D=new h(X,ge,_e),y.conditionalLevel=$}return D}function Ne(y){for(var D=Se(y);y.token==="or";)S(y),D=new m("or","or",[D,Se(y)]);return D}function Se(y){for(var D=se(y);y.token==="xor";)S(y),D=new m("xor","xor",[D,se(y)]);return D}function se(y){for(var D=me(y);y.token==="and";)S(y),D=new m("and","and",[D,me(y)]);return D}function me(y){for(var D=Ve(y);y.token==="|";)S(y),D=new m("|","bitOr",[D,Ve(y)]);return D}function Ve(y){for(var D=we(y);y.token==="^|";)S(y),D=new m("^|","bitXor",[D,we(y)]);return D}function we(y){for(var D=fe(y);y.token==="&";)S(y),D=new m("&","bitAnd",[D,fe(y)]);return D}function fe(y){for(var D=[Te(y)],$=[],X={"==":"equal","!=":"unequal","<":"smaller",">":"larger","<=":"smallerEq",">=":"largerEq"};ae(X,y.token);){var ge={name:y.token,fn:X[y.token]};$.push(ge),S(y),D.push(Te(y))}return D.length===1?D[0]:D.length===2?new m($[0].name,$[0].fn,D):new v($.map(_e=>_e.fn),D)}function Te(y){var D,$,X,ge;D=Fe(y);for(var _e={"<<":"leftShift",">>":"rightArithShift",">>>":"rightLogShift"};ae(_e,y.token);)$=y.token,X=_e[$],S(y),ge=[D,Fe(y)],D=new m($,X,ge);return D}function Fe(y){var D,$,X,ge;D=Me(y);for(var _e={to:"to",in:"to"};ae(_e,y.token);)$=y.token,X=_e[$],S(y),$==="in"&&y.token===""?D=new m("*","multiply",[D,new x("in")],!0):(ge=[D,Me(y)],D=new m($,X,ge));return D}function Me(y){var D,$=[];if(y.token===":"?D=new f(1):D=Be(y),y.token===":"&&y.conditionalLevel!==y.nestingLevel){for($.push(D);y.token===":"&&$.length<3;)S(y),y.token===")"||y.token==="]"||y.token===","||y.token===""?$.push(new x("end")):$.push(Be(y));$.length===3?D=new w($[0],$[2],$[1]):D=new w($[0],$[1])}return D}function Be(y){var D,$,X,ge;D=T(y);for(var _e={"+":"add","-":"subtract"};ae(_e,y.token);)$=y.token,X=_e[$],S(y),ge=[D,T(y)],D=new m($,X,ge);return D}function T(y){var D,$,X,ge;D=R(y),$=D;for(var _e={"*":"multiply",".*":"dotMultiply","/":"divide","./":"dotDivide","%":"mod",mod:"mod"};ae(_e,y.token);)X=y.token,ge=_e[X],S(y),$=R(y),D=new m(X,ge,[D,$]);return D}function R(y){var D,$;for(D=Y(y),$=D;y.tokenType===M.SYMBOL||y.token==="in"&&ur(D)||y.tokenType===M.NUMBER&&!ur($)&&(!mi($)||$.op==="!")||y.token==="(";)$=Y(y),D=new m("*","multiply",[D,$],!0);return D}function Y(y){for(var D=Q(y),$=D,X=[];y.token==="/"&&ur($);)if(X.push(Jt({},y)),S(y),y.tokenType===M.NUMBER)if(X.push(Jt({},y)),S(y),y.tokenType===M.SYMBOL||y.token==="(")Jt(y,X.pop()),X.pop(),$=Q(y),D=new m("/","divide",[D,$]);else{X.pop(),Jt(y,X.pop());break}else{Jt(y,X.pop());break}return D}function Q(y){var D,$,X,ge={"-":"unaryMinus","+":"unaryPlus","~":"bitNot",not:"not"};return ae(ge,y.token)?(X=ge[y.token],D=y.token,S(y),$=[Q(y)],new m(D,X,$)):C(y)}function C(y){var D,$,X,ge;return D=P(y),(y.token==="^"||y.token===".^")&&($=y.token,X=$==="^"?"pow":"dotPow",S(y),ge=[D,Q(y)],D=new m($,X,ge)),D}function P(y){var D,$,X,ge;D=U(y);for(var _e={"!":"factorial","'":"ctranspose"};ae(_e,y.token);)$=y.token,X=_e[$],k(y),ge=[D],D=new m($,X,ge),D=W(y,D);return D}function U(y){var D=[];if(y.tokenType===M.SYMBOL&&ae(y.extraNodes,y.token)){var $=y.extraNodes[y.token];if(k(y),y.token==="("){if(D=[],J(y),k(y),y.token!==")")for(D.push(ue(y));y.token===",";)k(y),D.push(ue(y));if(y.token!==")")throw De(y,"Parenthesis ) expected");A(y),k(y)}return new $(D)}return L(y)}function L(y){var D,$;return y.tokenType===M.SYMBOL||y.tokenType===M.DELIMITER&&y.token in N?($=y.token,k(y),ae(O,$)?D=new f(O[$]):E.indexOf($)!==-1?D=new f(t($,"number")):D=new x($),D=W(y,D),D):re(y)}function W(y,D,$){for(var X;(y.token==="("||y.token==="["||y.token===".")&&(!$||$.indexOf(y.token)!==-1);)if(X=[],y.token==="(")if(lt(D)||or(D)){if(J(y),k(y),y.token!==")")for(X.push(ue(y));y.token===",";)k(y),X.push(ue(y));if(y.token!==")")throw De(y,"Parenthesis ) expected");A(y),k(y),D=new a(D,X)}else return D;else if(y.token==="["){if(J(y),k(y),y.token!=="]")for(X.push(ue(y));y.token===",";)k(y),X.push(ue(y));if(y.token!=="]")throw De(y,"Parenthesis ] expected");A(y),k(y),D=new n(D,new u(X))}else{if(k(y),y.tokenType!==M.SYMBOL)throw De(y,"Property name expected after dot");X.push(new f(y.token)),k(y);var ge=!0;D=new n(D,new u(X,ge))}return D}function re(y){var D,$;return y.token==='"'?($=ne(y),D=new f($),D=W(y,D),D):te(y)}function ne(y){for(var D="";I(y)!==""&&I(y)!=='"';)I(y)==="\\"&&(D+=I(y),j(y)),D+=I(y),j(y);if(k(y),y.token!=='"')throw De(y,'End of string " expected');return k(y),JSON.parse('"'+D+'"')}function te(y){var D,$;return y.token==="'"?($=ee(y),D=new f($),D=W(y,D),D):le(y)}function ee(y){for(var D="";I(y)!==""&&I(y)!=="'";)I(y)==="\\"&&(D+=I(y),j(y)),D+=I(y),j(y);if(k(y),y.token!=="'")throw De(y,"End of string ' expected");return k(y),JSON.parse('"'+D+'"')}function le(y){var D,$,X,ge;if(y.token==="["){if(J(y),k(y),y.token!=="]"){var _e=je(y);if(y.token===";"){for(X=1,$=[_e];y.token===";";)k(y),$[X]=je(y),X++;if(y.token!=="]")throw De(y,"End of matrix ] expected");A(y),k(y),ge=$[0].items.length;for(var ht=1;ht<X;ht++)if($[ht].items.length!==ge)throw Kt(y,"Column dimensions mismatch ("+$[ht].items.length+" !== "+ge+")");D=new s($)}else{if(y.token!=="]")throw De(y,"End of matrix ] expected");A(y),k(y),D=_e}}else A(y),k(y),D=new s([]);return W(y,D)}return Ke(y)}function je(y){for(var D=[ue(y)],$=1;y.token===",";)k(y),D[$]=ue(y),$++;return new s(D)}function Ke(y){if(y.token==="{"){J(y);var D,$={};do if(k(y),y.token!=="}"){if(y.token==='"')D=ne(y);else if(y.token==="'")D=ee(y);else if(y.tokenType===M.SYMBOL||y.tokenType===M.DELIMITER&&y.token in N)D=y.token,k(y);else throw De(y,"Symbol or string expected as object key");if(y.token!==":")throw De(y,"Colon : expected after object key");k(y),$[D]=ue(y)}while(y.token===",");if(y.token!=="}")throw De(y,"Comma , or bracket } expected after object value");A(y),k(y);var X=new p($);return X=W(y,X),X}return it(y)}function it(y){var D;return y.tokenType===M.NUMBER?(D=y.token,k(y),new f(t(D,r.number))):Ft(y)}function Ft(y){var D;if(y.token==="("){if(J(y),k(y),D=ue(y),y.token!==")")throw De(y,"Parenthesis ) expected");return A(y),k(y),D=new d(D),D=W(y,D),D}return Fr(y)}function Fr(y){throw y.token===""?De(y,"Unexpected end of expression"):De(y,"Value expected")}function Xt(y){return y.index-y.token.length+1}function De(y,D){var $=Xt(y),X=new SyntaxError(D+" (char "+$+")");return X.char=$,X}function Kt(y,D){var $=Xt(y),X=new SyntaxError(D+" (char "+$+")");return X.char=$,X}return g}),xo="evaluate",sd=["typed","parse"],ad=K(xo,sd,i=>{var{typed:e,parse:t}=i;return e(xo,{string:function(n){var s={};return t(n).compile().evaluate(s)},"string, Object":function(n,s){return t(n).compile().evaluate(s)},"Array | Matrix":function(n){var s={};return Xe(n,function(c){return t(c).compile().evaluate(s)})},"Array | Matrix, Object":function(n,s){return Xe(n,function(c){return t(c).compile().evaluate(s)})}})}),bo="lup",od=["typed","matrix","abs","addScalar","divideScalar","multiplyScalar","subtract","larger","equalScalar","unaryMinus","DenseMatrix","SparseMatrix","Spa"],ud=K(bo,od,i=>{var{typed:e,matrix:t,abs:r,addScalar:n,divideScalar:s,multiplyScalar:c,subtract:l,larger:h,equalScalar:f,unaryMinus:o,DenseMatrix:a,SparseMatrix:u,Spa:p}=i;return e(bo,{DenseMatrix:function(v){return m(v)},SparseMatrix:function(v){return d(v)},Array:function(v){var x=t(v),g=m(x);return{L:g.L.valueOf(),U:g.U.valueOf(),p:g.p}}});function m(w){var v=w._size[0],x=w._size[1],g=Math.min(v,x),b=Ee(w._data),M=[],_=[v,g],N=[],O=[g,x],E,F,B,I=[];for(E=0;E<v;E++)I[E]=E;for(F=0;F<x;F++){if(F>0)for(E=0;E<v;E++){var j=Math.min(E,F),q=0;for(B=0;B<j;B++)q=n(q,c(b[E][B],b[B][F]));b[E][F]=l(b[E][F],q)}var H=F,k=0,S=0;for(E=F;E<v;E++){var J=b[E][F],A=r(J);h(A,k)&&(H=E,k=A,S=J)}if(F!==H&&(I[F]=[I[H],I[H]=I[F]][0],a._swapRows(F,H,b)),F<v)for(E=F+1;E<v;E++){var ie=b[E][F];f(ie,0)||(b[E][F]=s(b[E][F],S))}}for(F=0;F<x;F++)for(E=0;E<v;E++){if(F===0&&(E<x&&(N[E]=[]),M[E]=[]),E<F){E<x&&(N[E][F]=b[E][F]),F<v&&(M[E][F]=0);continue}if(E===F){E<x&&(N[E][F]=b[E][F]),F<v&&(M[E][F]=1);continue}E<x&&(N[E][F]=0),F<v&&(M[E][F]=b[E][F])}var de=new a({data:M,size:_}),ue=new a({data:N,size:O}),V=[];for(E=0,g=I.length;E<g;E++)V[I[E]]=E;return{L:de,U:ue,p:V,toString:function(){return"L: "+this.L.toString()+`
U: `+this.U.toString()+`
P: `+this.p}}}function d(w){var v=w._size[0],x=w._size[1],g=Math.min(v,x),b=w._values,M=w._index,_=w._ptr,N=[],O=[],E=[],F=[v,g],B=[],I=[],j=[],q=[g,x],H,k,S,J=[],A=[];for(H=0;H<v;H++)J[H]=H,A[H]=H;var ie=function(V,Ne){var Se=A[V],se=A[Ne];J[Se]=Ne,J[se]=V,A[V]=se,A[Ne]=Se},de=function(){var V=new p;k<v&&(E.push(N.length),N.push(1),O.push(k)),j.push(B.length);var Ne=_[k],Se=_[k+1];for(S=Ne;S<Se;S++)H=M[S],V.set(J[H],b[S]);k>0&&V.forEach(0,k-1,function(we,fe){u._forEachRow(we,N,O,E,function(Te,Fe){Te>we&&V.accumulate(Te,o(c(Fe,fe)))})});var se=k,me=V.get(k),Ve=r(me);V.forEach(k+1,v-1,function(we,fe){var Te=r(fe);h(Te,Ve)&&(se=we,Ve=Te,me=fe)}),k!==se&&(u._swapRows(k,se,F[1],N,O,E),u._swapRows(k,se,q[1],B,I,j),V.swap(k,se),ie(k,se)),V.forEach(0,v-1,function(we,fe){we<=k?(B.push(fe),I.push(we)):(fe=s(fe,me),f(fe,0)||(N.push(fe),O.push(we)))})};for(k=0;k<x;k++)de();return j.push(B.length),E.push(N.length),{L:new u({values:N,index:O,ptr:E,size:F}),U:new u({values:B,index:I,ptr:j,size:q}),p:J,toString:function(){return"L: "+this.L.toString()+`
U: `+this.U.toString()+`
P: `+this.p}}}}),Mo="det",cd=["typed","matrix","subtract","multiply","unaryMinus","lup"],hd=K(Mo,cd,i=>{var{typed:e,matrix:t,subtract:r,multiply:n,unaryMinus:s,lup:c}=i;return e(Mo,{any:function(f){return Ee(f)},"Array | Matrix":function(f){var o;switch(We(f)?o=f.size():Array.isArray(f)?(f=t(f),o=f.size()):o=[],o.length){case 0:return Ee(f);case 1:if(o[0]===1)return Ee(f.valueOf()[0]);throw new RangeError("Matrix must be square (size: "+qe(o)+")");case 2:{var a=o[0],u=o[1];if(a===u)return l(f.clone().valueOf(),a);throw new RangeError("Matrix must be square (size: "+qe(o)+")")}default:throw new RangeError("Matrix must be two dimensional (size: "+qe(o)+")")}}});function l(h,f,o){if(f===1)return Ee(h[0][0]);if(f===2)return r(n(h[0][0],h[1][1]),n(h[1][0],h[0][1]));for(var a=c(h),u=a.U[0][0],p=1;p<f;p++)u=n(u,a.U[p][p]);for(var m=0,d=0,w=[];;){for(;w[d];)d++;if(d>=f)break;for(var v=d,x=0;!w[a.p[v]];)w[a.p[v]]=!0,v=a.p[v],x++;x%2===0&&m++}return m%2===0?u:s(u)}}),_o="inv",ld=["typed","matrix","divideScalar","addScalar","multiply","unaryMinus","det","identity","abs"],fd=K(_o,ld,i=>{var{typed:e,matrix:t,divideScalar:r,addScalar:n,multiply:s,unaryMinus:c,det:l,identity:h,abs:f}=i;return e(_o,{"Array | Matrix":function(u){var p=We(u)?u.size():yt(u);switch(p.length){case 1:if(p[0]===1)return We(u)?t([r(1,u.valueOf()[0])]):[r(1,u[0])];throw new RangeError("Matrix must be square (size: "+qe(p)+")");case 2:{var m=p[0],d=p[1];if(m===d)return We(u)?t(o(u.valueOf(),m,d),u.storage()):o(u,m,d);throw new RangeError("Matrix must be square (size: "+qe(p)+")")}default:throw new RangeError("Matrix must be two dimensional (size: "+qe(p)+")")}},any:function(u){return r(1,u)}});function o(a,u,p){var m,d,w,v,x;if(u===1){if(v=a[0][0],v===0)throw Error("Cannot calculate inverse, determinant is zero");return[[r(1,v)]]}else if(u===2){var g=l(a);if(g===0)throw Error("Cannot calculate inverse, determinant is zero");return[[r(a[1][1],g),r(c(a[0][1]),g)],[r(c(a[1][0]),g),r(a[0][0],g)]]}else{var b=a.concat();for(m=0;m<u;m++)b[m]=b[m].concat();for(var M=h(u).valueOf(),_=0;_<p;_++){var N=f(b[_][_]),O=_;for(m=_+1;m<u;)f(b[m][_])>N&&(N=f(b[m][_]),O=m),m++;if(N===0)throw Error("Cannot calculate inverse, determinant is zero");m=O,m!==_&&(x=b[_],b[_]=b[m],b[m]=x,x=M[_],M[_]=M[m],M[m]=x);var E=b[_],F=M[_];for(m=0;m<u;m++){var B=b[m],I=M[m];if(m!==_){if(B[_]!==0){for(w=r(c(B[_]),E[_]),d=_;d<p;d++)B[d]=n(B[d],s(w,E[d]));for(d=0;d<p;d++)I[d]=n(I[d],s(w,F[d]))}}else{for(w=E[_],d=_;d<p;d++)B[d]=r(B[d],w);for(d=0;d<p;d++)I[d]=r(I[d],w)}}}return M}}}),pd="divide",dd=["typed","matrix","multiply","equalScalar","divideScalar","inv"],md=K(pd,dd,i=>{var{typed:e,matrix:t,multiply:r,equalScalar:n,divideScalar:s,inv:c}=i,l=Or({typed:e,equalScalar:n}),h=xt({typed:e});return e("divide",wi({"Array | Matrix, Array | Matrix":function(o,a){return r(o,c(a))},"DenseMatrix, any":function(o,a){return h(o,a,s,!1)},"SparseMatrix, any":function(o,a){return l(o,a,s,!1)},"Array, any":function(o,a){return h(t(o),a,s,!1).valueOf()},"any, Array | Matrix":function(o,a){return r(o,c(a))}},s.signatures))}),Cr={createBigNumberClass:_h},Pn={createComplexClass:Eh},Li={createMatrixClass:Bh},Ot={MatrixDependencies:Li,createDenseMatrixClass:kh},Ui={createFractionClass:Ah},ve={BigNumberDependencies:Cr,ComplexDependencies:Pn,DenseMatrixDependencies:Ot,FractionDependencies:Ui,createTyped:_c},vd={createResultSet:Oc},gd={createRangeClass:Fh},yd={typedDependencies:ve,createIsNumeric:Uh},bt={typedDependencies:ve,createEqualScalar:Vh},kn={MatrixDependencies:Li,equalScalarDependencies:bt,typedDependencies:ve,createSparseMatrixClass:Gh},Ln={typedDependencies:ve,createNumber:Zh},wd={BigNumberDependencies:Cr,typedDependencies:ve,createBignumber:Xh},No={FractionDependencies:Ui,typedDependencies:ve,createFraction:tl},Ze={DenseMatrixDependencies:Ot,MatrixDependencies:Li,SparseMatrixDependencies:kn,typedDependencies:ve,createMatrix:nl},Un={typedDependencies:ve,createUnaryMinus:sl},$i={typedDependencies:ve,createAbs:ol},Qt={typedDependencies:ve,createAddScalar:cl},xd={BigNumberDependencies:Cr,matrixDependencies:Ze,typedDependencies:ve,createZeros:yf},qi={BigNumberDependencies:Cr,DenseMatrixDependencies:Ot,equalScalarDependencies:bt,matrixDependencies:Ze,typedDependencies:ve,zerosDependencies:xd,createRound:Cf},bd={equalScalarDependencies:bt,matrixDependencies:Ze,roundDependencies:qi,typedDependencies:ve,createCeil:vl},Md={equalScalarDependencies:bt,matrixDependencies:Ze,roundDependencies:qi,typedDependencies:ve,createFloor:Ml},_d={ComplexDependencies:Pn,ceilDependencies:bd,floorDependencies:Md,matrixDependencies:Ze,typedDependencies:ve,createFix:wl},Nd={DenseMatrixDependencies:Ot,equalScalarDependencies:bt,matrixDependencies:Ze,typedDependencies:ve,createMod:ql},$n={typedDependencies:ve,createMultiplyScalar:Hl},Sd={typedDependencies:ve,createConj:Kl},So={matrixDependencies:Ze,typedDependencies:ve,createSize:uf},Ed={addScalarDependencies:Qt,conjDependencies:Sd,multiplyScalarDependencies:$n,sizeDependencies:So,typedDependencies:ve,createDot:tp},Xr={addScalarDependencies:Qt,dotDependencies:Ed,equalScalarDependencies:bt,matrixDependencies:Ze,multiplyScalarDependencies:$n,typedDependencies:ve,createMultiply:Wl},qn={DenseMatrixDependencies:Ot,addScalarDependencies:Qt,equalScalarDependencies:bt,matrixDependencies:Ze,typedDependencies:ve,unaryMinusDependencies:Un,createSubtract:Zl},Od={DenseMatrixDependencies:Ot,matrixDependencies:Ze,typedDependencies:ve,createSmaller:Bf},Eo={DenseMatrixDependencies:Ot,matrixDependencies:Ze,typedDependencies:ve,createLarger:Pf},Oo={BigNumberDependencies:Cr,DenseMatrixDependencies:Ot,SparseMatrixDependencies:kn,matrixDependencies:Ze,typedDependencies:ve,createIdentity:rf},zd={DenseMatrixDependencies:Ot,SparseMatrixDependencies:kn,addScalarDependencies:Qt,equalScalarDependencies:bt,matrixDependencies:Ze,typedDependencies:ve,createAdd:Kf},Ad={DenseMatrixDependencies:Ot,equalScalarDependencies:bt,matrixDependencies:Ze,typedDependencies:ve,createEqual:Df},Cd={largerDependencies:Eo,smallerDependencies:Od,createFibonacciHeapClass:Uf},Td={FibonacciHeapDependencies:Cd,addScalarDependencies:Qt,equalScalarDependencies:bt,createSpaClass:Vf},zo={bignumberDependencies:wd,fractionDependencies:No,numberDependencies:Ln,createNumeric:_f},Vn={numericDependencies:zo,typedDependencies:ve,createDivideScalar:Sf},Fd={DenseMatrixDependencies:Ot,SpaDependencies:Td,SparseMatrixDependencies:kn,absDependencies:$i,addScalarDependencies:Qt,divideScalarDependencies:Vn,equalScalarDependencies:bt,largerDependencies:Eo,matrixDependencies:Ze,multiplyScalarDependencies:$n,subtractDependencies:qn,typedDependencies:ve,unaryMinusDependencies:Un,createLup:ud},Dd={lupDependencies:Fd,matrixDependencies:Ze,multiplyDependencies:Xr,subtractDependencies:qn,typedDependencies:ve,unaryMinusDependencies:Un,createDet:hd},Id={absDependencies:$i,addScalarDependencies:Qt,detDependencies:Dd,divideScalarDependencies:Vn,identityDependencies:Oo,matrixDependencies:Ze,multiplyDependencies:Xr,typedDependencies:ve,unaryMinusDependencies:Un,createInv:fd},Bd={ComplexDependencies:Pn,fractionDependencies:No,identityDependencies:Oo,matrixDependencies:Ze,multiplyDependencies:Xr,numberDependencies:Ln,typedDependencies:ve,createPow:Of},Ao={matrixDependencies:Ze,typedDependencies:ve,createSubset:pf},Rd={typedDependencies:ve,createFormat:xf},Vi={BigNumberDependencies:Cr,ComplexDependencies:Pn,FractionDependencies:Ui,absDependencies:$i,addScalarDependencies:Qt,divideScalarDependencies:Vn,equalDependencies:Ad,fixDependencies:_d,formatDependencies:Rd,isNumericDependencies:yd,multiplyScalarDependencies:$n,numberDependencies:Ln,powDependencies:Bd,roundDependencies:qi,subtractDependencies:qn,createUnitClass:Wf},Pd={UnitDependencies:Vi,typedDependencies:ve,createUnitFunction:Zf},kd={UnitDependencies:Vi,typedDependencies:ve,createCreateUnit:Qf},ct={createNode:ip},Ld={NodeDependencies:ct,subsetDependencies:Ao,createAccessorNode:op},Ud={NodeDependencies:ct,createArrayNode:hp},$d={matrixDependencies:Ze,NodeDependencies:ct,subsetDependencies:Ao,createAssignmentNode:dp},qd={NodeDependencies:ct,ResultSetDependencies:vd,createBlockNode:gp},Vd={NodeDependencies:ct,createConditionalNode:xp},jd={NodeDependencies:ct,createConstantNode:Ap},Hd={NodeDependencies:ct,typedDependencies:ve,createFunctionAssignmentNode:Fp},Gd={NodeDependencies:ct,RangeDependencies:gd,sizeDependencies:So,createIndexNode:Bp},Wd={NodeDependencies:ct,createObjectNode:kp},Yd={NodeDependencies:ct,createOperatorNode:$p},Zd={NodeDependencies:ct,createParenthesisNode:jp},Jd={NodeDependencies:ct,createRangeNode:Wp},Qd={NodeDependencies:ct,createRelationalNode:Jp},Co={UnitDependencies:Vi,NodeDependencies:ct,createSymbolNode:Kp},Xd={NodeDependencies:ct,SymbolNodeDependencies:Co,createFunctionNode:rd},Kd={AccessorNodeDependencies:Ld,ArrayNodeDependencies:Ud,AssignmentNodeDependencies:$d,BlockNodeDependencies:qd,ConditionalNodeDependencies:Vd,ConstantNodeDependencies:jd,FunctionAssignmentNodeDependencies:Hd,FunctionNodeDependencies:Xd,IndexNodeDependencies:Gd,ObjectNodeDependencies:Wd,OperatorNodeDependencies:Yd,ParenthesisNodeDependencies:Zd,RangeNodeDependencies:Jd,RelationalNodeDependencies:Qd,SymbolNodeDependencies:Co,numericDependencies:zo,typedDependencies:ve,createParse:id},em={parseDependencies:Kd,typedDependencies:ve,createEvaluate:ad},tm={divideScalarDependencies:Vn,equalScalarDependencies:bt,invDependencies:Id,matrixDependencies:Ze,multiplyDependencies:Xr,typedDependencies:ve,createDivide:md},ji={exports:{}};function Hi(){}Hi.prototype={on:function(i,e,t){var r=this.e||(this.e={});return(r[i]||(r[i]=[])).push({fn:e,ctx:t}),this},once:function(i,e,t){var r=this;function n(){r.off(i,n),e.apply(t,arguments)}return n._=e,this.on(i,n,t)},emit:function(i){var e=[].slice.call(arguments,1),t=((this.e||(this.e={}))[i]||[]).slice(),r=0,n=t.length;for(r;r<n;r++)t[r].fn.apply(t[r].ctx,e);return this},off:function(i,e){var t=this.e||(this.e={}),r=t[i],n=[];if(r&&e)for(var s=0,c=r.length;s<c;s++)r[s].fn!==e&&r[s].fn._!==e&&n.push(r[s]);return n.length?t[i]=n:delete t[i],this}},ji.exports=Hi,ji.exports.TinyEmitter=Hi;var rm=ji.exports;function nm(i){var e=new rm;return i.on=e.on.bind(e),i.off=e.off.bind(e),i.once=e.once.bind(e),i.emit=e.emit.bind(e),i}function im(i,e,t,r){function n(v,x){var g=arguments.length;if(g!==1&&g!==2)throw new fr("import",g,1,2);x||(x={});function b(O,E,F){if(Array.isArray(E))E.forEach(j=>b(O,j));else if(typeof E=="object")for(var B in E)ae(E,B)&&b(O,E[B],B);else if(Vr(E)||F!==void 0){var I=Vr(E)?d(E)?E.fn+".transform":E.fn:F;if(ae(O,I)&&O[I]!==E&&!x.silent)throw new Error('Cannot import "'+I+'" twice');O[I]=E}else if(!x.silent)throw new TypeError("Factory, Object, or Array expected")}var M={};b(M,v);for(var _ in M)if(ae(M,_)){var N=M[_];if(Vr(N))f(N,x);else if(o(N))s(_,N,x);else if(!x.silent)throw new TypeError("Factory, Object, or Array expected")}}function s(v,x,g){if(g.wrap&&typeof x=="function"&&(x=h(x)),u(x)&&(x=i(v,{[x.signature]:x})),a(t[v])&&a(x)){g.override?x=i(v,x.signatures):x=i(t[v],x),t[v]=x,delete r[v],c(v,x),t.emit("import",v,function(){return x});return}if(t[v]===void 0||g.override){t[v]=x,delete r[v],c(v,x),t.emit("import",v,function(){return x});return}if(!g.silent)throw new Error('Cannot import "'+v+'": already exists')}function c(v,x){x&&typeof x.transform=="function"?(t.expression.transform[v]=x.transform,p(v)&&(t.expression.mathWithTransform[v]=x.transform)):(delete t.expression.transform[v],p(v)&&(t.expression.mathWithTransform[v]=x))}function l(v){delete t.expression.transform[v],p(v)?t.expression.mathWithTransform[v]=t[v]:delete t.expression.mathWithTransform[v]}function h(v){var x=function(){for(var b=[],M=0,_=arguments.length;M<_;M++){var N=arguments[M];b[M]=N&&N.valueOf()}return v.apply(t,b)};return v.transform&&(x.transform=v.transform),x}function f(v,x){var g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:v.fn;if(ha(g,"."))throw new Error("Factory name should not contain a nested path. Name: "+JSON.stringify(g));var b=d(v)?t.expression.transform:t,M=g in t.expression.transform,_=ae(b,g)?b[g]:void 0,N=function(){var E={};v.dependencies.map(la).forEach(B=>{if(ha(B,"."))throw new Error("Factory dependency should not contain a nested path. Name: "+JSON.stringify(B));B==="math"?E.math=t:B==="mathWithTransform"?E.mathWithTransform=t.expression.mathWithTransform:B==="classes"?E.classes=t:E[B]=t[B]});var F=v(E);if(F&&typeof F.transform=="function")throw new Error('Transforms cannot be attached to factory functions. Please create a separate function for it with exports.path="expression.transform"');if(_===void 0||x.override)return F;if(a(_)&&a(F))return i(_,F);if(x.silent)return _;throw new Error('Cannot import "'+g+'": already exists')};!v.meta||v.meta.lazy!==!1?(xi(b,g,N),_&&M?l(g):(d(v)||m(v))&&xi(t.expression.mathWithTransform,g,()=>b[g])):(b[g]=N(),_&&M?l(g):(d(v)||m(v))&&xi(t.expression.mathWithTransform,g,()=>b[g])),r[g]=v,t.emit("import",g,N)}function o(v){return typeof v=="function"||typeof v=="number"||typeof v=="string"||typeof v=="boolean"||v===null||ar(v)||Lt(v)||Ie(v)||Ur(v)||We(v)||Array.isArray(v)}function a(v){return typeof v=="function"&&typeof v.signatures=="object"}function u(v){return typeof v=="function"&&typeof v.signature=="string"}function p(v){return!ae(w,v)}function m(v){return v.fn.indexOf(".")===-1&&!ae(w,v.fn)&&(!v.meta||!v.meta.isClass)}function d(v){return v!==void 0&&v.meta!==void 0&&v.meta.isTransformFunction===!0||!1}var w={expression:!0,type:!0,docs:!0,error:!0,json:!0,chain:!0};return n}function Gi(){return Gi=Object.assign||function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},Gi.apply(this,arguments)}function To(i,e){var t=Gi({},Ts,e);if(typeof Object.create!="function")throw new Error("ES5 not supported by this JavaScript engine. Please load the es5-shim and es5-sham library for compatibility.");var r=nm({isNumber:Ue,isComplex:Lt,isBigNumber:Ie,isFraction:Ur,isUnit:ar,isString:zt,isArray:$e,isMatrix:We,isCollection:ui,isDenseMatrix:Fs,isSparseMatrix:Ds,isRange:ci,isIndex:xr,isBoolean:Is,isResultSet:hi,isHelp:li,isFunction:Bs,isDate:Rs,isRegExp:Ps,isObject:ks,isNull:Ls,isUndefined:Us,isAccessorNode:or,isArrayNode:fi,isAssignmentNode:$s,isBlockNode:qs,isConditionalNode:Vs,isConstantNode:ur,isFunctionAssignmentNode:pi,isFunctionNode:wn,isIndexNode:$r,isNode:Pe,isObjectNode:di,isOperatorNode:mi,isParenthesisNode:vi,isRangeNode:gi,isSymbolNode:lt,isChain:yi});r.config=sc(t,r.emit),r.expression={transform:{},mathWithTransform:{config:r.config}};var n=[],s=[];function c(o){if(Vr(o))return o(r);var a=o[Object.keys(o)[0]];if(Vr(a))return a(r);if(!nc(o))throw console.warn("Factory object with properties `type`, `name`, and `factory` expected",o),new Error("Factory object with properties `type`, `name`, and `factory` expected");var u=n.indexOf(o),p;return u===-1?(o.math===!0?p=o.factory(r.type,t,c,r.typed,r):p=o.factory(r.type,t,c,r.typed),n.push(o),s.push(p)):p=s[u],p}var l={};function h(){for(var o=arguments.length,a=new Array(o),u=0;u<o;u++)a[u]=arguments[u];return r.typed.apply(r.typed,a)}var f=im(h,c,r,l);return r.import=f,r.on("config",()=>{Gs(l).forEach(o=>{o&&o.meta&&o.meta.recreateOnConfigChange&&f(o,{override:!0})})}),r.create=To.bind(null,i),r.factory=K,r.import(Gs(rc(i))),r.ArgumentsError=fr,r.DimensionError=ye,r.IndexError=Gt,r}class Fo{constructor(e,t){z(this,"math",To({evaluateDependencies:em,addDependencies:zd,subtractDependencies:qn,multiplyDependencies:Xr,divideDependencies:tm,modDependencies:Nd,numberDependencies:Ln,createUnitDependencies:kd,unitDependencies:Pd},{predictable:!0}));z(this,"mathCompiledExpressions",new Map);z(this,"mathScope",{ratio:void 0,degree:this.math.unit("degree"),meter:this.math.unit("meter"),pixel:this.math.createUnit("pixel",{aliases:["pixels","px"]}),percent:void 0,vdeg:void 0,vw:void 0,vh:void 0});z(this,"epsillonMeters",1e-10);z(this,"epsillonRadians",1e-10);z(this,"epsillonRatio",1e-10);z(this,"transition",new Lr({multiplier:1,duration:0,easing:Es.easeInOut,threshold:0,delay:0,debounce:0,maxWait:10,blend:!0}));z(this,"optimize",new mn({minFeasibleTime:.02,maxInfeasibleTime:5,relativeTolerance:.001,maxIterationsPerFrame:10,swarmSize:10,pulseFrequencyMin:0,pulseFrequencyMax:1,pulseRate:.4,stepSizeMin:1e-4,stepSizeMax:4,stepSizeStart:1.5}));z(this,"optimizer",new ls(this));z(this,"viewFrustum",new Cs);z(this,"viewResolution",new ze(1e3,1e3));z(this,"deltaTime",1/60);z(this,"time",0);z(this,"maxDeltaTime",1/60);z(this,"nodeMetrics",new Map);z(this,"nodeAdapters",new Map);z(this,"transitionables",[]);z(this,"getMetrics",e=>{if(!e)throw new Error("node must be defined");let t=this.nodeMetrics.get(e);return t||(t=new hs(this,e),this.nodeMetrics.set(e,t)),t});z(this,"getState",e=>{if(!e)throw new Error("node must be defined");return this.getMetrics(e).target});z(this,"getAdapter",e=>{let t=this.nodeAdapters.get(e);return t||(t=new As(this,e),this.nodeAdapters.set(e,t)),t});z(this,"createTransitionable",(e,t)=>{const r=new kt(this,e,t,this.transition);return this.transitionables.push(r),r});z(this,"_prevResolution",new ze);z(this,"_prevSize",new ze);z(this,"measureNumberCache",{});this.viewNode=e,this.bindings=t}get viewMetrics(){if(!this.viewNode)throw new Error("EtherealSystem.viewNode must be defined");return this.getMetrics(this.viewNode)}update(e,t){this.deltaTime=Math.max(e,this.maxDeltaTime),this.time=t,(!this._prevResolution.equals(this.viewResolution)||!this._prevSize.equals(this.viewFrustum.sizeDegrees))&&(this.mathScope.vdeg=this.math.unit(this.viewResolution.y/this.viewFrustum.sizeDegrees.y,"px"),this.mathScope.vw=this.math.unit(this.viewResolution.x/100,"px"),this.mathScope.vh=this.math.unit(this.viewResolution.y/100,"px"),this.measureNumberCache={}),this._prevResolution.copy(this.viewResolution),this._prevSize.copy(this.viewFrustum.sizeDegrees);for(const r of this.nodeMetrics.values()){r.needsUpdate=!0;const n=this.nodeAdapters.get(r.node);n&&(n.opacity.needsUpdate=!0,n.orientation.needsUpdate=!0,n.bounds.needsUpdate=!0,n.outerOrigin.needsUpdate=!0,n.outerOrientation.needsUpdate=!0,n.outerBounds.needsUpdate=!0,n.outerVisualBounds.needsUpdate=!0)}for(const r of this.transitionables)r.needsUpdate=!0;for(const r of this.transitionables)r.update();this.viewMetrics.update();for(const r of this.nodeAdapters.values())r.metrics.update()}measureNumber(e,t){if(typeof e=="number")return e;if(e in this.measureNumberCache)return this.measureNumberCache[e];if(!this.mathCompiledExpressions.has(e)){const l=this.math.parse(e).compile();this.mathCompiledExpressions.set(e,l)}const r=this.mathCompiledExpressions.get(e),n=r.evaluate(this.mathScope),s=typeof n=="number"?n:this.math.number(r.evaluate(this.mathScope),t);return this.measureNumberCache[e]=s,s}}const sm=new G;class am{constructor(e=0,t=0,r=0){this.horizontalRadians=e,this.verticalRadians=t,this.distance=r}get horizontalDegrees(){return this.horizontalRadians*Ge}set horizontalDegrees(e){this.horizontalRadians=e*Ae}get verticalDegrees(){return this.verticalRadians*Ge}set verticalDegrees(e){this.verticalRadians=e*Ae}setWithRadians(e,t,r){return this.horizontalRadians=e,this.verticalRadians=t,this.distance=r,this}setWithDegrees(e,t,r){return this.horizontalDegrees=e,this.verticalDegrees=t,this.distance=r,this}fromCartesianDirection(e){const t=sm.copy(e).normalize();return this.verticalRadians=Math.asin(t.y)*Ge,this.horizontalRadians=Math.atan2(t.x,-t.z)*Ge,this.distance=0,this}fromCartesianPosition(e){return this.fromCartesianDirection(e),this.distance=e.length(),this}toCartesianDirection(e){const t=this.verticalRadians,r=-Math.PI-this.horizontalRadians,n=Math.sin(t),s=Math.cos(t)*Math.sin(r),c=-Math.cos(t)*Math.cos(r);return e.set(s,n,c).normalize()}toCartesianPosition(e){return this.toCartesianDirection(e).multiplyScalar(this.distance)}}const om=new xe,um=new xe,Kr={getChildren(i,e){const t=i.node;if(!!t.isObject3D){e.length=0;for(let r=0;r<t.children.length;r++)e[r]=t.children[r]}},getState(i){var n;if(i.system.viewNode===i.node){const s=i.node;s.updateMatrixWorld(),i.system.viewFrustum.setFromPerspectiveProjectionMatrix(s.projectionMatrix)}const e=i.node;if(!e.isObject3D)return;let t,r;if(i.isAdaptive){const s=(n=i.referenceMetrics)==null?void 0:n.target.worldMatrix;r=om.compose(e.position,e.quaternion,e.scale),t=s?um.multiplyMatrices(s,r):r}else t=e.matrixWorld,r=e.matrix;i.raw.parent=e.parent,i.raw.worldMatrix.copy(t),i.raw.relativeMatrix.copy(r),i.raw.opacity=Do(i)||1},getIntrinsicBounds(i,e){const t=i.node;if(!!t.isObject3D)return t.geometry?(t.geometry.boundingBox||t.geometry.computeBoundingBox(),e.copy(t.geometry.boundingBox)):e},apply(i,e){const t=i.node;if(!t.isObject3D)return;if(e.parent!==t.parent){const n=e.parent;n&&n.add(t)}let r=e.localMatrix;if(isNaN(r.elements[0])||isNaN(r.elements[13])||isNaN(r.elements[14])||isNaN(r.elements[15])||r.elements[0]===0)throw new Error;if(r=e.worldMatrix,isNaN(r.elements[0])||isNaN(r.elements[13])||isNaN(r.elements[14])||isNaN(r.elements[15])||r.elements[0]===0)throw new Error;t.matrixAutoUpdate=!1,t.matrix.copy(e.localMatrix),t.matrixWorld.copy(e.worldMatrix),Io(i,e.opacity)}};function Do(i){const e=i.node;if(e.material){const t=e.material;if(t.length){for(const r of t)if(r.opacity!==void 0)return r.opacity}else if("opacity"in e.material)return e.material.opacity}for(const t of i.boundingChildMetrics){const r=Do(t);if(r!==void 0)return r}}function Io(i,e){const t=i.node;if(t.material){const r=t.material;if(r.length)for(const n of r)"opacity"in n&&(n.opacity=e);else t.material.opacity=e}for(const r of i.boundingChildMetrics)Io(r,e)}const Bo={getChildren(i,e){i.node.isObject3D&&Kr.getChildren(i,e)},getState(i){i.node.isObject3D&&Kr.getState(i)},getIntrinsicBounds(i,e){return i.node.isObject3D&&Kr.getIntrinsicBounds(i,e),e},apply(i,e){i.node.isObject3D&&Kr.apply(i,e)}};function cm(i,e=Bo){return new Fo(i,e)}oe.Box2=vr,oe.Box3=tt,oe.Color=qt,oe.DIRECTION=Ir,oe.DefaultBindings=Bo,oe.EtherealLayoutSystem=Fo,oe.Euler=er,oe.LayoutFrustum=Cs,oe.LayoutSolution=vt,oe.Line3=su,oe.MathUtils=tu,oe.Matrix3=Kn,oe.Matrix4=xe,oe.MemoizationCache=fn,oe.NodeState=Pt,oe.NodeStateBase=cs,oe.OptimizerConfig=mn,oe.Plane=ns,oe.Q_IDENTITY=ri,oe.Quaternion=He,oe.Ray=iu,oe.SpatialAdapter=As,oe.SpatialLayout=vs,oe.SpatialMetrics=hs,oe.SpatialOptimizer=ls,oe.SphericalCoordinate=am,oe.ThreeBindings=Kr,oe.Transition=Os,oe.TransitionConfig=Lr,oe.Transitionable=kt,oe.V_00=is,oe.V_000=mt,oe.V_001=lu,oe.V_010=hu,oe.V_100=cu,oe.V_11=uu,oe.V_111=ti,oe.Vector2=ze,oe.Vector3=G,oe.Vector4=Qi,oe.computeRelativeDifference=ni,oe.createLayoutSystem=cm,oe.easing=Es,oe.extractRotationAboutAxis=wu,oe.gaussian=Br,oe.levy=ii,oe.randomQuaternion=ln,oe.randomSelect=as,Object.defineProperty(oe,"__esModule",{value:!0}),oe[Symbol.toStringTag]="Module"});
//# sourceMappingURL=ethereal.umd.js.map
