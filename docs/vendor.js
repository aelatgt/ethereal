var AS=Object.defineProperty;var bv=Object.getOwnPropertySymbols;var SS=Object.prototype.hasOwnProperty,ES=Object.prototype.propertyIsEnumerable;var Mv=(r,e,t)=>e in r?AS(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Av=(r,e)=>{for(var t in e||(e={}))SS.call(e,t)&&Mv(r,t,e[t]);if(bv)for(var t of bv(e))ES.call(e,t)&&Mv(r,t,e[t]);return r};function Xc(r,e){const t=Object.create(null),n=r.split(",");for(let i=0;i<n.length;i++)t[n[i]]=!0;return e?i=>!!t[i.toLowerCase()]:i=>!!t[i]}const _S="Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt",TS=Xc(_S),CS="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",RS=Xc(CS);function od(r){if(xt(r)){const e={};for(let t=0;t<r.length;t++){const n=r[t],i=od(rr(n)?PS(n):n);if(i)for(const s in i)e[s]=i[s]}return e}else if(Cn(r))return r}const NS=/;(?![^(]*\))/g,IS=/:(.+)/;function PS(r){const e={};return r.split(NS).forEach(t=>{if(t){const n=t.split(IS);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e}function ad(r){let e="";if(rr(r))e=r;else if(xt(r))for(let t=0;t<r.length;t++){const n=ad(r[t]);n&&(e+=n+" ")}else if(Cn(r))for(const t in r)r[t]&&(e+=t+" ");return e.trim()}const l5=r=>r==null?"":Cn(r)?JSON.stringify(r,BS,2):String(r),BS=(r,e)=>Go(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[n,i])=>(t[`${n} =>`]=i,t),{})}:_v(e)?{[`Set(${e.size})`]:[...e.values()]}:Cn(e)&&!xt(e)&&!zS(e)?String(e):e,Ct={},yl=[],qs=()=>{},Sv=()=>!1,LS=/^on[^a-z]/,Qc=r=>LS.test(r),ld=r=>r.startsWith("onUpdate:"),Tn=Object.assign,Ev=(r,e)=>{const t=r.indexOf(e);t>-1&&r.splice(t,1)},DS=Object.prototype.hasOwnProperty,Mt=(r,e)=>DS.call(r,e),xt=Array.isArray,Go=r=>jc(r)==="[object Map]",_v=r=>jc(r)==="[object Set]",mt=r=>typeof r=="function",rr=r=>typeof r=="string",cd=r=>typeof r=="symbol",Cn=r=>r!==null&&typeof r=="object",Tv=r=>Cn(r)&&mt(r.then)&&mt(r.catch),FS=Object.prototype.toString,jc=r=>FS.call(r),OS=r=>jc(r).slice(8,-1),zS=r=>jc(r)==="[object Object]",ud=r=>rr(r)&&r!=="NaN"&&r[0]!=="-"&&""+parseInt(r,10)===r,Zc=Xc(",key,ref,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Jc=r=>{const e=Object.create(null);return t=>e[t]||(e[t]=r(t))},US=/-(\w)/g,ko=Jc(r=>r.replace(US,(e,t)=>t?t.toUpperCase():"")),HS=/\B([A-Z])/g,Vo=Jc(r=>r.replace(HS,"-$1").toLowerCase()),Cv=Jc(r=>r.charAt(0).toUpperCase()+r.slice(1)),hd=Jc(r=>r?`on${Cv(r)}`:""),fd=(r,e)=>r!==e&&(r===r||e===e),dd=(r,e)=>{for(let t=0;t<r.length;t++)r[t](e)},pd=(r,e,t)=>{Object.defineProperty(r,e,{configurable:!0,enumerable:!1,value:t})},GS=r=>{const e=parseFloat(r);return isNaN(e)?r:e},md=new WeakMap,xl=[];let Ys;const Xs=Symbol(""),gd=Symbol("");function kS(r){return r&&r._isEffect===!0}function vd(r,e=Ct){kS(r)&&(r=r.raw);const t=WS(r,e);return e.lazy||t(),t}function yd(r){r.active&&(Rv(r),r.options.onStop&&r.options.onStop(),r.active=!1)}let VS=0;function WS(r,e){const t=function(){if(!t.active)return e.scheduler?void 0:r();if(!xl.includes(t)){Rv(t);try{return qS(),xl.push(t),Ys=t,r()}finally{xl.pop(),qo(),Ys=xl[xl.length-1]}}};return t.id=VS++,t.allowRecurse=!!e.allowRecurse,t._isEffect=!0,t.active=!0,t.raw=r,t.deps=[],t.options=e,t}function Rv(r){const{deps:e}=r;if(e.length){for(let t=0;t<e.length;t++)e[t].delete(r);e.length=0}}let Wo=!0;const xd=[];function wl(){xd.push(Wo),Wo=!1}function qS(){xd.push(Wo),Wo=!0}function qo(){const r=xd.pop();Wo=r===void 0?!0:r}function fr(r,e,t){if(!Wo||Ys===void 0)return;let n=md.get(r);n||md.set(r,n=new Map);let i=n.get(t);i||n.set(t,i=new Set),i.has(Ys)||(i.add(Ys),Ys.deps.push(i))}function Jr(r,e,t,n,i,s){const o=md.get(r);if(!o)return;const a=new Set,l=u=>{u&&u.forEach(c=>{(c!==Ys||c.allowRecurse)&&a.add(c)})};if(e==="clear")o.forEach(l);else if(t==="length"&&xt(r))o.forEach((u,c)=>{(c==="length"||c>=n)&&l(u)});else switch(t!==void 0&&l(o.get(t)),e){case"add":xt(r)?ud(t)&&l(o.get("length")):(l(o.get(Xs)),Go(r)&&l(o.get(gd)));break;case"delete":xt(r)||(l(o.get(Xs)),Go(r)&&l(o.get(gd)));break;case"set":Go(r)&&l(o.get(Xs));break}const h=u=>{u.options.scheduler?u.options.scheduler(u):u()};a.forEach(h)}const YS=Xc("__proto__,__v_isRef,__isVue"),Nv=new Set(Object.getOwnPropertyNames(Symbol).map(r=>Symbol[r]).filter(cd)),XS=$c(),QS=$c(!1,!0),jS=$c(!0),ZS=$c(!0,!0),Kc={};["includes","indexOf","lastIndexOf"].forEach(r=>{const e=Array.prototype[r];Kc[r]=function(...t){const n=kt(this);for(let s=0,o=this.length;s<o;s++)fr(n,"get",s+"");const i=e.apply(n,t);return i===-1||i===!1?e.apply(n,t.map(kt)):i}});["push","pop","shift","unshift","splice"].forEach(r=>{const e=Array.prototype[r];Kc[r]=function(...t){wl();const n=e.apply(this,t);return qo(),n}});function $c(r=!1,e=!1){return function(n,i,s){if(i==="__v_isReactive")return!r;if(i==="__v_isReadonly")return r;if(i==="__v_raw"&&s===(r?e?aE:Wv:e?Vv:kv).get(n))return n;const o=xt(n);if(!r&&o&&Mt(Kc,i))return Reflect.get(Kc,i,s);const a=Reflect.get(n,i,s);return(cd(i)?Nv.has(i):YS(i))||(r||fr(n,"get",i),e)?a:dr(a)?!o||!ud(i)?a.value:a:Cn(a)?r?qv(a):Sd(a):a}}const JS=Iv(),KS=Iv(!0);function Iv(r=!1){return function(t,n,i,s){let o=t[n];if(!r&&(i=kt(i),o=kt(o),!xt(t)&&dr(o)&&!dr(i)))return o.value=i,!0;const a=xt(t)&&ud(n)?Number(n)<t.length:Mt(t,n),l=Reflect.set(t,n,i,s);return t===kt(s)&&(a?fd(i,o)&&Jr(t,"set",n,i):Jr(t,"add",n,i)),l}}function $S(r,e){const t=Mt(r,e);r[e];const n=Reflect.deleteProperty(r,e);return n&&t&&Jr(r,"delete",e,void 0),n}function eE(r,e){const t=Reflect.has(r,e);return(!cd(e)||!Nv.has(e))&&fr(r,"has",e),t}function tE(r){return fr(r,"iterate",xt(r)?"length":Xs),Reflect.ownKeys(r)}const Pv={get:XS,set:JS,deleteProperty:$S,has:eE,ownKeys:tE},Bv={get:jS,set(r,e){return!0},deleteProperty(r,e){return!0}},nE=Tn({},Pv,{get:QS,set:KS});Tn({},Bv,{get:ZS});const wd=r=>Cn(r)?Sd(r):r,bd=r=>Cn(r)?qv(r):r,Md=r=>r,eu=r=>Reflect.getPrototypeOf(r);function tu(r,e,t=!1,n=!1){r=r.__v_raw;const i=kt(r),s=kt(e);e!==s&&!t&&fr(i,"get",e),!t&&fr(i,"get",s);const{has:o}=eu(i),a=n?Md:t?bd:wd;if(o.call(i,e))return a(r.get(e));if(o.call(i,s))return a(r.get(s))}function nu(r,e=!1){const t=this.__v_raw,n=kt(t),i=kt(r);return r!==i&&!e&&fr(n,"has",r),!e&&fr(n,"has",i),r===i?t.has(r):t.has(r)||t.has(i)}function ru(r,e=!1){return r=r.__v_raw,!e&&fr(kt(r),"iterate",Xs),Reflect.get(r,"size",r)}function Lv(r){r=kt(r);const e=kt(this);return eu(e).has.call(e,r)||(e.add(r),Jr(e,"add",r,r)),this}function Dv(r,e){e=kt(e);const t=kt(this),{has:n,get:i}=eu(t);let s=n.call(t,r);s||(r=kt(r),s=n.call(t,r));const o=i.call(t,r);return t.set(r,e),s?fd(e,o)&&Jr(t,"set",r,e):Jr(t,"add",r,e),this}function Fv(r){const e=kt(this),{has:t,get:n}=eu(e);let i=t.call(e,r);i||(r=kt(r),i=t.call(e,r)),n&&n.call(e,r);const s=e.delete(r);return i&&Jr(e,"delete",r,void 0),s}function Ov(){const r=kt(this),e=r.size!==0,t=r.clear();return e&&Jr(r,"clear",void 0,void 0),t}function iu(r,e){return function(n,i){const s=this,o=s.__v_raw,a=kt(o),l=e?Md:r?bd:wd;return!r&&fr(a,"iterate",Xs),o.forEach((h,u)=>n.call(i,l(h),l(u),s))}}function su(r,e,t){return function(...n){const i=this.__v_raw,s=kt(i),o=Go(s),a=r==="entries"||r===Symbol.iterator&&o,l=r==="keys"&&o,h=i[r](...n),u=t?Md:e?bd:wd;return!e&&fr(s,"iterate",l?gd:Xs),{next(){const{value:c,done:f}=h.next();return f?{value:c,done:f}:{value:a?[u(c[0]),u(c[1])]:u(c),done:f}},[Symbol.iterator](){return this}}}}function $i(r){return function(...e){return r==="delete"?!1:this}}const zv={get(r){return tu(this,r)},get size(){return ru(this)},has:nu,add:Lv,set:Dv,delete:Fv,clear:Ov,forEach:iu(!1,!1)},Uv={get(r){return tu(this,r,!1,!0)},get size(){return ru(this)},has:nu,add:Lv,set:Dv,delete:Fv,clear:Ov,forEach:iu(!1,!0)},Hv={get(r){return tu(this,r,!0)},get size(){return ru(this,!0)},has(r){return nu.call(this,r,!0)},add:$i("add"),set:$i("set"),delete:$i("delete"),clear:$i("clear"),forEach:iu(!0,!1)},Gv={get(r){return tu(this,r,!0,!0)},get size(){return ru(this,!0)},has(r){return nu.call(this,r,!0)},add:$i("add"),set:$i("set"),delete:$i("delete"),clear:$i("clear"),forEach:iu(!0,!0)},rE=["keys","values","entries",Symbol.iterator];rE.forEach(r=>{zv[r]=su(r,!1,!1),Hv[r]=su(r,!0,!1),Uv[r]=su(r,!1,!0),Gv[r]=su(r,!0,!0)});function Ad(r,e){const t=e?r?Gv:Uv:r?Hv:zv;return(n,i,s)=>i==="__v_isReactive"?!r:i==="__v_isReadonly"?r:i==="__v_raw"?n:Reflect.get(Mt(t,i)&&i in n?t:n,i,s)}const iE={get:Ad(!1,!1)},sE={get:Ad(!1,!0)},oE={get:Ad(!0,!1)},kv=new WeakMap,Vv=new WeakMap,Wv=new WeakMap,aE=new WeakMap;function lE(r){switch(r){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function cE(r){return r.__v_skip||!Object.isExtensible(r)?0:lE(OS(r))}function Sd(r){return r&&r.__v_isReadonly?r:Ed(r,!1,Pv,iE,kv)}function uE(r){return Ed(r,!1,nE,sE,Vv)}function qv(r){return Ed(r,!0,Bv,oE,Wv)}function Ed(r,e,t,n,i){if(!Cn(r)||r.__v_raw&&!(e&&r.__v_isReactive))return r;const s=i.get(r);if(s)return s;const o=cE(r);if(o===0)return r;const a=new Proxy(r,o===2?n:t);return i.set(r,a),a}function bl(r){return Yv(r)?bl(r.__v_raw):!!(r&&r.__v_isReactive)}function Yv(r){return!!(r&&r.__v_isReadonly)}function Xv(r){return bl(r)||Yv(r)}function kt(r){return r&&kt(r.__v_raw)||r}function dr(r){return Boolean(r&&r.__v_isRef===!0)}function hE(r){return dr(r)?r.value:r}const fE={get:(r,e,t)=>hE(Reflect.get(r,e,t)),set:(r,e,t,n)=>{const i=r[e];return dr(i)&&!dr(t)?(i.value=t,!0):Reflect.set(r,e,t,n)}};function _d(r){return bl(r)?r:new Proxy(r,fE)}class dE{constructor(e,t){this._object=e,this._key=t,this.__v_isRef=!0}get value(){return this._object[this._key]}set value(e){this._object[this._key]=e}}function pE(r,e){return dr(r[e])?r[e]:new dE(r,e)}class mE{constructor(e,t,n){this._setter=t,this._dirty=!0,this.__v_isRef=!0,this.effect=vd(e,{lazy:!0,scheduler:()=>{this._dirty||(this._dirty=!0,Jr(kt(this),"set","value"))}}),this.__v_isReadonly=n}get value(){const e=kt(this);return e._dirty&&(e._value=this.effect(),e._dirty=!1),fr(e,"get","value"),e._value}set value(e){this._setter(e)}}function gE(r){let e,t;return mt(r)?(e=r,t=qs):(e=r.get,t=r.set),new mE(e,t,mt(r)||!r.set)}function es(r,e,t,n){let i;try{i=n?r(...n):r()}catch(s){ou(s,e,t)}return i}function Kr(r,e,t,n){if(mt(r)){const s=es(r,e,t,n);return s&&Tv(s)&&s.catch(o=>{ou(o,e,t)}),s}const i=[];for(let s=0;s<r.length;s++)i.push(Kr(r[s],e,t,n));return i}function ou(r,e,t,n=!0){const i=e?e.vnode:null;if(e){let s=e.parent;const o=e.proxy,a=t;for(;s;){const h=s.ec;if(h){for(let u=0;u<h.length;u++)if(h[u](r,o,a)===!1)return}s=s.parent}const l=e.appContext.config.errorHandler;if(l){es(l,null,10,[r,o,a]);return}}vE(r,t,i,n)}function vE(r,e,t,n=!0){console.error(r)}let au=!1,Td=!1;const pr=[];let _i=0;const lu=[];let Ml=null,Yo=0;const Al=[];let ts=null,Xo=0;const Qv=Promise.resolve();let Cd=null,Rd=null;function yE(r){const e=Cd||Qv;return r?e.then(this?r.bind(this):r):e}function xE(r){let e=_i+1,t=pr.length;const n=Qo(r);for(;e<t;){const i=e+t>>>1;Qo(pr[i])<n?e=i+1:t=i}return e}function jv(r){if((!pr.length||!pr.includes(r,au&&r.allowRecurse?_i+1:_i))&&r!==Rd){const e=xE(r);e>-1?pr.splice(e,0,r):pr.push(r),Zv()}}function Zv(){!au&&!Td&&(Td=!0,Cd=Qv.then($v))}function wE(r){const e=pr.indexOf(r);e>_i&&pr.splice(e,1)}function Jv(r,e,t,n){xt(r)?t.push(...r):(!e||!e.includes(r,r.allowRecurse?n+1:n))&&t.push(r),Zv()}function bE(r){Jv(r,Ml,lu,Yo)}function ME(r){Jv(r,ts,Al,Xo)}function Nd(r,e=null){if(lu.length){for(Rd=e,Ml=[...new Set(lu)],lu.length=0,Yo=0;Yo<Ml.length;Yo++)Ml[Yo]();Ml=null,Yo=0,Rd=null,Nd(r,e)}}function Kv(r){if(Al.length){const e=[...new Set(Al)];if(Al.length=0,ts){ts.push(...e);return}for(ts=e,ts.sort((t,n)=>Qo(t)-Qo(n)),Xo=0;Xo<ts.length;Xo++)ts[Xo]();ts=null,Xo=0}}const Qo=r=>r.id==null?1/0:r.id;function $v(r){Td=!1,au=!0,Nd(r),pr.sort((e,t)=>Qo(e)-Qo(t));try{for(_i=0;_i<pr.length;_i++){const e=pr[_i];e&&es(e,null,14)}}finally{_i=0,pr.length=0,Kv(),au=!1,Cd=null,(pr.length||Al.length)&&$v(r)}}function AE(r,e,...t){const n=r.vnode.props||Ct;let i=t;const s=e.startsWith("update:"),o=s&&e.slice(7);if(o&&o in n){const u=`${o==="modelValue"?"model":o}Modifiers`,{number:c,trim:f}=n[u]||Ct;f?i=t.map(d=>d.trim()):c&&(i=t.map(GS))}let a,l=n[a=hd(e)]||n[a=hd(ko(e))];!l&&s&&(l=n[a=hd(Vo(e))]),l&&Kr(l,r,6,i);const h=n[a+"Once"];if(h){if(!r.emitted)(r.emitted={})[a]=!0;else if(r.emitted[a])return;Kr(h,r,6,i)}}function e0(r,e,t=!1){if(!e.deopt&&r.__emits!==void 0)return r.__emits;const n=r.emits;let i={},s=!1;if(!mt(r)){const o=a=>{const l=e0(a,e,!0);l&&(s=!0,Tn(i,l))};!t&&e.mixins.length&&e.mixins.forEach(o),r.extends&&o(r.extends),r.mixins&&r.mixins.forEach(o)}return!n&&!s?r.__emits=null:(xt(n)?n.forEach(o=>i[o]=null):Tn(i,n),r.__emits=i)}function Id(r,e){return!r||!Qc(e)?!1:(e=e.slice(2).replace(/Once$/,""),Mt(r,e[0].toLowerCase()+e.slice(1))||Mt(r,Vo(e))||Mt(r,e))}let Pd=0;const t0=r=>Pd+=r;let $r=null,cu=null;function uu(r){const e=$r;return $r=r,cu=r&&r.type.__scopeId||null,e}function c5(r){cu=r}function u5(){cu=null}function SE(r,e=$r){if(!e)return r;const t=(...n)=>{Pd||s_(!0);const i=uu(e),s=r(...n);return uu(i),Pd||w0(),s};return t._c=!0,t}function n0(r){const{type:e,vnode:t,proxy:n,withProxy:i,props:s,propsOptions:[o],slots:a,attrs:l,emit:h,render:u,renderCache:c,data:f,setupState:d,ctx:p}=r;let m;const y=uu(r);try{let g;if(t.shapeFlag&4){const w=i||n;m=Er(u.call(w,w,c,s,d,f,p)),g=l}else{const w=e;m=Er(w.length>1?w(s,{attrs:l,slots:a,emit:h}):w(s,null)),g=e.props?l:_E(l)}let v=m,x;if(e.inheritAttrs!==!1&&g){const w=Object.keys(g),{shapeFlag:b}=v;w.length&&(b&1||b&6)&&(o&&w.some(ld)&&(g=TE(g,o)),v=Jo(v,g))}t.dirs&&(v.dirs=v.dirs?v.dirs.concat(t.dirs):t.dirs),t.transition&&(v.transition=t.transition),m=v}catch(g){Sl.length=0,ou(g,r,1),m=is(Zo)}return uu(y),m}function EE(r){let e;for(let t=0;t<r.length;t++){const n=r[t];if(b0(n)){if(n.type!==Zo||n.children==="v-if"){if(e)return;e=n}}else return}return e}const _E=r=>{let e;for(const t in r)(t==="class"||t==="style"||Qc(t))&&((e||(e={}))[t]=r[t]);return e},TE=(r,e)=>{const t={};for(const n in r)(!ld(n)||!(n.slice(9)in e))&&(t[n]=r[n]);return t};function CE(r,e,t){const{props:n,children:i,component:s}=r,{props:o,children:a,patchFlag:l}=e,h=s.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&l>=0){if(l&1024)return!0;if(l&16)return n?r0(n,o,h):!!o;if(l&8){const u=e.dynamicProps;for(let c=0;c<u.length;c++){const f=u[c];if(o[f]!==n[f]&&!Id(h,f))return!0}}}else return(i||a)&&(!a||!a.$stable)?!0:n===o?!1:n?o?r0(n,o,h):!0:!!o;return!1}function r0(r,e,t){const n=Object.keys(e);if(n.length!==Object.keys(r).length)return!0;for(let i=0;i<n.length;i++){const s=n[i];if(e[s]!==r[s]&&!Id(t,s))return!0}return!1}function RE({vnode:r,parent:e},t){for(;e&&e.subTree===r;)(r=e.vnode).el=t,e=e.parent}const NE=r=>r.__isSuspense;function IE(r){const{shapeFlag:e,children:t}=r;let n,i;return e&32?(n=Bd(t.default),i=Bd(t.fallback)):(n=Bd(t),i=Er(null)),{content:n,fallback:i}}function Bd(r){return mt(r)&&(r=r()),xt(r)&&(r=EE(r)),Er(r)}function PE(r,e){e&&e.pendingBranch?xt(r)?e.effects.push(...r):e.effects.push(r):ME(r)}function BE(r,e,t,n=!1){const i={},s={};pd(s,fu,1),r.propsDefaults=Object.create(null),i0(r,e,i,s),t?r.props=n?i:uE(i):r.type.props?r.props=i:r.props=s,r.attrs=s}function LE(r,e,t,n){const{props:i,attrs:s,vnode:{patchFlag:o}}=r,a=kt(i),[l]=r.propsOptions;if((n||o>0)&&!(o&16)){if(o&8){const h=r.vnode.dynamicProps;for(let u=0;u<h.length;u++){const c=h[u],f=e[c];if(l)if(Mt(s,c))s[c]=f;else{const d=ko(c);i[d]=Ld(l,a,d,f,r)}else s[c]=f}}}else{i0(r,e,i,s);let h;for(const u in a)(!e||!Mt(e,u)&&((h=Vo(u))===u||!Mt(e,h)))&&(l?t&&(t[u]!==void 0||t[h]!==void 0)&&(i[u]=Ld(l,e||Ct,u,void 0,r)):delete i[u]);if(s!==a)for(const u in s)(!e||!Mt(e,u))&&delete s[u]}Jr(r,"set","$attrs")}function i0(r,e,t,n){const[i,s]=r.propsOptions;if(e)for(const o in e){const a=e[o];if(Zc(o))continue;let l;i&&Mt(i,l=ko(o))?t[l]=a:Id(r.emitsOptions,o)||(n[o]=a)}if(s){const o=kt(t);for(let a=0;a<s.length;a++){const l=s[a];t[l]=Ld(i,o,l,o[l],r)}}}function Ld(r,e,t,n,i){const s=r[t];if(s!=null){const o=Mt(s,"default");if(o&&n===void 0){const a=s.default;if(s.type!==Function&&mt(a)){const{propsDefaults:l}=i;t in l?n=l[t]:(gu(i),n=l[t]=a(e),gu(null))}else n=a}s[0]&&(!Mt(e,t)&&!o?n=!1:s[1]&&(n===""||n===Vo(t))&&(n=!0))}return n}function s0(r,e,t=!1){if(!e.deopt&&r.__props)return r.__props;const n=r.props,i={},s=[];let o=!1;if(!mt(r)){const a=l=>{o=!0;const[h,u]=s0(l,e,!0);Tn(i,h),u&&s.push(...u)};!t&&e.mixins.length&&e.mixins.forEach(a),r.extends&&a(r.extends),r.mixins&&r.mixins.forEach(a)}if(!n&&!o)return r.__props=yl;if(xt(n))for(let a=0;a<n.length;a++){const l=ko(n[a]);o0(l)&&(i[l]=Ct)}else if(n)for(const a in n){const l=ko(a);if(o0(l)){const h=n[a],u=i[l]=xt(h)||mt(h)?{type:h}:h;if(u){const c=c0(Boolean,u.type),f=c0(String,u.type);u[0]=c>-1,u[1]=f<0||c<f,(c>-1||Mt(u,"default"))&&s.push(l)}}}return r.__props=[i,s]}function o0(r){return r[0]!=="$"}function a0(r){const e=r&&r.toString().match(/^\s*function (\w+)/);return e?e[1]:""}function l0(r,e){return a0(r)===a0(e)}function c0(r,e){return xt(e)?e.findIndex(t=>l0(t,r)):mt(e)&&l0(e,r)?0:-1}function hu(r,e,t=Rn,n=!1){if(t){const i=t[r]||(t[r]=[]),s=e.__weh||(e.__weh=(...o)=>{if(t.isUnmounted)return;wl(),gu(t);const a=Kr(e,t,r,o);return gu(null),qo(),a});return n?i.unshift(s):i.push(s),s}}const ns=r=>(e,t=Rn)=>!qd&&hu(r,e,t),DE=ns("bm"),FE=ns("m"),OE=ns("bu"),zE=ns("u"),UE=ns("bum"),u0=ns("um"),HE=ns("rtg"),GE=ns("rtc"),kE=(r,e=Rn)=>{hu("ec",r,e)},h0={};function Dd(r,e,t){return f0(r,e,t)}function f0(r,e,{immediate:t,deep:n,flush:i,onTrack:s,onTrigger:o}=Ct,a=Rn){let l,h=!1;if(dr(r)?(l=()=>r.value,h=!!r._shallow):bl(r)?(l=()=>r,n=!0):xt(r)?l=()=>r.map(y=>{if(dr(y))return y.value;if(bl(y))return jo(y);if(mt(y))return es(y,a,2,[a&&a.proxy])}):mt(r)?e?l=()=>es(r,a,2,[a&&a.proxy]):l=()=>{if(!(a&&a.isUnmounted))return u&&u(),Kr(r,a,3,[c])}:l=qs,e&&n){const y=l;l=()=>jo(y())}let u,c=y=>{u=m.options.onStop=()=>{es(y,a,4)}},f=xt(r)?[]:h0;const d=()=>{if(!!m.active)if(e){const y=m();(n||h||fd(y,f))&&(u&&u(),Kr(e,a,3,[y,f===h0?void 0:f,c]),f=y)}else m()};d.allowRecurse=!!e;let p;i==="sync"?p=d:i==="post"?p=()=>qn(d,a&&a.suspense):p=()=>{!a||a.isMounted?bE(d):d()};const m=vd(l,{lazy:!0,onTrack:s,onTrigger:o,scheduler:p});return I0(m,a),e?t?d():f=m():i==="post"?qn(m,a&&a.suspense):m(),()=>{yd(m),a&&Ev(a.effects,m)}}function VE(r,e,t){const n=this.proxy,i=rr(r)?()=>n[r]:r.bind(n);return f0(i,e.bind(n),t,this)}function jo(r,e=new Set){if(!Cn(r)||e.has(r))return r;if(e.add(r),dr(r))jo(r.value,e);else if(xt(r))for(let t=0;t<r.length;t++)jo(r[t],e);else if(_v(r)||Go(r))r.forEach(t=>{jo(t,e)});else for(const t in r)jo(r[t],e);return r}const d0=r=>r.type.__isKeepAlive;function WE(r,e){p0(r,"a",e)}function qE(r,e){p0(r,"da",e)}function p0(r,e,t=Rn){const n=r.__wdc||(r.__wdc=()=>{let i=t;for(;i;){if(i.isDeactivated)return;i=i.parent}r()});if(hu(e,n,t),t){let i=t.parent;for(;i&&i.parent;)d0(i.parent.vnode)&&YE(n,e,t,i),i=i.parent}}function YE(r,e,t,n){const i=hu(e,r,n,!0);u0(()=>{Ev(n[e],i)},t)}const m0=r=>r[0]==="_"||r==="$stable",Fd=r=>xt(r)?r.map(Er):[Er(r)],XE=(r,e,t)=>SE(n=>Fd(e(n)),t),g0=(r,e)=>{const t=r._ctx;for(const n in r){if(m0(n))continue;const i=r[n];if(mt(i))e[n]=XE(n,i,t);else if(i!=null){const s=Fd(i);e[n]=()=>s}}},v0=(r,e)=>{const t=Fd(e);r.slots.default=()=>t},QE=(r,e)=>{if(r.vnode.shapeFlag&32){const t=e._;t?(r.slots=e,pd(e,"_",t)):g0(e,r.slots={})}else r.slots={},e&&v0(r,e);pd(r.slots,fu,1)},jE=(r,e,t)=>{const{vnode:n,slots:i}=r;let s=!0,o=Ct;if(n.shapeFlag&32){const a=e._;a?t&&a===1?s=!1:(Tn(i,e),!t&&a===1&&delete i._):(s=!e.$stable,g0(e,i)),o=e}else e&&(v0(r,e),o={default:1});if(s)for(const a in i)!m0(a)&&!(a in o)&&delete i[a]};function h5(r,e){const t=$r;if(t===null)return r;const n=t.proxy,i=r.dirs||(r.dirs=[]);for(let s=0;s<e.length;s++){let[o,a,l,h=Ct]=e[s];mt(o)&&(o={mounted:o,updated:o}),i.push({dir:o,instance:n,value:a,oldValue:void 0,arg:l,modifiers:h})}return r}function Qs(r,e,t,n){const i=r.dirs,s=e&&e.dirs;for(let o=0;o<i.length;o++){const a=i[o];s&&(a.oldValue=s[o].value);const l=a.dir[n];l&&Kr(l,t,8,[r.el,a,r,e])}}function y0(){return{app:null,config:{isNativeTag:Sv,performance:!1,globalProperties:{},optionMergeStrategies:{},isCustomElement:Sv,errorHandler:void 0,warnHandler:void 0},mixins:[],components:{},directives:{},provides:Object.create(null)}}let ZE=0;function JE(r,e){return function(n,i=null){i!=null&&!Cn(i)&&(i=null);const s=y0(),o=new Set;let a=!1;const l=s.app={_uid:ZE++,_component:n,_props:i,_container:null,_context:s,version:b_,get config(){return s.config},set config(h){},use(h,...u){return o.has(h)||(h&&mt(h.install)?(o.add(h),h.install(l,...u)):mt(h)&&(o.add(h),h(l,...u))),l},mixin(h){return s.mixins.includes(h)||(s.mixins.push(h),(h.props||h.emits)&&(s.deopt=!0)),l},component(h,u){return u?(s.components[h]=u,l):s.components[h]},directive(h,u){return u?(s.directives[h]=u,l):s.directives[h]},mount(h,u,c){if(!a){const f=is(n,i);return f.appContext=s,u&&e?e(f,h):r(f,h,c),a=!0,l._container=h,h.__vue_app__=l,f.component.proxy}},unmount(){a&&(r(null,l._container),delete l._container.__vue_app__)},provide(h,u){return s.provides[h]=u,l}};return l}}function f5(r){return mt(r)?{setup:r,name:r.name}:r}const KE=r=>!!r.type.__asyncLoader,$E={scheduler:jv,allowRecurse:!0},qn=PE,Od=(r,e,t,n)=>{if(xt(r)){r.forEach((u,c)=>Od(u,e&&(xt(e)?e[c]:e),t,n));return}let i;if(!n)i=null;else{if(KE(n))return;n.shapeFlag&4?i=n.component.exposed||n.component.proxy:i=n.el}const{i:s,r:o}=r,a=e&&e.r,l=s.refs===Ct?s.refs={}:s.refs,h=s.setupState;if(a!=null&&a!==o&&(rr(a)?(l[a]=null,Mt(h,a)&&(h[a]=null)):dr(a)&&(a.value=null)),rr(o)){const u=()=>{l[o]=i,Mt(h,o)&&(h[o]=i)};i?(u.id=-1,qn(u,t)):u()}else if(dr(o)){const u=()=>{o.value=i};i?(u.id=-1,qn(u,t)):u()}else mt(o)&&es(o,s,12,[i,l])};function e_(r){return t_(r)}function t_(r,e){const{insert:t,remove:n,patchProp:i,forcePatchProp:s,createElement:o,createText:a,createComment:l,setText:h,setElementText:u,parentNode:c,nextSibling:f,setScopeId:d=qs,cloneNode:p,insertStaticContent:m}=r,y=(G,q,B,D=null,$=null,ne=null,U=!1,W=null,P=!1)=>{G&&!El(G,q)&&(D=ge(G),z(G,$,ne,!0),G=null),q.patchFlag===-2&&(P=!1,q.dynamicChildren=null);const{type:C,ref:ee,shapeFlag:ae}=q;switch(C){case zd:g(G,q,B,D);break;case Zo:v(G,q,B,D);break;case Ud:G==null&&x(q,B,D,U);break;case rs:L(G,q,B,D,$,ne,U,W,P);break;default:ae&1?M(G,q,B,D,$,ne,U,W,P):ae&6?k(G,q,B,D,$,ne,U,W,P):(ae&64||ae&128)&&C.process(G,q,B,D,$,ne,U,W,P,he)}ee!=null&&$&&Od(ee,G&&G.ref,ne,q)},g=(G,q,B,D)=>{if(G==null)t(q.el=a(q.children),B,D);else{const $=q.el=G.el;q.children!==G.children&&h($,q.children)}},v=(G,q,B,D)=>{G==null?t(q.el=l(q.children||""),B,D):q.el=G.el},x=(G,q,B,D)=>{[G.el,G.anchor]=m(G.children,q,B,D)},w=({el:G,anchor:q},B,D)=>{let $;for(;G&&G!==q;)$=f(G),t(G,B,D),G=$;t(q,B,D)},b=({el:G,anchor:q})=>{let B;for(;G&&G!==q;)B=f(G),n(G),G=B;n(q)},M=(G,q,B,D,$,ne,U,W,P)=>{U=U||q.type==="svg",G==null?A(q,B,D,$,ne,U,W,P):R(G,q,$,ne,U,W,P)},A=(G,q,B,D,$,ne,U,W)=>{let P,C;const{type:ee,props:ae,shapeFlag:le,transition:ce,patchFlag:ye,dirs:we}=G;if(G.el&&p!==void 0&&ye===-1)P=G.el=p(G.el);else{if(P=G.el=o(G.type,ne,ae&&ae.is,ae),le&8?u(P,G.children):le&16&&N(G.children,P,null,D,$,ne&&ee!=="foreignObject",U,W||!!G.dynamicChildren),we&&Qs(G,null,D,"created"),ae){for(const oe in ae)Zc(oe)||i(P,oe,null,ae[oe],ne,G.children,D,$,me);(C=ae.onVnodeBeforeMount)&&ei(C,D,G)}E(P,G,G.scopeId,U,D)}we&&Qs(G,null,D,"beforeMount");const be=(!$||$&&!$.pendingBranch)&&ce&&!ce.persisted;be&&ce.beforeEnter(P),t(P,q,B),((C=ae&&ae.onVnodeMounted)||be||we)&&qn(()=>{C&&ei(C,D,G),be&&ce.enter(P),we&&Qs(G,null,D,"mounted")},$)},E=(G,q,B,D,$)=>{if(B&&d(G,B),D)for(let ne=0;ne<D.length;ne++)d(G,D[ne]);if($){let ne=$.subTree;if(q===ne){const U=$.vnode;E(G,U,U.scopeId,U.slotScopeIds,$.parent)}}},N=(G,q,B,D,$,ne,U,W,P=0)=>{for(let C=P;C<G.length;C++){const ee=G[C]=U?Zs(G[C]):Er(G[C]);y(null,ee,q,B,D,$,ne,U,W)}},R=(G,q,B,D,$,ne,U)=>{const W=q.el=G.el;let{patchFlag:P,dynamicChildren:C,dirs:ee}=q;P|=G.patchFlag&16;const ae=G.props||Ct,le=q.props||Ct;let ce;if((ce=le.onVnodeBeforeUpdate)&&ei(ce,B,q,G),ee&&Qs(q,G,B,"beforeUpdate"),P>0){if(P&16)S(W,q,ae,le,B,D,$);else if(P&2&&ae.class!==le.class&&i(W,"class",null,le.class,$),P&4&&i(W,"style",ae.style,le.style,$),P&8){const we=q.dynamicProps;for(let be=0;be<we.length;be++){const oe=we[be],Ie=ae[oe],Pe=le[oe];(Pe!==Ie||s&&s(W,oe))&&i(W,oe,Ie,Pe,$,G.children,B,D,me)}}P&1&&G.children!==q.children&&u(W,q.children)}else!U&&C==null&&S(W,q,ae,le,B,D,$);const ye=$&&q.type!=="foreignObject";C?_(G.dynamicChildren,C,W,B,D,ye,ne):U||F(G,q,W,null,B,D,ye,ne,!1),((ce=le.onVnodeUpdated)||ee)&&qn(()=>{ce&&ei(ce,B,q,G),ee&&Qs(q,G,B,"updated")},D)},_=(G,q,B,D,$,ne,U)=>{for(let W=0;W<q.length;W++){const P=G[W],C=q[W],ee=P.type===rs||!El(P,C)||P.shapeFlag&6||P.shapeFlag&64?c(P.el):B;y(P,C,ee,null,D,$,ne,U,!0)}},S=(G,q,B,D,$,ne,U)=>{if(B!==D){for(const W in D){if(Zc(W))continue;const P=D[W],C=B[W];(P!==C||s&&s(G,W))&&i(G,W,C,P,U,q.children,$,ne,me)}if(B!==Ct)for(const W in B)!Zc(W)&&!(W in D)&&i(G,W,B[W],null,U,q.children,$,ne,me)}},L=(G,q,B,D,$,ne,U,W,P)=>{const C=q.el=G?G.el:a(""),ee=q.anchor=G?G.anchor:a("");let{patchFlag:ae,dynamicChildren:le,slotScopeIds:ce}=q;ae>0&&(P=!0),ce&&(W=W?W.concat(ce):ce),G==null?(t(C,B,D),t(ee,B,D),N(q.children,B,ee,$,ne,U,W,P)):ae>0&&ae&64&&le&&G.dynamicChildren?(_(G.dynamicChildren,le,B,$,ne,U,W),(q.key!=null||$&&q===$.subTree)&&x0(G,q,!0)):F(G,q,B,ee,$,ne,U,W,P)},k=(G,q,B,D,$,ne,U,W,P)=>{q.slotScopeIds=W,G==null?q.shapeFlag&512?$.ctx.activate(q,B,D,U,P):H(q,B,D,$,ne,U,P):O(G,q,P)},H=(G,q,B,D,$,ne,U)=>{const W=G.component=m_(G,D,$);if(d0(G)&&(W.ctx.renderer=he),g_(W),W.asyncDep){if($&&$.registerDep(W,T),!G.el){const P=W.subTree=is(Zo);v(null,P,q,B)}return}T(W,G,q,B,$,ne,U)},O=(G,q,B)=>{const D=q.component=G.component;if(CE(G,q,B))if(D.asyncDep&&!D.asyncResolved){V(D,q,B);return}else D.next=q,wE(D.update),D.update();else q.component=G.component,q.el=G.el,D.vnode=q},T=(G,q,B,D,$,ne,U)=>{G.update=vd(function(){if(G.isMounted){let{next:P,bu:C,u:ee,parent:ae,vnode:le}=G,ce=P,ye;P?(P.el=le.el,V(G,P,U)):P=le,C&&dd(C),(ye=P.props&&P.props.onVnodeBeforeUpdate)&&ei(ye,ae,P,le);const we=n0(G),be=G.subTree;G.subTree=we,y(be,we,c(be.el),ge(be),G,$,ne),P.el=we.el,ce===null&&RE(G,we.el),ee&&qn(ee,$),(ye=P.props&&P.props.onVnodeUpdated)&&qn(()=>{ei(ye,ae,P,le)},$)}else{let P;const{el:C,props:ee}=q,{bm:ae,m:le,parent:ce}=G;ae&&dd(ae),(P=ee&&ee.onVnodeBeforeMount)&&ei(P,ce,q);const ye=G.subTree=n0(G);if(C&&pe?pe(q.el,ye,G,$,null):(y(null,ye,B,D,G,$,ne),q.el=ye.el),le&&qn(le,$),P=ee&&ee.onVnodeMounted){const be=q;qn(()=>{ei(P,ce,be)},$)}const{a:we}=G;we&&q.shapeFlag&256&&qn(we,$),G.isMounted=!0,q=B=D=null}},$E)},V=(G,q,B)=>{q.component=G;const D=G.vnode.props;G.vnode=q,G.next=null,LE(G,q.props,D,B),jE(G,q.children,B),wl(),Nd(void 0,G.update),qo()},F=(G,q,B,D,$,ne,U,W,P=!1)=>{const C=G&&G.children,ee=G?G.shapeFlag:0,ae=q.children,{patchFlag:le,shapeFlag:ce}=q;if(le>0){if(le&128){Y(C,ae,B,D,$,ne,U,W,P);return}else if(le&256){J(C,ae,B,D,$,ne,U,W,P);return}}ce&8?(ee&16&&me(C,$,ne),ae!==C&&u(B,ae)):ee&16?ce&16?Y(C,ae,B,D,$,ne,U,W,P):me(C,$,ne,!0):(ee&8&&u(B,""),ce&16&&N(ae,B,D,$,ne,U,W,P))},J=(G,q,B,D,$,ne,U,W,P)=>{G=G||yl,q=q||yl;const C=G.length,ee=q.length,ae=Math.min(C,ee);let le;for(le=0;le<ae;le++){const ce=q[le]=P?Zs(q[le]):Er(q[le]);y(G[le],ce,B,null,$,ne,U,W,P)}C>ee?me(G,$,ne,!0,!1,ae):N(q,B,D,$,ne,U,W,P,ae)},Y=(G,q,B,D,$,ne,U,W,P)=>{let C=0;const ee=q.length;let ae=G.length-1,le=ee-1;for(;C<=ae&&C<=le;){const ce=G[C],ye=q[C]=P?Zs(q[C]):Er(q[C]);if(El(ce,ye))y(ce,ye,B,null,$,ne,U,W,P);else break;C++}for(;C<=ae&&C<=le;){const ce=G[ae],ye=q[le]=P?Zs(q[le]):Er(q[le]);if(El(ce,ye))y(ce,ye,B,null,$,ne,U,W,P);else break;ae--,le--}if(C>ae){if(C<=le){const ce=le+1,ye=ce<ee?q[ce].el:D;for(;C<=le;)y(null,q[C]=P?Zs(q[C]):Er(q[C]),B,ye,$,ne,U,W,P),C++}}else if(C>le)for(;C<=ae;)z(G[C],$,ne,!0),C++;else{const ce=C,ye=C,we=new Map;for(C=ye;C<=le;C++){const Fe=q[C]=P?Zs(q[C]):Er(q[C]);Fe.key!=null&&we.set(Fe.key,C)}let be,oe=0;const Ie=le-ye+1;let Pe=!1,Qe=0;const Ge=new Array(Ie);for(C=0;C<Ie;C++)Ge[C]=0;for(C=ce;C<=ae;C++){const Fe=G[C];if(oe>=Ie){z(Fe,$,ne,!0);continue}let I;if(Fe.key!=null)I=we.get(Fe.key);else for(be=ye;be<=le;be++)if(Ge[be-ye]===0&&El(Fe,q[be])){I=be;break}I===void 0?z(Fe,$,ne,!0):(Ge[I-ye]=C+1,I>=Qe?Qe=I:Pe=!0,y(Fe,q[I],B,null,$,ne,U,W,P),oe++)}const We=Pe?n_(Ge):yl;for(be=We.length-1,C=Ie-1;C>=0;C--){const Fe=ye+C,I=q[Fe],re=Fe+1<ee?q[Fe+1].el:D;Ge[C]===0?y(null,I,B,re,$,ne,U,W,P):Pe&&(be<0||C!==We[be]?te(I,B,re,2):be--)}}},te=(G,q,B,D,$=null)=>{const{el:ne,type:U,transition:W,children:P,shapeFlag:C}=G;if(C&6){te(G.component.subTree,q,B,D);return}if(C&128){G.suspense.move(q,B,D);return}if(C&64){U.move(G,q,B,he);return}if(U===rs){t(ne,q,B);for(let ae=0;ae<P.length;ae++)te(P[ae],q,B,D);t(G.anchor,q,B);return}if(U===Ud){w(G,q,B);return}if(D!==2&&C&1&&W)if(D===0)W.beforeEnter(ne),t(ne,q,B),qn(()=>W.enter(ne),$);else{const{leave:ae,delayLeave:le,afterLeave:ce}=W,ye=()=>t(ne,q,B),we=()=>{ae(ne,()=>{ye(),ce&&ce()})};le?le(ne,ye,we):we()}else t(ne,q,B)},z=(G,q,B,D=!1,$=!1)=>{const{type:ne,props:U,ref:W,children:P,dynamicChildren:C,shapeFlag:ee,patchFlag:ae,dirs:le}=G;if(W!=null&&Od(W,null,B,null),ee&256){q.ctx.deactivate(G);return}const ce=ee&1&&le;let ye;if((ye=U&&U.onVnodeBeforeUnmount)&&ei(ye,q,G),ee&6)Q(G.component,B,D);else{if(ee&128){G.suspense.unmount(B,D);return}ce&&Qs(G,null,q,"beforeUnmount"),ee&64?G.type.remove(G,q,B,$,he,D):C&&(ne!==rs||ae>0&&ae&64)?me(C,q,B,!1,!0):(ne===rs&&(ae&128||ae&256)||!$&&ee&16)&&me(P,q,B),D&&K(G)}((ye=U&&U.onVnodeUnmounted)||ce)&&qn(()=>{ye&&ei(ye,q,G),ce&&Qs(G,null,q,"unmounted")},B)},K=G=>{const{type:q,el:B,anchor:D,transition:$}=G;if(q===rs){Z(B,D);return}if(q===Ud){b(G);return}const ne=()=>{n(B),$&&!$.persisted&&$.afterLeave&&$.afterLeave()};if(G.shapeFlag&1&&$&&!$.persisted){const{leave:U,delayLeave:W}=$,P=()=>U(B,ne);W?W(G.el,ne,P):P()}else ne()},Z=(G,q)=>{let B;for(;G!==q;)B=f(G),n(G),G=B;n(q)},Q=(G,q,B)=>{const{bum:D,effects:$,update:ne,subTree:U,um:W}=G;if(D&&dd(D),$)for(let P=0;P<$.length;P++)yd($[P]);ne&&(yd(ne),z(U,G,q,B)),W&&qn(W,q),qn(()=>{G.isUnmounted=!0},q),q&&q.pendingBranch&&!q.isUnmounted&&G.asyncDep&&!G.asyncResolved&&G.suspenseId===q.pendingId&&(q.deps--,q.deps===0&&q.resolve())},me=(G,q,B,D=!1,$=!1,ne=0)=>{for(let U=ne;U<G.length;U++)z(G[U],q,B,D,$)},ge=G=>G.shapeFlag&6?ge(G.component.subTree):G.shapeFlag&128?G.suspense.next():f(G.anchor||G.el),se=(G,q,B)=>{G==null?q._vnode&&z(q._vnode,null,null,!0):y(q._vnode||null,G,q,null,null,null,B),Kv(),q._vnode=G},he={p:y,um:z,m:te,r:K,mt:H,mc:N,pc:F,pbc:_,n:ge,o:r};let xe,pe;return e&&([xe,pe]=e(he)),{render:se,hydrate:xe,createApp:JE(se,xe)}}function ei(r,e,t,n=null){Kr(r,e,7,[t,n])}function x0(r,e,t=!1){const n=r.children,i=e.children;if(xt(n)&&xt(i))for(let s=0;s<n.length;s++){const o=n[s];let a=i[s];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=i[s]=Zs(i[s]),a.el=o.el),t||x0(o,a))}}function n_(r){const e=r.slice(),t=[0];let n,i,s,o,a;const l=r.length;for(n=0;n<l;n++){const h=r[n];if(h!==0){if(i=t[t.length-1],r[i]<h){e[n]=i,t.push(n);continue}for(s=0,o=t.length-1;s<o;)a=(s+o)/2|0,r[t[a]]<h?s=a+1:o=a;h<r[t[s]]&&(s>0&&(e[n]=t[s-1]),t[s]=n)}}for(s=t.length,o=t[s-1];s-- >0;)t[s]=o,o=e[o];return t}const r_=r=>r.__isTeleport,i_=Symbol(),rs=Symbol(void 0),zd=Symbol(void 0),Zo=Symbol(void 0),Ud=Symbol(void 0),Sl=[];let js=null;function s_(r=!1){Sl.push(js=r?null:[])}function w0(){Sl.pop(),js=Sl[Sl.length-1]||null}function d5(r,e,t,n,i){const s=is(r,e,t,n,i,!0);return s.dynamicChildren=js||yl,w0(),js&&js.push(s),s}function b0(r){return r?r.__v_isVNode===!0:!1}function El(r,e){return r.type===e.type&&r.key===e.key}const fu="__vInternal",M0=({key:r})=>r!=null?r:null,du=({ref:r})=>r!=null?rr(r)||dr(r)||mt(r)?{i:$r,r}:r:null,is=o_;function o_(r,e=null,t=null,n=0,i=null,s=!1){if((!r||r===i_)&&(r=Zo),b0(r)){const l=Jo(r,e,!0);return t&&Hd(l,t),l}if(x_(r)&&(r=r.__vccOpts),e){(Xv(e)||fu in e)&&(e=Tn({},e));let{class:l,style:h}=e;l&&!rr(l)&&(e.class=ad(l)),Cn(h)&&(Xv(h)&&!xt(h)&&(h=Tn({},h)),e.style=od(h))}const o=rr(r)?1:NE(r)?128:r_(r)?64:Cn(r)?4:mt(r)?2:0,a={__v_isVNode:!0,__v_skip:!0,type:r,props:e,key:e&&M0(e),ref:e&&du(e),scopeId:cu,slotScopeIds:null,children:null,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:o,patchFlag:n,dynamicProps:i,dynamicChildren:null,appContext:null};if(Hd(a,t),o&128){const{content:l,fallback:h}=IE(a);a.ssContent=l,a.ssFallback=h}return!s&&js&&(n>0||o&6)&&n!==32&&js.push(a),a}function Jo(r,e,t=!1){const{props:n,ref:i,patchFlag:s,children:o}=r,a=e?l_(n||{},e):n;return{__v_isVNode:!0,__v_skip:!0,type:r.type,props:a,key:a&&M0(a),ref:e&&e.ref?t&&i?xt(i)?i.concat(du(e)):[i,du(e)]:du(e):i,scopeId:r.scopeId,slotScopeIds:r.slotScopeIds,children:o,target:r.target,targetAnchor:r.targetAnchor,staticCount:r.staticCount,shapeFlag:r.shapeFlag,patchFlag:e&&r.type!==rs?s===-1?16:s|16:s,dynamicProps:r.dynamicProps,dynamicChildren:r.dynamicChildren,appContext:r.appContext,dirs:r.dirs,transition:r.transition,component:r.component,suspense:r.suspense,ssContent:r.ssContent&&Jo(r.ssContent),ssFallback:r.ssFallback&&Jo(r.ssFallback),el:r.el,anchor:r.anchor}}function a_(r=" ",e=0){return is(zd,null,r,e)}function Er(r){return r==null||typeof r=="boolean"?is(Zo):xt(r)?is(rs,null,r):typeof r=="object"?r.el===null?r:Jo(r):is(zd,null,String(r))}function Zs(r){return r.el===null?r:Jo(r)}function Hd(r,e){let t=0;const{shapeFlag:n}=r;if(e==null)e=null;else if(xt(e))t=16;else if(typeof e=="object")if(n&1||n&64){const i=e.default;i&&(i._c&&t0(1),Hd(r,i()),i._c&&t0(-1));return}else{t=32;const i=e._;!i&&!(fu in e)?e._ctx=$r:i===3&&$r&&($r.vnode.patchFlag&1024?(e._=2,r.patchFlag|=1024):e._=1)}else mt(e)?(e={default:e,_ctx:$r},t=32):(e=String(e),n&64?(t=16,e=[a_(e)]):t=8);r.children=e,r.shapeFlag|=t}function l_(...r){const e=Tn({},r[0]);for(let t=1;t<r.length;t++){const n=r[t];for(const i in n)if(i==="class")e.class!==n.class&&(e.class=ad([e.class,n.class]));else if(i==="style")e.style=od([e.style,n.style]);else if(Qc(i)){const s=e[i],o=n[i];s!==o&&(e[i]=s?[].concat(s,n[i]):o)}else i!==""&&(e[i]=n[i])}return e}function c_(r,e){if(Rn){let t=Rn.provides;const n=Rn.parent&&Rn.parent.provides;n===t&&(t=Rn.provides=Object.create(n)),t[r]=e}}function Gd(r,e,t=!1){const n=Rn||$r;if(n){const i=n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides;if(i&&r in i)return i[r];if(arguments.length>1)return t&&mt(e)?e():e}}let _l=!0;function kd(r,e,t=[],n=[],i=[],s=!1){const{mixins:o,extends:a,data:l,computed:h,methods:u,watch:c,provide:f,inject:d,components:p,directives:m,beforeMount:y,mounted:g,beforeUpdate:v,updated:x,activated:w,deactivated:b,beforeDestroy:M,beforeUnmount:A,destroyed:E,unmounted:N,render:R,renderTracked:_,renderTriggered:S,errorCaptured:L,expose:k}=e,H=r.proxy,O=r.ctx,T=r.appContext.mixins;if(s&&R&&r.render===qs&&(r.render=R),s||(_l=!1,A0("beforeCreate","bc",e,r,T),_l=!0,S0(r,T,t,n,i)),a&&kd(r,a,t,n,i,!0),o&&S0(r,o,t,n,i),d)if(xt(d))for(let V=0;V<d.length;V++){const F=d[V];O[F]=Gd(F)}else for(const V in d){const F=d[V];Cn(F)?O[V]=Gd(F.from||V,F.default,!0):O[V]=Gd(F)}if(u)for(const V in u){const F=u[V];mt(F)&&(O[V]=F.bind(H))}if(s?l&&t.push(l):(t.length&&t.forEach(V=>E0(r,V,H)),l&&E0(r,l,H)),h)for(const V in h){const F=h[V],J=mt(F)?F.bind(H,H):mt(F.get)?F.get.bind(H,H):qs,Y=!mt(F)&&mt(F.set)?F.set.bind(H):qs,te=w_({get:J,set:Y});Object.defineProperty(O,V,{enumerable:!0,configurable:!0,get:()=>te.value,set:z=>te.value=z})}if(c&&n.push(c),!s&&n.length&&n.forEach(V=>{for(const F in V)_0(V[F],O,H,F)}),f&&i.push(f),!s&&i.length&&i.forEach(V=>{const F=mt(V)?V.call(H):V;Reflect.ownKeys(F).forEach(J=>{c_(J,F[J])})}),s&&(p&&Tn(r.components||(r.components=Tn({},r.type.components)),p),m&&Tn(r.directives||(r.directives=Tn({},r.type.directives)),m)),s||A0("created","c",e,r,T),y&&DE(y.bind(H)),g&&FE(g.bind(H)),v&&OE(v.bind(H)),x&&zE(x.bind(H)),w&&WE(w.bind(H)),b&&qE(b.bind(H)),L&&kE(L.bind(H)),_&&GE(_.bind(H)),S&&HE(S.bind(H)),A&&UE(A.bind(H)),N&&u0(N.bind(H)),xt(k)&&!s)if(k.length){const V=r.exposed||(r.exposed=_d({}));k.forEach(F=>{V[F]=pE(H,F)})}else r.exposed||(r.exposed=Ct)}function A0(r,e,t,n,i){for(let s=0;s<i.length;s++)pu(r,e,i[s],n);pu(r,e,t,n)}function pu(r,e,t,n){const{extends:i,mixins:s}=t,o=t[r];if(i&&pu(r,e,i,n),s)for(let a=0;a<s.length;a++)pu(r,e,s[a],n);o&&Kr(o.bind(n.proxy),n,e)}function S0(r,e,t,n,i){for(let s=0;s<e.length;s++)kd(r,e[s],t,n,i,!0)}function E0(r,e,t){_l=!1;const n=e.call(t,t);_l=!0,Cn(n)&&(r.data===Ct?r.data=Sd(n):Tn(r.data,n))}function _0(r,e,t,n){const i=n.includes(".")?u_(t,n):()=>t[n];if(rr(r)){const s=e[r];mt(s)&&Dd(i,s)}else if(mt(r))Dd(i,r.bind(t));else if(Cn(r))if(xt(r))r.forEach(s=>_0(s,e,t,n));else{const s=mt(r.handler)?r.handler.bind(t):e[r.handler];mt(s)&&Dd(i,s,r)}}function u_(r,e){const t=e.split(".");return()=>{let n=r;for(let i=0;i<t.length&&n;i++)n=n[t[i]];return n}}function h_(r){const e=r.type,{__merged:t,mixins:n,extends:i}=e;if(t)return t;const s=r.appContext.mixins;if(!s.length&&!n&&!i)return e;const o={};return s.forEach(a=>mu(o,a,r)),mu(o,e,r),e.__merged=o}function mu(r,e,t){const n=t.appContext.config.optionMergeStrategies,{mixins:i,extends:s}=e;s&&mu(r,s,t),i&&i.forEach(o=>mu(r,o,t));for(const o in e)n&&Mt(n,o)?r[o]=n[o](r[o],e[o],t.proxy,o):r[o]=e[o]}const Vd=r=>r?C0(r)?r.exposed?r.exposed:r.proxy:Vd(r.parent):null,T0=Tn(Object.create(null),{$:r=>r,$el:r=>r.vnode.el,$data:r=>r.data,$props:r=>r.props,$attrs:r=>r.attrs,$slots:r=>r.slots,$refs:r=>r.refs,$parent:r=>Vd(r.parent),$root:r=>Vd(r.root),$emit:r=>r.emit,$options:r=>h_(r),$forceUpdate:r=>()=>jv(r.update),$nextTick:r=>yE.bind(r.proxy),$watch:r=>VE.bind(r)}),Wd={get({_:r},e){const{ctx:t,setupState:n,data:i,props:s,accessCache:o,type:a,appContext:l}=r;if(e==="__v_skip")return!0;let h;if(e[0]!=="$"){const d=o[e];if(d!==void 0)switch(d){case 0:return n[e];case 1:return i[e];case 3:return t[e];case 2:return s[e]}else{if(n!==Ct&&Mt(n,e))return o[e]=0,n[e];if(i!==Ct&&Mt(i,e))return o[e]=1,i[e];if((h=r.propsOptions[0])&&Mt(h,e))return o[e]=2,s[e];if(t!==Ct&&Mt(t,e))return o[e]=3,t[e];_l&&(o[e]=4)}}const u=T0[e];let c,f;if(u)return e==="$attrs"&&fr(r,"get",e),u(r);if((c=a.__cssModules)&&(c=c[e]))return c;if(t!==Ct&&Mt(t,e))return o[e]=3,t[e];if(f=l.config.globalProperties,Mt(f,e))return f[e]},set({_:r},e,t){const{data:n,setupState:i,ctx:s}=r;if(i!==Ct&&Mt(i,e))i[e]=t;else if(n!==Ct&&Mt(n,e))n[e]=t;else if(Mt(r.props,e))return!1;return e[0]==="$"&&e.slice(1)in r?!1:(s[e]=t,!0)},has({_:{data:r,setupState:e,accessCache:t,ctx:n,appContext:i,propsOptions:s}},o){let a;return t[o]!==void 0||r!==Ct&&Mt(r,o)||e!==Ct&&Mt(e,o)||(a=s[0])&&Mt(a,o)||Mt(n,o)||Mt(T0,o)||Mt(i.config.globalProperties,o)}},f_=Tn({},Wd,{get(r,e){if(e!==Symbol.unscopables)return Wd.get(r,e,r)},has(r,e){return e[0]!=="_"&&!TS(e)}}),d_=y0();let p_=0;function m_(r,e,t){const n=r.type,i=(e?e.appContext:r.appContext)||d_,s={uid:p_++,vnode:r,type:n,parent:e,appContext:i,root:null,next:null,subTree:null,update:null,render:null,proxy:null,exposed:null,withProxy:null,effects:null,provides:e?e.provides:Object.create(i.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:s0(n,i),emitsOptions:e0(n,i),emit:null,emitted:null,propsDefaults:Ct,ctx:Ct,data:Ct,props:Ct,attrs:Ct,slots:Ct,refs:Ct,setupState:Ct,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=AE.bind(null,s),s}let Rn=null;const gu=r=>{Rn=r};function C0(r){return r.vnode.shapeFlag&4}let qd=!1;function g_(r,e=!1){qd=e;const{props:t,children:n}=r.vnode,i=C0(r);BE(r,t,i,e),QE(r,n);const s=i?v_(r,e):void 0;return qd=!1,s}function v_(r,e){const t=r.type;r.accessCache=Object.create(null),r.proxy=new Proxy(r.ctx,Wd);const{setup:n}=t;if(n){const i=r.setupContext=n.length>1?y_(r):null;Rn=r,wl();const s=es(n,r,0,[r.props,i]);if(qo(),Rn=null,Tv(s)){if(e)return s.then(o=>{R0(r,o)}).catch(o=>{ou(o,r,0)});r.asyncDep=s}else R0(r,s)}else N0(r)}function R0(r,e,t){mt(e)?r.render=e:Cn(e)&&(r.setupState=_d(e)),N0(r)}function N0(r,e){const t=r.type;r.render||(r.render=t.render||qs,r.render._rc&&(r.withProxy=new Proxy(r.ctx,f_))),Rn=r,wl(),kd(r,t),qo(),Rn=null}function y_(r){const e=t=>{r.exposed=_d(t)};return{attrs:r.attrs,slots:r.slots,emit:r.emit,expose:e}}function I0(r,e=Rn){e&&(e.effects||(e.effects=[])).push(r)}function x_(r){return mt(r)&&"__vccOpts"in r}function w_(r){const e=gE(r);return I0(e.effect),e}const b_="3.0.11",P0="http://www.w3.org/2000/svg",Js=typeof document!="undefined"?document:null;let B0,L0;const D0={insert:(r,e,t)=>{e.insertBefore(r,t||null)},remove:r=>{const e=r.parentNode;e&&e.removeChild(r)},createElement:(r,e,t,n)=>{const i=e?Js.createElementNS(P0,r):Js.createElement(r,t?{is:t}:void 0);return r==="select"&&n&&n.multiple!=null&&i.setAttribute("multiple",n.multiple),i},createText:r=>Js.createTextNode(r),createComment:r=>Js.createComment(r),setText:(r,e)=>{r.nodeValue=e},setElementText:(r,e)=>{r.textContent=e},parentNode:r=>r.parentNode,nextSibling:r=>r.nextSibling,querySelector:r=>Js.querySelector(r),setScopeId(r,e){r.setAttribute(e,"")},cloneNode(r){const e=r.cloneNode(!0);return"_value"in r&&(e._value=r._value),e},insertStaticContent(r,e,t,n){const i=n?L0||(L0=Js.createElementNS(P0,"svg")):B0||(B0=Js.createElement("div"));i.innerHTML=r;const s=i.firstChild;let o=s,a=o;for(;o;)a=o,D0.insert(o,e,t),o=i.firstChild;return[s,a]}};function M_(r,e,t){if(e==null&&(e=""),t)r.setAttribute("class",e);else{const n=r._vtc;n&&(e=(e?[e,...n]:[...n]).join(" ")),r.className=e}}function A_(r,e,t){const n=r.style;if(!t)r.removeAttribute("style");else if(rr(t)){if(e!==t){const i=n.display;n.cssText=t,"_vod"in r&&(n.display=i)}}else{for(const i in t)Yd(n,i,t[i]);if(e&&!rr(e))for(const i in e)t[i]==null&&Yd(n,i,"")}}const F0=/\s*!important$/;function Yd(r,e,t){if(xt(t))t.forEach(n=>Yd(r,e,n));else if(e.startsWith("--"))r.setProperty(e,t);else{const n=S_(r,e);F0.test(t)?r.setProperty(Vo(n),t.replace(F0,""),"important"):r[n]=t}}const O0=["Webkit","Moz","ms"],Xd={};function S_(r,e){const t=Xd[e];if(t)return t;let n=ko(e);if(n!=="filter"&&n in r)return Xd[e]=n;n=Cv(n);for(let i=0;i<O0.length;i++){const s=O0[i]+n;if(s in r)return Xd[e]=s}return e}const z0="http://www.w3.org/1999/xlink";function E_(r,e,t,n){if(n&&e.startsWith("xlink:"))t==null?r.removeAttributeNS(z0,e.slice(6,e.length)):r.setAttributeNS(z0,e,t);else{const i=RS(e);t==null||i&&t===!1?r.removeAttribute(e):r.setAttribute(e,i?"":t)}}function __(r,e,t,n,i,s,o){if(e==="innerHTML"||e==="textContent"){n&&o(n,i,s),r[e]=t==null?"":t;return}if(e==="value"&&r.tagName!=="PROGRESS"){r._value=t;const a=t==null?"":t;r.value!==a&&(r.value=a);return}if(t===""||t==null){const a=typeof r[e];if(t===""&&a==="boolean"){r[e]=!0;return}else if(t==null&&a==="string"){r[e]="",r.removeAttribute(e);return}else if(a==="number"){r[e]=0,r.removeAttribute(e);return}}try{r[e]=t}catch{}}let vu=Date.now,U0=!1;if(typeof window!="undefined"){vu()>document.createEvent("Event").timeStamp&&(vu=()=>performance.now());const r=navigator.userAgent.match(/firefox\/(\d+)/i);U0=!!(r&&Number(r[1])<=53)}let Qd=0;const T_=Promise.resolve(),C_=()=>{Qd=0},R_=()=>Qd||(T_.then(C_),Qd=vu());function N_(r,e,t,n){r.addEventListener(e,t,n)}function I_(r,e,t,n){r.removeEventListener(e,t,n)}function P_(r,e,t,n,i=null){const s=r._vei||(r._vei={}),o=s[e];if(n&&o)o.value=n;else{const[a,l]=B_(e);if(n){const h=s[e]=L_(n,i);N_(r,a,h,l)}else o&&(I_(r,a,o,l),s[e]=void 0)}}const H0=/(?:Once|Passive|Capture)$/;function B_(r){let e;if(H0.test(r)){e={};let t;for(;t=r.match(H0);)r=r.slice(0,r.length-t[0].length),e[t[0].toLowerCase()]=!0}return[Vo(r.slice(2)),e]}function L_(r,e){const t=n=>{const i=n.timeStamp||vu();(U0||i>=t.attached-1)&&Kr(D_(n,t.value),e,5,[n])};return t.value=r,t.attached=R_(),t}function D_(r,e){if(xt(e)){const t=r.stopImmediatePropagation;return r.stopImmediatePropagation=()=>{t.call(r),r._stopped=!0},e.map(n=>i=>!i._stopped&&n(i))}else return e}const G0=/^on[a-z]/,F_=(r,e)=>e==="value",O_=(r,e,t,n,i=!1,s,o,a,l)=>{switch(e){case"class":M_(r,n,i);break;case"style":A_(r,t,n);break;default:Qc(e)?ld(e)||P_(r,e,t,n,o):z_(r,e,n,i)?__(r,e,n,s,o,a,l):(e==="true-value"?r._trueValue=n:e==="false-value"&&(r._falseValue=n),E_(r,e,n,i));break}};function z_(r,e,t,n){return n?!!(e==="innerHTML"||e in r&&G0.test(e)&&mt(t)):e==="spellcheck"||e==="draggable"||e==="form"||e==="list"&&r.tagName==="INPUT"||e==="type"&&r.tagName==="TEXTAREA"||G0.test(e)&&rr(t)?!1:e in r}const p5={beforeMount(r,{value:e},{transition:t}){r._vod=r.style.display==="none"?"":r.style.display,t&&e?t.beforeEnter(r):Tl(r,e)},mounted(r,{value:e},{transition:t}){t&&e&&t.enter(r)},updated(r,{value:e,oldValue:t},{transition:n}){!e!=!t&&(n?e?(n.beforeEnter(r),Tl(r,!0),n.enter(r)):n.leave(r,()=>{Tl(r,!1)}):Tl(r,e))},beforeUnmount(r,{value:e}){Tl(r,e)}};function Tl(r,e){r.style.display=e?r._vod:"none"}const U_=Tn({patchProp:O_,forcePatchProp:F_},D0);let k0;function H_(){return k0||(k0=e_(U_))}const m5=(...r)=>{const e=H_().createApp(...r),{mount:t}=e;return e.mount=n=>{const i=G_(n);if(!i)return;const s=e._component;!mt(s)&&!s.render&&!s.template&&(s.template=i.innerHTML),i.innerHTML="";const o=t(i,!1,i instanceof SVGElement);return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),o},e};function G_(r){return rr(r)?document.querySelector(r):r}/**
 * @license
 * Copyright 2010-2021 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const yu="136",k_={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},V_={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},V0=0,jd=1,W0=2,W_=3,q_=0,Zd=1,q0=2,Ko=3,Ti=0,zt=1,mr=2,Jd=1,Y_=2,Un=0,$o=1,Kd=2,$d=3,ep=4,Y0=5,Ks=100,X0=101,Q0=102,tp=103,np=104,j0=200,Z0=201,J0=202,K0=203,rp=204,ip=205,$0=206,ey=207,ty=208,ny=209,ry=210,iy=0,sy=1,oy=2,xu=3,ay=4,ly=5,cy=6,uy=7,Cl=0,hy=1,fy=2,Ci=0,dy=1,py=2,my=3,gy=4,vy=5,wu=300,$s=301,eo=302,Rl=303,Nl=304,ea=306,Il=307,Ri=1e3,Mn=1001,ta=1002,Ut=1003,Pl=1004,X_=1004,Bl=1005,Q_=1005,ft=1006,bu=1007,j_=1007,ti=1008,Z_=1008,pn=1009,yy=1010,xy=1011,na=1012,wy=1013,ra=1014,ni=1015,ss=1016,by=1017,My=1018,Ay=1019,os=1020,Sy=1021,An=1022,Lt=1023,Ll=1024,Ey=1025,as=1026,ls=1027,sp=1028,_y=1029,op=1030,Ty=1031,Cy=1032,Ry=1033,Mu=33776,ap=33777,lp=33778,Au=33779,Su=35840,cp=35841,Eu=35842,up=35843,hp=36196,_u=37492,Tu=37496,fp=37808,Ny=37809,Iy=37810,Py=37811,By=37812,Ly=37813,Dy=37814,Fy=37815,Oy=37816,zy=37817,Uy=37818,Hy=37819,Gy=37820,ky=37821,dp=36492,Vy=37840,Wy=37841,qy=37842,Yy=37843,Xy=37844,Qy=37845,jy=37846,Zy=37847,Jy=37848,Ky=37849,$y=37850,ex=37851,tx=37852,nx=37853,rx=2200,ix=2201,sx=2202,ia=2300,to=2301,Cu=2302,no=2400,ro=2401,Dl=2402,Ru=2500,pp=2501,ox=0,ax=1,mp=2,gr=3e3,Fr=3001,Fl=3200,lx=3201,cs=0,cx=1,J_=0,Nu=7680,K_=7681,$_=7682,eT=7683,tT=34055,nT=34056,rT=5386,iT=512,sT=513,oT=514,aT=515,lT=516,cT=517,uT=518,ux=519,sa=35044,oa=35048,hT=35040,fT=35045,dT=35049,pT=35041,mT=35046,gT=35050,vT=35042,yT="100",gp="300 es";class ri{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const n=this._listeners[e.type];if(n!==void 0){e.target=this;const i=n.slice(0);for(let s=0,o=i.length;s<o;s++)i[s].call(this,e);e.target=null}}}const Nn=[];for(let r=0;r<256;r++)Nn[r]=(r<16?"0":"")+r.toString(16);let Iu=1234567;const io=Math.PI/180,Ol=180/Math.PI;function vr(){const r=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(Nn[r&255]+Nn[r>>8&255]+Nn[r>>16&255]+Nn[r>>24&255]+"-"+Nn[e&255]+Nn[e>>8&255]+"-"+Nn[e>>16&15|64]+Nn[e>>24&255]+"-"+Nn[t&63|128]+Nn[t>>8&255]+"-"+Nn[t>>16&255]+Nn[t>>24&255]+Nn[n&255]+Nn[n>>8&255]+Nn[n>>16&255]+Nn[n>>24&255]).toUpperCase()}function In(r,e,t){return Math.max(e,Math.min(t,r))}function vp(r,e){return(r%e+e)%e}function xT(r,e,t,n,i){return n+(r-e)*(i-n)/(t-e)}function wT(r,e,t){return r!==e?(t-r)/(e-r):0}function zl(r,e,t){return(1-t)*r+t*e}function bT(r,e,t,n){return zl(r,e,1-Math.exp(-t*n))}function MT(r,e=1){return e-Math.abs(vp(r,e*2)-e)}function AT(r,e,t){return r<=e?0:r>=t?1:(r=(r-e)/(t-e),r*r*(3-2*r))}function ST(r,e,t){return r<=e?0:r>=t?1:(r=(r-e)/(t-e),r*r*r*(r*(r*6-15)+10))}function ET(r,e){return r+Math.floor(Math.random()*(e-r+1))}function _T(r,e){return r+Math.random()*(e-r)}function TT(r){return r*(.5-Math.random())}function CT(r){return r!==void 0&&(Iu=r%2147483647),Iu=Iu*16807%2147483647,(Iu-1)/2147483646}function RT(r){return r*io}function NT(r){return r*Ol}function yp(r){return(r&r-1)==0&&r!==0}function hx(r){return Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))}function fx(r){return Math.pow(2,Math.floor(Math.log(r)/Math.LN2))}function IT(r,e,t,n,i){const s=Math.cos,o=Math.sin,a=s(t/2),l=o(t/2),h=s((e+n)/2),u=o((e+n)/2),c=s((e-n)/2),f=o((e-n)/2),d=s((n-e)/2),p=o((n-e)/2);switch(i){case"XYX":r.set(a*u,l*c,l*f,a*h);break;case"YZY":r.set(l*f,a*u,l*c,a*h);break;case"ZXZ":r.set(l*c,l*f,a*u,a*h);break;case"XZX":r.set(a*u,l*p,l*d,a*h);break;case"YXY":r.set(l*d,a*u,l*p,a*h);break;case"ZYZ":r.set(l*p,l*d,a*u,a*h);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}var Pu=Object.freeze({__proto__:null,DEG2RAD:io,RAD2DEG:Ol,generateUUID:vr,clamp:In,euclideanModulo:vp,mapLinear:xT,inverseLerp:wT,lerp:zl,damp:bT,pingpong:MT,smoothstep:AT,smootherstep:ST,randInt:ET,randFloat:_T,randFloatSpread:TT,seededRandom:CT,degToRad:RT,radToDeg:NT,isPowerOfTwo:yp,ceilPowerOfTwo:hx,floorPowerOfTwo:fx,setQuaternionFromProperEuler:IT});class Ae{constructor(e=0,t=0){this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6],this.y=i[1]*t+i[4]*n+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t,n){return n!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),i=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*n-o*i+e.x,this.y=s*i+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}Ae.prototype.isVector2=!0;class yn{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,t,n,i,s,o,a,l,h){const u=this.elements;return u[0]=e,u[1]=i,u[2]=a,u[3]=t,u[4]=s,u[5]=l,u[6]=n,u[7]=o,u[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,s=this.elements,o=n[0],a=n[3],l=n[6],h=n[1],u=n[4],c=n[7],f=n[2],d=n[5],p=n[8],m=i[0],y=i[3],g=i[6],v=i[1],x=i[4],w=i[7],b=i[2],M=i[5],A=i[8];return s[0]=o*m+a*v+l*b,s[3]=o*y+a*x+l*M,s[6]=o*g+a*w+l*A,s[1]=h*m+u*v+c*b,s[4]=h*y+u*x+c*M,s[7]=h*g+u*w+c*A,s[2]=f*m+d*v+p*b,s[5]=f*y+d*x+p*M,s[8]=f*g+d*w+p*A,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],h=e[7],u=e[8];return t*o*u-t*a*h-n*s*u+n*a*l+i*s*h-i*o*l}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],h=e[7],u=e[8],c=u*o-a*h,f=a*l-u*s,d=h*s-o*l,p=t*c+n*f+i*d;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);const m=1/p;return e[0]=c*m,e[1]=(i*h-u*n)*m,e[2]=(a*n-i*o)*m,e[3]=f*m,e[4]=(u*t-i*l)*m,e[5]=(i*s-a*t)*m,e[6]=d*m,e[7]=(n*l-h*t)*m,e[8]=(o*t-n*s)*m,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,i,s,o,a){const l=Math.cos(s),h=Math.sin(s);return this.set(n*l,n*h,-n*(l*o+h*a)+o+e,-i*h,i*l,-i*(-h*o+l*a)+a+t,0,0,1),this}scale(e,t){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this}rotate(e){const t=Math.cos(e),n=Math.sin(e),i=this.elements,s=i[0],o=i[3],a=i[6],l=i[1],h=i[4],u=i[7];return i[0]=t*s+n*l,i[3]=t*o+n*h,i[6]=t*a+n*u,i[1]=-n*s+t*l,i[4]=-n*o+t*h,i[7]=-n*a+t*u,this}translate(e,t){const n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<9;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}yn.prototype.isMatrix3=!0;function dx(r){if(r.length===0)return-1/0;let e=r[0];for(let t=1,n=r.length;t<n;++t)r[t]>e&&(e=r[t]);return e}const PT={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function aa(r,e){return new PT[r](e)}function Bu(r){return document.createElementNS("http://www.w3.org/1999/xhtml",r)}let la;class so{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement=="undefined")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{la===void 0&&(la=Bu("canvas")),la.width=e.width,la.height=e.height;const n=la.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=la}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}}let BT=0;class Qt extends ri{constructor(e=Qt.DEFAULT_IMAGE,t=Qt.DEFAULT_MAPPING,n=Mn,i=Mn,s=ft,o=ti,a=Lt,l=pn,h=1,u=gr){super();Object.defineProperty(this,"id",{value:BT++}),this.uuid=vr(),this.name="",this.image=e,this.mipmaps=[],this.mapping=t,this.wrapS=n,this.wrapT=i,this.magFilter=s,this.minFilter=o,this.anisotropy=h,this.format=a,this.internalFormat=null,this.type=l,this.offset=new Ae(0,0),this.repeat=new Ae(1,1),this.center=new Ae(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new yn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=u,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){const i=this.image;if(i.uuid===void 0&&(i.uuid=vr()),!t&&e.images[i.uuid]===void 0){let s;if(Array.isArray(i)){s=[];for(let o=0,a=i.length;o<a;o++)i[o].isDataTexture?s.push(xp(i[o].image)):s.push(xp(i[o]))}else s=xp(i);e.images[i.uuid]={uuid:i.uuid,url:s}}n.image=i.uuid}return JSON.stringify(this.userData)!=="{}"&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==wu)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Ri:e.x=e.x-Math.floor(e.x);break;case Mn:e.x=e.x<0?0:1;break;case ta:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Ri:e.y=e.y-Math.floor(e.y);break;case Mn:e.y=e.y<0?0:1;break;case ta:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&this.version++}}Qt.DEFAULT_IMAGE=void 0;Qt.DEFAULT_MAPPING=wu;Qt.prototype.isTexture=!0;function xp(r){return typeof HTMLImageElement!="undefined"&&r instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&r instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&r instanceof ImageBitmap?so.getDataURL(r):r.data?{data:Array.prototype.slice.call(r.data),width:r.width,height:r.height,type:r.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}class At{constructor(e=0,t=0,n=0,i=1){this.x=e,this.y=t,this.z=n,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*i+o[12]*s,this.y=o[1]*t+o[5]*n+o[9]*i+o[13]*s,this.z=o[2]*t+o[6]*n+o[10]*i+o[14]*s,this.w=o[3]*t+o[7]*n+o[11]*i+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,i,s;const o=.01,a=.1,l=e.elements,h=l[0],u=l[4],c=l[8],f=l[1],d=l[5],p=l[9],m=l[2],y=l[6],g=l[10];if(Math.abs(u-f)<o&&Math.abs(c-m)<o&&Math.abs(p-y)<o){if(Math.abs(u+f)<a&&Math.abs(c+m)<a&&Math.abs(p+y)<a&&Math.abs(h+d+g-3)<a)return this.set(1,0,0,0),this;t=Math.PI;const x=(h+1)/2,w=(d+1)/2,b=(g+1)/2,M=(u+f)/4,A=(c+m)/4,E=(p+y)/4;return x>w&&x>b?x<o?(n=0,i=.707106781,s=.707106781):(n=Math.sqrt(x),i=M/n,s=A/n):w>b?w<o?(n=.707106781,i=0,s=.707106781):(i=Math.sqrt(w),n=M/i,s=E/i):b<o?(n=.707106781,i=.707106781,s=0):(s=Math.sqrt(b),n=A/s,i=E/s),this.set(n,i,s,t),this}let v=Math.sqrt((y-p)*(y-p)+(c-m)*(c-m)+(f-u)*(f-u));return Math.abs(v)<.001&&(v=1),this.x=(y-p)/v,this.y=(c-m)/v,this.z=(f-u)/v,this.w=Math.acos((h+d+g-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t,n){return n!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}At.prototype.isVector4=!0;class mn extends ri{constructor(e,t,n={}){super();this.width=e,this.height=t,this.depth=1,this.scissor=new At(0,0,e,t),this.scissorTest=!1,this.viewport=new At(0,0,e,t),this.texture=new Qt(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.image={width:e,height:t,depth:1},this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.internalFormat=n.internalFormat!==void 0?n.internalFormat:null,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:ft,this.depthBuffer=n.depthBuffer!==void 0?n.depthBuffer:!0,this.stencilBuffer=n.stencilBuffer!==void 0?n.stencilBuffer:!1,this.depthTexture=n.depthTexture!==void 0?n.depthTexture:null}setTexture(e){e.image={width:this.width,height:this.height,depth:this.depth},this.texture=e}setSize(e,t,n=1){(this.width!==e||this.height!==t||this.depth!==n)&&(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.image=Av({},this.texture.image),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}mn.prototype.isWebGLRenderTarget=!0;class px extends mn{constructor(e,t,n){super(e,t);const i=this.texture;this.texture=[];for(let s=0;s<n;s++)this.texture[s]=i.clone()}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let i=0,s=this.texture.length;i<s;i++)this.texture[i].image.width=e,this.texture[i].image.height=t,this.texture[i].image.depth=n;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this.texture.length=0;for(let t=0,n=e.texture.length;t<n;t++)this.texture[t]=e.texture[t].clone();return this}}px.prototype.isWebGLMultipleRenderTargets=!0;class ca extends mn{constructor(e,t,n={}){super(e,t,n);this.samples=4,this.ignoreDepthForMultisampleCopy=n.ignoreDepth!==void 0?n.ignoreDepth:!0,this.useRenderToTexture=n.useRenderToTexture!==void 0?n.useRenderToTexture:!1,this.useRenderbuffer=this.useRenderToTexture===!1}copy(e){return super.copy.call(this,e),this.samples=e.samples,this.useRenderToTexture=e.useRenderToTexture,this.useRenderbuffer=e.useRenderbuffer,this}}ca.prototype.isWebGLMultisampleRenderTarget=!0;class Sn{constructor(e=0,t=0,n=0,i=1){this._x=e,this._y=t,this._z=n,this._w=i}static slerp(e,t,n,i){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(e,t,i)}static slerpFlat(e,t,n,i,s,o,a){let l=n[i+0],h=n[i+1],u=n[i+2],c=n[i+3];const f=s[o+0],d=s[o+1],p=s[o+2],m=s[o+3];if(a===0){e[t+0]=l,e[t+1]=h,e[t+2]=u,e[t+3]=c;return}if(a===1){e[t+0]=f,e[t+1]=d,e[t+2]=p,e[t+3]=m;return}if(c!==m||l!==f||h!==d||u!==p){let y=1-a;const g=l*f+h*d+u*p+c*m,v=g>=0?1:-1,x=1-g*g;if(x>Number.EPSILON){const b=Math.sqrt(x),M=Math.atan2(b,g*v);y=Math.sin(y*M)/b,a=Math.sin(a*M)/b}const w=a*v;if(l=l*y+f*w,h=h*y+d*w,u=u*y+p*w,c=c*y+m*w,y===1-a){const b=1/Math.sqrt(l*l+h*h+u*u+c*c);l*=b,h*=b,u*=b,c*=b}}e[t]=l,e[t+1]=h,e[t+2]=u,e[t+3]=c}static multiplyQuaternionsFlat(e,t,n,i,s,o){const a=n[i],l=n[i+1],h=n[i+2],u=n[i+3],c=s[o],f=s[o+1],d=s[o+2],p=s[o+3];return e[t]=a*p+u*c+l*d-h*f,e[t+1]=l*p+u*f+h*c-a*d,e[t+2]=h*p+u*d+a*f-l*c,e[t+3]=u*p-a*c-l*f-h*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!(e&&e.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=e._x,i=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,h=a(n/2),u=a(i/2),c=a(s/2),f=l(n/2),d=l(i/2),p=l(s/2);switch(o){case"XYZ":this._x=f*u*c+h*d*p,this._y=h*d*c-f*u*p,this._z=h*u*p+f*d*c,this._w=h*u*c-f*d*p;break;case"YXZ":this._x=f*u*c+h*d*p,this._y=h*d*c-f*u*p,this._z=h*u*p-f*d*c,this._w=h*u*c+f*d*p;break;case"ZXY":this._x=f*u*c-h*d*p,this._y=h*d*c+f*u*p,this._z=h*u*p+f*d*c,this._w=h*u*c-f*d*p;break;case"ZYX":this._x=f*u*c-h*d*p,this._y=h*d*c+f*u*p,this._z=h*u*p-f*d*c,this._w=h*u*c+f*d*p;break;case"YZX":this._x=f*u*c+h*d*p,this._y=h*d*c+f*u*p,this._z=h*u*p-f*d*c,this._w=h*u*c-f*d*p;break;case"XZY":this._x=f*u*c-h*d*p,this._y=h*d*c-f*u*p,this._z=h*u*p+f*d*c,this._w=h*u*c+f*d*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],i=t[4],s=t[8],o=t[1],a=t[5],l=t[9],h=t[2],u=t[6],c=t[10],f=n+a+c;if(f>0){const d=.5/Math.sqrt(f+1);this._w=.25/d,this._x=(u-l)*d,this._y=(s-h)*d,this._z=(o-i)*d}else if(n>a&&n>c){const d=2*Math.sqrt(1+n-a-c);this._w=(u-l)/d,this._x=.25*d,this._y=(i+o)/d,this._z=(s+h)/d}else if(a>c){const d=2*Math.sqrt(1+a-n-c);this._w=(s-h)/d,this._x=(i+o)/d,this._y=.25*d,this._z=(l+u)/d}else{const d=2*Math.sqrt(1+c-n-a);this._w=(o-i)/d,this._x=(s+h)/d,this._y=(l+u)/d,this._z=.25*d}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(In(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const i=Math.min(1,t/n);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,t){return t!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,i=e._y,s=e._z,o=e._w,a=t._x,l=t._y,h=t._z,u=t._w;return this._x=n*u+o*a+i*h-s*l,this._y=i*u+o*l+s*a-n*h,this._z=s*u+o*h+n*l-i*a,this._w=o*u-n*a-i*l-s*h,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const n=this._x,i=this._y,s=this._z,o=this._w;let a=o*e._w+n*e._x+i*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=n,this._y=i,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const d=1-t;return this._w=d*o+t*this._w,this._x=d*n+t*this._x,this._y=d*i+t*this._y,this._z=d*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const h=Math.sqrt(l),u=Math.atan2(h,a),c=Math.sin((1-t)*u)/h,f=Math.sin(t*u)/h;return this._w=o*c+this._w*f,this._x=n*c+this._x*f,this._y=i*c+this._y*f,this._z=s*c+this._z*f,this._onChangeCallback(),this}slerpQuaternions(e,t,n){this.copy(e).slerp(t,n)}random(){const e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),i=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(i),n*Math.sin(s),n*Math.cos(s),t*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}Sn.prototype.isQuaternion=!0;class X{constructor(e=0,t=0,n=0){this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e,t){return t!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(mx.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(mx.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6]*i,this.y=s[1]*t+s[4]*n+s[7]*i,this.z=s[2]*t+s[5]*n+s[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,s=e.elements,o=1/(s[3]*t+s[7]*n+s[11]*i+s[15]);return this.x=(s[0]*t+s[4]*n+s[8]*i+s[12])*o,this.y=(s[1]*t+s[5]*n+s[9]*i+s[13])*o,this.z=(s[2]*t+s[6]*n+s[10]*i+s[14])*o,this}applyQuaternion(e){const t=this.x,n=this.y,i=this.z,s=e.x,o=e.y,a=e.z,l=e.w,h=l*t+o*i-a*n,u=l*n+a*t-s*i,c=l*i+s*n-o*t,f=-s*t-o*n-a*i;return this.x=h*l+f*-s+u*-a-c*-o,this.y=u*l+f*-o+c*-s-h*-a,this.z=c*l+f*-a+h*-o-u*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*i,this.y=s[1]*t+s[5]*n+s[9]*i,this.z=s[2]*t+s[6]*n+s[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e,t){return t!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,i=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=i*l-s*a,this.y=s*o-n*l,this.z=n*a-i*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return wp.copy(this).projectOnVector(e),this.sub(wp)}reflect(e){return this.sub(wp.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(In(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const i=Math.sin(t)*e;return this.x=i*Math.sin(n),this.y=Math.cos(t)*e,this.z=i*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t,n){return n!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,n=Math.sqrt(1-e**2);return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}X.prototype.isVector3=!0;const wp=new X,mx=new Sn;class Rt{constructor(e=new X(1/0,1/0,1/0),t=new X(-1/0,-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,n=1/0,i=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,h=e.length;l<h;l+=3){const u=e[l],c=e[l+1],f=e[l+2];u<t&&(t=u),c<n&&(n=c),f<i&&(i=f),u>s&&(s=u),c>o&&(o=c),f>a&&(a=f)}return this.min.set(t,n,i),this.max.set(s,o,a),this}setFromBufferAttribute(e){let t=1/0,n=1/0,i=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,h=e.count;l<h;l++){const u=e.getX(l),c=e.getY(l),f=e.getZ(l);u<t&&(t=u),c<n&&(n=c),f<i&&(i=f),u>s&&(s=u),c>o&&(o=c),f>a&&(a=f)}return this.min.set(t,n,i),this.max.set(s,o,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Ul.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e){return this.makeEmpty(),this.expandByObject(e)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e){e.updateWorldMatrix(!1,!1);const t=e.geometry;t!==void 0&&(t.boundingBox===null&&t.computeBoundingBox(),bp.copy(t.boundingBox),bp.applyMatrix4(e.matrixWorld),this.union(bp));const n=e.children;for(let i=0,s=n.length;i<s;i++)this.expandByObject(n[i]);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Ul),Ul.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Hl),Lu.subVectors(this.max,Hl),ua.subVectors(e.a,Hl),ha.subVectors(e.b,Hl),fa.subVectors(e.c,Hl),us.subVectors(ha,ua),hs.subVectors(fa,ha),oo.subVectors(ua,fa);let t=[0,-us.z,us.y,0,-hs.z,hs.y,0,-oo.z,oo.y,us.z,0,-us.x,hs.z,0,-hs.x,oo.z,0,-oo.x,-us.y,us.x,0,-hs.y,hs.x,0,-oo.y,oo.x,0];return!Mp(t,ua,ha,fa,Lu)||(t=[1,0,0,0,1,0,0,0,1],!Mp(t,ua,ha,fa,Lu))?!1:(Du.crossVectors(us,hs),t=[Du.x,Du.y,Du.z],Mp(t,ua,ha,fa,Lu))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Ul.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=this.getSize(Ul).length()*.5,e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Ni[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Ni[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Ni[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Ni[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Ni[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Ni[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Ni[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Ni[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Ni),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}Rt.prototype.isBox3=!0;const Ni=[new X,new X,new X,new X,new X,new X,new X,new X],Ul=new X,bp=new Rt,ua=new X,ha=new X,fa=new X,us=new X,hs=new X,oo=new X,Hl=new X,Lu=new X,Du=new X,ao=new X;function Mp(r,e,t,n,i){for(let s=0,o=r.length-3;s<=o;s+=3){ao.fromArray(r,s);const a=i.x*Math.abs(ao.x)+i.y*Math.abs(ao.y)+i.z*Math.abs(ao.z),l=e.dot(ao),h=t.dot(ao),u=n.dot(ao);if(Math.max(-Math.max(l,h,u),Math.min(l,h,u))>a)return!1}return!0}const LT=new Rt,gx=new X,Fu=new X,Ap=new X;class yr{constructor(e=new X,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):LT.setFromPoints(e).getCenter(n);let i=0;for(let s=0,o=e.length;s<o;s++)i=Math.max(i,n.distanceToSquared(e[s]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){Ap.subVectors(e,this.center);const t=Ap.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),i=(n-this.radius)*.5;this.center.add(Ap.multiplyScalar(i/n)),this.radius+=i}return this}union(e){return this.center.equals(e.center)===!0?Fu.set(0,0,1).multiplyScalar(e.radius):Fu.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(gx.copy(e.center).add(Fu)),this.expandByPoint(gx.copy(e.center).sub(Fu)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Ii=new X,Sp=new X,Ou=new X,fs=new X,Ep=new X,zu=new X,_p=new X;class Pi{constructor(e=new X,t=new X(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Ii)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Ii.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Ii.copy(this.direction).multiplyScalar(t).add(this.origin),Ii.distanceToSquared(e))}distanceSqToSegment(e,t,n,i){Sp.copy(e).add(t).multiplyScalar(.5),Ou.copy(t).sub(e).normalize(),fs.copy(this.origin).sub(Sp);const s=e.distanceTo(t)*.5,o=-this.direction.dot(Ou),a=fs.dot(this.direction),l=-fs.dot(Ou),h=fs.lengthSq(),u=Math.abs(1-o*o);let c,f,d,p;if(u>0)if(c=o*l-a,f=o*a-l,p=s*u,c>=0)if(f>=-p)if(f<=p){const m=1/u;c*=m,f*=m,d=c*(c+o*f+2*a)+f*(o*c+f+2*l)+h}else f=s,c=Math.max(0,-(o*f+a)),d=-c*c+f*(f+2*l)+h;else f=-s,c=Math.max(0,-(o*f+a)),d=-c*c+f*(f+2*l)+h;else f<=-p?(c=Math.max(0,-(-o*s+a)),f=c>0?-s:Math.min(Math.max(-s,-l),s),d=-c*c+f*(f+2*l)+h):f<=p?(c=0,f=Math.min(Math.max(-s,-l),s),d=f*(f+2*l)+h):(c=Math.max(0,-(o*s+a)),f=c>0?s:Math.min(Math.max(-s,-l),s),d=-c*c+f*(f+2*l)+h);else f=o>0?-s:s,c=Math.max(0,-(o*f+a)),d=-c*c+f*(f+2*l)+h;return n&&n.copy(this.direction).multiplyScalar(c).add(this.origin),i&&i.copy(Ou).multiplyScalar(f).add(Sp),d}intersectSphere(e,t){Ii.subVectors(e.center,this.origin);const n=Ii.dot(this.direction),i=Ii.dot(Ii)-n*n,s=e.radius*e.radius;if(i>s)return null;const o=Math.sqrt(s-i),a=n-o,l=n+o;return a<0&&l<0?null:a<0?this.at(l,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,i,s,o,a,l;const h=1/this.direction.x,u=1/this.direction.y,c=1/this.direction.z,f=this.origin;return h>=0?(n=(e.min.x-f.x)*h,i=(e.max.x-f.x)*h):(n=(e.max.x-f.x)*h,i=(e.min.x-f.x)*h),u>=0?(s=(e.min.y-f.y)*u,o=(e.max.y-f.y)*u):(s=(e.max.y-f.y)*u,o=(e.min.y-f.y)*u),n>o||s>i||((s>n||n!==n)&&(n=s),(o<i||i!==i)&&(i=o),c>=0?(a=(e.min.z-f.z)*c,l=(e.max.z-f.z)*c):(a=(e.max.z-f.z)*c,l=(e.min.z-f.z)*c),n>l||a>i)||((a>n||n!==n)&&(n=a),(l<i||i!==i)&&(i=l),i<0)?null:this.at(n>=0?n:i,t)}intersectsBox(e){return this.intersectBox(e,Ii)!==null}intersectTriangle(e,t,n,i,s){Ep.subVectors(t,e),zu.subVectors(n,e),_p.crossVectors(Ep,zu);let o=this.direction.dot(_p),a;if(o>0){if(i)return null;a=1}else if(o<0)a=-1,o=-o;else return null;fs.subVectors(this.origin,e);const l=a*this.direction.dot(zu.crossVectors(fs,zu));if(l<0)return null;const h=a*this.direction.dot(Ep.cross(fs));if(h<0||l+h>o)return null;const u=-a*fs.dot(_p);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Ye{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,t,n,i,s,o,a,l,h,u,c,f,d,p,m,y){const g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=i,g[1]=s,g[5]=o,g[9]=a,g[13]=l,g[2]=h,g[6]=u,g[10]=c,g[14]=f,g[3]=d,g[7]=p,g[11]=m,g[15]=y,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Ye().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,i=1/da.setFromMatrixColumn(e,0).length(),s=1/da.setFromMatrixColumn(e,1).length(),o=1/da.setFromMatrixColumn(e,2).length();return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=0,t[4]=n[4]*s,t[5]=n[5]*s,t[6]=n[6]*s,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const t=this.elements,n=e.x,i=e.y,s=e.z,o=Math.cos(n),a=Math.sin(n),l=Math.cos(i),h=Math.sin(i),u=Math.cos(s),c=Math.sin(s);if(e.order==="XYZ"){const f=o*u,d=o*c,p=a*u,m=a*c;t[0]=l*u,t[4]=-l*c,t[8]=h,t[1]=d+p*h,t[5]=f-m*h,t[9]=-a*l,t[2]=m-f*h,t[6]=p+d*h,t[10]=o*l}else if(e.order==="YXZ"){const f=l*u,d=l*c,p=h*u,m=h*c;t[0]=f+m*a,t[4]=p*a-d,t[8]=o*h,t[1]=o*c,t[5]=o*u,t[9]=-a,t[2]=d*a-p,t[6]=m+f*a,t[10]=o*l}else if(e.order==="ZXY"){const f=l*u,d=l*c,p=h*u,m=h*c;t[0]=f-m*a,t[4]=-o*c,t[8]=p+d*a,t[1]=d+p*a,t[5]=o*u,t[9]=m-f*a,t[2]=-o*h,t[6]=a,t[10]=o*l}else if(e.order==="ZYX"){const f=o*u,d=o*c,p=a*u,m=a*c;t[0]=l*u,t[4]=p*h-d,t[8]=f*h+m,t[1]=l*c,t[5]=m*h+f,t[9]=d*h-p,t[2]=-h,t[6]=a*l,t[10]=o*l}else if(e.order==="YZX"){const f=o*l,d=o*h,p=a*l,m=a*h;t[0]=l*u,t[4]=m-f*c,t[8]=p*c+d,t[1]=c,t[5]=o*u,t[9]=-a*u,t[2]=-h*u,t[6]=d*c+p,t[10]=f-m*c}else if(e.order==="XZY"){const f=o*l,d=o*h,p=a*l,m=a*h;t[0]=l*u,t[4]=-c,t[8]=h*u,t[1]=f*c+m,t[5]=o*u,t[9]=d*c-p,t[2]=p*c-d,t[6]=a*u,t[10]=m*c+f}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(DT,e,FT)}lookAt(e,t,n){const i=this.elements;return xr.subVectors(e,t),xr.lengthSq()===0&&(xr.z=1),xr.normalize(),ds.crossVectors(n,xr),ds.lengthSq()===0&&(Math.abs(n.z)===1?xr.x+=1e-4:xr.z+=1e-4,xr.normalize(),ds.crossVectors(n,xr)),ds.normalize(),Uu.crossVectors(xr,ds),i[0]=ds.x,i[4]=Uu.x,i[8]=xr.x,i[1]=ds.y,i[5]=Uu.y,i[9]=xr.y,i[2]=ds.z,i[6]=Uu.z,i[10]=xr.z,this}multiply(e,t){return t!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,s=this.elements,o=n[0],a=n[4],l=n[8],h=n[12],u=n[1],c=n[5],f=n[9],d=n[13],p=n[2],m=n[6],y=n[10],g=n[14],v=n[3],x=n[7],w=n[11],b=n[15],M=i[0],A=i[4],E=i[8],N=i[12],R=i[1],_=i[5],S=i[9],L=i[13],k=i[2],H=i[6],O=i[10],T=i[14],V=i[3],F=i[7],J=i[11],Y=i[15];return s[0]=o*M+a*R+l*k+h*V,s[4]=o*A+a*_+l*H+h*F,s[8]=o*E+a*S+l*O+h*J,s[12]=o*N+a*L+l*T+h*Y,s[1]=u*M+c*R+f*k+d*V,s[5]=u*A+c*_+f*H+d*F,s[9]=u*E+c*S+f*O+d*J,s[13]=u*N+c*L+f*T+d*Y,s[2]=p*M+m*R+y*k+g*V,s[6]=p*A+m*_+y*H+g*F,s[10]=p*E+m*S+y*O+g*J,s[14]=p*N+m*L+y*T+g*Y,s[3]=v*M+x*R+w*k+b*V,s[7]=v*A+x*_+w*H+b*F,s[11]=v*E+x*S+w*O+b*J,s[15]=v*N+x*L+w*T+b*Y,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],i=e[8],s=e[12],o=e[1],a=e[5],l=e[9],h=e[13],u=e[2],c=e[6],f=e[10],d=e[14],p=e[3],m=e[7],y=e[11],g=e[15];return p*(+s*l*c-i*h*c-s*a*f+n*h*f+i*a*d-n*l*d)+m*(+t*l*d-t*h*f+s*o*f-i*o*d+i*h*u-s*l*u)+y*(+t*h*c-t*a*d-s*o*c+n*o*d+s*a*u-n*h*u)+g*(-i*a*u-t*l*c+t*a*f+i*o*c-n*o*f+n*l*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],h=e[7],u=e[8],c=e[9],f=e[10],d=e[11],p=e[12],m=e[13],y=e[14],g=e[15],v=c*y*h-m*f*h+m*l*d-a*y*d-c*l*g+a*f*g,x=p*f*h-u*y*h-p*l*d+o*y*d+u*l*g-o*f*g,w=u*m*h-p*c*h+p*a*d-o*m*d-u*a*g+o*c*g,b=p*c*l-u*m*l-p*a*f+o*m*f+u*a*y-o*c*y,M=t*v+n*x+i*w+s*b;if(M===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const A=1/M;return e[0]=v*A,e[1]=(m*f*s-c*y*s-m*i*d+n*y*d+c*i*g-n*f*g)*A,e[2]=(a*y*s-m*l*s+m*i*h-n*y*h-a*i*g+n*l*g)*A,e[3]=(c*l*s-a*f*s-c*i*h+n*f*h+a*i*d-n*l*d)*A,e[4]=x*A,e[5]=(u*y*s-p*f*s+p*i*d-t*y*d-u*i*g+t*f*g)*A,e[6]=(p*l*s-o*y*s-p*i*h+t*y*h+o*i*g-t*l*g)*A,e[7]=(o*f*s-u*l*s+u*i*h-t*f*h-o*i*d+t*l*d)*A,e[8]=w*A,e[9]=(p*c*s-u*m*s-p*n*d+t*m*d+u*n*g-t*c*g)*A,e[10]=(o*m*s-p*a*s+p*n*h-t*m*h-o*n*g+t*a*g)*A,e[11]=(u*a*s-o*c*s-u*n*h+t*c*h+o*n*d-t*a*d)*A,e[12]=b*A,e[13]=(u*m*i-p*c*i+p*n*f-t*m*f-u*n*y+t*c*y)*A,e[14]=(p*a*i-o*m*i-p*n*l+t*m*l+o*n*y-t*a*y)*A,e[15]=(o*c*i-u*a*i+u*n*l-t*c*l-o*n*f+t*a*f)*A,this}scale(e){const t=this.elements,n=e.x,i=e.y,s=e.z;return t[0]*=n,t[4]*=i,t[8]*=s,t[1]*=n,t[5]*=i,t[9]*=s,t[2]*=n,t[6]*=i,t[10]*=s,t[3]*=n,t[7]*=i,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,i))}makeTranslation(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),i=Math.sin(t),s=1-n,o=e.x,a=e.y,l=e.z,h=s*o,u=s*a;return this.set(h*o+n,h*a-i*l,h*l+i*a,0,h*a+i*l,u*a+n,u*l-i*o,0,h*l-i*a,u*l+i*o,s*l*l+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,i,s,o){return this.set(1,n,s,0,e,1,o,0,t,i,1,0,0,0,0,1),this}compose(e,t,n){const i=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,h=s+s,u=o+o,c=a+a,f=s*h,d=s*u,p=s*c,m=o*u,y=o*c,g=a*c,v=l*h,x=l*u,w=l*c,b=n.x,M=n.y,A=n.z;return i[0]=(1-(m+g))*b,i[1]=(d+w)*b,i[2]=(p-x)*b,i[3]=0,i[4]=(d-w)*M,i[5]=(1-(f+g))*M,i[6]=(y+v)*M,i[7]=0,i[8]=(p+x)*A,i[9]=(y-v)*A,i[10]=(1-(f+m))*A,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,n){const i=this.elements;let s=da.set(i[0],i[1],i[2]).length();const o=da.set(i[4],i[5],i[6]).length(),a=da.set(i[8],i[9],i[10]).length();this.determinant()<0&&(s=-s),e.x=i[12],e.y=i[13],e.z=i[14],Or.copy(this);const h=1/s,u=1/o,c=1/a;return Or.elements[0]*=h,Or.elements[1]*=h,Or.elements[2]*=h,Or.elements[4]*=u,Or.elements[5]*=u,Or.elements[6]*=u,Or.elements[8]*=c,Or.elements[9]*=c,Or.elements[10]*=c,t.setFromRotationMatrix(Or),n.x=s,n.y=o,n.z=a,this}makePerspective(e,t,n,i,s,o){o===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const a=this.elements,l=2*s/(t-e),h=2*s/(n-i),u=(t+e)/(t-e),c=(n+i)/(n-i),f=-(o+s)/(o-s),d=-2*o*s/(o-s);return a[0]=l,a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=h,a[9]=c,a[13]=0,a[2]=0,a[6]=0,a[10]=f,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,n,i,s,o){const a=this.elements,l=1/(t-e),h=1/(n-i),u=1/(o-s),c=(t+e)*l,f=(n+i)*h,d=(o+s)*u;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-c,a[1]=0,a[5]=2*h,a[9]=0,a[13]=-f,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<16;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}Ye.prototype.isMatrix4=!0;const da=new X,Or=new Ye,DT=new X(0,0,0),FT=new X(1,1,1),ds=new X,Uu=new X,xr=new X,vx=new Ye,yx=new Sn;class lo{constructor(e=0,t=0,n=0,i=lo.DefaultOrder){this._x=e,this._y=t,this._z=n,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,i=this._order){return this._x=e,this._y=t,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const i=e.elements,s=i[0],o=i[4],a=i[8],l=i[1],h=i[5],u=i[9],c=i[2],f=i[6],d=i[10];switch(t){case"XYZ":this._y=Math.asin(In(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-u,d),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(f,h),this._z=0);break;case"YXZ":this._x=Math.asin(-In(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(a,d),this._z=Math.atan2(l,h)):(this._y=Math.atan2(-c,s),this._z=0);break;case"ZXY":this._x=Math.asin(In(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-c,d),this._z=Math.atan2(-o,h)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-In(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(f,d),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,h));break;case"YZX":this._z=Math.asin(In(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,h),this._y=Math.atan2(-c,s)):(this._x=0,this._y=Math.atan2(a,d));break;case"XZY":this._z=Math.asin(-In(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(f,h),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-u,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return vx.makeRotationFromQuaternion(e),this.setFromRotationMatrix(vx,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return yx.setFromEuler(this),this.setFromQuaternion(yx,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}toVector3(e){return e?e.set(this._x,this._y,this._z):new X(this._x,this._y,this._z)}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}lo.prototype.isEuler=!0;lo.DefaultOrder="XYZ";lo.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class Hu{constructor(){this.mask=1|0}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=4294967295|0}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!=0}isEnabled(e){return(this.mask&(1<<e|0))!=0}}let OT=0;const xx=new X,pa=new Sn,Bi=new Ye,Gu=new X,Gl=new X,zT=new X,UT=new Sn,wx=new X(1,0,0),bx=new X(0,1,0),Mx=new X(0,0,1),HT={type:"added"},Ax={type:"removed"};class dt extends ri{constructor(){super();Object.defineProperty(this,"id",{value:OT++}),this.uuid=vr(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=dt.DefaultUp.clone();const e=new X,t=new lo,n=new Sn,i=new X(1,1,1);function s(){n.setFromEuler(t,!1)}function o(){t.setFromQuaternion(n,void 0,!1)}t._onChange(s),n._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Ye},normalMatrix:{value:new yn}}),this.matrix=new Ye,this.matrixWorld=new Ye,this.matrixAutoUpdate=dt.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Hu,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return pa.setFromAxisAngle(e,t),this.quaternion.multiply(pa),this}rotateOnWorldAxis(e,t){return pa.setFromAxisAngle(e,t),this.quaternion.premultiply(pa),this}rotateX(e){return this.rotateOnAxis(wx,e)}rotateY(e){return this.rotateOnAxis(bx,e)}rotateZ(e){return this.rotateOnAxis(Mx,e)}translateOnAxis(e,t){return xx.copy(e).applyQuaternion(this.quaternion),this.position.add(xx.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(wx,e)}translateY(e){return this.translateOnAxis(bx,e)}translateZ(e){return this.translateOnAxis(Mx,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(Bi.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?Gu.copy(e):Gu.set(e,t,n);const i=this.parent;this.updateWorldMatrix(!0,!1),Gl.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Bi.lookAt(Gl,Gu,this.up):Bi.lookAt(Gu,Gl,this.up),this.quaternion.setFromRotationMatrix(Bi),i&&(Bi.extractRotation(i.matrixWorld),pa.setFromRotationMatrix(Bi),this.quaternion.premultiply(pa.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(HT)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Ax)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(Ax)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),Bi.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Bi.multiply(e.parent.matrixWorld)),e.applyMatrix4(Bi),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,i=this.children.length;n<i;n++){const o=this.children[n].getObjectByProperty(e,t);if(o!==void 0)return o}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Gl,e,zT),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Gl,UT,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const i=this.children;for(let s=0,o=i.length;s<o;s++)i[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON()));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let h=0,u=l.length;h<u;h++){const c=l[h];s(e.shapes,c)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,h=this.material.length;l<h;l++)a.push(s(e.materials,this.material[l]));i.material=a}else i.material=s(e.materials,this.material);if(this.children.length>0){i.children=[];for(let a=0;a<this.children.length;a++)i.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];i.animations.push(s(e.animations,l))}}if(t){const a=o(e.geometries),l=o(e.materials),h=o(e.textures),u=o(e.images),c=o(e.shapes),f=o(e.skeletons),d=o(e.animations);a.length>0&&(n.geometries=a),l.length>0&&(n.materials=l),h.length>0&&(n.textures=h),u.length>0&&(n.images=u),c.length>0&&(n.shapes=c),f.length>0&&(n.skeletons=f),d.length>0&&(n.animations=d)}return n.object=i,n;function o(a){const l=[];for(const h in a){const u=a[h];delete u.metadata,l.push(u)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const i=e.children[n];this.add(i.clone())}return this}}dt.DefaultUp=new X(0,1,0);dt.DefaultMatrixAutoUpdate=!0;dt.prototype.isObject3D=!0;const zr=new X,Li=new X,Tp=new X,Di=new X,ma=new X,ga=new X,Sx=new X,Cp=new X,Rp=new X,Np=new X;class jt{constructor(e=new X,t=new X,n=new X){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,i){i.subVectors(n,t),zr.subVectors(e,t),i.cross(zr);const s=i.lengthSq();return s>0?i.multiplyScalar(1/Math.sqrt(s)):i.set(0,0,0)}static getBarycoord(e,t,n,i,s){zr.subVectors(i,t),Li.subVectors(n,t),Tp.subVectors(e,t);const o=zr.dot(zr),a=zr.dot(Li),l=zr.dot(Tp),h=Li.dot(Li),u=Li.dot(Tp),c=o*h-a*a;if(c===0)return s.set(-2,-1,-1);const f=1/c,d=(h*l-a*u)*f,p=(o*u-a*l)*f;return s.set(1-d-p,p,d)}static containsPoint(e,t,n,i){return this.getBarycoord(e,t,n,i,Di),Di.x>=0&&Di.y>=0&&Di.x+Di.y<=1}static getUV(e,t,n,i,s,o,a,l){return this.getBarycoord(e,t,n,i,Di),l.set(0,0),l.addScaledVector(s,Di.x),l.addScaledVector(o,Di.y),l.addScaledVector(a,Di.z),l}static isFrontFacing(e,t,n,i){return zr.subVectors(n,t),Li.subVectors(e,t),zr.cross(Li).dot(i)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,n,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return zr.subVectors(this.c,this.b),Li.subVectors(this.a,this.b),zr.cross(Li).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return jt.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return jt.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,i,s){return jt.getUV(e,this.a,this.b,this.c,t,n,i,s)}containsPoint(e){return jt.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return jt.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,i=this.b,s=this.c;let o,a;ma.subVectors(i,n),ga.subVectors(s,n),Cp.subVectors(e,n);const l=ma.dot(Cp),h=ga.dot(Cp);if(l<=0&&h<=0)return t.copy(n);Rp.subVectors(e,i);const u=ma.dot(Rp),c=ga.dot(Rp);if(u>=0&&c<=u)return t.copy(i);const f=l*c-u*h;if(f<=0&&l>=0&&u<=0)return o=l/(l-u),t.copy(n).addScaledVector(ma,o);Np.subVectors(e,s);const d=ma.dot(Np),p=ga.dot(Np);if(p>=0&&d<=p)return t.copy(s);const m=d*h-l*p;if(m<=0&&h>=0&&p<=0)return a=h/(h-p),t.copy(n).addScaledVector(ga,a);const y=u*p-d*c;if(y<=0&&c-u>=0&&d-p>=0)return Sx.subVectors(s,i),a=(c-u)/(c-u+(d-p)),t.copy(i).addScaledVector(Sx,a);const g=1/(y+m+f);return o=m*g,a=f*g,t.copy(n).addScaledVector(ma,o).addScaledVector(ga,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let GT=0;class an extends ri{constructor(){super();Object.defineProperty(this,"id",{value:GT++}),this.uuid=vr(),this.name="",this.type="Material",this.fog=!0,this.blending=$o,this.side=Ti,this.vertexColors=!1,this.opacity=1,this.format=Lt,this.transparent=!1,this.blendSrc=rp,this.blendDst=ip,this.blendEquation=Ks,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=xu,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=ux,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Nu,this.stencilZFail=Nu,this.stencilZPass=Nu,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if(t==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===Jd;continue}const i=this[t];if(i===void 0){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==$o&&(n.blending=this.blending),this.side!==Ti&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.format!==Lt&&(n.format=this.format),this.transparent===!0&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(n.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=this.flatShading),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(n.userData=this.userData);function i(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(t){const s=i(e.textures),o=i(e.images);s.length>0&&(n.textures=s),o.length>0&&(n.images=o)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.format=e.format,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const i=t.length;n=new Array(i);for(let s=0;s!==i;++s)n[s]=t[s].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}an.prototype.isMaterial=!0;const Ex={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ur={h:0,s:0,l:0},ku={h:0,s:0,l:0};function Ip(r,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?r+(e-r)*6*t:t<1/2?e:t<2/3?r+(e-r)*6*(2/3-t):r}function Pp(r){return r<.04045?r*.0773993808:Math.pow(r*.9478672986+.0521327014,2.4)}function Bp(r){return r<.0031308?r*12.92:1.055*Math.pow(r,.41666)-.055}class He{constructor(e,t,n){return t===void 0&&n===void 0?this.set(e):this.setRGB(e,t,n)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,this}setRGB(e,t,n){return this.r=e,this.g=t,this.b=n,this}setHSL(e,t,n){if(e=vp(e,1),t=In(t,0,1),n=In(n,0,1),t===0)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+t):n+t-n*t,s=2*n-i;this.r=Ip(s,i,e+1/3),this.g=Ip(s,i,e),this.b=Ip(s,i,e-1/3)}return this}setStyle(e){function t(i){i!==void 0&&parseFloat(i)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let i;const s=n[1],o=n[2];switch(s){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(i[1],10))/255,this.g=Math.min(255,parseInt(i[2],10))/255,this.b=Math.min(255,parseInt(i[3],10))/255,t(i[4]),this;if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(i[1],10))/100,this.g=Math.min(100,parseInt(i[2],10))/100,this.b=Math.min(100,parseInt(i[3],10))/100,t(i[4]),this;break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o)){const a=parseFloat(i[1])/360,l=parseInt(i[2],10)/100,h=parseInt(i[3],10)/100;return t(i[4]),this.setHSL(a,l,h)}break}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){const i=n[1],s=i.length;if(s===3)return this.r=parseInt(i.charAt(0)+i.charAt(0),16)/255,this.g=parseInt(i.charAt(1)+i.charAt(1),16)/255,this.b=parseInt(i.charAt(2)+i.charAt(2),16)/255,this;if(s===6)return this.r=parseInt(i.charAt(0)+i.charAt(1),16)/255,this.g=parseInt(i.charAt(2)+i.charAt(3),16)/255,this.b=parseInt(i.charAt(4)+i.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this}setColorName(e){const t=Ex[e.toLowerCase()];return t!==void 0?this.setHex(t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Pp(e.r),this.g=Pp(e.g),this.b=Pp(e.b),this}copyLinearToSRGB(e){return this.r=Bp(e.r),this.g=Bp(e.g),this.b=Bp(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return this.r*255<<16^this.g*255<<8^this.b*255<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(e){const t=this.r,n=this.g,i=this.b,s=Math.max(t,n,i),o=Math.min(t,n,i);let a,l;const h=(o+s)/2;if(o===s)a=0,l=0;else{const u=s-o;switch(l=h<=.5?u/(s+o):u/(2-s-o),s){case t:a=(n-i)/u+(n<i?6:0);break;case n:a=(i-t)/u+2;break;case i:a=(t-n)/u+4;break}a/=6}return e.h=a,e.s=l,e.l=h,e}getStyle(){return"rgb("+(this.r*255|0)+","+(this.g*255|0)+","+(this.b*255|0)+")"}offsetHSL(e,t,n){return this.getHSL(Ur),Ur.h+=e,Ur.s+=t,Ur.l+=n,this.setHSL(Ur.h,Ur.s,Ur.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(Ur),e.getHSL(ku);const n=zl(Ur.h,ku.h,t),i=zl(Ur.s,ku.s,t),s=zl(Ur.l,ku.l,t);return this.setHSL(n,i,s),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),e.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}He.NAMES=Ex;He.prototype.isColor=!0;He.prototype.r=1;He.prototype.g=1;He.prototype.b=1;class ir extends an{constructor(e){super();this.type="MeshBasicMaterial",this.color=new He(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Cl,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}ir.prototype.isMeshBasicMaterial=!0;const Ht=new X,Vu=new Ae;class ut{constructor(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n===!0,this.usage=sa,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let i=0,s=this.itemSize;i<s;i++)this.array[e+i]=t.array[n+i];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const t=this.array;let n=0;for(let i=0,s=e.length;i<s;i++){let o=e[i];o===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),o=new He),t[n++]=o.r,t[n++]=o.g,t[n++]=o.b}return this}copyVector2sArray(e){const t=this.array;let n=0;for(let i=0,s=e.length;i<s;i++){let o=e[i];o===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),o=new Ae),t[n++]=o.x,t[n++]=o.y}return this}copyVector3sArray(e){const t=this.array;let n=0;for(let i=0,s=e.length;i<s;i++){let o=e[i];o===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),o=new X),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z}return this}copyVector4sArray(e){const t=this.array;let n=0;for(let i=0,s=e.length;i<s;i++){let o=e[i];o===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),o=new At),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z,t[n++]=o.w}return this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)Vu.fromBufferAttribute(this,t),Vu.applyMatrix3(e),this.setXY(t,Vu.x,Vu.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)Ht.fromBufferAttribute(this,t),Ht.applyMatrix3(e),this.setXYZ(t,Ht.x,Ht.y,Ht.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)Ht.x=this.getX(t),Ht.y=this.getY(t),Ht.z=this.getZ(t),Ht.applyMatrix4(e),this.setXYZ(t,Ht.x,Ht.y,Ht.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Ht.x=this.getX(t),Ht.y=this.getY(t),Ht.z=this.getZ(t),Ht.applyNormalMatrix(e),this.setXYZ(t,Ht.x,Ht.y,Ht.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Ht.x=this.getX(t),Ht.y=this.getY(t),Ht.z=this.getZ(t),Ht.transformDirection(e),this.setXYZ(t,Ht.x,Ht.y,Ht.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){return this.array[e*this.itemSize]}setX(e,t){return this.array[e*this.itemSize]=t,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,t){return this.array[e*this.itemSize+1]=t,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,t){return this.array[e*this.itemSize+2]=t,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,t){return this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this}setXYZW(e,t,n,i,s){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==sa&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}}ut.prototype.isBufferAttribute=!0;class _x extends ut{constructor(e,t,n){super(new Int8Array(e),t,n)}}class Tx extends ut{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class Cx extends ut{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class Rx extends ut{constructor(e,t,n){super(new Int16Array(e),t,n)}}class Wu extends ut{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class Nx extends ut{constructor(e,t,n){super(new Int32Array(e),t,n)}}class qu extends ut{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class Ix extends ut{constructor(e,t,n){super(new Uint16Array(e),t,n)}}Ix.prototype.isFloat16BufferAttribute=!0;class je extends ut{constructor(e,t,n){super(new Float32Array(e),t,n)}}class Px extends ut{constructor(e,t,n){super(new Float64Array(e),t,n)}}let kT=0;const _r=new Ye,Lp=new dt,va=new X,wr=new Rt,kl=new Rt,En=new X;class rt extends ri{constructor(){super();Object.defineProperty(this,"id",{value:kT++}),this.uuid=vr(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(dx(e)>65535?qu:Wu)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const s=new yn().getNormalMatrix(e);n.applyNormalMatrix(s),n.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return _r.makeRotationFromQuaternion(e),this.applyMatrix4(_r),this}rotateX(e){return _r.makeRotationX(e),this.applyMatrix4(_r),this}rotateY(e){return _r.makeRotationY(e),this.applyMatrix4(_r),this}rotateZ(e){return _r.makeRotationZ(e),this.applyMatrix4(_r),this}translate(e,t,n){return _r.makeTranslation(e,t,n),this.applyMatrix4(_r),this}scale(e,t,n){return _r.makeScale(e,t,n),this.applyMatrix4(_r),this}lookAt(e){return Lp.lookAt(e),Lp.updateMatrix(),this.applyMatrix4(Lp.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(va).negate(),this.translate(va.x,va.y,va.z),this}setFromPoints(e){const t=[];for(let n=0,i=e.length;n<i;n++){const s=e[n];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new je(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Rt);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new X(-1/0,-1/0,-1/0),new X(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,i=t.length;n<i;n++){const s=t[n];wr.setFromBufferAttribute(s),this.morphTargetsRelative?(En.addVectors(this.boundingBox.min,wr.min),this.boundingBox.expandByPoint(En),En.addVectors(this.boundingBox.max,wr.max),this.boundingBox.expandByPoint(En)):(this.boundingBox.expandByPoint(wr.min),this.boundingBox.expandByPoint(wr.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new yr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new X,1/0);return}if(e){const n=this.boundingSphere.center;if(wr.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){const a=t[s];kl.setFromBufferAttribute(a),this.morphTargetsRelative?(En.addVectors(wr.min,kl.min),wr.expandByPoint(En),En.addVectors(wr.max,kl.max),wr.expandByPoint(En)):(wr.expandByPoint(kl.min),wr.expandByPoint(kl.max))}wr.getCenter(n);let i=0;for(let s=0,o=e.count;s<o;s++)En.fromBufferAttribute(e,s),i=Math.max(i,n.distanceToSquared(En));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let h=0,u=a.count;h<u;h++)En.fromBufferAttribute(a,h),l&&(va.fromBufferAttribute(e,h),En.add(va)),i=Math.max(i,n.distanceToSquared(En))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=e.array,i=t.position.array,s=t.normal.array,o=t.uv.array,a=i.length/3;t.tangent===void 0&&this.setAttribute("tangent",new ut(new Float32Array(4*a),4));const l=t.tangent.array,h=[],u=[];for(let R=0;R<a;R++)h[R]=new X,u[R]=new X;const c=new X,f=new X,d=new X,p=new Ae,m=new Ae,y=new Ae,g=new X,v=new X;function x(R,_,S){c.fromArray(i,R*3),f.fromArray(i,_*3),d.fromArray(i,S*3),p.fromArray(o,R*2),m.fromArray(o,_*2),y.fromArray(o,S*2),f.sub(c),d.sub(c),m.sub(p),y.sub(p);const L=1/(m.x*y.y-y.x*m.y);!isFinite(L)||(g.copy(f).multiplyScalar(y.y).addScaledVector(d,-m.y).multiplyScalar(L),v.copy(d).multiplyScalar(m.x).addScaledVector(f,-y.x).multiplyScalar(L),h[R].add(g),h[_].add(g),h[S].add(g),u[R].add(v),u[_].add(v),u[S].add(v))}let w=this.groups;w.length===0&&(w=[{start:0,count:n.length}]);for(let R=0,_=w.length;R<_;++R){const S=w[R],L=S.start,k=S.count;for(let H=L,O=L+k;H<O;H+=3)x(n[H+0],n[H+1],n[H+2])}const b=new X,M=new X,A=new X,E=new X;function N(R){A.fromArray(s,R*3),E.copy(A);const _=h[R];b.copy(_),b.sub(A.multiplyScalar(A.dot(_))).normalize(),M.crossVectors(E,_);const L=M.dot(u[R])<0?-1:1;l[R*4]=b.x,l[R*4+1]=b.y,l[R*4+2]=b.z,l[R*4+3]=L}for(let R=0,_=w.length;R<_;++R){const S=w[R],L=S.start,k=S.count;for(let H=L,O=L+k;H<O;H+=3)N(n[H+0]),N(n[H+1]),N(n[H+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new ut(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let f=0,d=n.count;f<d;f++)n.setXYZ(f,0,0,0);const i=new X,s=new X,o=new X,a=new X,l=new X,h=new X,u=new X,c=new X;if(e)for(let f=0,d=e.count;f<d;f+=3){const p=e.getX(f+0),m=e.getX(f+1),y=e.getX(f+2);i.fromBufferAttribute(t,p),s.fromBufferAttribute(t,m),o.fromBufferAttribute(t,y),u.subVectors(o,s),c.subVectors(i,s),u.cross(c),a.fromBufferAttribute(n,p),l.fromBufferAttribute(n,m),h.fromBufferAttribute(n,y),a.add(u),l.add(u),h.add(u),n.setXYZ(p,a.x,a.y,a.z),n.setXYZ(m,l.x,l.y,l.z),n.setXYZ(y,h.x,h.y,h.z)}else for(let f=0,d=t.count;f<d;f+=3)i.fromBufferAttribute(t,f+0),s.fromBufferAttribute(t,f+1),o.fromBufferAttribute(t,f+2),u.subVectors(o,s),c.subVectors(i,s),u.cross(c),n.setXYZ(f+0,u.x,u.y,u.z),n.setXYZ(f+1,u.x,u.y,u.z),n.setXYZ(f+2,u.x,u.y,u.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(e,t){if(!(e&&e.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);return}t===void 0&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const i in n){if(e.attributes[i]===void 0)continue;const o=n[i].array,a=e.attributes[i],l=a.array,h=a.itemSize*t,u=Math.min(l.length,o.length-h);for(let c=0,f=h;c<u;c++,f++)o[f]=l[c]}return this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)En.fromBufferAttribute(e,t),En.normalize(),e.setXYZ(t,En.x,En.y,En.z)}toNonIndexed(){function e(a,l){const h=a.array,u=a.itemSize,c=a.normalized,f=new h.constructor(l.length*u);let d=0,p=0;for(let m=0,y=l.length;m<y;m++){a.isInterleavedBufferAttribute?d=l[m]*a.data.stride+a.offset:d=l[m]*u;for(let g=0;g<u;g++)f[p++]=h[d++]}return new ut(f,u,c)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new rt,n=this.index.array,i=this.attributes;for(const a in i){const l=i[a],h=e(l,n);t.setAttribute(a,h)}const s=this.morphAttributes;for(const a in s){const l=[],h=s[a];for(let u=0,c=h.length;u<c;u++){const f=h[u],d=e(f,n);l.push(d)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const h=o[a];t.addGroup(h.start,h.count,h.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const h in l)l[h]!==void 0&&(e[h]=l[h]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const l in n){const h=n[l];e.data.attributes[l]=h.toJSON(e.data)}const i={};let s=!1;for(const l in this.morphAttributes){const h=this.morphAttributes[l],u=[];for(let c=0,f=h.length;c<f;c++){const d=h[c];u.push(d.toJSON(e.data))}u.length>0&&(i[l]=u,s=!0)}s&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone(t));const i=e.attributes;for(const h in i){const u=i[h];this.setAttribute(h,u.clone(t))}const s=e.morphAttributes;for(const h in s){const u=[],c=s[h];for(let f=0,d=c.length;f<d;f++)u.push(c[f].clone(t));this.morphAttributes[h]=u}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let h=0,u=o.length;h<u;h++){const c=o[h];this.addGroup(c.start,c.count,c.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,e.parameters!==void 0&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}rt.prototype.isBufferGeometry=!0;const Bx=new Ye,ya=new Pi,Dp=new yr,ps=new X,ms=new X,gs=new X,Fp=new X,Op=new X,zp=new X,Yu=new X,Xu=new X,Qu=new X,ju=new Ae,Zu=new Ae,Ju=new Ae,Up=new X,Ku=new X;class Gt extends dt{constructor(e=new rt,t=new ir){super();this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=i.length;s<o;s++){const a=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}else{const t=e.morphTargets;t!==void 0&&t.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(e,t){const n=this.geometry,i=this.material,s=this.matrixWorld;if(i===void 0||(n.boundingSphere===null&&n.computeBoundingSphere(),Dp.copy(n.boundingSphere),Dp.applyMatrix4(s),e.ray.intersectsSphere(Dp)===!1)||(Bx.copy(s).invert(),ya.copy(e.ray).applyMatrix4(Bx),n.boundingBox!==null&&ya.intersectsBox(n.boundingBox)===!1))return;let o;if(n.isBufferGeometry){const a=n.index,l=n.attributes.position,h=n.morphAttributes.position,u=n.morphTargetsRelative,c=n.attributes.uv,f=n.attributes.uv2,d=n.groups,p=n.drawRange;if(a!==null)if(Array.isArray(i))for(let m=0,y=d.length;m<y;m++){const g=d[m],v=i[g.materialIndex],x=Math.max(g.start,p.start),w=Math.min(a.count,Math.min(g.start+g.count,p.start+p.count));for(let b=x,M=w;b<M;b+=3){const A=a.getX(b),E=a.getX(b+1),N=a.getX(b+2);o=$u(this,v,e,ya,l,h,u,c,f,A,E,N),o&&(o.faceIndex=Math.floor(b/3),o.face.materialIndex=g.materialIndex,t.push(o))}}else{const m=Math.max(0,p.start),y=Math.min(a.count,p.start+p.count);for(let g=m,v=y;g<v;g+=3){const x=a.getX(g),w=a.getX(g+1),b=a.getX(g+2);o=$u(this,i,e,ya,l,h,u,c,f,x,w,b),o&&(o.faceIndex=Math.floor(g/3),t.push(o))}}else if(l!==void 0)if(Array.isArray(i))for(let m=0,y=d.length;m<y;m++){const g=d[m],v=i[g.materialIndex],x=Math.max(g.start,p.start),w=Math.min(l.count,Math.min(g.start+g.count,p.start+p.count));for(let b=x,M=w;b<M;b+=3){const A=b,E=b+1,N=b+2;o=$u(this,v,e,ya,l,h,u,c,f,A,E,N),o&&(o.faceIndex=Math.floor(b/3),o.face.materialIndex=g.materialIndex,t.push(o))}}else{const m=Math.max(0,p.start),y=Math.min(l.count,p.start+p.count);for(let g=m,v=y;g<v;g+=3){const x=g,w=g+1,b=g+2;o=$u(this,i,e,ya,l,h,u,c,f,x,w,b),o&&(o.faceIndex=Math.floor(g/3),t.push(o))}}}else n.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}Gt.prototype.isMesh=!0;function VT(r,e,t,n,i,s,o,a){let l;if(e.side===zt?l=n.intersectTriangle(o,s,i,!0,a):l=n.intersectTriangle(i,s,o,e.side!==mr,a),l===null)return null;Ku.copy(a),Ku.applyMatrix4(r.matrixWorld);const h=t.ray.origin.distanceTo(Ku);return h<t.near||h>t.far?null:{distance:h,point:Ku.clone(),object:r}}function $u(r,e,t,n,i,s,o,a,l,h,u,c){ps.fromBufferAttribute(i,h),ms.fromBufferAttribute(i,u),gs.fromBufferAttribute(i,c);const f=r.morphTargetInfluences;if(s&&f){Yu.set(0,0,0),Xu.set(0,0,0),Qu.set(0,0,0);for(let p=0,m=s.length;p<m;p++){const y=f[p],g=s[p];y!==0&&(Fp.fromBufferAttribute(g,h),Op.fromBufferAttribute(g,u),zp.fromBufferAttribute(g,c),o?(Yu.addScaledVector(Fp,y),Xu.addScaledVector(Op,y),Qu.addScaledVector(zp,y)):(Yu.addScaledVector(Fp.sub(ps),y),Xu.addScaledVector(Op.sub(ms),y),Qu.addScaledVector(zp.sub(gs),y)))}ps.add(Yu),ms.add(Xu),gs.add(Qu)}r.isSkinnedMesh&&(r.boneTransform(h,ps),r.boneTransform(u,ms),r.boneTransform(c,gs));const d=VT(r,e,t,n,ps,ms,gs,Up);if(d){a&&(ju.fromBufferAttribute(a,h),Zu.fromBufferAttribute(a,u),Ju.fromBufferAttribute(a,c),d.uv=jt.getUV(Up,ps,ms,gs,ju,Zu,Ju,new Ae)),l&&(ju.fromBufferAttribute(l,h),Zu.fromBufferAttribute(l,u),Ju.fromBufferAttribute(l,c),d.uv2=jt.getUV(Up,ps,ms,gs,ju,Zu,Ju,new Ae));const p={a:h,b:u,c,normal:new X,materialIndex:0};jt.getNormal(ps,ms,gs,p.normal),d.face=p}return d}class Fi extends rt{constructor(e=1,t=1,n=1,i=1,s=1,o=1){super();this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:s,depthSegments:o};const a=this;i=Math.floor(i),s=Math.floor(s),o=Math.floor(o);const l=[],h=[],u=[],c=[];let f=0,d=0;p("z","y","x",-1,-1,n,t,e,o,s,0),p("z","y","x",1,-1,n,t,-e,o,s,1),p("x","z","y",1,1,e,n,t,i,o,2),p("x","z","y",1,-1,e,n,-t,i,o,3),p("x","y","z",1,-1,e,t,n,i,s,4),p("x","y","z",-1,-1,e,t,-n,i,s,5),this.setIndex(l),this.setAttribute("position",new je(h,3)),this.setAttribute("normal",new je(u,3)),this.setAttribute("uv",new je(c,2));function p(m,y,g,v,x,w,b,M,A,E,N){const R=w/A,_=b/E,S=w/2,L=b/2,k=M/2,H=A+1,O=E+1;let T=0,V=0;const F=new X;for(let J=0;J<O;J++){const Y=J*_-L;for(let te=0;te<H;te++){const z=te*R-S;F[m]=z*v,F[y]=Y*x,F[g]=k,h.push(F.x,F.y,F.z),F[m]=0,F[y]=0,F[g]=M>0?1:-1,u.push(F.x,F.y,F.z),c.push(te/A),c.push(1-J/E),T+=1}}for(let J=0;J<E;J++)for(let Y=0;Y<A;Y++){const te=f+Y+H*J,z=f+Y+H*(J+1),K=f+(Y+1)+H*(J+1),Z=f+(Y+1)+H*J;l.push(te,z,Z),l.push(z,K,Z),V+=6}a.addGroup(d,V,N),d+=V,f+=T}}static fromJSON(e){return new Fi(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function xa(r){const e={};for(const t in r){e[t]={};for(const n in r[t]){const i=r[t][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?e[t][n]=i.clone():Array.isArray(i)?e[t][n]=i.slice():e[t][n]=i}}return e}function Hn(r){const e={};for(let t=0;t<r.length;t++){const n=xa(r[t]);for(const i in n)e[i]=n[i]}return e}const eh={clone:xa,merge:Hn};var WT=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,qT=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Pn extends an{constructor(e){super();this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=WT,this.fragmentShader=qT,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&(e.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=xa(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const o=this.uniforms[i].value;o&&o.isTexture?t.uniforms[i]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[i]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[i]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[i]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[i]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[i]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[i]={type:"m4",value:o.toArray()}:t.uniforms[i]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const n={};for(const i in this.extensions)this.extensions[i]===!0&&(n[i]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}Pn.prototype.isShaderMaterial=!0;class wa extends dt{constructor(){super();this.type="Camera",this.matrixWorldInverse=new Ye,this.projectionMatrix=new Ye,this.projectionMatrixInverse=new Ye}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}wa.prototype.isCamera=!0;class ln extends wa{constructor(e=50,t=1,n=.1,i=2e3){super();this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=Ol*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(io*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Ol*2*Math.atan(Math.tan(io*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,n,i,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(io*.5*this.fov)/this.zoom,n=2*t,i=this.aspect*n,s=-.5*i;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,h=o.fullHeight;s+=o.offsetX*i/l,t-=o.offsetY*n/h,i*=o.width/l,n*=o.height/h}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+i,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}ln.prototype.isPerspectiveCamera=!0;const ba=90,Ma=1;class th extends dt{constructor(e,t,n){super();if(this.type="CubeCamera",n.isWebGLCubeRenderTarget!==!0){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=n;const i=new ln(ba,Ma,e,t);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new X(1,0,0)),this.add(i);const s=new ln(ba,Ma,e,t);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new X(-1,0,0)),this.add(s);const o=new ln(ba,Ma,e,t);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(new X(0,1,0)),this.add(o);const a=new ln(ba,Ma,e,t);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new X(0,-1,0)),this.add(a);const l=new ln(ba,Ma,e,t);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new X(0,0,1)),this.add(l);const h=new ln(ba,Ma,e,t);h.layers=this.layers,h.up.set(0,-1,0),h.lookAt(new X(0,0,-1)),this.add(h)}update(e,t){this.parent===null&&this.updateMatrixWorld();const n=this.renderTarget,[i,s,o,a,l,h]=this.children,u=e.xr.enabled,c=e.getRenderTarget();e.xr.enabled=!1;const f=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,i),e.setRenderTarget(n,1),e.render(t,s),e.setRenderTarget(n,2),e.render(t,o),e.setRenderTarget(n,3),e.render(t,a),e.setRenderTarget(n,4),e.render(t,l),n.texture.generateMipmaps=f,e.setRenderTarget(n,5),e.render(t,h),e.setRenderTarget(c),e.xr.enabled=u}}class Aa extends Qt{constructor(e,t,n,i,s,o,a,l,h,u){e=e!==void 0?e:[],t=t!==void 0?t:$s;super(e,t,n,i,s,o,a,l,h,u);this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}Aa.prototype.isCubeTexture=!0;class nh extends mn{constructor(e,t,n){Number.isInteger(t)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),t=n);super(e,e,t);t=t||{},this.texture=new Aa(void 0,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:ft,this.texture._needsFlipEnvMap=!1}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.format=Lt,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new Fi(5,5,5),s=new Pn({name:"CubemapFromEquirect",uniforms:xa(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:zt,blending:Un});s.uniforms.tEquirect.value=t;const o=new Gt(i,s),a=t.minFilter;return t.minFilter===ti&&(t.minFilter=ft),new th(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,n,i){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,n,i);e.setRenderTarget(s)}}nh.prototype.isWebGLCubeRenderTarget=!0;const Hp=new X,YT=new X,XT=new yn;class Hr{constructor(e=new X(1,0,0),t=0){this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const i=Hp.subVectors(n,t).cross(YT.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const n=e.delta(Hp),i=this.normal.dot(n);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/i;return s<0||s>1?null:t.copy(n).multiplyScalar(s).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||XT.getNormalMatrix(e),i=this.coplanarPoint(Hp).applyMatrix4(e),s=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}Hr.prototype.isPlane=!0;const Sa=new yr,rh=new X;class Vl{constructor(e=new Hr,t=new Hr,n=new Hr,i=new Hr,s=new Hr,o=new Hr){this.planes=[e,t,n,i,s,o]}set(e,t,n,i,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(i),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){const t=this.planes,n=e.elements,i=n[0],s=n[1],o=n[2],a=n[3],l=n[4],h=n[5],u=n[6],c=n[7],f=n[8],d=n[9],p=n[10],m=n[11],y=n[12],g=n[13],v=n[14],x=n[15];return t[0].setComponents(a-i,c-l,m-f,x-y).normalize(),t[1].setComponents(a+i,c+l,m+f,x+y).normalize(),t[2].setComponents(a+s,c+h,m+d,x+g).normalize(),t[3].setComponents(a-s,c-h,m-d,x-g).normalize(),t[4].setComponents(a-o,c-u,m-p,x-v).normalize(),t[5].setComponents(a+o,c+u,m+p,x+v).normalize(),this}intersectsObject(e){const t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),Sa.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Sa)}intersectsSprite(e){return Sa.center.set(0,0,0),Sa.radius=.7071067811865476,Sa.applyMatrix4(e.matrixWorld),this.intersectsSphere(Sa)}intersectsSphere(e){const t=this.planes,n=e.center,i=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(n)<i)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const i=t[n];if(rh.x=i.normal.x>0?e.max.x:e.min.x,rh.y=i.normal.y>0?e.max.y:e.min.y,rh.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(rh)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function Lx(){let r=null,e=!1,t=null,n=null;function i(s,o){t(s,o),n=r.requestAnimationFrame(i)}return{start:function(){e!==!0&&t!==null&&(n=r.requestAnimationFrame(i),e=!0)},stop:function(){r.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){r=s}}}function QT(r,e){const t=e.isWebGL2,n=new WeakMap;function i(h,u){const c=h.array,f=h.usage,d=r.createBuffer();r.bindBuffer(u,d),r.bufferData(u,c,f),h.onUploadCallback();let p=5126;return c instanceof Float32Array?p=5126:c instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):c instanceof Uint16Array?h.isFloat16BufferAttribute?t?p=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):p=5123:c instanceof Int16Array?p=5122:c instanceof Uint32Array?p=5125:c instanceof Int32Array?p=5124:c instanceof Int8Array?p=5120:(c instanceof Uint8Array||c instanceof Uint8ClampedArray)&&(p=5121),{buffer:d,type:p,bytesPerElement:c.BYTES_PER_ELEMENT,version:h.version}}function s(h,u,c){const f=u.array,d=u.updateRange;r.bindBuffer(c,h),d.count===-1?r.bufferSubData(c,0,f):(t?r.bufferSubData(c,d.offset*f.BYTES_PER_ELEMENT,f,d.offset,d.count):r.bufferSubData(c,d.offset*f.BYTES_PER_ELEMENT,f.subarray(d.offset,d.offset+d.count)),d.count=-1)}function o(h){return h.isInterleavedBufferAttribute&&(h=h.data),n.get(h)}function a(h){h.isInterleavedBufferAttribute&&(h=h.data);const u=n.get(h);u&&(r.deleteBuffer(u.buffer),n.delete(h))}function l(h,u){if(h.isGLBufferAttribute){const f=n.get(h);(!f||f.version<h.version)&&n.set(h,{buffer:h.buffer,type:h.type,bytesPerElement:h.elementSize,version:h.version});return}h.isInterleavedBufferAttribute&&(h=h.data);const c=n.get(h);c===void 0?n.set(h,i(h,u)):c.version<h.version&&(s(c.buffer,h,u),c.version=h.version)}return{get:o,remove:a,update:l}}class co extends rt{constructor(e=1,t=1,n=1,i=1){super();this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i};const s=e/2,o=t/2,a=Math.floor(n),l=Math.floor(i),h=a+1,u=l+1,c=e/a,f=t/l,d=[],p=[],m=[],y=[];for(let g=0;g<u;g++){const v=g*f-o;for(let x=0;x<h;x++){const w=x*c-s;p.push(w,-v,0),m.push(0,0,1),y.push(x/a),y.push(1-g/l)}}for(let g=0;g<l;g++)for(let v=0;v<a;v++){const x=v+h*g,w=v+h*(g+1),b=v+1+h*(g+1),M=v+1+h*g;d.push(x,w,M),d.push(w,b,M)}this.setIndex(d),this.setAttribute("position",new je(p,3)),this.setAttribute("normal",new je(m,3)),this.setAttribute("uv",new je(y,2))}static fromJSON(e){return new co(e.width,e.height,e.widthSegments,e.heightSegments)}}var jT=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,ZT=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,JT=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,KT=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,$T=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,eC=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,tC="vec3 transformed = vec3( position );",nC=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,rC=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,iC=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,sC=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,oC=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,aC=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,lC=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,cC=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,uC=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,hC=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,fC=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,dC=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,pC=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_maxMipLevel 8.0
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_maxTileSize 256.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );
		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 ) + 0.5;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		if ( mipInt < cubeUV_maxMipLevel ) {
			uv.y += 2.0 * cubeUV_maxTileSize;
		}
		uv.y += filterInt * 2.0 * cubeUV_minTileSize;
		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );
		uv *= texelSize;
		return texture2D( envMap, uv ).rgb;
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,mC=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,gC=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,vC=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,yC=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,xC=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,wC="gl_FragColor = linearToOutputTexel( gl_FragColor );",bC=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,MC=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
		envColor = envMapTexelToLinear( envColor );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,AC=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,SC=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,EC=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,_C=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,TC=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,CC=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,RC=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,NC=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,IC=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,PC=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		lightMapIrradiance *= PI;
	#endif
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,BC=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,LC=`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointLightInfo( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotLightInfo( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
		#endif
	}
	#pragma unroll_loop_end
#endif`,DC=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,FC=`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec;
			#ifdef ENVMAP_MODE_REFLECTION
				reflectVec = reflect( - viewDir, normal );
				reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			#else
				reflectVec = refract( - viewDir, normal, refractionRatio );
			#endif
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,OC=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,zC=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,UC=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,HC=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,GC=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= specularColorMapTexelToLinear( texture2D( specularColorMap, vUv ) ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= sheenColorMapTexelToLinear( texture2D( sheenColorMap, vUv ) ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,kC=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	vec3 FssEss = specularColor * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,VC=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,WC=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,qC=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,YC=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,XC=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,QC=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,jC=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,ZC=`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,JC=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,KC=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,$C=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,e2=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,t2=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,n2=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] > 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1, 2 ) * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,r2=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform vec2 morphTargetsTextureSize;
		vec3 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset, const in int stride ) {
			float texelIndex = float( vertexIndex * stride + offset );
			float y = floor( texelIndex / morphTargetsTextureSize.x );
			float x = texelIndex - y * morphTargetsTextureSize.x;
			vec3 morphUV = vec3( ( x + 0.5 ) / morphTargetsTextureSize.x, y / morphTargetsTextureSize.y, morphTargetIndex );
			return texture( morphTargetsTexture, morphUV ).xyz;
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,i2=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			#ifndef USE_MORPHNORMALS
				if ( morphTargetInfluences[ i ] > 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 1 ) * morphTargetInfluences[ i ];
			#else
				if ( morphTargetInfluences[ i ] > 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 2 ) * morphTargetInfluences[ i ];
			#endif
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,s2=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,o2=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,a2=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,l2=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,c2=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,u2=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,h2=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,f2=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,d2=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,p2=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,m2=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,g2=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,v2=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,y2=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,x2=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,w2=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,b2=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,M2=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,A2=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,S2=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,E2=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,_2=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,T2=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,C2=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,R2=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,N2=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,I2=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,P2=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,B2=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,L2=`#ifdef USE_TRANSMISSION
	float transmissionAlpha = 1.0;
	float transmissionFactor = transmission;
	float thicknessFactor = thickness;
	#ifdef USE_TRANSMISSIONMAP
		transmissionFactor *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		thicknessFactor *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,
		attenuationColor, attenuationDistance );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );
	transmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );
#endif`,D2=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( float roughness, float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( vec2 fragCoord, float roughness, float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef TEXTURE_LOD_EXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( vec3 radiance, float transmissionDistance, vec3 attenuationColor, float attenuationDistance ) {
		if ( attenuationDistance == 0.0 ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 diffuseColor, vec3 specularColor, float specularF90,
		vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness,
		vec3 attenuationColor, float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,F2=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,O2=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,z2=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,U2=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,H2=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,G2=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,k2=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const V2=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,W2=`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,q2=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Y2=`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,X2=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,Q2=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,j2=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,Z2=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,J2=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,K2=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,$2=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,eR=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,tR=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,nR=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,rR=`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,iR=`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,sR=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,oR=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,aR=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,lR=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,cR=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,uR=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,hR=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,fR=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,dR=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,pR=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,mR=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,gR=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,vR=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,yR=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,xR=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,wR=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,pt={alphamap_fragment:jT,alphamap_pars_fragment:ZT,alphatest_fragment:JT,alphatest_pars_fragment:KT,aomap_fragment:$T,aomap_pars_fragment:eC,begin_vertex:tC,beginnormal_vertex:nC,bsdfs:rC,bumpmap_pars_fragment:iC,clipping_planes_fragment:sC,clipping_planes_pars_fragment:oC,clipping_planes_pars_vertex:aC,clipping_planes_vertex:lC,color_fragment:cC,color_pars_fragment:uC,color_pars_vertex:hC,color_vertex:fC,common:dC,cube_uv_reflection_fragment:pC,defaultnormal_vertex:mC,displacementmap_pars_vertex:gC,displacementmap_vertex:vC,emissivemap_fragment:yC,emissivemap_pars_fragment:xC,encodings_fragment:wC,encodings_pars_fragment:bC,envmap_fragment:MC,envmap_common_pars_fragment:AC,envmap_pars_fragment:SC,envmap_pars_vertex:EC,envmap_physical_pars_fragment:FC,envmap_vertex:_C,fog_vertex:TC,fog_pars_vertex:CC,fog_fragment:RC,fog_pars_fragment:NC,gradientmap_pars_fragment:IC,lightmap_fragment:PC,lightmap_pars_fragment:BC,lights_lambert_vertex:LC,lights_pars_begin:DC,lights_toon_fragment:OC,lights_toon_pars_fragment:zC,lights_phong_fragment:UC,lights_phong_pars_fragment:HC,lights_physical_fragment:GC,lights_physical_pars_fragment:kC,lights_fragment_begin:VC,lights_fragment_maps:WC,lights_fragment_end:qC,logdepthbuf_fragment:YC,logdepthbuf_pars_fragment:XC,logdepthbuf_pars_vertex:QC,logdepthbuf_vertex:jC,map_fragment:ZC,map_pars_fragment:JC,map_particle_fragment:KC,map_particle_pars_fragment:$C,metalnessmap_fragment:e2,metalnessmap_pars_fragment:t2,morphnormal_vertex:n2,morphtarget_pars_vertex:r2,morphtarget_vertex:i2,normal_fragment_begin:s2,normal_fragment_maps:o2,normal_pars_fragment:a2,normal_pars_vertex:l2,normal_vertex:c2,normalmap_pars_fragment:u2,clearcoat_normal_fragment_begin:h2,clearcoat_normal_fragment_maps:f2,clearcoat_pars_fragment:d2,output_fragment:p2,packing:m2,premultiplied_alpha_fragment:g2,project_vertex:v2,dithering_fragment:y2,dithering_pars_fragment:x2,roughnessmap_fragment:w2,roughnessmap_pars_fragment:b2,shadowmap_pars_fragment:M2,shadowmap_pars_vertex:A2,shadowmap_vertex:S2,shadowmask_pars_fragment:E2,skinbase_vertex:_2,skinning_pars_vertex:T2,skinning_vertex:C2,skinnormal_vertex:R2,specularmap_fragment:N2,specularmap_pars_fragment:I2,tonemapping_fragment:P2,tonemapping_pars_fragment:B2,transmission_fragment:L2,transmission_pars_fragment:D2,uv_pars_fragment:F2,uv_pars_vertex:O2,uv_vertex:z2,uv2_pars_fragment:U2,uv2_pars_vertex:H2,uv2_vertex:G2,worldpos_vertex:k2,background_vert:V2,background_frag:W2,cube_vert:q2,cube_frag:Y2,depth_vert:X2,depth_frag:Q2,distanceRGBA_vert:j2,distanceRGBA_frag:Z2,equirect_vert:J2,equirect_frag:K2,linedashed_vert:$2,linedashed_frag:eR,meshbasic_vert:tR,meshbasic_frag:nR,meshlambert_vert:rR,meshlambert_frag:iR,meshmatcap_vert:sR,meshmatcap_frag:oR,meshnormal_vert:aR,meshnormal_frag:lR,meshphong_vert:cR,meshphong_frag:uR,meshphysical_vert:hR,meshphysical_frag:fR,meshtoon_vert:dR,meshtoon_frag:pR,points_vert:mR,points_frag:gR,shadow_vert:vR,shadow_frag:yR,sprite_vert:xR,sprite_frag:wR},Ve={common:{diffuse:{value:new He(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new yn},uv2Transform:{value:new yn},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Ae(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new He(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new He(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new yn}},sprite:{diffuse:{value:new He(16777215)},opacity:{value:1},center:{value:new Ae(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new yn}}},Yn={basic:{uniforms:Hn([Ve.common,Ve.specularmap,Ve.envmap,Ve.aomap,Ve.lightmap,Ve.fog]),vertexShader:pt.meshbasic_vert,fragmentShader:pt.meshbasic_frag},lambert:{uniforms:Hn([Ve.common,Ve.specularmap,Ve.envmap,Ve.aomap,Ve.lightmap,Ve.emissivemap,Ve.fog,Ve.lights,{emissive:{value:new He(0)}}]),vertexShader:pt.meshlambert_vert,fragmentShader:pt.meshlambert_frag},phong:{uniforms:Hn([Ve.common,Ve.specularmap,Ve.envmap,Ve.aomap,Ve.lightmap,Ve.emissivemap,Ve.bumpmap,Ve.normalmap,Ve.displacementmap,Ve.fog,Ve.lights,{emissive:{value:new He(0)},specular:{value:new He(1118481)},shininess:{value:30}}]),vertexShader:pt.meshphong_vert,fragmentShader:pt.meshphong_frag},standard:{uniforms:Hn([Ve.common,Ve.envmap,Ve.aomap,Ve.lightmap,Ve.emissivemap,Ve.bumpmap,Ve.normalmap,Ve.displacementmap,Ve.roughnessmap,Ve.metalnessmap,Ve.fog,Ve.lights,{emissive:{value:new He(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:pt.meshphysical_vert,fragmentShader:pt.meshphysical_frag},toon:{uniforms:Hn([Ve.common,Ve.aomap,Ve.lightmap,Ve.emissivemap,Ve.bumpmap,Ve.normalmap,Ve.displacementmap,Ve.gradientmap,Ve.fog,Ve.lights,{emissive:{value:new He(0)}}]),vertexShader:pt.meshtoon_vert,fragmentShader:pt.meshtoon_frag},matcap:{uniforms:Hn([Ve.common,Ve.bumpmap,Ve.normalmap,Ve.displacementmap,Ve.fog,{matcap:{value:null}}]),vertexShader:pt.meshmatcap_vert,fragmentShader:pt.meshmatcap_frag},points:{uniforms:Hn([Ve.points,Ve.fog]),vertexShader:pt.points_vert,fragmentShader:pt.points_frag},dashed:{uniforms:Hn([Ve.common,Ve.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:pt.linedashed_vert,fragmentShader:pt.linedashed_frag},depth:{uniforms:Hn([Ve.common,Ve.displacementmap]),vertexShader:pt.depth_vert,fragmentShader:pt.depth_frag},normal:{uniforms:Hn([Ve.common,Ve.bumpmap,Ve.normalmap,Ve.displacementmap,{opacity:{value:1}}]),vertexShader:pt.meshnormal_vert,fragmentShader:pt.meshnormal_frag},sprite:{uniforms:Hn([Ve.sprite,Ve.fog]),vertexShader:pt.sprite_vert,fragmentShader:pt.sprite_frag},background:{uniforms:{uvTransform:{value:new yn},t2D:{value:null}},vertexShader:pt.background_vert,fragmentShader:pt.background_frag},cube:{uniforms:Hn([Ve.envmap,{opacity:{value:1}}]),vertexShader:pt.cube_vert,fragmentShader:pt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:pt.equirect_vert,fragmentShader:pt.equirect_frag},distanceRGBA:{uniforms:Hn([Ve.common,Ve.displacementmap,{referencePosition:{value:new X},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:pt.distanceRGBA_vert,fragmentShader:pt.distanceRGBA_frag},shadow:{uniforms:Hn([Ve.lights,Ve.fog,{color:{value:new He(0)},opacity:{value:1}}]),vertexShader:pt.shadow_vert,fragmentShader:pt.shadow_frag}};Yn.physical={uniforms:Hn([Yn.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Ae(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new He(0)},sheenColorMap:{value:null},sheenRoughness:{value:0},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Ae},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new He(0)},specularIntensity:{value:0},specularIntensityMap:{value:null},specularColor:{value:new He(1,1,1)},specularColorMap:{value:null}}]),vertexShader:pt.meshphysical_vert,fragmentShader:pt.meshphysical_frag};function bR(r,e,t,n,i){const s=new He(0);let o=0,a,l,h=null,u=0,c=null;function f(p,m){let y=!1,g=m.isScene===!0?m.background:null;g&&g.isTexture&&(g=e.get(g));const v=r.xr,x=v.getSession&&v.getSession();x&&x.environmentBlendMode==="additive"&&(g=null),g===null?d(s,o):g&&g.isColor&&(d(g,1),y=!0),(r.autoClear||y)&&r.clear(r.autoClearColor,r.autoClearDepth,r.autoClearStencil),g&&(g.isCubeTexture||g.mapping===ea)?(l===void 0&&(l=new Gt(new Fi(1,1,1),new Pn({name:"BackgroundCubeMaterial",uniforms:xa(Yn.cube.uniforms),vertexShader:Yn.cube.vertexShader,fragmentShader:Yn.cube.fragmentShader,side:zt,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),l.geometry.deleteAttribute("uv"),l.onBeforeRender=function(w,b,M){this.matrixWorld.copyPosition(M.matrixWorld)},Object.defineProperty(l.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(l)),l.material.uniforms.envMap.value=g,l.material.uniforms.flipEnvMap.value=g.isCubeTexture&&g.isRenderTargetTexture===!1?-1:1,(h!==g||u!==g.version||c!==r.toneMapping)&&(l.material.needsUpdate=!0,h=g,u=g.version,c=r.toneMapping),p.unshift(l,l.geometry,l.material,0,0,null)):g&&g.isTexture&&(a===void 0&&(a=new Gt(new co(2,2),new Pn({name:"BackgroundMaterial",uniforms:xa(Yn.background.uniforms),vertexShader:Yn.background.vertexShader,fragmentShader:Yn.background.fragmentShader,side:Ti,depthTest:!1,depthWrite:!1,fog:!1})),a.geometry.deleteAttribute("normal"),Object.defineProperty(a.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(a)),a.material.uniforms.t2D.value=g,g.matrixAutoUpdate===!0&&g.updateMatrix(),a.material.uniforms.uvTransform.value.copy(g.matrix),(h!==g||u!==g.version||c!==r.toneMapping)&&(a.material.needsUpdate=!0,h=g,u=g.version,c=r.toneMapping),p.unshift(a,a.geometry,a.material,0,0,null))}function d(p,m){t.buffers.color.setClear(p.r,p.g,p.b,m,i)}return{getClearColor:function(){return s},setClearColor:function(p,m=1){s.set(p),o=m,d(s,o)},getClearAlpha:function(){return o},setClearAlpha:function(p){o=p,d(s,o)},render:f}}function MR(r,e,t,n){const i=r.getParameter(34921),s=n.isWebGL2?null:e.get("OES_vertex_array_object"),o=n.isWebGL2||s!==null,a={},l=m(null);let h=l;function u(L,k,H,O,T){let V=!1;if(o){const F=p(O,H,k);h!==F&&(h=F,f(h.object)),V=y(O,T),V&&g(O,T)}else{const F=k.wireframe===!0;(h.geometry!==O.id||h.program!==H.id||h.wireframe!==F)&&(h.geometry=O.id,h.program=H.id,h.wireframe=F,V=!0)}L.isInstancedMesh===!0&&(V=!0),T!==null&&t.update(T,34963),V&&(A(L,k,H,O),T!==null&&r.bindBuffer(34963,t.get(T).buffer))}function c(){return n.isWebGL2?r.createVertexArray():s.createVertexArrayOES()}function f(L){return n.isWebGL2?r.bindVertexArray(L):s.bindVertexArrayOES(L)}function d(L){return n.isWebGL2?r.deleteVertexArray(L):s.deleteVertexArrayOES(L)}function p(L,k,H){const O=H.wireframe===!0;let T=a[L.id];T===void 0&&(T={},a[L.id]=T);let V=T[k.id];V===void 0&&(V={},T[k.id]=V);let F=V[O];return F===void 0&&(F=m(c()),V[O]=F),F}function m(L){const k=[],H=[],O=[];for(let T=0;T<i;T++)k[T]=0,H[T]=0,O[T]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:k,enabledAttributes:H,attributeDivisors:O,object:L,attributes:{},index:null}}function y(L,k){const H=h.attributes,O=L.attributes;let T=0;for(const V in O){const F=H[V],J=O[V];if(F===void 0||F.attribute!==J||F.data!==J.data)return!0;T++}return h.attributesNum!==T||h.index!==k}function g(L,k){const H={},O=L.attributes;let T=0;for(const V in O){const F=O[V],J={};J.attribute=F,F.data&&(J.data=F.data),H[V]=J,T++}h.attributes=H,h.attributesNum=T,h.index=k}function v(){const L=h.newAttributes;for(let k=0,H=L.length;k<H;k++)L[k]=0}function x(L){w(L,0)}function w(L,k){const H=h.newAttributes,O=h.enabledAttributes,T=h.attributeDivisors;H[L]=1,O[L]===0&&(r.enableVertexAttribArray(L),O[L]=1),T[L]!==k&&((n.isWebGL2?r:e.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](L,k),T[L]=k)}function b(){const L=h.newAttributes,k=h.enabledAttributes;for(let H=0,O=k.length;H<O;H++)k[H]!==L[H]&&(r.disableVertexAttribArray(H),k[H]=0)}function M(L,k,H,O,T,V){n.isWebGL2===!0&&(H===5124||H===5125)?r.vertexAttribIPointer(L,k,H,T,V):r.vertexAttribPointer(L,k,H,O,T,V)}function A(L,k,H,O){if(n.isWebGL2===!1&&(L.isInstancedMesh||O.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;v();const T=O.attributes,V=H.getAttributes(),F=k.defaultAttributeValues;for(const J in V){const Y=V[J];if(Y.location>=0){let te=T[J];if(te===void 0&&(J==="instanceMatrix"&&L.instanceMatrix&&(te=L.instanceMatrix),J==="instanceColor"&&L.instanceColor&&(te=L.instanceColor)),te!==void 0){const z=te.normalized,K=te.itemSize,Z=t.get(te);if(Z===void 0)continue;const Q=Z.buffer,me=Z.type,ge=Z.bytesPerElement;if(te.isInterleavedBufferAttribute){const se=te.data,he=se.stride,xe=te.offset;if(se&&se.isInstancedInterleavedBuffer){for(let pe=0;pe<Y.locationSize;pe++)w(Y.location+pe,se.meshPerAttribute);L.isInstancedMesh!==!0&&O._maxInstanceCount===void 0&&(O._maxInstanceCount=se.meshPerAttribute*se.count)}else for(let pe=0;pe<Y.locationSize;pe++)x(Y.location+pe);r.bindBuffer(34962,Q);for(let pe=0;pe<Y.locationSize;pe++)M(Y.location+pe,K/Y.locationSize,me,z,he*ge,(xe+K/Y.locationSize*pe)*ge)}else{if(te.isInstancedBufferAttribute){for(let se=0;se<Y.locationSize;se++)w(Y.location+se,te.meshPerAttribute);L.isInstancedMesh!==!0&&O._maxInstanceCount===void 0&&(O._maxInstanceCount=te.meshPerAttribute*te.count)}else for(let se=0;se<Y.locationSize;se++)x(Y.location+se);r.bindBuffer(34962,Q);for(let se=0;se<Y.locationSize;se++)M(Y.location+se,K/Y.locationSize,me,z,K*ge,K/Y.locationSize*se*ge)}}else if(F!==void 0){const z=F[J];if(z!==void 0)switch(z.length){case 2:r.vertexAttrib2fv(Y.location,z);break;case 3:r.vertexAttrib3fv(Y.location,z);break;case 4:r.vertexAttrib4fv(Y.location,z);break;default:r.vertexAttrib1fv(Y.location,z)}}}}b()}function E(){_();for(const L in a){const k=a[L];for(const H in k){const O=k[H];for(const T in O)d(O[T].object),delete O[T];delete k[H]}delete a[L]}}function N(L){if(a[L.id]===void 0)return;const k=a[L.id];for(const H in k){const O=k[H];for(const T in O)d(O[T].object),delete O[T];delete k[H]}delete a[L.id]}function R(L){for(const k in a){const H=a[k];if(H[L.id]===void 0)continue;const O=H[L.id];for(const T in O)d(O[T].object),delete O[T];delete H[L.id]}}function _(){S(),h!==l&&(h=l,f(h.object))}function S(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:u,reset:_,resetDefaultState:S,dispose:E,releaseStatesOfGeometry:N,releaseStatesOfProgram:R,initAttributes:v,enableAttribute:x,disableUnusedAttributes:b}}function AR(r,e,t,n){const i=n.isWebGL2;let s;function o(h){s=h}function a(h,u){r.drawArrays(s,h,u),t.update(u,s,1)}function l(h,u,c){if(c===0)return;let f,d;if(i)f=r,d="drawArraysInstanced";else if(f=e.get("ANGLE_instanced_arrays"),d="drawArraysInstancedANGLE",f===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}f[d](s,h,u,c),t.update(u,s,c)}this.setMode=o,this.render=a,this.renderInstances=l}function SR(r,e,t){let n;function i(){if(n!==void 0)return n;if(e.has("EXT_texture_filter_anisotropic")===!0){const A=e.get("EXT_texture_filter_anisotropic");n=r.getParameter(A.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n}function s(A){if(A==="highp"){if(r.getShaderPrecisionFormat(35633,36338).precision>0&&r.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";A="mediump"}return A==="mediump"&&r.getShaderPrecisionFormat(35633,36337).precision>0&&r.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext!="undefined"&&r instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext!="undefined"&&r instanceof WebGL2ComputeRenderingContext;let a=t.precision!==void 0?t.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const h=o||e.has("WEBGL_draw_buffers"),u=t.logarithmicDepthBuffer===!0,c=r.getParameter(34930),f=r.getParameter(35660),d=r.getParameter(3379),p=r.getParameter(34076),m=r.getParameter(34921),y=r.getParameter(36347),g=r.getParameter(36348),v=r.getParameter(36349),x=f>0,w=o||e.has("OES_texture_float"),b=x&&w,M=o?r.getParameter(36183):0;return{isWebGL2:o,drawBuffers:h,getMaxAnisotropy:i,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:u,maxTextures:c,maxVertexTextures:f,maxTextureSize:d,maxCubemapSize:p,maxAttributes:m,maxVertexUniforms:y,maxVaryings:g,maxFragmentUniforms:v,vertexTextures:x,floatFragmentTextures:w,floatVertexTextures:b,maxSamples:M}}function ER(r){const e=this;let t=null,n=0,i=!1,s=!1;const o=new Hr,a=new yn,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(c,f,d){const p=c.length!==0||f||n!==0||i;return i=f,t=u(c,d,0),n=c.length,p},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1,h()},this.setState=function(c,f,d){const p=c.clippingPlanes,m=c.clipIntersection,y=c.clipShadows,g=r.get(c);if(!i||p===null||p.length===0||s&&!y)s?u(null):h();else{const v=s?0:n,x=v*4;let w=g.clippingState||null;l.value=w,w=u(p,f,x,d);for(let b=0;b!==x;++b)w[b]=t[b];g.clippingState=w,this.numIntersection=m?this.numPlanes:0,this.numPlanes+=v}};function h(){l.value!==t&&(l.value=t,l.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function u(c,f,d,p){const m=c!==null?c.length:0;let y=null;if(m!==0){if(y=l.value,p!==!0||y===null){const g=d+m*4,v=f.matrixWorldInverse;a.getNormalMatrix(v),(y===null||y.length<g)&&(y=new Float32Array(g));for(let x=0,w=d;x!==m;++x,w+=4)o.copy(c[x]).applyMatrix4(v,a),o.normal.toArray(y,w),y[w+3]=o.constant}l.value=y,l.needsUpdate=!0}return e.numPlanes=m,e.numIntersection=0,y}}function _R(r){let e=new WeakMap;function t(o,a){return a===Rl?o.mapping=$s:a===Nl&&(o.mapping=eo),o}function n(o){if(o&&o.isTexture&&o.isRenderTargetTexture===!1){const a=o.mapping;if(a===Rl||a===Nl)if(e.has(o)){const l=e.get(o).texture;return t(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const h=r.getRenderTarget(),u=new nh(l.height/2);return u.fromEquirectangularTexture(r,o),e.set(o,u),r.setRenderTarget(h),o.addEventListener("dispose",i),t(u.texture,o.mapping)}else return null}}return o}function i(o){const a=o.target;a.removeEventListener("dispose",i);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:n,dispose:s}}class Ea extends wa{constructor(e=-1,t=1,n=1,i=-1,s=.1,o=2e3){super();this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=i,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,i,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let s=n-e,o=n+e,a=i+t,l=i-t;if(this.view!==null&&this.view.enabled){const h=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=h*this.view.offsetX,o=s+h*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}Ea.prototype.isOrthographicCamera=!0;class _a extends Pn{constructor(e){super(e);this.type="RawShaderMaterial"}}_a.prototype.isRawShaderMaterial=!0;const Ta=4,vs=8,ii=Math.pow(2,vs),Dx=[.125,.215,.35,.446,.526,.582],Fx=vs-Ta+1+Dx.length,Ca=20,ih={[gr]:0,[Fr]:1},Gp=new Ea,{_lodPlanes:Wl,_sizeLods:Ox,_sigmas:sh}=TR(),zx=new He;let kp=null;const uo=(1+Math.sqrt(5))/2,Ra=1/uo,Ux=[new X(1,1,1),new X(-1,1,1),new X(1,1,-1),new X(-1,1,-1),new X(0,uo,Ra),new X(0,uo,-Ra),new X(Ra,0,uo),new X(-Ra,0,uo),new X(uo,Ra,0),new X(-uo,Ra,0)];class Hx{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._blurMaterial=CR(Ca),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,i=100){kp=this._renderer.getRenderTarget();const s=this._allocateTargets();return this._sceneToCubeUV(e,n,i,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e){return this._fromTexture(e)}fromCubemap(e){return this._fromTexture(e)}compileCubemapShader(){this._cubemapShader===null&&(this._cubemapShader=Vx(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){this._equirectShader===null&&(this._equirectShader=kx(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),this._cubemapShader!==null&&this._cubemapShader.dispose(),this._equirectShader!==null&&this._equirectShader.dispose();for(let e=0;e<Wl.length;e++)Wl[e].dispose()}_cleanup(e){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(kp),e.scissorTest=!1,oh(e,0,0,e.width,e.height)}_fromTexture(e){kp=this._renderer.getRenderTarget();const t=this._allocateTargets(e);return this._textureToCubeUV(e,t),this._applyPMREM(t),this._cleanup(t),t}_allocateTargets(e){const t={magFilter:ft,minFilter:ft,generateMipmaps:!1,type:ss,format:Lt,encoding:gr,depthBuffer:!1},n=Gx(t);return n.depthBuffer=!e,this._pingPongRenderTarget=Gx(t),n}_compileMaterial(e){const t=new Gt(Wl[0],e);this._renderer.compile(t,Gp)}_sceneToCubeUV(e,t,n,i){const s=90,o=1,a=new ln(s,o,t,n),l=[1,-1,1,1,1,1],h=[1,1,1,-1,-1,-1],u=this._renderer,c=u.autoClear,f=u.toneMapping;u.getClearColor(zx),u.toneMapping=Ci,u.autoClear=!1;const d=new ir({name:"PMREM.Background",side:zt,depthWrite:!1,depthTest:!1}),p=new Gt(new Fi,d);let m=!1;const y=e.background;y?y.isColor&&(d.color.copy(y),e.background=null,m=!0):(d.color.copy(zx),m=!0);for(let g=0;g<6;g++){const v=g%3;v==0?(a.up.set(0,l[g],0),a.lookAt(h[g],0,0)):v==1?(a.up.set(0,0,l[g]),a.lookAt(0,h[g],0)):(a.up.set(0,l[g],0),a.lookAt(0,0,h[g])),oh(i,v*ii,g>2?ii:0,ii,ii),u.setRenderTarget(i),m&&u.render(p,a),u.render(e,a)}p.geometry.dispose(),p.material.dispose(),u.toneMapping=f,u.autoClear=c,e.background=y}_setEncoding(e,t){this._renderer.capabilities.isWebGL2===!0&&t.format===Lt&&t.type===pn&&t.encoding===Fr?e.value=ih[gr]:e.value=ih[t.encoding]}_textureToCubeUV(e,t){const n=this._renderer,i=e.mapping===$s||e.mapping===eo;i?this._cubemapShader==null&&(this._cubemapShader=Vx()):this._equirectShader==null&&(this._equirectShader=kx());const s=i?this._cubemapShader:this._equirectShader,o=new Gt(Wl[0],s),a=s.uniforms;a.envMap.value=e,i||a.texelSize.value.set(1/e.image.width,1/e.image.height),this._setEncoding(a.inputEncoding,e),oh(t,0,0,3*ii,2*ii),n.setRenderTarget(t),n.render(o,Gp)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let i=1;i<Fx;i++){const s=Math.sqrt(sh[i]*sh[i]-sh[i-1]*sh[i-1]),o=Ux[(i-1)%Ux.length];this._blur(e,i-1,i,s,o)}t.autoClear=n}_blur(e,t,n,i,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,i,"latitudinal",s),this._halfBlur(o,e,n,n,i,"longitudinal",s)}_halfBlur(e,t,n,i,s,o,a){const l=this._renderer,h=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const u=3,c=new Gt(Wl[i],h),f=h.uniforms,d=Ox[n]-1,p=isFinite(s)?Math.PI/(2*d):2*Math.PI/(2*Ca-1),m=s/p,y=isFinite(s)?1+Math.floor(u*m):Ca;y>Ca&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${y} samples when the maximum is set to ${Ca}`);const g=[];let v=0;for(let M=0;M<Ca;++M){const A=M/m,E=Math.exp(-A*A/2);g.push(E),M==0?v+=E:M<y&&(v+=2*E)}for(let M=0;M<g.length;M++)g[M]=g[M]/v;f.envMap.value=e.texture,f.samples.value=y,f.weights.value=g,f.latitudinal.value=o==="latitudinal",a&&(f.poleAxis.value=a),f.dTheta.value=p,f.mipInt.value=vs-n;const x=Ox[i],w=3*Math.max(0,ii-2*x),b=(i===0?0:2*ii)+2*x*(i>vs-Ta?i-vs+Ta:0);oh(t,w,b,3*x,2*x),l.setRenderTarget(t),l.render(c,Gp)}}function TR(){const r=[],e=[],t=[];let n=vs;for(let i=0;i<Fx;i++){const s=Math.pow(2,n);e.push(s);let o=1/s;i>vs-Ta?o=Dx[i-vs+Ta-1]:i==0&&(o=0),t.push(o);const a=1/(s-1),l=-a/2,h=1+a/2,u=[l,l,h,l,h,h,l,l,h,h,l,h],c=6,f=6,d=3,p=2,m=1,y=new Float32Array(d*f*c),g=new Float32Array(p*f*c),v=new Float32Array(m*f*c);for(let w=0;w<c;w++){const b=w%3*2/3-1,M=w>2?0:-1,A=[b,M,0,b+2/3,M,0,b+2/3,M+1,0,b,M,0,b+2/3,M+1,0,b,M+1,0];y.set(A,d*f*w),g.set(u,p*f*w);const E=[w,w,w,w,w,w];v.set(E,m*f*w)}const x=new rt;x.setAttribute("position",new ut(y,d)),x.setAttribute("uv",new ut(g,p)),x.setAttribute("faceIndex",new ut(v,m)),r.push(x),n>Ta&&n--}return{_lodPlanes:r,_sizeLods:e,_sigmas:t}}function Gx(r){const e=new mn(3*ii,3*ii,r);return e.texture.mapping=ea,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function oh(r,e,t,n,i){r.viewport.set(e,t,n,i),r.scissor.set(e,t,n,i)}function CR(r){const e=new Float32Array(r),t=new X(0,1,0);return new _a({name:"SphericalGaussianBlur",defines:{n:r},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:e},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:t}},vertexShader:Vp(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			${Wp()}

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Un,depthTest:!1,depthWrite:!1})}function kx(){const r=new Ae(1,1);return new _a({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:r},inputEncoding:{value:ih[gr]}},vertexShader:Vp(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform vec2 texelSize;

			${Wp()}

			#include <common>

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				vec2 f = fract( uv / texelSize - 0.5 );
				uv -= f * texelSize;
				vec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x += texelSize.x;
				vec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.y += texelSize.y;
				vec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x -= texelSize.x;
				vec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;

				vec3 tm = mix( tl, tr, f.x );
				vec3 bm = mix( bl, br, f.x );
				gl_FragColor.rgb = mix( tm, bm, f.y );

			}
		`,blending:Un,depthTest:!1,depthWrite:!1})}function Vx(){return new _a({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:ih[gr]}},vertexShader:Vp(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			${Wp()}

			void main() {

				gl_FragColor = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) );

			}
		`,blending:Un,depthTest:!1,depthWrite:!1})}function Vp(){return`

		precision mediump float;
		precision mediump int;

		attribute vec3 position;
		attribute vec2 uv;
		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function Wp(){return`

		uniform int inputEncoding;

		#include <encodings_pars_fragment>

		vec4 inputTexelToLinear( vec4 value ) {

			if ( inputEncoding == 0 ) {

				return value;

			} else {

				return sRGBToLinear( value );

			}

		}

		vec4 envMapTexelToLinear( vec4 color ) {

			return inputTexelToLinear( color );

		}
	`}function RR(r){let e=new WeakMap,t=null;function n(a){if(a&&a.isTexture&&a.isRenderTargetTexture===!1){const l=a.mapping,h=l===Rl||l===Nl,u=l===$s||l===eo;if(h||u){if(e.has(a))return e.get(a).texture;{const c=a.image;if(h&&c&&c.height>0||u&&c&&i(c)){const f=r.getRenderTarget();t===null&&(t=new Hx(r));const d=h?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,d),r.setRenderTarget(f),a.addEventListener("dispose",s),d.texture}else return null}}}return a}function i(a){let l=0;const h=6;for(let u=0;u<h;u++)a[u]!==void 0&&l++;return l===h}function s(a){const l=a.target;l.removeEventListener("dispose",s);const h=e.get(l);h!==void 0&&(e.delete(l),h.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:o}}function NR(r){const e={};function t(n){if(e[n]!==void 0)return e[n];let i;switch(n){case"WEBGL_depth_texture":i=r.getExtension("WEBGL_depth_texture")||r.getExtension("MOZ_WEBGL_depth_texture")||r.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=r.getExtension("WEBGL_compressed_texture_s3tc")||r.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=r.getExtension("WEBGL_compressed_texture_pvrtc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=r.getExtension(n)}return e[n]=i,i}return{has:function(n){return t(n)!==null},init:function(n){n.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(n){const i=t(n);return i===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),i}}}function IR(r,e,t,n){const i={},s=new WeakMap;function o(c){const f=c.target;f.index!==null&&e.remove(f.index);for(const p in f.attributes)e.remove(f.attributes[p]);f.removeEventListener("dispose",o),delete i[f.id];const d=s.get(f);d&&(e.remove(d),s.delete(f)),n.releaseStatesOfGeometry(f),f.isInstancedBufferGeometry===!0&&delete f._maxInstanceCount,t.memory.geometries--}function a(c,f){return i[f.id]===!0||(f.addEventListener("dispose",o),i[f.id]=!0,t.memory.geometries++),f}function l(c){const f=c.attributes;for(const p in f)e.update(f[p],34962);const d=c.morphAttributes;for(const p in d){const m=d[p];for(let y=0,g=m.length;y<g;y++)e.update(m[y],34962)}}function h(c){const f=[],d=c.index,p=c.attributes.position;let m=0;if(d!==null){const v=d.array;m=d.version;for(let x=0,w=v.length;x<w;x+=3){const b=v[x+0],M=v[x+1],A=v[x+2];f.push(b,M,M,A,A,b)}}else{const v=p.array;m=p.version;for(let x=0,w=v.length/3-1;x<w;x+=3){const b=x+0,M=x+1,A=x+2;f.push(b,M,M,A,A,b)}}const y=new(dx(f)>65535?qu:Wu)(f,1);y.version=m;const g=s.get(c);g&&e.remove(g),s.set(c,y)}function u(c){const f=s.get(c);if(f){const d=c.index;d!==null&&f.version<d.version&&h(c)}else h(c);return s.get(c)}return{get:a,update:l,getWireframeAttribute:u}}function PR(r,e,t,n){const i=n.isWebGL2;let s;function o(f){s=f}let a,l;function h(f){a=f.type,l=f.bytesPerElement}function u(f,d){r.drawElements(s,d,a,f*l),t.update(d,s,1)}function c(f,d,p){if(p===0)return;let m,y;if(i)m=r,y="drawElementsInstanced";else if(m=e.get("ANGLE_instanced_arrays"),y="drawElementsInstancedANGLE",m===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}m[y](s,d,a,f*l,p),t.update(d,s,p)}this.setMode=o,this.setIndex=h,this.render=u,this.renderInstances=c}function BR(r){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(s,o,a){switch(t.calls++,o){case 4:t.triangles+=a*(s/3);break;case 1:t.lines+=a*(s/2);break;case 3:t.lines+=a*(s-1);break;case 2:t.lines+=a*s;break;case 0:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function i(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:i,update:n}}class ah extends Qt{constructor(e=null,t=1,n=1,i=1){super(null);this.image={data:e,width:t,height:n,depth:i},this.magFilter=Ut,this.minFilter=Ut,this.wrapR=Mn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}ah.prototype.isDataTexture2DArray=!0;function LR(r,e){return r[0]-e[0]}function DR(r,e){return Math.abs(e[1])-Math.abs(r[1])}function Wx(r,e){let t=1;const n=e.isInterleavedBufferAttribute?e.data.array:e.array;n instanceof Int8Array?t=127:n instanceof Int16Array?t=32767:n instanceof Int32Array?t=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",n),r.divideScalar(t)}function FR(r,e,t){const n={},i=new Float32Array(8),s=new WeakMap,o=new X,a=[];for(let h=0;h<8;h++)a[h]=[h,0];function l(h,u,c,f){const d=h.morphTargetInfluences;if(e.isWebGL2===!0){const p=u.morphAttributes.position.length;let m=s.get(u);if(m===void 0||m.count!==p){m!==void 0&&m.texture.dispose();const v=u.morphAttributes.normal!==void 0,x=u.morphAttributes.position,w=u.morphAttributes.normal||[],b=u.attributes.position.count,M=v===!0?2:1;let A=b*M,E=1;A>e.maxTextureSize&&(E=Math.ceil(A/e.maxTextureSize),A=e.maxTextureSize);const N=new Float32Array(A*E*4*p),R=new ah(N,A,E,p);R.format=Lt,R.type=ni,R.needsUpdate=!0;const _=M*4;for(let S=0;S<p;S++){const L=x[S],k=w[S],H=A*E*4*S;for(let O=0;O<L.count;O++){o.fromBufferAttribute(L,O),L.normalized===!0&&Wx(o,L);const T=O*_;N[H+T+0]=o.x,N[H+T+1]=o.y,N[H+T+2]=o.z,N[H+T+3]=0,v===!0&&(o.fromBufferAttribute(k,O),k.normalized===!0&&Wx(o,k),N[H+T+4]=o.x,N[H+T+5]=o.y,N[H+T+6]=o.z,N[H+T+7]=0)}}m={count:p,texture:R,size:new Ae(A,E)},s.set(u,m)}let y=0;for(let v=0;v<d.length;v++)y+=d[v];const g=u.morphTargetsRelative?1:1-y;f.getUniforms().setValue(r,"morphTargetBaseInfluence",g),f.getUniforms().setValue(r,"morphTargetInfluences",d),f.getUniforms().setValue(r,"morphTargetsTexture",m.texture,t),f.getUniforms().setValue(r,"morphTargetsTextureSize",m.size)}else{const p=d===void 0?0:d.length;let m=n[u.id];if(m===void 0||m.length!==p){m=[];for(let w=0;w<p;w++)m[w]=[w,0];n[u.id]=m}for(let w=0;w<p;w++){const b=m[w];b[0]=w,b[1]=d[w]}m.sort(DR);for(let w=0;w<8;w++)w<p&&m[w][1]?(a[w][0]=m[w][0],a[w][1]=m[w][1]):(a[w][0]=Number.MAX_SAFE_INTEGER,a[w][1]=0);a.sort(LR);const y=u.morphAttributes.position,g=u.morphAttributes.normal;let v=0;for(let w=0;w<8;w++){const b=a[w],M=b[0],A=b[1];M!==Number.MAX_SAFE_INTEGER&&A?(y&&u.getAttribute("morphTarget"+w)!==y[M]&&u.setAttribute("morphTarget"+w,y[M]),g&&u.getAttribute("morphNormal"+w)!==g[M]&&u.setAttribute("morphNormal"+w,g[M]),i[w]=A,v+=A):(y&&u.hasAttribute("morphTarget"+w)===!0&&u.deleteAttribute("morphTarget"+w),g&&u.hasAttribute("morphNormal"+w)===!0&&u.deleteAttribute("morphNormal"+w),i[w]=0)}const x=u.morphTargetsRelative?1:1-v;f.getUniforms().setValue(r,"morphTargetBaseInfluence",x),f.getUniforms().setValue(r,"morphTargetInfluences",i)}}return{update:l}}function OR(r,e,t,n){let i=new WeakMap;function s(l){const h=n.render.frame,u=l.geometry,c=e.get(l,u);return i.get(c)!==h&&(e.update(c),i.set(c,h)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),t.update(l.instanceMatrix,34962),l.instanceColor!==null&&t.update(l.instanceColor,34962)),c}function o(){i=new WeakMap}function a(l){const h=l.target;h.removeEventListener("dispose",a),t.remove(h.instanceMatrix),h.instanceColor!==null&&t.remove(h.instanceColor)}return{update:s,dispose:o}}class qp extends Qt{constructor(e=null,t=1,n=1,i=1){super(null);this.image={data:e,width:t,height:n,depth:i},this.magFilter=Ut,this.minFilter=Ut,this.wrapR=Mn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}qp.prototype.isDataTexture3D=!0;const qx=new Qt,Yx=new ah,Xx=new qp,Qx=new Aa,jx=[],Zx=[],Jx=new Float32Array(16),Kx=new Float32Array(9),$x=new Float32Array(4);function Na(r,e,t){const n=r[0];if(n<=0||n>0)return r;const i=e*t;let s=jx[i];if(s===void 0&&(s=new Float32Array(i),jx[i]=s),e!==0){n.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,r[o].toArray(s,a)}return s}function Xn(r,e){if(r.length!==e.length)return!1;for(let t=0,n=r.length;t<n;t++)if(r[t]!==e[t])return!1;return!0}function Gn(r,e){for(let t=0,n=e.length;t<n;t++)r[t]=e[t]}function lh(r,e){let t=Zx[e];t===void 0&&(t=new Int32Array(e),Zx[e]=t);for(let n=0;n!==e;++n)t[n]=r.allocateTextureUnit();return t}function zR(r,e){const t=this.cache;t[0]!==e&&(r.uniform1f(this.addr,e),t[0]=e)}function UR(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(r.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Xn(t,e))return;r.uniform2fv(this.addr,e),Gn(t,e)}}function HR(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(r.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(r.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Xn(t,e))return;r.uniform3fv(this.addr,e),Gn(t,e)}}function GR(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(r.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Xn(t,e))return;r.uniform4fv(this.addr,e),Gn(t,e)}}function kR(r,e){const t=this.cache,n=e.elements;if(n===void 0){if(Xn(t,e))return;r.uniformMatrix2fv(this.addr,!1,e),Gn(t,e)}else{if(Xn(t,n))return;$x.set(n),r.uniformMatrix2fv(this.addr,!1,$x),Gn(t,n)}}function VR(r,e){const t=this.cache,n=e.elements;if(n===void 0){if(Xn(t,e))return;r.uniformMatrix3fv(this.addr,!1,e),Gn(t,e)}else{if(Xn(t,n))return;Kx.set(n),r.uniformMatrix3fv(this.addr,!1,Kx),Gn(t,n)}}function WR(r,e){const t=this.cache,n=e.elements;if(n===void 0){if(Xn(t,e))return;r.uniformMatrix4fv(this.addr,!1,e),Gn(t,e)}else{if(Xn(t,n))return;Jx.set(n),r.uniformMatrix4fv(this.addr,!1,Jx),Gn(t,n)}}function qR(r,e){const t=this.cache;t[0]!==e&&(r.uniform1i(this.addr,e),t[0]=e)}function YR(r,e){const t=this.cache;Xn(t,e)||(r.uniform2iv(this.addr,e),Gn(t,e))}function XR(r,e){const t=this.cache;Xn(t,e)||(r.uniform3iv(this.addr,e),Gn(t,e))}function QR(r,e){const t=this.cache;Xn(t,e)||(r.uniform4iv(this.addr,e),Gn(t,e))}function jR(r,e){const t=this.cache;t[0]!==e&&(r.uniform1ui(this.addr,e),t[0]=e)}function ZR(r,e){const t=this.cache;Xn(t,e)||(r.uniform2uiv(this.addr,e),Gn(t,e))}function JR(r,e){const t=this.cache;Xn(t,e)||(r.uniform3uiv(this.addr,e),Gn(t,e))}function KR(r,e){const t=this.cache;Xn(t,e)||(r.uniform4uiv(this.addr,e),Gn(t,e))}function $R(r,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(r.uniform1i(this.addr,i),n[0]=i),t.safeSetTexture2D(e||qx,i)}function eN(r,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(r.uniform1i(this.addr,i),n[0]=i),t.setTexture3D(e||Xx,i)}function tN(r,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(r.uniform1i(this.addr,i),n[0]=i),t.safeSetTextureCube(e||Qx,i)}function nN(r,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(r.uniform1i(this.addr,i),n[0]=i),t.setTexture2DArray(e||Yx,i)}function rN(r){switch(r){case 5126:return zR;case 35664:return UR;case 35665:return HR;case 35666:return GR;case 35674:return kR;case 35675:return VR;case 35676:return WR;case 5124:case 35670:return qR;case 35667:case 35671:return YR;case 35668:case 35672:return XR;case 35669:case 35673:return QR;case 5125:return jR;case 36294:return ZR;case 36295:return JR;case 36296:return KR;case 35678:case 36198:case 36298:case 36306:case 35682:return $R;case 35679:case 36299:case 36307:return eN;case 35680:case 36300:case 36308:case 36293:return tN;case 36289:case 36303:case 36311:case 36292:return nN}}function iN(r,e){r.uniform1fv(this.addr,e)}function sN(r,e){const t=Na(e,this.size,2);r.uniform2fv(this.addr,t)}function oN(r,e){const t=Na(e,this.size,3);r.uniform3fv(this.addr,t)}function aN(r,e){const t=Na(e,this.size,4);r.uniform4fv(this.addr,t)}function lN(r,e){const t=Na(e,this.size,4);r.uniformMatrix2fv(this.addr,!1,t)}function cN(r,e){const t=Na(e,this.size,9);r.uniformMatrix3fv(this.addr,!1,t)}function uN(r,e){const t=Na(e,this.size,16);r.uniformMatrix4fv(this.addr,!1,t)}function hN(r,e){r.uniform1iv(this.addr,e)}function fN(r,e){r.uniform2iv(this.addr,e)}function dN(r,e){r.uniform3iv(this.addr,e)}function pN(r,e){r.uniform4iv(this.addr,e)}function mN(r,e){r.uniform1uiv(this.addr,e)}function gN(r,e){r.uniform2uiv(this.addr,e)}function vN(r,e){r.uniform3uiv(this.addr,e)}function yN(r,e){r.uniform4uiv(this.addr,e)}function xN(r,e,t){const n=e.length,i=lh(t,n);r.uniform1iv(this.addr,i);for(let s=0;s!==n;++s)t.safeSetTexture2D(e[s]||qx,i[s])}function wN(r,e,t){const n=e.length,i=lh(t,n);r.uniform1iv(this.addr,i);for(let s=0;s!==n;++s)t.setTexture3D(e[s]||Xx,i[s])}function bN(r,e,t){const n=e.length,i=lh(t,n);r.uniform1iv(this.addr,i);for(let s=0;s!==n;++s)t.safeSetTextureCube(e[s]||Qx,i[s])}function MN(r,e,t){const n=e.length,i=lh(t,n);r.uniform1iv(this.addr,i);for(let s=0;s!==n;++s)t.setTexture2DArray(e[s]||Yx,i[s])}function AN(r){switch(r){case 5126:return iN;case 35664:return sN;case 35665:return oN;case 35666:return aN;case 35674:return lN;case 35675:return cN;case 35676:return uN;case 5124:case 35670:return hN;case 35667:case 35671:return fN;case 35668:case 35672:return dN;case 35669:case 35673:return pN;case 5125:return mN;case 36294:return gN;case 36295:return vN;case 36296:return yN;case 35678:case 36198:case 36298:case 36306:case 35682:return xN;case 35679:case 36299:case 36307:return wN;case 35680:case 36300:case 36308:case 36293:return bN;case 36289:case 36303:case 36311:case 36292:return MN}}function SN(r,e,t){this.id=r,this.addr=t,this.cache=[],this.setValue=rN(e.type)}function ew(r,e,t){this.id=r,this.addr=t,this.cache=[],this.size=e.size,this.setValue=AN(e.type)}ew.prototype.updateCache=function(r){const e=this.cache;r instanceof Float32Array&&e.length!==r.length&&(this.cache=new Float32Array(r.length)),Gn(e,r)};function tw(r){this.id=r,this.seq=[],this.map={}}tw.prototype.setValue=function(r,e,t){const n=this.seq;for(let i=0,s=n.length;i!==s;++i){const o=n[i];o.setValue(r,e[o.id],t)}};const Yp=/(\w+)(\])?(\[|\.)?/g;function nw(r,e){r.seq.push(e),r.map[e.id]=e}function EN(r,e,t){const n=r.name,i=n.length;for(Yp.lastIndex=0;;){const s=Yp.exec(n),o=Yp.lastIndex;let a=s[1];const l=s[2]==="]",h=s[3];if(l&&(a=a|0),h===void 0||h==="["&&o+2===i){nw(t,h===void 0?new SN(a,r,e):new ew(a,r,e));break}else{let c=t.map[a];c===void 0&&(c=new tw(a),nw(t,c)),t=c}}}function ys(r,e){this.seq=[],this.map={};const t=r.getProgramParameter(e,35718);for(let n=0;n<t;++n){const i=r.getActiveUniform(e,n),s=r.getUniformLocation(e,i.name);EN(i,s,this)}}ys.prototype.setValue=function(r,e,t,n){const i=this.map[e];i!==void 0&&i.setValue(r,t,n)};ys.prototype.setOptional=function(r,e,t){const n=e[t];n!==void 0&&this.setValue(r,t,n)};ys.upload=function(r,e,t,n){for(let i=0,s=e.length;i!==s;++i){const o=e[i],a=t[o.id];a.needsUpdate!==!1&&o.setValue(r,a.value,n)}};ys.seqWithValue=function(r,e){const t=[];for(let n=0,i=r.length;n!==i;++n){const s=r[n];s.id in e&&t.push(s)}return t};function rw(r,e,t){const n=r.createShader(e);return r.shaderSource(n,t),r.compileShader(n),n}let _N=0;function TN(r){const e=r.split(`
`);for(let t=0;t<e.length;t++)e[t]=t+1+": "+e[t];return e.join(`
`)}function iw(r){switch(r){case gr:return["Linear","( value )"];case Fr:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",r),["Linear","( value )"]}}function sw(r,e,t){const n=r.getShaderParameter(e,35713),i=r.getShaderInfoLog(e).trim();return n&&i===""?"":t.toUpperCase()+`

`+i+`

`+TN(r.getShaderSource(e))}function ho(r,e){const t=iw(e);return"vec4 "+r+"( vec4 value ) { return "+t[0]+"ToLinear"+t[1]+"; }"}function CN(r,e){const t=iw(e);return"vec4 "+r+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function RN(r,e){let t;switch(e){case dy:t="Linear";break;case py:t="Reinhard";break;case my:t="OptimizedCineon";break;case gy:t="ACESFilmic";break;case vy:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+r+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function NN(r){return[r.extensionDerivatives||r.envMapCubeUV||r.bumpMap||r.tangentSpaceNormalMap||r.clearcoatNormalMap||r.flatShading||r.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(r.extensionFragDepth||r.logarithmicDepthBuffer)&&r.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",r.extensionDrawBuffers&&r.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(r.extensionShaderTextureLOD||r.envMap||r.transmission)&&r.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(ql).join(`
`)}function IN(r){const e=[];for(const t in r){const n=r[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function PN(r,e){const t={},n=r.getProgramParameter(e,35721);for(let i=0;i<n;i++){const s=r.getActiveAttrib(e,i),o=s.name;let a=1;s.type===35674&&(a=2),s.type===35675&&(a=3),s.type===35676&&(a=4),t[o]={type:s.type,location:r.getAttribLocation(e,o),locationSize:a}}return t}function ql(r){return r!==""}function ow(r,e){return r.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function aw(r,e){return r.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const BN=/^[ \t]*#include +<([\w\d./]+)>/gm;function Xp(r){return r.replace(BN,LN)}function LN(r,e){const t=pt[e];if(t===void 0)throw new Error("Can not resolve #include <"+e+">");return Xp(t)}const DN=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,FN=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function lw(r){return r.replace(FN,cw).replace(DN,ON)}function ON(r,e,t,n){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),cw(r,e,t,n)}function cw(r,e,t,n){let i="";for(let s=parseInt(e);s<parseInt(t);s++)i+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return i}function uw(r){let e="precision "+r.precision+` float;
precision `+r.precision+" int;";return r.precision==="highp"?e+=`
#define HIGH_PRECISION`:r.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:r.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function zN(r){let e="SHADOWMAP_TYPE_BASIC";return r.shadowMapType===Zd?e="SHADOWMAP_TYPE_PCF":r.shadowMapType===q0?e="SHADOWMAP_TYPE_PCF_SOFT":r.shadowMapType===Ko&&(e="SHADOWMAP_TYPE_VSM"),e}function UN(r){let e="ENVMAP_TYPE_CUBE";if(r.envMap)switch(r.envMapMode){case $s:case eo:e="ENVMAP_TYPE_CUBE";break;case ea:case Il:e="ENVMAP_TYPE_CUBE_UV";break}return e}function HN(r){let e="ENVMAP_MODE_REFLECTION";if(r.envMap)switch(r.envMapMode){case eo:case Il:e="ENVMAP_MODE_REFRACTION";break}return e}function GN(r){let e="ENVMAP_BLENDING_NONE";if(r.envMap)switch(r.combine){case Cl:e="ENVMAP_BLENDING_MULTIPLY";break;case hy:e="ENVMAP_BLENDING_MIX";break;case fy:e="ENVMAP_BLENDING_ADD";break}return e}function kN(r,e,t,n){const i=r.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=zN(t),h=UN(t),u=HN(t),c=GN(t),f=t.isWebGL2?"":NN(t),d=IN(s),p=i.createProgram();let m,y,g=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(m=[d].filter(ql).join(`
`),m.length>0&&(m+=`
`),y=[f,d].filter(ql).join(`
`),y.length>0&&(y+=`
`)):(m=[uw(t),"#define SHADER_NAME "+t.shaderName,d,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define MAX_BONES "+t.maxBones,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.useVertexTexture?"#define BONE_TEXTURE":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphTargets&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargets&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(ql).join(`
`),y=[f,uw(t),"#define SHADER_NAME "+t.shaderName,d,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+h:"",t.envMap?"#define "+u:"",t.envMap?"#define "+c:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(t.extensionShaderTextureLOD||t.envMap)&&t.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Ci?"#define TONE_MAPPING":"",t.toneMapping!==Ci?pt.tonemapping_pars_fragment:"",t.toneMapping!==Ci?RN("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.format===An?"#define OPAQUE":"",pt.encodings_pars_fragment,t.map?ho("mapTexelToLinear",t.mapEncoding):"",t.matcap?ho("matcapTexelToLinear",t.matcapEncoding):"",t.envMap?ho("envMapTexelToLinear",t.envMapEncoding):"",t.emissiveMap?ho("emissiveMapTexelToLinear",t.emissiveMapEncoding):"",t.specularColorMap?ho("specularColorMapTexelToLinear",t.specularColorMapEncoding):"",t.sheenColorMap?ho("sheenColorMapTexelToLinear",t.sheenColorMapEncoding):"",t.lightMap?ho("lightMapTexelToLinear",t.lightMapEncoding):"",CN("linearToOutputTexel",t.outputEncoding),t.depthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(ql).join(`
`)),o=Xp(o),o=ow(o,t),o=aw(o,t),a=Xp(a),a=ow(a,t),a=aw(a,t),o=lw(o),a=lw(a),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(g=`#version 300 es
`,m=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+m,y=["#define varying in",t.glslVersion===gp?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===gp?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+y);const v=g+m+o,x=g+y+a,w=rw(i,35633,v),b=rw(i,35632,x);if(i.attachShader(p,w),i.attachShader(p,b),t.index0AttributeName!==void 0?i.bindAttribLocation(p,0,t.index0AttributeName):t.morphTargets===!0&&i.bindAttribLocation(p,0,"position"),i.linkProgram(p),r.debug.checkShaderErrors){const E=i.getProgramInfoLog(p).trim(),N=i.getShaderInfoLog(w).trim(),R=i.getShaderInfoLog(b).trim();let _=!0,S=!0;if(i.getProgramParameter(p,35714)===!1){_=!1;const L=sw(i,w,"vertex"),k=sw(i,b,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(p,35715)+`

Program Info Log: `+E+`
`+L+`
`+k)}else E!==""?console.warn("THREE.WebGLProgram: Program Info Log:",E):(N===""||R==="")&&(S=!1);S&&(this.diagnostics={runnable:_,programLog:E,vertexShader:{log:N,prefix:m},fragmentShader:{log:R,prefix:y}})}i.deleteShader(w),i.deleteShader(b);let M;this.getUniforms=function(){return M===void 0&&(M=new ys(i,p)),M};let A;return this.getAttributes=function(){return A===void 0&&(A=PN(i,p)),A},this.destroy=function(){n.releaseStatesOfProgram(this),i.deleteProgram(p),this.program=void 0},this.name=t.shaderName,this.id=_N++,this.cacheKey=e,this.usedTimes=1,this.program=p,this.vertexShader=w,this.fragmentShader=b,this}let VN=0;class WN{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,i=this._getShaderStage(t),s=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return o.has(i)===!1&&(o.add(i),i.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;return t.has(e)===!1&&t.set(e,new Set),t.get(e)}_getShaderStage(e){const t=this.shaderCache;if(t.has(e)===!1){const n=new qN;t.set(e,n)}return t.get(e)}}class qN{constructor(){this.id=VN++,this.usedTimes=0}}function YN(r,e,t,n,i,s,o){const a=new Hu,l=new WN,h=[],u=i.isWebGL2,c=i.logarithmicDepthBuffer,f=i.floatVertexTextures,d=i.maxVertexUniforms,p=i.vertexTextures;let m=i.precision;const y={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function g(S){const k=S.skeleton.bones;if(f)return 1024;{const O=Math.floor((d-20)/4),T=Math.min(O,k.length);return T<k.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+k.length+" bones. This GPU supports "+T+"."),0):T}}function v(S){let L;return S&&S.isTexture?L=S.encoding:S&&S.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),L=S.texture.encoding):L=gr,u&&S&&S.isTexture&&S.format===Lt&&S.type===pn&&S.encoding===Fr&&(L=gr),L}function x(S,L,k,H,O){const T=H.fog,V=S.isMeshStandardMaterial?H.environment:null,F=(S.isMeshStandardMaterial?t:e).get(S.envMap||V),J=y[S.type],Y=O.isSkinnedMesh?g(O):0;S.precision!==null&&(m=i.getMaxPrecision(S.precision),m!==S.precision&&console.warn("THREE.WebGLProgram.getParameters:",S.precision,"not supported, using",m,"instead."));let te,z,K,Z;if(J){const he=Yn[J];te=he.vertexShader,z=he.fragmentShader}else te=S.vertexShader,z=S.fragmentShader,l.update(S),K=l.getVertexShaderID(S),Z=l.getFragmentShaderID(S);const Q=r.getRenderTarget(),me=S.alphaTest>0,ge=S.clearcoat>0;return{isWebGL2:u,shaderID:J,shaderName:S.type,vertexShader:te,fragmentShader:z,defines:S.defines,customVertexShaderID:K,customFragmentShaderID:Z,isRawShaderMaterial:S.isRawShaderMaterial===!0,glslVersion:S.glslVersion,precision:m,instancing:O.isInstancedMesh===!0,instancingColor:O.isInstancedMesh===!0&&O.instanceColor!==null,supportsVertexTextures:p,outputEncoding:Q!==null?v(Q.texture):r.outputEncoding,map:!!S.map,mapEncoding:v(S.map),matcap:!!S.matcap,matcapEncoding:v(S.matcap),envMap:!!F,envMapMode:F&&F.mapping,envMapEncoding:v(F),envMapCubeUV:!!F&&(F.mapping===ea||F.mapping===Il),lightMap:!!S.lightMap,lightMapEncoding:v(S.lightMap),aoMap:!!S.aoMap,emissiveMap:!!S.emissiveMap,emissiveMapEncoding:v(S.emissiveMap),bumpMap:!!S.bumpMap,normalMap:!!S.normalMap,objectSpaceNormalMap:S.normalMapType===cx,tangentSpaceNormalMap:S.normalMapType===cs,clearcoat:ge,clearcoatMap:ge&&!!S.clearcoatMap,clearcoatRoughnessMap:ge&&!!S.clearcoatRoughnessMap,clearcoatNormalMap:ge&&!!S.clearcoatNormalMap,displacementMap:!!S.displacementMap,roughnessMap:!!S.roughnessMap,metalnessMap:!!S.metalnessMap,specularMap:!!S.specularMap,specularIntensityMap:!!S.specularIntensityMap,specularColorMap:!!S.specularColorMap,specularColorMapEncoding:v(S.specularColorMap),alphaMap:!!S.alphaMap,alphaTest:me,gradientMap:!!S.gradientMap,sheen:S.sheen>0,sheenColorMap:!!S.sheenColorMap,sheenColorMapEncoding:v(S.sheenColorMap),sheenRoughnessMap:!!S.sheenRoughnessMap,transmission:S.transmission>0,transmissionMap:!!S.transmissionMap,thicknessMap:!!S.thicknessMap,combine:S.combine,vertexTangents:!!S.normalMap&&!!O.geometry&&!!O.geometry.attributes.tangent,vertexColors:S.vertexColors,vertexAlphas:S.vertexColors===!0&&!!O.geometry&&!!O.geometry.attributes.color&&O.geometry.attributes.color.itemSize===4,vertexUvs:!!S.map||!!S.bumpMap||!!S.normalMap||!!S.specularMap||!!S.alphaMap||!!S.emissiveMap||!!S.roughnessMap||!!S.metalnessMap||!!S.clearcoatMap||!!S.clearcoatRoughnessMap||!!S.clearcoatNormalMap||!!S.displacementMap||!!S.transmissionMap||!!S.thicknessMap||!!S.specularIntensityMap||!!S.specularColorMap||!!S.sheenColorMap||!!S.sheenRoughnessMap,uvsVertexOnly:!(!!S.map||!!S.bumpMap||!!S.normalMap||!!S.specularMap||!!S.alphaMap||!!S.emissiveMap||!!S.roughnessMap||!!S.metalnessMap||!!S.clearcoatNormalMap||S.transmission>0||!!S.transmissionMap||!!S.thicknessMap||!!S.specularIntensityMap||!!S.specularColorMap||S.sheen>0||!!S.sheenColorMap||!!S.sheenRoughnessMap)&&!!S.displacementMap,fog:!!T,useFog:S.fog,fogExp2:T&&T.isFogExp2,flatShading:!!S.flatShading,sizeAttenuation:S.sizeAttenuation,logarithmicDepthBuffer:c,skinning:O.isSkinnedMesh===!0&&Y>0,maxBones:Y,useVertexTexture:f,morphTargets:!!O.geometry&&!!O.geometry.morphAttributes.position,morphNormals:!!O.geometry&&!!O.geometry.morphAttributes.normal,morphTargetsCount:!!O.geometry&&!!O.geometry.morphAttributes.position?O.geometry.morphAttributes.position.length:0,numDirLights:L.directional.length,numPointLights:L.point.length,numSpotLights:L.spot.length,numRectAreaLights:L.rectArea.length,numHemiLights:L.hemi.length,numDirLightShadows:L.directionalShadowMap.length,numPointLightShadows:L.pointShadowMap.length,numSpotLightShadows:L.spotShadowMap.length,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,format:S.format,dithering:S.dithering,shadowMapEnabled:r.shadowMap.enabled&&k.length>0,shadowMapType:r.shadowMap.type,toneMapping:S.toneMapped?r.toneMapping:Ci,physicallyCorrectLights:r.physicallyCorrectLights,premultipliedAlpha:S.premultipliedAlpha,doubleSided:S.side===mr,flipSided:S.side===zt,depthPacking:S.depthPacking!==void 0?S.depthPacking:!1,index0AttributeName:S.index0AttributeName,extensionDerivatives:S.extensions&&S.extensions.derivatives,extensionFragDepth:S.extensions&&S.extensions.fragDepth,extensionDrawBuffers:S.extensions&&S.extensions.drawBuffers,extensionShaderTextureLOD:S.extensions&&S.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||n.has("EXT_shader_texture_lod"),customProgramCacheKey:S.customProgramCacheKey()}}function w(S){const L=[];if(S.shaderID?L.push(S.shaderID):(L.push(S.customVertexShaderID),L.push(S.customFragmentShaderID)),S.defines!==void 0)for(const k in S.defines)L.push(k),L.push(S.defines[k]);return S.isRawShaderMaterial===!1&&(b(L,S),M(L,S),L.push(r.outputEncoding)),L.push(S.customProgramCacheKey),L.join()}function b(S,L){S.push(L.precision),S.push(L.outputEncoding),S.push(L.mapEncoding),S.push(L.matcapEncoding),S.push(L.envMapMode),S.push(L.envMapEncoding),S.push(L.lightMapEncoding),S.push(L.emissiveMapEncoding),S.push(L.combine),S.push(L.vertexUvs),S.push(L.fogExp2),S.push(L.sizeAttenuation),S.push(L.maxBones),S.push(L.morphTargetsCount),S.push(L.numDirLights),S.push(L.numPointLights),S.push(L.numSpotLights),S.push(L.numHemiLights),S.push(L.numRectAreaLights),S.push(L.numDirLightShadows),S.push(L.numPointLightShadows),S.push(L.numSpotLightShadows),S.push(L.shadowMapType),S.push(L.toneMapping),S.push(L.numClippingPlanes),S.push(L.numClipIntersection),S.push(L.format),S.push(L.specularColorMapEncoding),S.push(L.sheenColorMapEncoding)}function M(S,L){a.disableAll(),L.isWebGL2&&a.enable(0),L.supportsVertexTextures&&a.enable(1),L.instancing&&a.enable(2),L.instancingColor&&a.enable(3),L.map&&a.enable(4),L.matcap&&a.enable(5),L.envMap&&a.enable(6),L.envMapCubeUV&&a.enable(7),L.lightMap&&a.enable(8),L.aoMap&&a.enable(9),L.emissiveMap&&a.enable(10),L.bumpMap&&a.enable(11),L.normalMap&&a.enable(12),L.objectSpaceNormalMap&&a.enable(13),L.tangentSpaceNormalMap&&a.enable(14),L.clearcoat&&a.enable(15),L.clearcoatMap&&a.enable(16),L.clearcoatRoughnessMap&&a.enable(17),L.clearcoatNormalMap&&a.enable(18),L.displacementMap&&a.enable(19),L.specularMap&&a.enable(20),L.roughnessMap&&a.enable(21),L.metalnessMap&&a.enable(22),L.gradientMap&&a.enable(23),L.alphaMap&&a.enable(24),L.alphaTest&&a.enable(25),L.vertexColors&&a.enable(26),L.vertexAlphas&&a.enable(27),L.vertexUvs&&a.enable(28),L.vertexTangents&&a.enable(29),L.uvsVertexOnly&&a.enable(30),L.fog&&a.enable(31),S.push(a.mask),a.disableAll(),L.useFog&&a.enable(0),L.flatShading&&a.enable(1),L.logarithmicDepthBuffer&&a.enable(2),L.skinning&&a.enable(3),L.useVertexTexture&&a.enable(4),L.morphTargets&&a.enable(5),L.morphNormals&&a.enable(6),L.premultipliedAlpha&&a.enable(7),L.shadowMapEnabled&&a.enable(8),L.physicallyCorrectLights&&a.enable(9),L.doubleSided&&a.enable(10),L.flipSided&&a.enable(11),L.depthPacking&&a.enable(12),L.dithering&&a.enable(13),L.specularIntensityMap&&a.enable(14),L.specularColorMap&&a.enable(15),L.transmission&&a.enable(16),L.transmissionMap&&a.enable(17),L.thicknessMap&&a.enable(18),L.sheen&&a.enable(19),L.sheenColorMap&&a.enable(20),L.sheenRoughnessMap&&a.enable(21),S.push(a.mask)}function A(S){const L=y[S.type];let k;if(L){const H=Yn[L];k=eh.clone(H.uniforms)}else k=S.uniforms;return k}function E(S,L){let k;for(let H=0,O=h.length;H<O;H++){const T=h[H];if(T.cacheKey===L){k=T,++k.usedTimes;break}}return k===void 0&&(k=new kN(r,L,S,s),h.push(k)),k}function N(S){if(--S.usedTimes==0){const L=h.indexOf(S);h[L]=h[h.length-1],h.pop(),S.destroy()}}function R(S){l.remove(S)}function _(){l.dispose()}return{getParameters:x,getProgramCacheKey:w,getUniforms:A,acquireProgram:E,releaseProgram:N,releaseShaderCache:R,programs:h,dispose:_}}function XN(){let r=new WeakMap;function e(s){let o=r.get(s);return o===void 0&&(o={},r.set(s,o)),o}function t(s){r.delete(s)}function n(s,o,a){r.get(s)[o]=a}function i(){r=new WeakMap}return{get:e,remove:t,update:n,dispose:i}}function QN(r,e){return r.groupOrder!==e.groupOrder?r.groupOrder-e.groupOrder:r.renderOrder!==e.renderOrder?r.renderOrder-e.renderOrder:r.material.id!==e.material.id?r.material.id-e.material.id:r.z!==e.z?r.z-e.z:r.id-e.id}function hw(r,e){return r.groupOrder!==e.groupOrder?r.groupOrder-e.groupOrder:r.renderOrder!==e.renderOrder?r.renderOrder-e.renderOrder:r.z!==e.z?e.z-r.z:r.id-e.id}function fw(){const r=[];let e=0;const t=[],n=[],i=[];function s(){e=0,t.length=0,n.length=0,i.length=0}function o(c,f,d,p,m,y){let g=r[e];return g===void 0?(g={id:c.id,object:c,geometry:f,material:d,groupOrder:p,renderOrder:c.renderOrder,z:m,group:y},r[e]=g):(g.id=c.id,g.object=c,g.geometry=f,g.material=d,g.groupOrder=p,g.renderOrder=c.renderOrder,g.z=m,g.group=y),e++,g}function a(c,f,d,p,m,y){const g=o(c,f,d,p,m,y);d.transmission>0?n.push(g):d.transparent===!0?i.push(g):t.push(g)}function l(c,f,d,p,m,y){const g=o(c,f,d,p,m,y);d.transmission>0?n.unshift(g):d.transparent===!0?i.unshift(g):t.unshift(g)}function h(c,f){t.length>1&&t.sort(c||QN),n.length>1&&n.sort(f||hw),i.length>1&&i.sort(f||hw)}function u(){for(let c=e,f=r.length;c<f;c++){const d=r[c];if(d.id===null)break;d.id=null,d.object=null,d.geometry=null,d.material=null,d.group=null}}return{opaque:t,transmissive:n,transparent:i,init:s,push:a,unshift:l,finish:u,sort:h}}function jN(){let r=new WeakMap;function e(n,i){let s;return r.has(n)===!1?(s=new fw,r.set(n,[s])):i>=r.get(n).length?(s=new fw,r.get(n).push(s)):s=r.get(n)[i],s}function t(){r=new WeakMap}return{get:e,dispose:t}}function ZN(){const r={};return{get:function(e){if(r[e.id]!==void 0)return r[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new X,color:new He};break;case"SpotLight":t={position:new X,direction:new X,color:new He,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new X,color:new He,distance:0,decay:0};break;case"HemisphereLight":t={direction:new X,skyColor:new He,groundColor:new He};break;case"RectAreaLight":t={color:new He,position:new X,halfWidth:new X,halfHeight:new X};break}return r[e.id]=t,t}}}function JN(){const r={};return{get:function(e){if(r[e.id]!==void 0)return r[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ae};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ae};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ae,shadowCameraNear:1,shadowCameraFar:1e3};break}return r[e.id]=t,t}}}let KN=0;function $N(r,e){return(e.castShadow?1:0)-(r.castShadow?1:0)}function e3(r,e){const t=new ZN,n=JN(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let u=0;u<9;u++)i.probe.push(new X);const s=new X,o=new Ye,a=new Ye;function l(u,c){let f=0,d=0,p=0;for(let N=0;N<9;N++)i.probe[N].set(0,0,0);let m=0,y=0,g=0,v=0,x=0,w=0,b=0,M=0;u.sort($N);const A=c!==!0?Math.PI:1;for(let N=0,R=u.length;N<R;N++){const _=u[N],S=_.color,L=_.intensity,k=_.distance,H=_.shadow&&_.shadow.map?_.shadow.map.texture:null;if(_.isAmbientLight)f+=S.r*L*A,d+=S.g*L*A,p+=S.b*L*A;else if(_.isLightProbe)for(let O=0;O<9;O++)i.probe[O].addScaledVector(_.sh.coefficients[O],L);else if(_.isDirectionalLight){const O=t.get(_);if(O.color.copy(_.color).multiplyScalar(_.intensity*A),_.castShadow){const T=_.shadow,V=n.get(_);V.shadowBias=T.bias,V.shadowNormalBias=T.normalBias,V.shadowRadius=T.radius,V.shadowMapSize=T.mapSize,i.directionalShadow[m]=V,i.directionalShadowMap[m]=H,i.directionalShadowMatrix[m]=_.shadow.matrix,w++}i.directional[m]=O,m++}else if(_.isSpotLight){const O=t.get(_);if(O.position.setFromMatrixPosition(_.matrixWorld),O.color.copy(S).multiplyScalar(L*A),O.distance=k,O.coneCos=Math.cos(_.angle),O.penumbraCos=Math.cos(_.angle*(1-_.penumbra)),O.decay=_.decay,_.castShadow){const T=_.shadow,V=n.get(_);V.shadowBias=T.bias,V.shadowNormalBias=T.normalBias,V.shadowRadius=T.radius,V.shadowMapSize=T.mapSize,i.spotShadow[g]=V,i.spotShadowMap[g]=H,i.spotShadowMatrix[g]=_.shadow.matrix,M++}i.spot[g]=O,g++}else if(_.isRectAreaLight){const O=t.get(_);O.color.copy(S).multiplyScalar(L),O.halfWidth.set(_.width*.5,0,0),O.halfHeight.set(0,_.height*.5,0),i.rectArea[v]=O,v++}else if(_.isPointLight){const O=t.get(_);if(O.color.copy(_.color).multiplyScalar(_.intensity*A),O.distance=_.distance,O.decay=_.decay,_.castShadow){const T=_.shadow,V=n.get(_);V.shadowBias=T.bias,V.shadowNormalBias=T.normalBias,V.shadowRadius=T.radius,V.shadowMapSize=T.mapSize,V.shadowCameraNear=T.camera.near,V.shadowCameraFar=T.camera.far,i.pointShadow[y]=V,i.pointShadowMap[y]=H,i.pointShadowMatrix[y]=_.shadow.matrix,b++}i.point[y]=O,y++}else if(_.isHemisphereLight){const O=t.get(_);O.skyColor.copy(_.color).multiplyScalar(L*A),O.groundColor.copy(_.groundColor).multiplyScalar(L*A),i.hemi[x]=O,x++}}v>0&&(e.isWebGL2||r.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=Ve.LTC_FLOAT_1,i.rectAreaLTC2=Ve.LTC_FLOAT_2):r.has("OES_texture_half_float_linear")===!0?(i.rectAreaLTC1=Ve.LTC_HALF_1,i.rectAreaLTC2=Ve.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=f,i.ambient[1]=d,i.ambient[2]=p;const E=i.hash;(E.directionalLength!==m||E.pointLength!==y||E.spotLength!==g||E.rectAreaLength!==v||E.hemiLength!==x||E.numDirectionalShadows!==w||E.numPointShadows!==b||E.numSpotShadows!==M)&&(i.directional.length=m,i.spot.length=g,i.rectArea.length=v,i.point.length=y,i.hemi.length=x,i.directionalShadow.length=w,i.directionalShadowMap.length=w,i.pointShadow.length=b,i.pointShadowMap.length=b,i.spotShadow.length=M,i.spotShadowMap.length=M,i.directionalShadowMatrix.length=w,i.pointShadowMatrix.length=b,i.spotShadowMatrix.length=M,E.directionalLength=m,E.pointLength=y,E.spotLength=g,E.rectAreaLength=v,E.hemiLength=x,E.numDirectionalShadows=w,E.numPointShadows=b,E.numSpotShadows=M,i.version=KN++)}function h(u,c){let f=0,d=0,p=0,m=0,y=0;const g=c.matrixWorldInverse;for(let v=0,x=u.length;v<x;v++){const w=u[v];if(w.isDirectionalLight){const b=i.directional[f];b.direction.setFromMatrixPosition(w.matrixWorld),s.setFromMatrixPosition(w.target.matrixWorld),b.direction.sub(s),b.direction.transformDirection(g),f++}else if(w.isSpotLight){const b=i.spot[p];b.position.setFromMatrixPosition(w.matrixWorld),b.position.applyMatrix4(g),b.direction.setFromMatrixPosition(w.matrixWorld),s.setFromMatrixPosition(w.target.matrixWorld),b.direction.sub(s),b.direction.transformDirection(g),p++}else if(w.isRectAreaLight){const b=i.rectArea[m];b.position.setFromMatrixPosition(w.matrixWorld),b.position.applyMatrix4(g),a.identity(),o.copy(w.matrixWorld),o.premultiply(g),a.extractRotation(o),b.halfWidth.set(w.width*.5,0,0),b.halfHeight.set(0,w.height*.5,0),b.halfWidth.applyMatrix4(a),b.halfHeight.applyMatrix4(a),m++}else if(w.isPointLight){const b=i.point[d];b.position.setFromMatrixPosition(w.matrixWorld),b.position.applyMatrix4(g),d++}else if(w.isHemisphereLight){const b=i.hemi[y];b.direction.setFromMatrixPosition(w.matrixWorld),b.direction.transformDirection(g),b.direction.normalize(),y++}}}return{setup:l,setupView:h,state:i}}function dw(r,e){const t=new e3(r,e),n=[],i=[];function s(){n.length=0,i.length=0}function o(c){n.push(c)}function a(c){i.push(c)}function l(c){t.setup(n,c)}function h(c){t.setupView(n,c)}return{init:s,state:{lightsArray:n,shadowsArray:i,lights:t},setupLights:l,setupLightsView:h,pushLight:o,pushShadow:a}}function t3(r,e){let t=new WeakMap;function n(s,o=0){let a;return t.has(s)===!1?(a=new dw(r,e),t.set(s,[a])):o>=t.get(s).length?(a=new dw(r,e),t.get(s).push(a)):a=t.get(s)[o],a}function i(){t=new WeakMap}return{get:n,dispose:i}}class ch extends an{constructor(e){super();this.type="MeshDepthMaterial",this.depthPacking=Fl,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}ch.prototype.isMeshDepthMaterial=!0;class uh extends an{constructor(e){super();this.type="MeshDistanceMaterial",this.referencePosition=new X,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}uh.prototype.isMeshDistanceMaterial=!0;const n3=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,r3=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function pw(r,e,t){let n=new Vl;const i=new Ae,s=new Ae,o=new At,a=new ch({depthPacking:lx}),l=new uh,h={},u=t.maxTextureSize,c={0:zt,1:Ti,2:mr},f=new Pn({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Ae},radius:{value:4}},vertexShader:n3,fragmentShader:r3}),d=f.clone();d.defines.HORIZONTAL_PASS=1;const p=new rt;p.setAttribute("position",new ut(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new Gt(p,f),y=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Zd,this.render=function(w,b,M){if(y.enabled===!1||y.autoUpdate===!1&&y.needsUpdate===!1||w.length===0)return;const A=r.getRenderTarget(),E=r.getActiveCubeFace(),N=r.getActiveMipmapLevel(),R=r.state;R.setBlending(Un),R.buffers.color.setClear(1,1,1,1),R.buffers.depth.setTest(!0),R.setScissorTest(!1);for(let _=0,S=w.length;_<S;_++){const L=w[_],k=L.shadow;if(k===void 0){console.warn("THREE.WebGLShadowMap:",L,"has no shadow.");continue}if(k.autoUpdate===!1&&k.needsUpdate===!1)continue;i.copy(k.mapSize);const H=k.getFrameExtents();if(i.multiply(H),s.copy(k.mapSize),(i.x>u||i.y>u)&&(i.x>u&&(s.x=Math.floor(u/H.x),i.x=s.x*H.x,k.mapSize.x=s.x),i.y>u&&(s.y=Math.floor(u/H.y),i.y=s.y*H.y,k.mapSize.y=s.y)),k.map===null&&!k.isPointLightShadow&&this.type===Ko){const T={minFilter:ft,magFilter:ft,format:Lt};k.map=new mn(i.x,i.y,T),k.map.texture.name=L.name+".shadowMap",k.mapPass=new mn(i.x,i.y,T),k.camera.updateProjectionMatrix()}if(k.map===null){const T={minFilter:Ut,magFilter:Ut,format:Lt};k.map=new mn(i.x,i.y,T),k.map.texture.name=L.name+".shadowMap",k.camera.updateProjectionMatrix()}r.setRenderTarget(k.map),r.clear();const O=k.getViewportCount();for(let T=0;T<O;T++){const V=k.getViewport(T);o.set(s.x*V.x,s.y*V.y,s.x*V.z,s.y*V.w),R.viewport(o),k.updateMatrices(L,T),n=k.getFrustum(),x(b,M,k.camera,L,this.type)}!k.isPointLightShadow&&this.type===Ko&&g(k,M),k.needsUpdate=!1}y.needsUpdate=!1,r.setRenderTarget(A,E,N)};function g(w,b){const M=e.update(m);f.defines.VSM_SAMPLES!==w.blurSamples&&(f.defines.VSM_SAMPLES=w.blurSamples,d.defines.VSM_SAMPLES=w.blurSamples,f.needsUpdate=!0,d.needsUpdate=!0),f.uniforms.shadow_pass.value=w.map.texture,f.uniforms.resolution.value=w.mapSize,f.uniforms.radius.value=w.radius,r.setRenderTarget(w.mapPass),r.clear(),r.renderBufferDirect(b,null,M,f,m,null),d.uniforms.shadow_pass.value=w.mapPass.texture,d.uniforms.resolution.value=w.mapSize,d.uniforms.radius.value=w.radius,r.setRenderTarget(w.map),r.clear(),r.renderBufferDirect(b,null,M,d,m,null)}function v(w,b,M,A,E,N,R){let _=null;const S=A.isPointLight===!0?w.customDistanceMaterial:w.customDepthMaterial;if(S!==void 0?_=S:_=A.isPointLight===!0?l:a,r.localClippingEnabled&&M.clipShadows===!0&&M.clippingPlanes.length!==0||M.displacementMap&&M.displacementScale!==0||M.alphaMap&&M.alphaTest>0){const L=_.uuid,k=M.uuid;let H=h[L];H===void 0&&(H={},h[L]=H);let O=H[k];O===void 0&&(O=_.clone(),H[k]=O),_=O}return _.visible=M.visible,_.wireframe=M.wireframe,R===Ko?_.side=M.shadowSide!==null?M.shadowSide:M.side:_.side=M.shadowSide!==null?M.shadowSide:c[M.side],_.alphaMap=M.alphaMap,_.alphaTest=M.alphaTest,_.clipShadows=M.clipShadows,_.clippingPlanes=M.clippingPlanes,_.clipIntersection=M.clipIntersection,_.displacementMap=M.displacementMap,_.displacementScale=M.displacementScale,_.displacementBias=M.displacementBias,_.wireframeLinewidth=M.wireframeLinewidth,_.linewidth=M.linewidth,A.isPointLight===!0&&_.isMeshDistanceMaterial===!0&&(_.referencePosition.setFromMatrixPosition(A.matrixWorld),_.nearDistance=E,_.farDistance=N),_}function x(w,b,M,A,E){if(w.visible===!1)return;if(w.layers.test(b.layers)&&(w.isMesh||w.isLine||w.isPoints)&&(w.castShadow||w.receiveShadow&&E===Ko)&&(!w.frustumCulled||n.intersectsObject(w))){w.modelViewMatrix.multiplyMatrices(M.matrixWorldInverse,w.matrixWorld);const _=e.update(w),S=w.material;if(Array.isArray(S)){const L=_.groups;for(let k=0,H=L.length;k<H;k++){const O=L[k],T=S[O.materialIndex];if(T&&T.visible){const V=v(w,_,T,A,M.near,M.far,E);r.renderBufferDirect(M,null,_,V,w,O)}}}else if(S.visible){const L=v(w,_,S,A,M.near,M.far,E);r.renderBufferDirect(M,null,_,L,w,null)}}const R=w.children;for(let _=0,S=R.length;_<S;_++)x(R[_],b,M,A,E)}}function i3(r,e,t){const n=t.isWebGL2;function i(){let oe=!1;const Ie=new At;let Pe=null;const Qe=new At(0,0,0,0);return{setMask:function(Ge){Pe!==Ge&&!oe&&(r.colorMask(Ge,Ge,Ge,Ge),Pe=Ge)},setLocked:function(Ge){oe=Ge},setClear:function(Ge,We,Fe,I,re){re===!0&&(Ge*=I,We*=I,Fe*=I),Ie.set(Ge,We,Fe,I),Qe.equals(Ie)===!1&&(r.clearColor(Ge,We,Fe,I),Qe.copy(Ie))},reset:function(){oe=!1,Pe=null,Qe.set(-1,0,0,0)}}}function s(){let oe=!1,Ie=null,Pe=null,Qe=null;return{setTest:function(Ge){Ge?z(2929):K(2929)},setMask:function(Ge){Ie!==Ge&&!oe&&(r.depthMask(Ge),Ie=Ge)},setFunc:function(Ge){if(Pe!==Ge){if(Ge)switch(Ge){case iy:r.depthFunc(512);break;case sy:r.depthFunc(519);break;case oy:r.depthFunc(513);break;case xu:r.depthFunc(515);break;case ay:r.depthFunc(514);break;case ly:r.depthFunc(518);break;case cy:r.depthFunc(516);break;case uy:r.depthFunc(517);break;default:r.depthFunc(515)}else r.depthFunc(515);Pe=Ge}},setLocked:function(Ge){oe=Ge},setClear:function(Ge){Qe!==Ge&&(r.clearDepth(Ge),Qe=Ge)},reset:function(){oe=!1,Ie=null,Pe=null,Qe=null}}}function o(){let oe=!1,Ie=null,Pe=null,Qe=null,Ge=null,We=null,Fe=null,I=null,re=null;return{setTest:function(ve){oe||(ve?z(2960):K(2960))},setMask:function(ve){Ie!==ve&&!oe&&(r.stencilMask(ve),Ie=ve)},setFunc:function(ve,Be,Ze){(Pe!==ve||Qe!==Be||Ge!==Ze)&&(r.stencilFunc(ve,Be,Ze),Pe=ve,Qe=Be,Ge=Ze)},setOp:function(ve,Be,Ze){(We!==ve||Fe!==Be||I!==Ze)&&(r.stencilOp(ve,Be,Ze),We=ve,Fe=Be,I=Ze)},setLocked:function(ve){oe=ve},setClear:function(ve){re!==ve&&(r.clearStencil(ve),re=ve)},reset:function(){oe=!1,Ie=null,Pe=null,Qe=null,Ge=null,We=null,Fe=null,I=null,re=null}}}const a=new i,l=new s,h=new o;let u={},c={},f=null,d=!1,p=null,m=null,y=null,g=null,v=null,x=null,w=null,b=!1,M=null,A=null,E=null,N=null,R=null;const _=r.getParameter(35661);let S=!1,L=0;const k=r.getParameter(7938);k.indexOf("WebGL")!==-1?(L=parseFloat(/^WebGL (\d)/.exec(k)[1]),S=L>=1):k.indexOf("OpenGL ES")!==-1&&(L=parseFloat(/^OpenGL ES (\d)/.exec(k)[1]),S=L>=2);let H=null,O={};const T=r.getParameter(3088),V=r.getParameter(2978),F=new At().fromArray(T),J=new At().fromArray(V);function Y(oe,Ie,Pe){const Qe=new Uint8Array(4),Ge=r.createTexture();r.bindTexture(oe,Ge),r.texParameteri(oe,10241,9728),r.texParameteri(oe,10240,9728);for(let We=0;We<Pe;We++)r.texImage2D(Ie+We,0,6408,1,1,0,6408,5121,Qe);return Ge}const te={};te[3553]=Y(3553,3553,1),te[34067]=Y(34067,34069,6),a.setClear(0,0,0,1),l.setClear(1),h.setClear(0),z(2929),l.setFunc(xu),xe(!1),pe(jd),z(2884),se(Un);function z(oe){u[oe]!==!0&&(r.enable(oe),u[oe]=!0)}function K(oe){u[oe]!==!1&&(r.disable(oe),u[oe]=!1)}function Z(oe,Ie){return c[oe]!==Ie?(r.bindFramebuffer(oe,Ie),c[oe]=Ie,n&&(oe===36009&&(c[36160]=Ie),oe===36160&&(c[36009]=Ie)),!0):!1}function Q(oe){return f!==oe?(r.useProgram(oe),f=oe,!0):!1}const me={[Ks]:32774,[X0]:32778,[Q0]:32779};if(n)me[tp]=32775,me[np]=32776;else{const oe=e.get("EXT_blend_minmax");oe!==null&&(me[tp]=oe.MIN_EXT,me[np]=oe.MAX_EXT)}const ge={[j0]:0,[Z0]:1,[J0]:768,[rp]:770,[ry]:776,[ty]:774,[$0]:772,[K0]:769,[ip]:771,[ny]:775,[ey]:773};function se(oe,Ie,Pe,Qe,Ge,We,Fe,I){if(oe===Un){d===!0&&(K(3042),d=!1);return}if(d===!1&&(z(3042),d=!0),oe!==Y0){if(oe!==p||I!==b){if((m!==Ks||v!==Ks)&&(r.blendEquation(32774),m=Ks,v=Ks),I)switch(oe){case $o:r.blendFuncSeparate(1,771,1,771);break;case Kd:r.blendFunc(1,1);break;case $d:r.blendFuncSeparate(0,0,769,771);break;case ep:r.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",oe);break}else switch(oe){case $o:r.blendFuncSeparate(770,771,1,771);break;case Kd:r.blendFunc(770,1);break;case $d:r.blendFunc(0,769);break;case ep:r.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",oe);break}y=null,g=null,x=null,w=null,p=oe,b=I}return}Ge=Ge||Ie,We=We||Pe,Fe=Fe||Qe,(Ie!==m||Ge!==v)&&(r.blendEquationSeparate(me[Ie],me[Ge]),m=Ie,v=Ge),(Pe!==y||Qe!==g||We!==x||Fe!==w)&&(r.blendFuncSeparate(ge[Pe],ge[Qe],ge[We],ge[Fe]),y=Pe,g=Qe,x=We,w=Fe),p=oe,b=null}function he(oe,Ie){oe.side===mr?K(2884):z(2884);let Pe=oe.side===zt;Ie&&(Pe=!Pe),xe(Pe),oe.blending===$o&&oe.transparent===!1?se(Un):se(oe.blending,oe.blendEquation,oe.blendSrc,oe.blendDst,oe.blendEquationAlpha,oe.blendSrcAlpha,oe.blendDstAlpha,oe.premultipliedAlpha),l.setFunc(oe.depthFunc),l.setTest(oe.depthTest),l.setMask(oe.depthWrite),a.setMask(oe.colorWrite);const Qe=oe.stencilWrite;h.setTest(Qe),Qe&&(h.setMask(oe.stencilWriteMask),h.setFunc(oe.stencilFunc,oe.stencilRef,oe.stencilFuncMask),h.setOp(oe.stencilFail,oe.stencilZFail,oe.stencilZPass)),q(oe.polygonOffset,oe.polygonOffsetFactor,oe.polygonOffsetUnits),oe.alphaToCoverage===!0?z(32926):K(32926)}function xe(oe){M!==oe&&(oe?r.frontFace(2304):r.frontFace(2305),M=oe)}function pe(oe){oe!==V0?(z(2884),oe!==A&&(oe===jd?r.cullFace(1029):oe===W0?r.cullFace(1028):r.cullFace(1032))):K(2884),A=oe}function G(oe){oe!==E&&(S&&r.lineWidth(oe),E=oe)}function q(oe,Ie,Pe){oe?(z(32823),(N!==Ie||R!==Pe)&&(r.polygonOffset(Ie,Pe),N=Ie,R=Pe)):K(32823)}function B(oe){oe?z(3089):K(3089)}function D(oe){oe===void 0&&(oe=33984+_-1),H!==oe&&(r.activeTexture(oe),H=oe)}function $(oe,Ie){H===null&&D();let Pe=O[H];Pe===void 0&&(Pe={type:void 0,texture:void 0},O[H]=Pe),(Pe.type!==oe||Pe.texture!==Ie)&&(r.bindTexture(oe,Ie||te[oe]),Pe.type=oe,Pe.texture=Ie)}function ne(){const oe=O[H];oe!==void 0&&oe.type!==void 0&&(r.bindTexture(oe.type,null),oe.type=void 0,oe.texture=void 0)}function U(){try{r.compressedTexImage2D.apply(r,arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}}function W(){try{r.texSubImage2D.apply(r,arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}}function P(){try{r.texSubImage3D.apply(r,arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}}function C(){try{r.compressedTexSubImage2D.apply(r,arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}}function ee(){try{r.texStorage2D.apply(r,arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}}function ae(){try{r.texStorage3D.apply(r,arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}}function le(){try{r.texImage2D.apply(r,arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}}function ce(){try{r.texImage3D.apply(r,arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}}function ye(oe){F.equals(oe)===!1&&(r.scissor(oe.x,oe.y,oe.z,oe.w),F.copy(oe))}function we(oe){J.equals(oe)===!1&&(r.viewport(oe.x,oe.y,oe.z,oe.w),J.copy(oe))}function be(){r.disable(3042),r.disable(2884),r.disable(2929),r.disable(32823),r.disable(3089),r.disable(2960),r.disable(32926),r.blendEquation(32774),r.blendFunc(1,0),r.blendFuncSeparate(1,0,1,0),r.colorMask(!0,!0,!0,!0),r.clearColor(0,0,0,0),r.depthMask(!0),r.depthFunc(513),r.clearDepth(1),r.stencilMask(4294967295),r.stencilFunc(519,0,4294967295),r.stencilOp(7680,7680,7680),r.clearStencil(0),r.cullFace(1029),r.frontFace(2305),r.polygonOffset(0,0),r.activeTexture(33984),r.bindFramebuffer(36160,null),n===!0&&(r.bindFramebuffer(36009,null),r.bindFramebuffer(36008,null)),r.useProgram(null),r.lineWidth(1),r.scissor(0,0,r.canvas.width,r.canvas.height),r.viewport(0,0,r.canvas.width,r.canvas.height),u={},H=null,O={},c={},f=null,d=!1,p=null,m=null,y=null,g=null,v=null,x=null,w=null,b=!1,M=null,A=null,E=null,N=null,R=null,F.set(0,0,r.canvas.width,r.canvas.height),J.set(0,0,r.canvas.width,r.canvas.height),a.reset(),l.reset(),h.reset()}return{buffers:{color:a,depth:l,stencil:h},enable:z,disable:K,bindFramebuffer:Z,useProgram:Q,setBlending:se,setMaterial:he,setFlipSided:xe,setCullFace:pe,setLineWidth:G,setPolygonOffset:q,setScissorTest:B,activeTexture:D,bindTexture:$,unbindTexture:ne,compressedTexImage2D:U,texImage2D:le,texImage3D:ce,texStorage2D:ee,texStorage3D:ae,texSubImage2D:W,texSubImage3D:P,compressedTexSubImage2D:C,scissor:ye,viewport:we,reset:be}}function s3(r,e,t,n,i,s,o){const a=i.isWebGL2,l=i.maxTextures,h=i.maxCubemapSize,u=i.maxTextureSize,c=i.maxSamples,d=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):void 0,p=new WeakMap;let m,y=!1;try{y=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function g(P,C){return y?new OffscreenCanvas(P,C):Bu("canvas")}function v(P,C,ee,ae){let le=1;if((P.width>ae||P.height>ae)&&(le=ae/Math.max(P.width,P.height)),le<1||C===!0)if(typeof HTMLImageElement!="undefined"&&P instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&P instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&P instanceof ImageBitmap){const ce=C?fx:Math.floor,ye=ce(le*P.width),we=ce(le*P.height);m===void 0&&(m=g(ye,we));const be=ee?g(ye,we):m;return be.width=ye,be.height=we,be.getContext("2d").drawImage(P,0,0,ye,we),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+P.width+"x"+P.height+") to ("+ye+"x"+we+")."),be}else return"data"in P&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+P.width+"x"+P.height+")."),P;return P}function x(P){return yp(P.width)&&yp(P.height)}function w(P){return a?!1:P.wrapS!==Mn||P.wrapT!==Mn||P.minFilter!==Ut&&P.minFilter!==ft}function b(P,C){return P.generateMipmaps&&C&&P.minFilter!==Ut&&P.minFilter!==ft}function M(P){r.generateMipmap(P)}function A(P,C,ee,ae){if(a===!1)return C;if(P!==null){if(r[P]!==void 0)return r[P];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+P+"'")}let le=C;return C===6403&&(ee===5126&&(le=33326),ee===5131&&(le=33325),ee===5121&&(le=33321)),C===6407&&(ee===5126&&(le=34837),ee===5131&&(le=34843),ee===5121&&(le=32849)),C===6408&&(ee===5126&&(le=34836),ee===5131&&(le=34842),ee===5121&&(le=ae===Fr?35907:32856)),(le===33325||le===33326||le===34842||le===34836)&&e.get("EXT_color_buffer_float"),le}function E(P,C,ee){return b(P,ee)===!0||P.isFramebufferTexture&&P.minFilter!==Ut&&P.minFilter!==ft?Math.log2(Math.max(C.width,C.height))+1:P.mipmaps!==void 0&&P.mipmaps.length>0?P.mipmaps.length:P.isCompressedTexture&&Array.isArray(P.image)?C.mipmaps.length:1}function N(P){return P===Ut||P===Pl||P===Bl?9728:9729}function R(P){const C=P.target;C.removeEventListener("dispose",R),S(C),C.isVideoTexture&&p.delete(C),o.memory.textures--}function _(P){const C=P.target;C.removeEventListener("dispose",_),L(C)}function S(P){const C=n.get(P);C.__webglInit!==void 0&&(r.deleteTexture(C.__webglTexture),n.remove(P))}function L(P){const C=P.texture,ee=n.get(P),ae=n.get(C);if(!!P){if(ae.__webglTexture!==void 0&&(r.deleteTexture(ae.__webglTexture),o.memory.textures--),P.depthTexture&&P.depthTexture.dispose(),P.isWebGLCubeRenderTarget)for(let le=0;le<6;le++)r.deleteFramebuffer(ee.__webglFramebuffer[le]),ee.__webglDepthbuffer&&r.deleteRenderbuffer(ee.__webglDepthbuffer[le]);else r.deleteFramebuffer(ee.__webglFramebuffer),ee.__webglDepthbuffer&&r.deleteRenderbuffer(ee.__webglDepthbuffer),ee.__webglMultisampledFramebuffer&&r.deleteFramebuffer(ee.__webglMultisampledFramebuffer),ee.__webglColorRenderbuffer&&r.deleteRenderbuffer(ee.__webglColorRenderbuffer),ee.__webglDepthRenderbuffer&&r.deleteRenderbuffer(ee.__webglDepthRenderbuffer);if(P.isWebGLMultipleRenderTargets)for(let le=0,ce=C.length;le<ce;le++){const ye=n.get(C[le]);ye.__webglTexture&&(r.deleteTexture(ye.__webglTexture),o.memory.textures--),n.remove(C[le])}n.remove(C),n.remove(P)}}let k=0;function H(){k=0}function O(){const P=k;return P>=l&&console.warn("THREE.WebGLTextures: Trying to use "+P+" texture units while this GPU supports only "+l),k+=1,P}function T(P,C){const ee=n.get(P);if(P.isVideoTexture&&D(P),P.version>0&&ee.__version!==P.version){const ae=P.image;if(ae===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(ae.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Z(ee,P,C);return}}t.activeTexture(33984+C),t.bindTexture(3553,ee.__webglTexture)}function V(P,C){const ee=n.get(P);if(P.version>0&&ee.__version!==P.version){Z(ee,P,C);return}t.activeTexture(33984+C),t.bindTexture(35866,ee.__webglTexture)}function F(P,C){const ee=n.get(P);if(P.version>0&&ee.__version!==P.version){Z(ee,P,C);return}t.activeTexture(33984+C),t.bindTexture(32879,ee.__webglTexture)}function J(P,C){const ee=n.get(P);if(P.version>0&&ee.__version!==P.version){Q(ee,P,C);return}t.activeTexture(33984+C),t.bindTexture(34067,ee.__webglTexture)}const Y={[Ri]:10497,[Mn]:33071,[ta]:33648},te={[Ut]:9728,[Pl]:9984,[Bl]:9986,[ft]:9729,[bu]:9985,[ti]:9987};function z(P,C,ee){if(ee?(r.texParameteri(P,10242,Y[C.wrapS]),r.texParameteri(P,10243,Y[C.wrapT]),(P===32879||P===35866)&&r.texParameteri(P,32882,Y[C.wrapR]),r.texParameteri(P,10240,te[C.magFilter]),r.texParameteri(P,10241,te[C.minFilter])):(r.texParameteri(P,10242,33071),r.texParameteri(P,10243,33071),(P===32879||P===35866)&&r.texParameteri(P,32882,33071),(C.wrapS!==Mn||C.wrapT!==Mn)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),r.texParameteri(P,10240,N(C.magFilter)),r.texParameteri(P,10241,N(C.minFilter)),C.minFilter!==Ut&&C.minFilter!==ft&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){const ae=e.get("EXT_texture_filter_anisotropic");if(C.type===ni&&e.has("OES_texture_float_linear")===!1||a===!1&&C.type===ss&&e.has("OES_texture_half_float_linear")===!1)return;(C.anisotropy>1||n.get(C).__currentAnisotropy)&&(r.texParameterf(P,ae.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(C.anisotropy,i.getMaxAnisotropy())),n.get(C).__currentAnisotropy=C.anisotropy)}}function K(P,C){P.__webglInit===void 0&&(P.__webglInit=!0,C.addEventListener("dispose",R),P.__webglTexture=r.createTexture(),o.memory.textures++)}function Z(P,C,ee){let ae=3553;C.isDataTexture2DArray&&(ae=35866),C.isDataTexture3D&&(ae=32879),K(P,C),t.activeTexture(33984+ee),t.bindTexture(ae,P.__webglTexture),r.pixelStorei(37440,C.flipY),r.pixelStorei(37441,C.premultiplyAlpha),r.pixelStorei(3317,C.unpackAlignment),r.pixelStorei(37443,0);const le=w(C)&&x(C.image)===!1,ce=v(C.image,le,!1,u),ye=x(ce)||a,we=s.convert(C.format);let be=s.convert(C.type),oe=A(C.internalFormat,we,be,C.encoding);z(ae,C,ye);let Ie;const Pe=C.mipmaps,Qe=a&&C.isVideoTexture!==!0,Ge=P.__version===void 0,We=E(C,ce,ye);if(C.isDepthTexture)oe=6402,a?C.type===ni?oe=36012:C.type===ra?oe=33190:C.type===os?oe=35056:oe=33189:C.type===ni&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),C.format===as&&oe===6402&&C.type!==na&&C.type!==ra&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),C.type=na,be=s.convert(C.type)),C.format===ls&&oe===6402&&(oe=34041,C.type!==os&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),C.type=os,be=s.convert(C.type))),Qe&&Ge?t.texStorage2D(3553,1,oe,ce.width,ce.height):t.texImage2D(3553,0,oe,ce.width,ce.height,0,we,be,null);else if(C.isDataTexture)if(Pe.length>0&&ye){Qe&&Ge&&t.texStorage2D(3553,We,oe,Pe[0].width,Pe[0].height);for(let Fe=0,I=Pe.length;Fe<I;Fe++)Ie=Pe[Fe],Qe?t.texSubImage2D(3553,0,0,0,Ie.width,Ie.height,we,be,Ie.data):t.texImage2D(3553,Fe,oe,Ie.width,Ie.height,0,we,be,Ie.data);C.generateMipmaps=!1}else Qe?(Ge&&t.texStorage2D(3553,We,oe,ce.width,ce.height),t.texSubImage2D(3553,0,0,0,ce.width,ce.height,we,be,ce.data)):t.texImage2D(3553,0,oe,ce.width,ce.height,0,we,be,ce.data);else if(C.isCompressedTexture){Qe&&Ge&&t.texStorage2D(3553,We,oe,Pe[0].width,Pe[0].height);for(let Fe=0,I=Pe.length;Fe<I;Fe++)Ie=Pe[Fe],C.format!==Lt&&C.format!==An?we!==null?Qe?t.compressedTexSubImage2D(3553,Fe,0,0,Ie.width,Ie.height,we,Ie.data):t.compressedTexImage2D(3553,Fe,oe,Ie.width,Ie.height,0,Ie.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Qe?t.texSubImage2D(3553,Fe,0,0,Ie.width,Ie.height,we,be,Ie.data):t.texImage2D(3553,Fe,oe,Ie.width,Ie.height,0,we,be,Ie.data)}else if(C.isDataTexture2DArray)Qe?(Ge&&t.texStorage3D(35866,We,oe,ce.width,ce.height,ce.depth),t.texSubImage3D(35866,0,0,0,0,ce.width,ce.height,ce.depth,we,be,ce.data)):t.texImage3D(35866,0,oe,ce.width,ce.height,ce.depth,0,we,be,ce.data);else if(C.isDataTexture3D)Qe?(Ge&&t.texStorage3D(32879,We,oe,ce.width,ce.height,ce.depth),t.texSubImage3D(32879,0,0,0,0,ce.width,ce.height,ce.depth,we,be,ce.data)):t.texImage3D(32879,0,oe,ce.width,ce.height,ce.depth,0,we,be,ce.data);else if(C.isFramebufferTexture)Qe&&Ge?t.texStorage2D(3553,We,oe,ce.width,ce.height):t.texImage2D(3553,0,oe,ce.width,ce.height,0,we,be,null);else if(Pe.length>0&&ye){Qe&&Ge&&t.texStorage2D(3553,We,oe,Pe[0].width,Pe[0].height);for(let Fe=0,I=Pe.length;Fe<I;Fe++)Ie=Pe[Fe],Qe?t.texSubImage2D(3553,Fe,0,0,we,be,Ie):t.texImage2D(3553,Fe,oe,we,be,Ie);C.generateMipmaps=!1}else Qe?(Ge&&t.texStorage2D(3553,We,oe,ce.width,ce.height),t.texSubImage2D(3553,0,0,0,we,be,ce)):t.texImage2D(3553,0,oe,we,be,ce);b(C,ye)&&M(ae),P.__version=C.version,C.onUpdate&&C.onUpdate(C)}function Q(P,C,ee){if(C.image.length!==6)return;K(P,C),t.activeTexture(33984+ee),t.bindTexture(34067,P.__webglTexture),r.pixelStorei(37440,C.flipY),r.pixelStorei(37441,C.premultiplyAlpha),r.pixelStorei(3317,C.unpackAlignment),r.pixelStorei(37443,0);const ae=C&&(C.isCompressedTexture||C.image[0].isCompressedTexture),le=C.image[0]&&C.image[0].isDataTexture,ce=[];for(let Fe=0;Fe<6;Fe++)!ae&&!le?ce[Fe]=v(C.image[Fe],!1,!0,h):ce[Fe]=le?C.image[Fe].image:C.image[Fe];const ye=ce[0],we=x(ye)||a,be=s.convert(C.format),oe=s.convert(C.type),Ie=A(C.internalFormat,be,oe,C.encoding),Pe=a&&C.isVideoTexture!==!0,Qe=P.__version===void 0;let Ge=E(C,ye,we);z(34067,C,we);let We;if(ae){Pe&&Qe&&t.texStorage2D(34067,Ge,Ie,ye.width,ye.height);for(let Fe=0;Fe<6;Fe++){We=ce[Fe].mipmaps;for(let I=0;I<We.length;I++){const re=We[I];C.format!==Lt&&C.format!==An?be!==null?Pe?t.compressedTexSubImage2D(34069+Fe,I,0,0,re.width,re.height,be,re.data):t.compressedTexImage2D(34069+Fe,I,Ie,re.width,re.height,0,re.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Pe?t.texSubImage2D(34069+Fe,I,0,0,re.width,re.height,be,oe,re.data):t.texImage2D(34069+Fe,I,Ie,re.width,re.height,0,be,oe,re.data)}}}else{We=C.mipmaps,Pe&&Qe&&(We.length>0&&Ge++,t.texStorage2D(34067,Ge,Ie,ce[0].width,ce[0].height));for(let Fe=0;Fe<6;Fe++)if(le){Pe?t.texSubImage2D(34069+Fe,0,0,0,ce[Fe].width,ce[Fe].height,be,oe,ce[Fe].data):t.texImage2D(34069+Fe,0,Ie,ce[Fe].width,ce[Fe].height,0,be,oe,ce[Fe].data);for(let I=0;I<We.length;I++){const ve=We[I].image[Fe].image;Pe?t.texSubImage2D(34069+Fe,I+1,0,0,ve.width,ve.height,be,oe,ve.data):t.texImage2D(34069+Fe,I+1,Ie,ve.width,ve.height,0,be,oe,ve.data)}}else{Pe?t.texSubImage2D(34069+Fe,0,0,0,be,oe,ce[Fe]):t.texImage2D(34069+Fe,0,Ie,be,oe,ce[Fe]);for(let I=0;I<We.length;I++){const re=We[I];Pe?t.texSubImage2D(34069+Fe,I+1,0,0,be,oe,re.image[Fe]):t.texImage2D(34069+Fe,I+1,Ie,be,oe,re.image[Fe])}}}b(C,we)&&M(34067),P.__version=C.version,C.onUpdate&&C.onUpdate(C)}function me(P,C,ee,ae,le){const ce=s.convert(ee.format),ye=s.convert(ee.type),we=A(ee.internalFormat,ce,ye,ee.encoding);n.get(C).__hasExternalTextures||(le===32879||le===35866?t.texImage3D(le,0,we,C.width,C.height,C.depth,0,ce,ye,null):t.texImage2D(le,0,we,C.width,C.height,0,ce,ye,null)),t.bindFramebuffer(36160,P),C.useRenderToTexture?d.framebufferTexture2DMultisampleEXT(36160,ae,le,n.get(ee).__webglTexture,0,B(C)):r.framebufferTexture2D(36160,ae,le,n.get(ee).__webglTexture,0),t.bindFramebuffer(36160,null)}function ge(P,C,ee){if(r.bindRenderbuffer(36161,P),C.depthBuffer&&!C.stencilBuffer){let ae=33189;if(ee||C.useRenderToTexture){const le=C.depthTexture;le&&le.isDepthTexture&&(le.type===ni?ae=36012:le.type===ra&&(ae=33190));const ce=B(C);C.useRenderToTexture?d.renderbufferStorageMultisampleEXT(36161,ce,ae,C.width,C.height):r.renderbufferStorageMultisample(36161,ce,ae,C.width,C.height)}else r.renderbufferStorage(36161,ae,C.width,C.height);r.framebufferRenderbuffer(36160,36096,36161,P)}else if(C.depthBuffer&&C.stencilBuffer){const ae=B(C);ee&&C.useRenderbuffer?r.renderbufferStorageMultisample(36161,ae,35056,C.width,C.height):C.useRenderToTexture?d.renderbufferStorageMultisampleEXT(36161,ae,35056,C.width,C.height):r.renderbufferStorage(36161,34041,C.width,C.height),r.framebufferRenderbuffer(36160,33306,36161,P)}else{const ae=C.isWebGLMultipleRenderTargets===!0?C.texture[0]:C.texture,le=s.convert(ae.format),ce=s.convert(ae.type),ye=A(ae.internalFormat,le,ce,ae.encoding),we=B(C);ee&&C.useRenderbuffer?r.renderbufferStorageMultisample(36161,we,ye,C.width,C.height):C.useRenderToTexture?d.renderbufferStorageMultisampleEXT(36161,we,ye,C.width,C.height):r.renderbufferStorage(36161,ye,C.width,C.height)}r.bindRenderbuffer(36161,null)}function se(P,C){if(C&&C.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,P),!(C.depthTexture&&C.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(C.depthTexture).__webglTexture||C.depthTexture.image.width!==C.width||C.depthTexture.image.height!==C.height)&&(C.depthTexture.image.width=C.width,C.depthTexture.image.height=C.height,C.depthTexture.needsUpdate=!0),T(C.depthTexture,0);const ae=n.get(C.depthTexture).__webglTexture,le=B(C);if(C.depthTexture.format===as)C.useRenderToTexture?d.framebufferTexture2DMultisampleEXT(36160,36096,3553,ae,0,le):r.framebufferTexture2D(36160,36096,3553,ae,0);else if(C.depthTexture.format===ls)C.useRenderToTexture?d.framebufferTexture2DMultisampleEXT(36160,33306,3553,ae,0,le):r.framebufferTexture2D(36160,33306,3553,ae,0);else throw new Error("Unknown depthTexture format")}function he(P){const C=n.get(P),ee=P.isWebGLCubeRenderTarget===!0;if(P.depthTexture&&!C.__autoAllocateDepthBuffer){if(ee)throw new Error("target.depthTexture not supported in Cube render targets");se(C.__webglFramebuffer,P)}else if(ee){C.__webglDepthbuffer=[];for(let ae=0;ae<6;ae++)t.bindFramebuffer(36160,C.__webglFramebuffer[ae]),C.__webglDepthbuffer[ae]=r.createRenderbuffer(),ge(C.__webglDepthbuffer[ae],P,!1)}else t.bindFramebuffer(36160,C.__webglFramebuffer),C.__webglDepthbuffer=r.createRenderbuffer(),ge(C.__webglDepthbuffer,P,!1);t.bindFramebuffer(36160,null)}function xe(P,C,ee){const ae=n.get(P);C!==void 0&&me(ae.__webglFramebuffer,P,P.texture,36064,3553),ee!==void 0&&he(P)}function pe(P){const C=P.texture,ee=n.get(P),ae=n.get(C);P.addEventListener("dispose",_),P.isWebGLMultipleRenderTargets!==!0&&(ae.__webglTexture===void 0&&(ae.__webglTexture=r.createTexture()),ae.__version=C.version,o.memory.textures++);const le=P.isWebGLCubeRenderTarget===!0,ce=P.isWebGLMultipleRenderTargets===!0,ye=C.isDataTexture3D||C.isDataTexture2DArray,we=x(P)||a;if(a&&C.format===An&&(C.type===ni||C.type===ss)&&(C.format=Lt,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),le){ee.__webglFramebuffer=[];for(let be=0;be<6;be++)ee.__webglFramebuffer[be]=r.createFramebuffer()}else if(ee.__webglFramebuffer=r.createFramebuffer(),ce)if(i.drawBuffers){const be=P.texture;for(let oe=0,Ie=be.length;oe<Ie;oe++){const Pe=n.get(be[oe]);Pe.__webglTexture===void 0&&(Pe.__webglTexture=r.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(P.useRenderbuffer)if(a){ee.__webglMultisampledFramebuffer=r.createFramebuffer(),ee.__webglColorRenderbuffer=r.createRenderbuffer(),r.bindRenderbuffer(36161,ee.__webglColorRenderbuffer);const be=s.convert(C.format),oe=s.convert(C.type),Ie=A(C.internalFormat,be,oe,C.encoding),Pe=B(P);r.renderbufferStorageMultisample(36161,Pe,Ie,P.width,P.height),t.bindFramebuffer(36160,ee.__webglMultisampledFramebuffer),r.framebufferRenderbuffer(36160,36064,36161,ee.__webglColorRenderbuffer),r.bindRenderbuffer(36161,null),P.depthBuffer&&(ee.__webglDepthRenderbuffer=r.createRenderbuffer(),ge(ee.__webglDepthRenderbuffer,P,!0)),t.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(le){t.bindTexture(34067,ae.__webglTexture),z(34067,C,we);for(let be=0;be<6;be++)me(ee.__webglFramebuffer[be],P,C,36064,34069+be);b(C,we)&&M(34067),t.unbindTexture()}else if(ce){const be=P.texture;for(let oe=0,Ie=be.length;oe<Ie;oe++){const Pe=be[oe],Qe=n.get(Pe);t.bindTexture(3553,Qe.__webglTexture),z(3553,Pe,we),me(ee.__webglFramebuffer,P,Pe,36064+oe,3553),b(Pe,we)&&M(3553)}t.unbindTexture()}else{let be=3553;ye&&(a?be=C.isDataTexture3D?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),t.bindTexture(be,ae.__webglTexture),z(be,C,we),me(ee.__webglFramebuffer,P,C,36064,be),b(C,we)&&M(be),t.unbindTexture()}P.depthBuffer&&he(P)}function G(P){const C=x(P)||a,ee=P.isWebGLMultipleRenderTargets===!0?P.texture:[P.texture];for(let ae=0,le=ee.length;ae<le;ae++){const ce=ee[ae];if(b(ce,C)){const ye=P.isWebGLCubeRenderTarget?34067:3553,we=n.get(ce).__webglTexture;t.bindTexture(ye,we),M(ye),t.unbindTexture()}}}function q(P){if(P.useRenderbuffer)if(a){const C=P.width,ee=P.height;let ae=16384;const le=[36064],ce=P.stencilBuffer?33306:36096;P.depthBuffer&&le.push(ce),P.ignoreDepthForMultisampleCopy||(P.depthBuffer&&(ae|=256),P.stencilBuffer&&(ae|=1024));const ye=n.get(P);t.bindFramebuffer(36008,ye.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,ye.__webglFramebuffer),P.ignoreDepthForMultisampleCopy&&(r.invalidateFramebuffer(36008,[ce]),r.invalidateFramebuffer(36009,[ce])),r.blitFramebuffer(0,0,C,ee,0,0,C,ee,ae,9728),r.invalidateFramebuffer(36008,le),t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,ye.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}function B(P){return a&&(P.useRenderbuffer||P.useRenderToTexture)?Math.min(c,P.samples):0}function D(P){const C=o.render.frame;p.get(P)!==C&&(p.set(P,C),P.update())}let $=!1,ne=!1;function U(P,C){P&&P.isWebGLRenderTarget&&($===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),$=!0),P=P.texture),T(P,C)}function W(P,C){P&&P.isWebGLCubeRenderTarget&&(ne===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),ne=!0),P=P.texture),J(P,C)}this.allocateTextureUnit=O,this.resetTextureUnits=H,this.setTexture2D=T,this.setTexture2DArray=V,this.setTexture3D=F,this.setTextureCube=J,this.rebindTextures=xe,this.setupRenderTarget=pe,this.updateRenderTargetMipmap=G,this.updateMultisampleRenderTarget=q,this.setupDepthRenderbuffer=he,this.setupFrameBufferTexture=me,this.safeSetTexture2D=U,this.safeSetTextureCube=W}function mw(r,e,t){const n=t.isWebGL2;function i(s){let o;if(s===pn)return 5121;if(s===by)return 32819;if(s===My)return 32820;if(s===Ay)return 33635;if(s===yy)return 5120;if(s===xy)return 5122;if(s===na)return 5123;if(s===wy)return 5124;if(s===ra)return 5125;if(s===ni)return 5126;if(s===ss)return n?5131:(o=e.get("OES_texture_half_float"),o!==null?o.HALF_FLOAT_OES:null);if(s===Sy)return 6406;if(s===An)return 6407;if(s===Lt)return 6408;if(s===Ll)return 6409;if(s===Ey)return 6410;if(s===as)return 6402;if(s===ls)return 34041;if(s===sp)return 6403;if(s===_y)return 36244;if(s===op)return 33319;if(s===Ty)return 33320;if(s===Cy)return 36248;if(s===Ry)return 36249;if(s===Mu||s===ap||s===lp||s===Au)if(o=e.get("WEBGL_compressed_texture_s3tc"),o!==null){if(s===Mu)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===ap)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===lp)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===Au)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===Su||s===cp||s===Eu||s===up)if(o=e.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(s===Su)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===cp)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===Eu)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===up)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===hp)return o=e.get("WEBGL_compressed_texture_etc1"),o!==null?o.COMPRESSED_RGB_ETC1_WEBGL:null;if((s===_u||s===Tu)&&(o=e.get("WEBGL_compressed_texture_etc"),o!==null)){if(s===_u)return o.COMPRESSED_RGB8_ETC2;if(s===Tu)return o.COMPRESSED_RGBA8_ETC2_EAC}if(s===fp||s===Ny||s===Iy||s===Py||s===By||s===Ly||s===Dy||s===Fy||s===Oy||s===zy||s===Uy||s===Hy||s===Gy||s===ky||s===Vy||s===Wy||s===qy||s===Yy||s===Xy||s===Qy||s===jy||s===Zy||s===Jy||s===Ky||s===$y||s===ex||s===tx||s===nx)return o=e.get("WEBGL_compressed_texture_astc"),o!==null?s:null;if(s===dp)return o=e.get("EXT_texture_compression_bptc"),o!==null?s:null;if(s===os)return n?34042:(o=e.get("WEBGL_depth_texture"),o!==null?o.UNSIGNED_INT_24_8_WEBGL:null)}return{convert:i}}class Qp extends ln{constructor(e=[]){super();this.cameras=e}}Qp.prototype.isArrayCamera=!0;class si extends dt{constructor(){super();this.type="Group"}}si.prototype.isGroup=!0;const o3={type:"move"};class jp{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new si,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new si,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new X,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new X),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new si,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new X,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new X),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let i=null,s=null,o=null;const a=this._targetRay,l=this._grip,h=this._hand;if(e&&t.session.visibilityState!=="visible-blurred")if(a!==null&&(i=t.getPose(e.targetRaySpace,n),i!==null&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(o3))),h&&e.hand){o=!0;for(const m of e.hand.values()){const y=t.getJointPose(m,n);if(h.joints[m.jointName]===void 0){const v=new si;v.matrixAutoUpdate=!1,v.visible=!1,h.joints[m.jointName]=v,h.add(v)}const g=h.joints[m.jointName];y!==null&&(g.matrix.fromArray(y.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),g.jointRadius=y.radius),g.visible=y!==null}const u=h.joints["index-finger-tip"],c=h.joints["thumb-tip"],f=u.position.distanceTo(c.position),d=.02,p=.005;h.inputState.pinching&&f>d+p?(h.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!h.inputState.pinching&&f<=d-p&&(h.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,n),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));return a!==null&&(a.visible=i!==null),l!==null&&(l.visible=s!==null),h!==null&&(h.visible=o!==null),this}}class Yl extends Qt{constructor(e,t,n,i,s,o,a,l,h,u){if(u=u!==void 0?u:as,u!==as&&u!==ls)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&u===as&&(n=na),n===void 0&&u===ls&&(n=os);super(null,i,s,o,a,l,u,n,h);this.image={width:e,height:t},this.magFilter=a!==void 0?a:Ut,this.minFilter=l!==void 0?l:Ut,this.flipY=!1,this.generateMipmaps=!1}}Yl.prototype.isDepthTexture=!0;class a3 extends ri{constructor(e,t){super();const n=this;let i=null,s=1,o=null,a="local-floor";const l=e.extensions.has("WEBGL_multisampled_render_to_texture");let h=null,u=null,c=null,f=null,d=!1,p=null;const m=t.getContextAttributes();let y=null,g=null;const v=[],x=new Map,w=new ln;w.layers.enable(1),w.viewport=new At;const b=new ln;b.layers.enable(2),b.viewport=new At;const M=[w,b],A=new Qp;A.layers.enable(1),A.layers.enable(2);let E=null,N=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(J){let Y=v[J];return Y===void 0&&(Y=new jp,v[J]=Y),Y.getTargetRaySpace()},this.getControllerGrip=function(J){let Y=v[J];return Y===void 0&&(Y=new jp,v[J]=Y),Y.getGripSpace()},this.getHand=function(J){let Y=v[J];return Y===void 0&&(Y=new jp,v[J]=Y),Y.getHandSpace()};function R(J){const Y=x.get(J.inputSource);Y&&Y.dispatchEvent({type:J.type,data:J.inputSource})}function _(){x.forEach(function(J,Y){J.disconnect(Y)}),x.clear(),E=null,N=null,e.setRenderTarget(y),f=null,c=null,u=null,i=null,g=null,F.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(J){s=J,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(J){a=J,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return o},this.getBaseLayer=function(){return c!==null?c:f},this.getBinding=function(){return u},this.getFrame=function(){return p},this.getSession=function(){return i},this.setSession=async function(J){if(i=J,i!==null){if(y=e.getRenderTarget(),i.addEventListener("select",R),i.addEventListener("selectstart",R),i.addEventListener("selectend",R),i.addEventListener("squeeze",R),i.addEventListener("squeezestart",R),i.addEventListener("squeezeend",R),i.addEventListener("end",_),i.addEventListener("inputsourceschange",S),m.xrCompatible!==!0&&await t.makeXRCompatible(),i.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const Y={antialias:i.renderState.layers===void 0?m.antialias:!0,alpha:m.alpha,depth:m.depth,stencil:m.stencil,framebufferScaleFactor:s};f=new XRWebGLLayer(i,t,Y),i.updateRenderState({baseLayer:f}),g=new mn(f.framebufferWidth,f.framebufferHeight,{format:Lt,type:pn,encoding:e.outputEncoding})}else{d=m.antialias;let Y=null,te=null,z=null;m.depth&&(z=m.stencil?35056:33190,Y=m.stencil?ls:as,te=m.stencil?os:na);const K={colorFormat:m.alpha||d?32856:32849,depthFormat:z,scaleFactor:s};u=new XRWebGLBinding(i,t),c=u.createProjectionLayer(K),i.updateRenderState({layers:[c]}),d?g=new ca(c.textureWidth,c.textureHeight,{format:Lt,type:pn,depthTexture:new Yl(c.textureWidth,c.textureHeight,te,void 0,void 0,void 0,void 0,void 0,void 0,Y),stencilBuffer:m.stencil,ignoreDepth:c.ignoreDepthValues,useRenderToTexture:l,encoding:e.outputEncoding}):g=new mn(c.textureWidth,c.textureHeight,{format:m.alpha?Lt:An,type:pn,depthTexture:new Yl(c.textureWidth,c.textureHeight,te,void 0,void 0,void 0,void 0,void 0,void 0,Y),stencilBuffer:m.stencil,ignoreDepth:c.ignoreDepthValues,encoding:e.outputEncoding})}this.setFoveation(1),o=await i.requestReferenceSpace(a),F.setContext(i),F.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}};function S(J){const Y=i.inputSources;for(let te=0;te<v.length;te++)x.set(Y[te],v[te]);for(let te=0;te<J.removed.length;te++){const z=J.removed[te],K=x.get(z);K&&(K.dispatchEvent({type:"disconnected",data:z}),x.delete(z))}for(let te=0;te<J.added.length;te++){const z=J.added[te],K=x.get(z);K&&K.dispatchEvent({type:"connected",data:z})}}const L=new X,k=new X;function H(J,Y,te){L.setFromMatrixPosition(Y.matrixWorld),k.setFromMatrixPosition(te.matrixWorld);const z=L.distanceTo(k),K=Y.projectionMatrix.elements,Z=te.projectionMatrix.elements,Q=K[14]/(K[10]-1),me=K[14]/(K[10]+1),ge=(K[9]+1)/K[5],se=(K[9]-1)/K[5],he=(K[8]-1)/K[0],xe=(Z[8]+1)/Z[0],pe=Q*he,G=Q*xe,q=z/(-he+xe),B=q*-he;Y.matrixWorld.decompose(J.position,J.quaternion,J.scale),J.translateX(B),J.translateZ(q),J.matrixWorld.compose(J.position,J.quaternion,J.scale),J.matrixWorldInverse.copy(J.matrixWorld).invert();const D=Q+q,$=me+q,ne=pe-B,U=G+(z-B),W=ge*me/$*D,P=se*me/$*D;J.projectionMatrix.makePerspective(ne,U,W,P,D,$)}function O(J,Y){Y===null?J.matrixWorld.copy(J.matrix):J.matrixWorld.multiplyMatrices(Y.matrixWorld,J.matrix),J.matrixWorldInverse.copy(J.matrixWorld).invert()}this.updateCamera=function(J){if(i===null)return;A.near=b.near=w.near=J.near,A.far=b.far=w.far=J.far,(E!==A.near||N!==A.far)&&(i.updateRenderState({depthNear:A.near,depthFar:A.far}),E=A.near,N=A.far);const Y=J.parent,te=A.cameras;O(A,Y);for(let K=0;K<te.length;K++)O(te[K],Y);A.matrixWorld.decompose(A.position,A.quaternion,A.scale),J.position.copy(A.position),J.quaternion.copy(A.quaternion),J.scale.copy(A.scale),J.matrix.copy(A.matrix),J.matrixWorld.copy(A.matrixWorld);const z=J.children;for(let K=0,Z=z.length;K<Z;K++)z[K].updateMatrixWorld(!0);te.length===2?H(A,w,b):A.projectionMatrix.copy(w.projectionMatrix)},this.getCamera=function(){return A},this.getFoveation=function(){if(c!==null)return c.fixedFoveation;if(f!==null)return f.fixedFoveation},this.setFoveation=function(J){c!==null&&(c.fixedFoveation=J),f!==null&&f.fixedFoveation!==void 0&&(f.fixedFoveation=J)};let T=null;function V(J,Y){if(h=Y.getViewerPose(o),p=Y,h!==null){const z=h.views;f!==null&&(e.setRenderTargetFramebuffer(g,f.framebuffer),e.setRenderTarget(g));let K=!1;z.length!==A.cameras.length&&(A.cameras.length=0,K=!0);for(let Z=0;Z<z.length;Z++){const Q=z[Z];let me=null;if(f!==null)me=f.getViewport(Q);else{const se=u.getViewSubImage(c,Q);me=se.viewport,Z===0&&(e.setRenderTargetTextures(g,se.colorTexture,c.ignoreDepthValues?void 0:se.depthStencilTexture),e.setRenderTarget(g))}const ge=M[Z];ge.matrix.fromArray(Q.transform.matrix),ge.projectionMatrix.fromArray(Q.projectionMatrix),ge.viewport.set(me.x,me.y,me.width,me.height),Z===0&&A.matrix.copy(ge.matrix),K===!0&&A.cameras.push(ge)}}const te=i.inputSources;for(let z=0;z<v.length;z++){const K=v[z],Z=te[z];K.update(Z,Y,o)}T&&T(J,Y),p=null}const F=new Lx;F.setAnimationLoop(V),this.setAnimationLoop=function(J){T=J},this.dispose=function(){}}}function l3(r){function e(g,v){g.fogColor.value.copy(v.color),v.isFog?(g.fogNear.value=v.near,g.fogFar.value=v.far):v.isFogExp2&&(g.fogDensity.value=v.density)}function t(g,v,x,w,b){v.isMeshBasicMaterial?n(g,v):v.isMeshLambertMaterial?(n(g,v),l(g,v)):v.isMeshToonMaterial?(n(g,v),u(g,v)):v.isMeshPhongMaterial?(n(g,v),h(g,v)):v.isMeshStandardMaterial?(n(g,v),v.isMeshPhysicalMaterial?f(g,v,b):c(g,v)):v.isMeshMatcapMaterial?(n(g,v),d(g,v)):v.isMeshDepthMaterial?(n(g,v),p(g,v)):v.isMeshDistanceMaterial?(n(g,v),m(g,v)):v.isMeshNormalMaterial?(n(g,v),y(g,v)):v.isLineBasicMaterial?(i(g,v),v.isLineDashedMaterial&&s(g,v)):v.isPointsMaterial?o(g,v,x,w):v.isSpriteMaterial?a(g,v):v.isShadowMaterial?(g.color.value.copy(v.color),g.opacity.value=v.opacity):v.isShaderMaterial&&(v.uniformsNeedUpdate=!1)}function n(g,v){g.opacity.value=v.opacity,v.color&&g.diffuse.value.copy(v.color),v.emissive&&g.emissive.value.copy(v.emissive).multiplyScalar(v.emissiveIntensity),v.map&&(g.map.value=v.map),v.alphaMap&&(g.alphaMap.value=v.alphaMap),v.specularMap&&(g.specularMap.value=v.specularMap),v.alphaTest>0&&(g.alphaTest.value=v.alphaTest);const x=r.get(v).envMap;x&&(g.envMap.value=x,g.flipEnvMap.value=x.isCubeTexture&&x.isRenderTargetTexture===!1?-1:1,g.reflectivity.value=v.reflectivity,g.ior.value=v.ior,g.refractionRatio.value=v.refractionRatio),v.lightMap&&(g.lightMap.value=v.lightMap,g.lightMapIntensity.value=v.lightMapIntensity),v.aoMap&&(g.aoMap.value=v.aoMap,g.aoMapIntensity.value=v.aoMapIntensity);let w;v.map?w=v.map:v.specularMap?w=v.specularMap:v.displacementMap?w=v.displacementMap:v.normalMap?w=v.normalMap:v.bumpMap?w=v.bumpMap:v.roughnessMap?w=v.roughnessMap:v.metalnessMap?w=v.metalnessMap:v.alphaMap?w=v.alphaMap:v.emissiveMap?w=v.emissiveMap:v.clearcoatMap?w=v.clearcoatMap:v.clearcoatNormalMap?w=v.clearcoatNormalMap:v.clearcoatRoughnessMap?w=v.clearcoatRoughnessMap:v.specularIntensityMap?w=v.specularIntensityMap:v.specularColorMap?w=v.specularColorMap:v.transmissionMap?w=v.transmissionMap:v.thicknessMap?w=v.thicknessMap:v.sheenColorMap?w=v.sheenColorMap:v.sheenRoughnessMap&&(w=v.sheenRoughnessMap),w!==void 0&&(w.isWebGLRenderTarget&&(w=w.texture),w.matrixAutoUpdate===!0&&w.updateMatrix(),g.uvTransform.value.copy(w.matrix));let b;v.aoMap?b=v.aoMap:v.lightMap&&(b=v.lightMap),b!==void 0&&(b.isWebGLRenderTarget&&(b=b.texture),b.matrixAutoUpdate===!0&&b.updateMatrix(),g.uv2Transform.value.copy(b.matrix))}function i(g,v){g.diffuse.value.copy(v.color),g.opacity.value=v.opacity}function s(g,v){g.dashSize.value=v.dashSize,g.totalSize.value=v.dashSize+v.gapSize,g.scale.value=v.scale}function o(g,v,x,w){g.diffuse.value.copy(v.color),g.opacity.value=v.opacity,g.size.value=v.size*x,g.scale.value=w*.5,v.map&&(g.map.value=v.map),v.alphaMap&&(g.alphaMap.value=v.alphaMap),v.alphaTest>0&&(g.alphaTest.value=v.alphaTest);let b;v.map?b=v.map:v.alphaMap&&(b=v.alphaMap),b!==void 0&&(b.matrixAutoUpdate===!0&&b.updateMatrix(),g.uvTransform.value.copy(b.matrix))}function a(g,v){g.diffuse.value.copy(v.color),g.opacity.value=v.opacity,g.rotation.value=v.rotation,v.map&&(g.map.value=v.map),v.alphaMap&&(g.alphaMap.value=v.alphaMap),v.alphaTest>0&&(g.alphaTest.value=v.alphaTest);let x;v.map?x=v.map:v.alphaMap&&(x=v.alphaMap),x!==void 0&&(x.matrixAutoUpdate===!0&&x.updateMatrix(),g.uvTransform.value.copy(x.matrix))}function l(g,v){v.emissiveMap&&(g.emissiveMap.value=v.emissiveMap)}function h(g,v){g.specular.value.copy(v.specular),g.shininess.value=Math.max(v.shininess,1e-4),v.emissiveMap&&(g.emissiveMap.value=v.emissiveMap),v.bumpMap&&(g.bumpMap.value=v.bumpMap,g.bumpScale.value=v.bumpScale,v.side===zt&&(g.bumpScale.value*=-1)),v.normalMap&&(g.normalMap.value=v.normalMap,g.normalScale.value.copy(v.normalScale),v.side===zt&&g.normalScale.value.negate()),v.displacementMap&&(g.displacementMap.value=v.displacementMap,g.displacementScale.value=v.displacementScale,g.displacementBias.value=v.displacementBias)}function u(g,v){v.gradientMap&&(g.gradientMap.value=v.gradientMap),v.emissiveMap&&(g.emissiveMap.value=v.emissiveMap),v.bumpMap&&(g.bumpMap.value=v.bumpMap,g.bumpScale.value=v.bumpScale,v.side===zt&&(g.bumpScale.value*=-1)),v.normalMap&&(g.normalMap.value=v.normalMap,g.normalScale.value.copy(v.normalScale),v.side===zt&&g.normalScale.value.negate()),v.displacementMap&&(g.displacementMap.value=v.displacementMap,g.displacementScale.value=v.displacementScale,g.displacementBias.value=v.displacementBias)}function c(g,v){g.roughness.value=v.roughness,g.metalness.value=v.metalness,v.roughnessMap&&(g.roughnessMap.value=v.roughnessMap),v.metalnessMap&&(g.metalnessMap.value=v.metalnessMap),v.emissiveMap&&(g.emissiveMap.value=v.emissiveMap),v.bumpMap&&(g.bumpMap.value=v.bumpMap,g.bumpScale.value=v.bumpScale,v.side===zt&&(g.bumpScale.value*=-1)),v.normalMap&&(g.normalMap.value=v.normalMap,g.normalScale.value.copy(v.normalScale),v.side===zt&&g.normalScale.value.negate()),v.displacementMap&&(g.displacementMap.value=v.displacementMap,g.displacementScale.value=v.displacementScale,g.displacementBias.value=v.displacementBias),r.get(v).envMap&&(g.envMapIntensity.value=v.envMapIntensity)}function f(g,v,x){c(g,v),g.ior.value=v.ior,v.sheen>0&&(g.sheenColor.value.copy(v.sheenColor).multiplyScalar(v.sheen),g.sheenRoughness.value=v.sheenRoughness,v.sheenColorMap&&(g.sheenColorMap.value=v.sheenColorMap),v.sheenRoughnessMap&&(g.sheenRoughnessMap.value=v.sheenRoughnessMap)),v.clearcoat>0&&(g.clearcoat.value=v.clearcoat,g.clearcoatRoughness.value=v.clearcoatRoughness,v.clearcoatMap&&(g.clearcoatMap.value=v.clearcoatMap),v.clearcoatRoughnessMap&&(g.clearcoatRoughnessMap.value=v.clearcoatRoughnessMap),v.clearcoatNormalMap&&(g.clearcoatNormalScale.value.copy(v.clearcoatNormalScale),g.clearcoatNormalMap.value=v.clearcoatNormalMap,v.side===zt&&g.clearcoatNormalScale.value.negate())),v.transmission>0&&(g.transmission.value=v.transmission,g.transmissionSamplerMap.value=x.texture,g.transmissionSamplerSize.value.set(x.width,x.height),v.transmissionMap&&(g.transmissionMap.value=v.transmissionMap),g.thickness.value=v.thickness,v.thicknessMap&&(g.thicknessMap.value=v.thicknessMap),g.attenuationDistance.value=v.attenuationDistance,g.attenuationColor.value.copy(v.attenuationColor)),g.specularIntensity.value=v.specularIntensity,g.specularColor.value.copy(v.specularColor),v.specularIntensityMap&&(g.specularIntensityMap.value=v.specularIntensityMap),v.specularColorMap&&(g.specularColorMap.value=v.specularColorMap)}function d(g,v){v.matcap&&(g.matcap.value=v.matcap),v.bumpMap&&(g.bumpMap.value=v.bumpMap,g.bumpScale.value=v.bumpScale,v.side===zt&&(g.bumpScale.value*=-1)),v.normalMap&&(g.normalMap.value=v.normalMap,g.normalScale.value.copy(v.normalScale),v.side===zt&&g.normalScale.value.negate()),v.displacementMap&&(g.displacementMap.value=v.displacementMap,g.displacementScale.value=v.displacementScale,g.displacementBias.value=v.displacementBias)}function p(g,v){v.displacementMap&&(g.displacementMap.value=v.displacementMap,g.displacementScale.value=v.displacementScale,g.displacementBias.value=v.displacementBias)}function m(g,v){v.displacementMap&&(g.displacementMap.value=v.displacementMap,g.displacementScale.value=v.displacementScale,g.displacementBias.value=v.displacementBias),g.referencePosition.value.copy(v.referencePosition),g.nearDistance.value=v.nearDistance,g.farDistance.value=v.farDistance}function y(g,v){v.bumpMap&&(g.bumpMap.value=v.bumpMap,g.bumpScale.value=v.bumpScale,v.side===zt&&(g.bumpScale.value*=-1)),v.normalMap&&(g.normalMap.value=v.normalMap,g.normalScale.value.copy(v.normalScale),v.side===zt&&g.normalScale.value.negate()),v.displacementMap&&(g.displacementMap.value=v.displacementMap,g.displacementScale.value=v.displacementScale,g.displacementBias.value=v.displacementBias)}return{refreshFogUniforms:e,refreshMaterialUniforms:t}}function c3(){const r=Bu("canvas");return r.style.display="block",r}function Nt(r={}){const e=r.canvas!==void 0?r.canvas:c3(),t=r.context!==void 0?r.context:null,n=r.alpha!==void 0?r.alpha:!1,i=r.depth!==void 0?r.depth:!0,s=r.stencil!==void 0?r.stencil:!0,o=r.antialias!==void 0?r.antialias:!1,a=r.premultipliedAlpha!==void 0?r.premultipliedAlpha:!0,l=r.preserveDrawingBuffer!==void 0?r.preserveDrawingBuffer:!1,h=r.powerPreference!==void 0?r.powerPreference:"default",u=r.failIfMajorPerformanceCaveat!==void 0?r.failIfMajorPerformanceCaveat:!1;let c=null,f=null;const d=[],p=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=gr,this.physicallyCorrectLights=!1,this.toneMapping=Ci,this.toneMappingExposure=1;const m=this;let y=!1,g=0,v=0,x=null,w=-1,b=null;const M=new At,A=new At;let E=null,N=e.width,R=e.height,_=1,S=null,L=null;const k=new At(0,0,N,R),H=new At(0,0,N,R);let O=!1;const T=[],V=new Vl;let F=!1,J=!1,Y=null;const te=new Ye,z=new X,K={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Z(){return x===null?_:1}let Q=t;function me(j,ue){for(let fe=0;fe<j.length;fe++){const de=j[fe],ie=e.getContext(de,ue);if(ie!==null)return ie}return null}try{const j={alpha:n,depth:i,stencil:s,antialias:o,premultipliedAlpha:a,preserveDrawingBuffer:l,powerPreference:h,failIfMajorPerformanceCaveat:u};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${yu}`),e.addEventListener("webglcontextlost",Qe,!1),e.addEventListener("webglcontextrestored",Ge,!1),Q===null){const ue=["webgl2","webgl","experimental-webgl"];if(m.isWebGL1Renderer===!0&&ue.shift(),Q=me(ue,j),Q===null)throw me(ue)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}Q.getShaderPrecisionFormat===void 0&&(Q.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(j){throw console.error("THREE.WebGLRenderer: "+j.message),j}let ge,se,he,xe,pe,G,q,B,D,$,ne,U,W,P,C,ee,ae,le,ce,ye,we,be,oe;function Ie(){ge=new NR(Q),se=new SR(Q,ge,r),ge.init(se),be=new mw(Q,ge,se),he=new i3(Q,ge,se),T[0]=1029,xe=new BR(Q),pe=new XN,G=new s3(Q,ge,he,pe,se,be,xe),q=new _R(m),B=new RR(m),D=new QT(Q,se),oe=new MR(Q,ge,D,se),$=new IR(Q,D,xe,oe),ne=new OR(Q,$,D,xe),ce=new FR(Q,se,G),ee=new ER(pe),U=new YN(m,q,B,ge,se,oe,ee),W=new l3(pe),P=new jN,C=new t3(ge,se),le=new bR(m,q,he,ne,a),ae=new pw(m,ne,se),ye=new AR(Q,ge,xe,se),we=new PR(Q,ge,xe,se),xe.programs=U.programs,m.capabilities=se,m.extensions=ge,m.properties=pe,m.renderLists=P,m.shadowMap=ae,m.state=he,m.info=xe}Ie();const Pe=new a3(m,Q);this.xr=Pe,this.getContext=function(){return Q},this.getContextAttributes=function(){return Q.getContextAttributes()},this.forceContextLoss=function(){const j=ge.get("WEBGL_lose_context");j&&j.loseContext()},this.forceContextRestore=function(){const j=ge.get("WEBGL_lose_context");j&&j.restoreContext()},this.getPixelRatio=function(){return _},this.setPixelRatio=function(j){j!==void 0&&(_=j,this.setSize(N,R,!1))},this.getSize=function(j){return j.set(N,R)},this.setSize=function(j,ue,fe){if(Pe.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}N=j,R=ue,e.width=Math.floor(j*_),e.height=Math.floor(ue*_),fe!==!1&&(e.style.width=j+"px",e.style.height=ue+"px"),this.setViewport(0,0,j,ue)},this.getDrawingBufferSize=function(j){return j.set(N*_,R*_).floor()},this.setDrawingBufferSize=function(j,ue,fe){N=j,R=ue,_=fe,e.width=Math.floor(j*fe),e.height=Math.floor(ue*fe),this.setViewport(0,0,j,ue)},this.getCurrentViewport=function(j){return j.copy(M)},this.getViewport=function(j){return j.copy(k)},this.setViewport=function(j,ue,fe,de){j.isVector4?k.set(j.x,j.y,j.z,j.w):k.set(j,ue,fe,de),he.viewport(M.copy(k).multiplyScalar(_).floor())},this.getScissor=function(j){return j.copy(H)},this.setScissor=function(j,ue,fe,de){j.isVector4?H.set(j.x,j.y,j.z,j.w):H.set(j,ue,fe,de),he.scissor(A.copy(H).multiplyScalar(_).floor())},this.getScissorTest=function(){return O},this.setScissorTest=function(j){he.setScissorTest(O=j)},this.setOpaqueSort=function(j){S=j},this.setTransparentSort=function(j){L=j},this.getClearColor=function(j){return j.copy(le.getClearColor())},this.setClearColor=function(){le.setClearColor.apply(le,arguments)},this.getClearAlpha=function(){return le.getClearAlpha()},this.setClearAlpha=function(){le.setClearAlpha.apply(le,arguments)},this.clear=function(j,ue,fe){let de=0;(j===void 0||j)&&(de|=16384),(ue===void 0||ue)&&(de|=256),(fe===void 0||fe)&&(de|=1024),Q.clear(de)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",Qe,!1),e.removeEventListener("webglcontextrestored",Ge,!1),P.dispose(),C.dispose(),pe.dispose(),q.dispose(),B.dispose(),ne.dispose(),oe.dispose(),U.dispose(),Pe.dispose(),Pe.removeEventListener("sessionstart",Be),Pe.removeEventListener("sessionend",Ze),Y&&(Y.dispose(),Y=null),Ke.stop()};function Qe(j){j.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),y=!0}function Ge(){console.log("THREE.WebGLRenderer: Context Restored."),y=!1;const j=xe.autoReset,ue=ae.enabled,fe=ae.autoUpdate,de=ae.needsUpdate,ie=ae.type;Ie(),xe.autoReset=j,ae.enabled=ue,ae.autoUpdate=fe,ae.needsUpdate=de,ae.type=ie}function We(j){const ue=j.target;ue.removeEventListener("dispose",We),Fe(ue)}function Fe(j){I(j),pe.remove(j)}function I(j){const ue=pe.get(j).programs;ue!==void 0&&(ue.forEach(function(fe){U.releaseProgram(fe)}),j.isShaderMaterial&&U.releaseShaderCache(j))}this.renderBufferDirect=function(j,ue,fe,de,ie,_e){ue===null&&(ue=K);const Ce=ie.isMesh&&ie.matrixWorld.determinant()<0,Te=Re(j,ue,fe,de,ie);he.setMaterial(de,Ce);let Me=fe.index;const Ee=fe.attributes.position;if(Me===null){if(Ee===void 0||Ee.count===0)return}else if(Me.count===0)return;let Ne=1;de.wireframe===!0&&(Me=$.getWireframeAttribute(fe),Ne=2),oe.setup(ie,de,Te,fe,Me);let Ue,Xe=ye;Me!==null&&(Ue=D.get(Me),Xe=we,Xe.setIndex(Ue));const Oe=Me!==null?Me.count:Ee.count,st=fe.drawRange.start*Ne,qe=fe.drawRange.count*Ne,bt=_e!==null?_e.start*Ne:0,$e=_e!==null?_e.count*Ne:1/0,at=Math.max(st,bt),et=Math.min(Oe,st+qe,bt+$e)-1,$t=Math.max(0,et-at+1);if($t!==0){if(ie.isMesh)de.wireframe===!0?(he.setLineWidth(de.wireframeLinewidth*Z()),Xe.setMode(1)):Xe.setMode(4);else if(ie.isLine){let sn=de.linewidth;sn===void 0&&(sn=1),he.setLineWidth(sn*Z()),ie.isLineSegments?Xe.setMode(1):ie.isLineLoop?Xe.setMode(2):Xe.setMode(3)}else ie.isPoints?Xe.setMode(0):ie.isSprite&&Xe.setMode(4);if(ie.isInstancedMesh)Xe.renderInstances(at,$t,ie.count);else if(fe.isInstancedBufferGeometry){const sn=Math.min(fe.instanceCount,fe._maxInstanceCount);Xe.renderInstances(at,$t,sn)}else Xe.render(at,$t)}},this.compile=function(j,ue){f=C.get(j),f.init(),p.push(f),j.traverseVisible(function(fe){fe.isLight&&fe.layers.test(ue.layers)&&(f.pushLight(fe),fe.castShadow&&f.pushShadow(fe))}),f.setupLights(m.physicallyCorrectLights),j.traverse(function(fe){const de=fe.material;if(de)if(Array.isArray(de))for(let ie=0;ie<de.length;ie++){const _e=de[ie];qt(_e,j,fe)}else qt(de,j,fe)}),p.pop(),f=null};let re=null;function ve(j){re&&re(j)}function Be(){Ke.stop()}function Ze(){Ke.start()}const Ke=new Lx;Ke.setAnimationLoop(ve),typeof window!="undefined"&&Ke.setContext(window),this.setAnimationLoop=function(j){re=j,Pe.setAnimationLoop(j),j===null?Ke.stop():Ke.start()},Pe.addEventListener("sessionstart",Be),Pe.addEventListener("sessionend",Ze),this.render=function(j,ue){if(ue!==void 0&&ue.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(y===!0)return;j.autoUpdate===!0&&j.updateMatrixWorld(),ue.parent===null&&ue.updateMatrixWorld(),Pe.enabled===!0&&Pe.isPresenting===!0&&(Pe.cameraAutoUpdate===!0&&Pe.updateCamera(ue),ue=Pe.getCamera()),j.isScene===!0&&j.onBeforeRender(m,j,ue,x),f=C.get(j,p.length),f.init(),p.push(f),te.multiplyMatrices(ue.projectionMatrix,ue.matrixWorldInverse),V.setFromProjectionMatrix(te),J=this.localClippingEnabled,F=ee.init(this.clippingPlanes,J,ue),c=P.get(j,d.length),c.init(),d.push(c),Ft(j,ue,0,m.sortObjects),c.finish(),m.sortObjects===!0&&c.sort(S,L),F===!0&&ee.beginShadows();const fe=f.state.shadowsArray;if(ae.render(fe,j,ue),F===!0&&ee.endShadows(),this.info.autoReset===!0&&this.info.reset(),le.render(c,j),f.setupLights(m.physicallyCorrectLights),ue.isArrayCamera){const de=ue.cameras;for(let ie=0,_e=de.length;ie<_e;ie++){const Ce=de[ie];tr(c,j,Ce,Ce.viewport)}}else tr(c,j,ue);x!==null&&(G.updateMultisampleRenderTarget(x),G.updateRenderTargetMipmap(x)),j.isScene===!0&&j.onAfterRender(m,j,ue),he.buffers.depth.setTest(!0),he.buffers.depth.setMask(!0),he.buffers.color.setMask(!0),he.setPolygonOffset(!1),oe.resetDefaultState(),w=-1,b=null,p.pop(),p.length>0?f=p[p.length-1]:f=null,d.pop(),d.length>0?c=d[d.length-1]:c=null};function Ft(j,ue,fe,de){if(j.visible===!1)return;if(j.layers.test(ue.layers)){if(j.isGroup)fe=j.renderOrder;else if(j.isLOD)j.autoUpdate===!0&&j.update(ue);else if(j.isLight)f.pushLight(j),j.castShadow&&f.pushShadow(j);else if(j.isSprite){if(!j.frustumCulled||V.intersectsSprite(j)){de&&z.setFromMatrixPosition(j.matrixWorld).applyMatrix4(te);const Ce=ne.update(j),Te=j.material;Te.visible&&c.push(j,Ce,Te,fe,z.z,null)}}else if((j.isMesh||j.isLine||j.isPoints)&&(j.isSkinnedMesh&&j.skeleton.frame!==xe.render.frame&&(j.skeleton.update(),j.skeleton.frame=xe.render.frame),!j.frustumCulled||V.intersectsObject(j))){de&&z.setFromMatrixPosition(j.matrixWorld).applyMatrix4(te);const Ce=ne.update(j),Te=j.material;if(Array.isArray(Te)){const Me=Ce.groups;for(let Ee=0,Ne=Me.length;Ee<Ne;Ee++){const Ue=Me[Ee],Xe=Te[Ue.materialIndex];Xe&&Xe.visible&&c.push(j,Ce,Xe,fe,z.z,Ue)}}else Te.visible&&c.push(j,Ce,Te,fe,z.z,null)}}const _e=j.children;for(let Ce=0,Te=_e.length;Ce<Te;Ce++)Ft(_e[Ce],ue,fe,de)}function tr(j,ue,fe,de){const ie=j.opaque,_e=j.transmissive,Ce=j.transparent;f.setupLightsView(fe),_e.length>0&&Dr(ie,ue,fe),de&&he.viewport(M.copy(de)),ie.length>0&&ur(ie,ue,fe),_e.length>0&&ur(_e,ue,fe),Ce.length>0&&ur(Ce,ue,fe)}function Dr(j,ue,fe){if(Y===null){const Ce=o===!0&&se.isWebGL2===!0?ca:mn;Y=new Ce(1024,1024,{generateMipmaps:!0,type:be.convert(ss)!==null?ss:pn,minFilter:ti,magFilter:Ut,wrapS:Mn,wrapT:Mn,useRenderToTexture:ge.has("WEBGL_multisampled_render_to_texture")})}const de=m.getRenderTarget();m.setRenderTarget(Y),m.clear();const ie=m.toneMapping;m.toneMapping=Ci,ur(j,ue,fe),m.toneMapping=ie,G.updateMultisampleRenderTarget(Y),G.updateRenderTargetMipmap(Y),m.setRenderTarget(de)}function ur(j,ue,fe){const de=ue.isScene===!0?ue.overrideMaterial:null;for(let ie=0,_e=j.length;ie<_e;ie++){const Ce=j[ie],Te=Ce.object,Me=Ce.geometry,Ee=de===null?Ce.material:de,Ne=Ce.group;Te.layers.test(fe.layers)&&Zr(Te,ue,fe,Me,Ee,Ne)}}function Zr(j,ue,fe,de,ie,_e){j.onBeforeRender(m,ue,fe,de,ie,_e),j.modelViewMatrix.multiplyMatrices(fe.matrixWorldInverse,j.matrixWorld),j.normalMatrix.getNormalMatrix(j.modelViewMatrix),ie.onBeforeRender(m,ue,fe,de,j,_e),ie.transparent===!0&&ie.side===mr?(ie.side=zt,ie.needsUpdate=!0,m.renderBufferDirect(fe,ue,de,ie,j,_e),ie.side=Ti,ie.needsUpdate=!0,m.renderBufferDirect(fe,ue,de,ie,j,_e),ie.side=mr):m.renderBufferDirect(fe,ue,de,ie,j,_e),j.onAfterRender(m,ue,fe,de,ie,_e)}function qt(j,ue,fe){ue.isScene!==!0&&(ue=K);const de=pe.get(j),ie=f.state.lights,_e=f.state.shadowsArray,Ce=ie.state.version,Te=U.getParameters(j,ie.state,_e,ue,fe),Me=U.getProgramCacheKey(Te);let Ee=de.programs;de.environment=j.isMeshStandardMaterial?ue.environment:null,de.fog=ue.fog,de.envMap=(j.isMeshStandardMaterial?B:q).get(j.envMap||de.environment),Ee===void 0&&(j.addEventListener("dispose",We),Ee=new Map,de.programs=Ee);let Ne=Ee.get(Me);if(Ne!==void 0){if(de.currentProgram===Ne&&de.lightsStateVersion===Ce)return Se(j,Te),Ne}else Te.uniforms=U.getUniforms(j),j.onBuild(fe,Te,m),j.onBeforeCompile(Te,m),Ne=U.acquireProgram(Te,Me),Ee.set(Me,Ne),de.uniforms=Te.uniforms;const Ue=de.uniforms;(!j.isShaderMaterial&&!j.isRawShaderMaterial||j.clipping===!0)&&(Ue.clippingPlanes=ee.uniform),Se(j,Te),de.needsLights=De(j),de.lightsStateVersion=Ce,de.needsLights&&(Ue.ambientLightColor.value=ie.state.ambient,Ue.lightProbe.value=ie.state.probe,Ue.directionalLights.value=ie.state.directional,Ue.directionalLightShadows.value=ie.state.directionalShadow,Ue.spotLights.value=ie.state.spot,Ue.spotLightShadows.value=ie.state.spotShadow,Ue.rectAreaLights.value=ie.state.rectArea,Ue.ltc_1.value=ie.state.rectAreaLTC1,Ue.ltc_2.value=ie.state.rectAreaLTC2,Ue.pointLights.value=ie.state.point,Ue.pointLightShadows.value=ie.state.pointShadow,Ue.hemisphereLights.value=ie.state.hemi,Ue.directionalShadowMap.value=ie.state.directionalShadowMap,Ue.directionalShadowMatrix.value=ie.state.directionalShadowMatrix,Ue.spotShadowMap.value=ie.state.spotShadowMap,Ue.spotShadowMatrix.value=ie.state.spotShadowMatrix,Ue.pointShadowMap.value=ie.state.pointShadowMap,Ue.pointShadowMatrix.value=ie.state.pointShadowMatrix);const Xe=Ne.getUniforms(),Oe=ys.seqWithValue(Xe.seq,Ue);return de.currentProgram=Ne,de.uniformsList=Oe,Ne}function Se(j,ue){const fe=pe.get(j);fe.outputEncoding=ue.outputEncoding,fe.instancing=ue.instancing,fe.skinning=ue.skinning,fe.morphTargets=ue.morphTargets,fe.morphNormals=ue.morphNormals,fe.morphTargetsCount=ue.morphTargetsCount,fe.numClippingPlanes=ue.numClippingPlanes,fe.numIntersection=ue.numClipIntersection,fe.vertexAlphas=ue.vertexAlphas,fe.vertexTangents=ue.vertexTangents,fe.toneMapping=ue.toneMapping}function Re(j,ue,fe,de,ie){ue.isScene!==!0&&(ue=K),G.resetTextureUnits();const _e=ue.fog,Ce=de.isMeshStandardMaterial?ue.environment:null,Te=x===null?m.outputEncoding:x.texture.encoding,Me=(de.isMeshStandardMaterial?B:q).get(de.envMap||Ce),Ee=de.vertexColors===!0&&!!fe.attributes.color&&fe.attributes.color.itemSize===4,Ne=!!de.normalMap&&!!fe.attributes.tangent,Ue=!!fe.morphAttributes.position,Xe=!!fe.morphAttributes.normal,Oe=fe.morphAttributes.position?fe.morphAttributes.position.length:0,st=de.toneMapped?m.toneMapping:Ci,qe=pe.get(de),bt=f.state.lights;if(F===!0&&(J===!0||j!==b)){const Ot=j===b&&de.id===w;ee.setState(de,j,Ot)}let $e=!1;de.version===qe.__version?(qe.needsLights&&qe.lightsStateVersion!==bt.state.version||qe.outputEncoding!==Te||ie.isInstancedMesh&&qe.instancing===!1||!ie.isInstancedMesh&&qe.instancing===!0||ie.isSkinnedMesh&&qe.skinning===!1||!ie.isSkinnedMesh&&qe.skinning===!0||qe.envMap!==Me||de.fog&&qe.fog!==_e||qe.numClippingPlanes!==void 0&&(qe.numClippingPlanes!==ee.numPlanes||qe.numIntersection!==ee.numIntersection)||qe.vertexAlphas!==Ee||qe.vertexTangents!==Ne||qe.morphTargets!==Ue||qe.morphNormals!==Xe||qe.toneMapping!==st||se.isWebGL2===!0&&qe.morphTargetsCount!==Oe)&&($e=!0):($e=!0,qe.__version=de.version);let at=qe.currentProgram;$e===!0&&(at=qt(de,ue,ie));let et=!1,$t=!1,sn=!1;const _t=at.getUniforms(),Wn=qe.uniforms;if(he.useProgram(at.program)&&(et=!0,$t=!0,sn=!0),de.id!==w&&(w=de.id,$t=!0),et||b!==j){if(_t.setValue(Q,"projectionMatrix",j.projectionMatrix),se.logarithmicDepthBuffer&&_t.setValue(Q,"logDepthBufFC",2/(Math.log(j.far+1)/Math.LN2)),b!==j&&(b=j,$t=!0,sn=!0),de.isShaderMaterial||de.isMeshPhongMaterial||de.isMeshToonMaterial||de.isMeshStandardMaterial||de.envMap){const Ot=_t.map.cameraPosition;Ot!==void 0&&Ot.setValue(Q,z.setFromMatrixPosition(j.matrixWorld))}(de.isMeshPhongMaterial||de.isMeshToonMaterial||de.isMeshLambertMaterial||de.isMeshBasicMaterial||de.isMeshStandardMaterial||de.isShaderMaterial)&&_t.setValue(Q,"isOrthographic",j.isOrthographicCamera===!0),(de.isMeshPhongMaterial||de.isMeshToonMaterial||de.isMeshLambertMaterial||de.isMeshBasicMaterial||de.isMeshStandardMaterial||de.isShaderMaterial||de.isShadowMaterial||ie.isSkinnedMesh)&&_t.setValue(Q,"viewMatrix",j.matrixWorldInverse)}if(ie.isSkinnedMesh){_t.setOptional(Q,ie,"bindMatrix"),_t.setOptional(Q,ie,"bindMatrixInverse");const Ot=ie.skeleton;Ot&&(se.floatVertexTextures?(Ot.boneTexture===null&&Ot.computeBoneTexture(),_t.setValue(Q,"boneTexture",Ot.boneTexture,G),_t.setValue(Q,"boneTextureSize",Ot.boneTextureSize)):_t.setOptional(Q,Ot,"boneMatrices"))}return!!fe&&(fe.morphAttributes.position!==void 0||fe.morphAttributes.normal!==void 0)&&ce.update(ie,fe,de,at),($t||qe.receiveShadow!==ie.receiveShadow)&&(qe.receiveShadow=ie.receiveShadow,_t.setValue(Q,"receiveShadow",ie.receiveShadow)),$t&&(_t.setValue(Q,"toneMappingExposure",m.toneMappingExposure),qe.needsLights&&Le(Wn,sn),_e&&de.fog&&W.refreshFogUniforms(Wn,_e),W.refreshMaterialUniforms(Wn,de,_,R,Y),ys.upload(Q,qe.uniformsList,Wn,G)),de.isShaderMaterial&&de.uniformsNeedUpdate===!0&&(ys.upload(Q,qe.uniformsList,Wn,G),de.uniformsNeedUpdate=!1),de.isSpriteMaterial&&_t.setValue(Q,"center",ie.center),_t.setValue(Q,"modelViewMatrix",ie.modelViewMatrix),_t.setValue(Q,"normalMatrix",ie.normalMatrix),_t.setValue(Q,"modelMatrix",ie.matrixWorld),at}function Le(j,ue){j.ambientLightColor.needsUpdate=ue,j.lightProbe.needsUpdate=ue,j.directionalLights.needsUpdate=ue,j.directionalLightShadows.needsUpdate=ue,j.pointLights.needsUpdate=ue,j.pointLightShadows.needsUpdate=ue,j.spotLights.needsUpdate=ue,j.spotLightShadows.needsUpdate=ue,j.rectAreaLights.needsUpdate=ue,j.hemisphereLights.needsUpdate=ue}function De(j){return j.isMeshLambertMaterial||j.isMeshToonMaterial||j.isMeshPhongMaterial||j.isMeshStandardMaterial||j.isShadowMaterial||j.isShaderMaterial&&j.lights===!0}this.getActiveCubeFace=function(){return g},this.getActiveMipmapLevel=function(){return v},this.getRenderTarget=function(){return x},this.setRenderTargetTextures=function(j,ue,fe){pe.get(j.texture).__webglTexture=ue,pe.get(j.depthTexture).__webglTexture=fe;const de=pe.get(j);de.__hasExternalTextures=!0,de.__hasExternalTextures&&(de.__autoAllocateDepthBuffer=fe===void 0,de.__autoAllocateDepthBuffer||j.useRenderToTexture&&(console.warn("render-to-texture extension was disabled because an external texture was provided"),j.useRenderToTexture=!1,j.useRenderbuffer=!0))},this.setRenderTargetFramebuffer=function(j,ue){const fe=pe.get(j);fe.__webglFramebuffer=ue,fe.__useDefaultFramebuffer=ue===void 0},this.setRenderTarget=function(j,ue=0,fe=0){x=j,g=ue,v=fe;let de=!0;if(j){const Me=pe.get(j);Me.__useDefaultFramebuffer!==void 0?(he.bindFramebuffer(36160,null),de=!1):Me.__webglFramebuffer===void 0?G.setupRenderTarget(j):Me.__hasExternalTextures&&G.rebindTextures(j,pe.get(j.texture).__webglTexture,pe.get(j.depthTexture).__webglTexture)}let ie=null,_e=!1,Ce=!1;if(j){const Me=j.texture;(Me.isDataTexture3D||Me.isDataTexture2DArray)&&(Ce=!0);const Ee=pe.get(j).__webglFramebuffer;j.isWebGLCubeRenderTarget?(ie=Ee[ue],_e=!0):j.useRenderbuffer?ie=pe.get(j).__webglMultisampledFramebuffer:ie=Ee,M.copy(j.viewport),A.copy(j.scissor),E=j.scissorTest}else M.copy(k).multiplyScalar(_).floor(),A.copy(H).multiplyScalar(_).floor(),E=O;if(he.bindFramebuffer(36160,ie)&&se.drawBuffers&&de){let Me=!1;if(j)if(j.isWebGLMultipleRenderTargets){const Ee=j.texture;if(T.length!==Ee.length||T[0]!==36064){for(let Ne=0,Ue=Ee.length;Ne<Ue;Ne++)T[Ne]=36064+Ne;T.length=Ee.length,Me=!0}}else(T.length!==1||T[0]!==36064)&&(T[0]=36064,T.length=1,Me=!0);else(T.length!==1||T[0]!==1029)&&(T[0]=1029,T.length=1,Me=!0);Me&&(se.isWebGL2?Q.drawBuffers(T):ge.get("WEBGL_draw_buffers").drawBuffersWEBGL(T))}if(he.viewport(M),he.scissor(A),he.setScissorTest(E),_e){const Me=pe.get(j.texture);Q.framebufferTexture2D(36160,36064,34069+ue,Me.__webglTexture,fe)}else if(Ce){const Me=pe.get(j.texture),Ee=ue||0;Q.framebufferTextureLayer(36160,36064,Me.__webglTexture,fe||0,Ee)}w=-1},this.readRenderTargetPixels=function(j,ue,fe,de,ie,_e,Ce){if(!(j&&j.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Te=pe.get(j).__webglFramebuffer;if(j.isWebGLCubeRenderTarget&&Ce!==void 0&&(Te=Te[Ce]),Te){he.bindFramebuffer(36160,Te);try{const Me=j.texture,Ee=Me.format,Ne=Me.type;if(Ee!==Lt&&be.convert(Ee)!==Q.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const Ue=Ne===ss&&(ge.has("EXT_color_buffer_half_float")||se.isWebGL2&&ge.has("EXT_color_buffer_float"));if(Ne!==pn&&be.convert(Ne)!==Q.getParameter(35738)&&!(Ne===ni&&(se.isWebGL2||ge.has("OES_texture_float")||ge.has("WEBGL_color_buffer_float")))&&!Ue){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Q.checkFramebufferStatus(36160)===36053?ue>=0&&ue<=j.width-de&&fe>=0&&fe<=j.height-ie&&Q.readPixels(ue,fe,de,ie,be.convert(Ee),be.convert(Ne),_e):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const Me=x!==null?pe.get(x).__webglFramebuffer:null;he.bindFramebuffer(36160,Me)}}},this.copyFramebufferToTexture=function(j,ue,fe=0){if(ue.isFramebufferTexture!==!0){console.error("THREE.WebGLRenderer: copyFramebufferToTexture() can only be used with FramebufferTexture.");return}const de=Math.pow(2,-fe),ie=Math.floor(ue.image.width*de),_e=Math.floor(ue.image.height*de);G.setTexture2D(ue,0),Q.copyTexSubImage2D(3553,fe,0,0,j.x,j.y,ie,_e),he.unbindTexture()},this.copyTextureToTexture=function(j,ue,fe,de=0){const ie=ue.image.width,_e=ue.image.height,Ce=be.convert(fe.format),Te=be.convert(fe.type);G.setTexture2D(fe,0),Q.pixelStorei(37440,fe.flipY),Q.pixelStorei(37441,fe.premultiplyAlpha),Q.pixelStorei(3317,fe.unpackAlignment),ue.isDataTexture?Q.texSubImage2D(3553,de,j.x,j.y,ie,_e,Ce,Te,ue.image.data):ue.isCompressedTexture?Q.compressedTexSubImage2D(3553,de,j.x,j.y,ue.mipmaps[0].width,ue.mipmaps[0].height,Ce,ue.mipmaps[0].data):Q.texSubImage2D(3553,de,j.x,j.y,Ce,Te,ue.image),de===0&&fe.generateMipmaps&&Q.generateMipmap(3553),he.unbindTexture()},this.copyTextureToTexture3D=function(j,ue,fe,de,ie=0){if(m.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const _e=j.max.x-j.min.x+1,Ce=j.max.y-j.min.y+1,Te=j.max.z-j.min.z+1,Me=be.convert(de.format),Ee=be.convert(de.type);let Ne;if(de.isDataTexture3D)G.setTexture3D(de,0),Ne=32879;else if(de.isDataTexture2DArray)G.setTexture2DArray(de,0),Ne=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}Q.pixelStorei(37440,de.flipY),Q.pixelStorei(37441,de.premultiplyAlpha),Q.pixelStorei(3317,de.unpackAlignment);const Ue=Q.getParameter(3314),Xe=Q.getParameter(32878),Oe=Q.getParameter(3316),st=Q.getParameter(3315),qe=Q.getParameter(32877),bt=fe.isCompressedTexture?fe.mipmaps[0]:fe.image;Q.pixelStorei(3314,bt.width),Q.pixelStorei(32878,bt.height),Q.pixelStorei(3316,j.min.x),Q.pixelStorei(3315,j.min.y),Q.pixelStorei(32877,j.min.z),fe.isDataTexture||fe.isDataTexture3D?Q.texSubImage3D(Ne,ie,ue.x,ue.y,ue.z,_e,Ce,Te,Me,Ee,bt.data):fe.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Q.compressedTexSubImage3D(Ne,ie,ue.x,ue.y,ue.z,_e,Ce,Te,Me,bt.data)):Q.texSubImage3D(Ne,ie,ue.x,ue.y,ue.z,_e,Ce,Te,Me,Ee,bt),Q.pixelStorei(3314,Ue),Q.pixelStorei(32878,Xe),Q.pixelStorei(3316,Oe),Q.pixelStorei(3315,st),Q.pixelStorei(32877,qe),ie===0&&de.generateMipmaps&&Q.generateMipmap(Ne),he.unbindTexture()},this.initTexture=function(j){G.setTexture2D(j,0),he.unbindTexture()},this.resetState=function(){g=0,v=0,x=null,he.reset(),oe.reset()},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Nt.prototype.isWebGLRenderer=!0;class gw extends Nt{}gw.prototype.isWebGL1Renderer=!0;class Xl{constructor(e,t=25e-5){this.name="",this.color=new He(e),this.density=t}clone(){return new Xl(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}Xl.prototype.isFogExp2=!0;class Ql{constructor(e,t=1,n=1e3){this.name="",this.color=new He(e),this.near=t,this.far=n}clone(){return new Ql(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}Ql.prototype.isFog=!0;class xs extends dt{constructor(){super();this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),t}}xs.prototype.isScene=!0;class ws{constructor(e,t){this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=sa,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=vr()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let i=0,s=this.stride;i<s;i++)this.array[e+i]=t.array[n+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=vr()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=vr()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}ws.prototype.isInterleavedBuffer=!0;const cn=new X;class Qn{constructor(e,t,n,i=!1){this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=i===!0}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)cn.x=this.getX(t),cn.y=this.getY(t),cn.z=this.getZ(t),cn.applyMatrix4(e),this.setXYZ(t,cn.x,cn.y,cn.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)cn.x=this.getX(t),cn.y=this.getY(t),cn.z=this.getZ(t),cn.applyNormalMatrix(e),this.setXYZ(t,cn.x,cn.y,cn.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)cn.x=this.getX(t),cn.y=this.getY(t),cn.z=this.getZ(t),cn.transformDirection(e),this.setXYZ(t,cn.x,cn.y,cn.z);return this}setX(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this}setXYZW(e,t,n,i,s){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const i=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return new ut(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Qn(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const i=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}Qn.prototype.isInterleavedBufferAttribute=!0;class hh extends an{constructor(e){super();this.type="SpriteMaterial",this.color=new He(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}}hh.prototype.isSpriteMaterial=!0;let Ia;const jl=new X,Pa=new X,Ba=new X,La=new Ae,Zl=new Ae,vw=new Ye,fh=new X,Jl=new X,dh=new X,yw=new Ae,Zp=new Ae,xw=new Ae;class ph extends dt{constructor(e){super();if(this.type="Sprite",Ia===void 0){Ia=new rt;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new ws(t,5);Ia.setIndex([0,1,2,0,2,3]),Ia.setAttribute("position",new Qn(n,3,0,!1)),Ia.setAttribute("uv",new Qn(n,2,3,!1))}this.geometry=Ia,this.material=e!==void 0?e:new hh,this.center=new Ae(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Pa.setFromMatrixScale(this.matrixWorld),vw.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Ba.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Pa.multiplyScalar(-Ba.z);const n=this.material.rotation;let i,s;n!==0&&(s=Math.cos(n),i=Math.sin(n));const o=this.center;mh(fh.set(-.5,-.5,0),Ba,o,Pa,i,s),mh(Jl.set(.5,-.5,0),Ba,o,Pa,i,s),mh(dh.set(.5,.5,0),Ba,o,Pa,i,s),yw.set(0,0),Zp.set(1,0),xw.set(1,1);let a=e.ray.intersectTriangle(fh,Jl,dh,!1,jl);if(a===null&&(mh(Jl.set(-.5,.5,0),Ba,o,Pa,i,s),Zp.set(0,1),a=e.ray.intersectTriangle(fh,dh,Jl,!1,jl),a===null))return;const l=e.ray.origin.distanceTo(jl);l<e.near||l>e.far||t.push({distance:l,point:jl.clone(),uv:jt.getUV(jl,fh,Jl,dh,yw,Zp,xw,new Ae),face:null,object:this})}copy(e){return super.copy(e),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}ph.prototype.isSprite=!0;function mh(r,e,t,n,i,s){La.subVectors(r,t).addScalar(.5).multiply(n),i!==void 0?(Zl.x=s*La.x-i*La.y,Zl.y=i*La.x+s*La.y):Zl.copy(La),r.copy(e),r.x+=Zl.x,r.y+=Zl.y,r.applyMatrix4(vw)}const gh=new X,ww=new X;class bw extends dt{constructor(){super();this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,i=t.length;n<i;n++){const s=t[n];this.addLevel(s.object.clone(),s.distance)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0){t=Math.abs(t);const n=this.levels;let i;for(i=0;i<n.length&&!(t<n[i].distance);i++);return n.splice(i,0,{distance:t,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,i;for(n=1,i=t.length;n<i&&!(e<t[n].distance);n++);return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){gh.setFromMatrixPosition(this.matrixWorld);const i=e.ray.origin.distanceTo(gh);this.getObjectForDistance(i).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){gh.setFromMatrixPosition(e.matrixWorld),ww.setFromMatrixPosition(this.matrixWorld);const n=gh.distanceTo(ww)/e.zoom;t[0].object.visible=!0;let i,s;for(i=1,s=t.length;i<s&&n>=t[i].distance;i++)t[i-1].object.visible=!1,t[i].object.visible=!0;for(this._currentLevel=i-1;i<s;i++)t[i].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let i=0,s=n.length;i<s;i++){const o=n[i];t.object.levels.push({object:o.object.uuid,distance:o.distance})}return t}}const Mw=new X,Aw=new At,Sw=new At,u3=new X,Ew=new Ye;class Kl extends Gt{constructor(e,t){super(e,t);this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Ye,this.bindMatrixInverse=new Ye}copy(e){return super.copy(e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new At,t=this.geometry.attributes.skinWeight;for(let n=0,i=t.count;n<i;n++){e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.w=t.getW(n);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const n=this.skeleton,i=this.geometry;Aw.fromBufferAttribute(i.attributes.skinIndex,e),Sw.fromBufferAttribute(i.attributes.skinWeight,e),Mw.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=Sw.getComponent(s);if(o!==0){const a=Aw.getComponent(s);Ew.multiplyMatrices(n.bones[a].matrixWorld,n.boneInverses[a]),t.addScaledVector(u3.copy(Mw).applyMatrix4(Ew),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}Kl.prototype.isSkinnedMesh=!0;class $l extends dt{constructor(){super();this.type="Bone"}}$l.prototype.isBone=!0;class bs extends Qt{constructor(e=null,t=1,n=1,i,s,o,a,l,h=Ut,u=Ut,c,f){super(null,o,a,l,h,u,i,s,c,f);this.image={data:e,width:t,height:n},this.magFilter=h,this.minFilter=u,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}bs.prototype.isDataTexture=!0;const _w=new Ye,h3=new Ye;class ec{constructor(e=[],t=[]){this.uuid=vr(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,i=this.bones.length;n<i;n++)this.boneInverses.push(new Ye)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new Ye;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,i=this.boneTexture;for(let s=0,o=e.length;s<o;s++){const a=e[s]?e[s].matrixWorld:h3;_w.multiplyMatrices(a,t[s]),_w.toArray(n,s*16)}i!==null&&(i.needsUpdate=!0)}clone(){return new ec(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=hx(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new bs(t,e,e,Lt,ni);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const i=this.bones[t];if(i.name===e)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,i=e.bones.length;n<i;n++){const s=e.bones[n];let o=t[s];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new $l),this.bones.push(o),this.boneInverses.push(new Ye().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let i=0,s=t.length;i<s;i++){const o=t[i];e.bones.push(o.uuid);const a=n[i];e.boneInverses.push(a.toArray())}return e}}class fo extends ut{constructor(e,t,n,i=1){typeof n=="number"&&(i=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument."));super(e,t,n);this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}fo.prototype.isInstancedBufferAttribute=!0;const Tw=new Ye,Cw=new Ye,vh=[],tc=new Gt;class Jp extends Gt{constructor(e,t,n){super(e,t);this.instanceMatrix=new fo(new Float32Array(n*16),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}copy(e){return super.copy(e),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){const n=this.matrixWorld,i=this.count;if(tc.geometry=this.geometry,tc.material=this.material,tc.material!==void 0)for(let s=0;s<i;s++){this.getMatrixAt(s,Tw),Cw.multiplyMatrices(n,Tw),tc.matrixWorld=Cw,tc.raycast(e,vh);for(let o=0,a=vh.length;o<a;o++){const l=vh[o];l.instanceId=s,l.object=this,t.push(l)}vh.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new fo(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}Jp.prototype.isInstancedMesh=!0;class gn extends an{constructor(e){super();this.type="LineBasicMaterial",this.color=new He(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this}}gn.prototype.isLineBasicMaterial=!0;const Rw=new X,Nw=new X,Iw=new Ye,Kp=new Pi,yh=new yr;class oi extends dt{constructor(e=new rt,t=new gn){super();this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(e.index===null){const t=e.attributes.position,n=[0];for(let i=1,s=t.count;i<s;i++)Rw.fromBufferAttribute(t,i-1),Nw.fromBufferAttribute(t,i),n[i]=n[i-1],n[i]+=Rw.distanceTo(Nw);e.setAttribute("lineDistance",new je(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,s=e.params.Line.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),yh.copy(n.boundingSphere),yh.applyMatrix4(i),yh.radius+=s,e.ray.intersectsSphere(yh)===!1)return;Iw.copy(i).invert(),Kp.copy(e.ray).applyMatrix4(Iw);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,h=new X,u=new X,c=new X,f=new X,d=this.isLineSegments?2:1;if(n.isBufferGeometry){const p=n.index,y=n.attributes.position;if(p!==null){const g=Math.max(0,o.start),v=Math.min(p.count,o.start+o.count);for(let x=g,w=v-1;x<w;x+=d){const b=p.getX(x),M=p.getX(x+1);if(h.fromBufferAttribute(y,b),u.fromBufferAttribute(y,M),Kp.distanceSqToSegment(h,u,f,c)>l)continue;f.applyMatrix4(this.matrixWorld);const E=e.ray.origin.distanceTo(f);E<e.near||E>e.far||t.push({distance:E,point:c.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}else{const g=Math.max(0,o.start),v=Math.min(y.count,o.start+o.count);for(let x=g,w=v-1;x<w;x+=d){if(h.fromBufferAttribute(y,x),u.fromBufferAttribute(y,x+1),Kp.distanceSqToSegment(h,u,f,c)>l)continue;f.applyMatrix4(this.matrixWorld);const M=e.ray.origin.distanceTo(f);M<e.near||M>e.far||t.push({distance:M,point:c.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}}else n.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=i.length;s<o;s++){const a=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}else{const t=e.morphTargets;t!==void 0&&t.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}oi.prototype.isLine=!0;const Pw=new X,Bw=new X;class jn extends oi{constructor(e,t){super(e,t);this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(e.index===null){const t=e.attributes.position,n=[];for(let i=0,s=t.count;i<s;i+=2)Pw.fromBufferAttribute(t,i),Bw.fromBufferAttribute(t,i+1),n[i]=i===0?0:n[i-1],n[i+1]=n[i]+Pw.distanceTo(Bw);e.setAttribute("lineDistance",new je(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}jn.prototype.isLineSegments=!0;class xh extends oi{constructor(e,t){super(e,t);this.type="LineLoop"}}xh.prototype.isLineLoop=!0;class Ms extends an{constructor(e){super();this.type="PointsMaterial",this.color=new He(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this}}Ms.prototype.isPointsMaterial=!0;const Lw=new Ye,$p=new Pi,wh=new yr,bh=new X;class Da extends dt{constructor(e=new rt,t=new Ms){super();this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,s=e.params.Points.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),wh.copy(n.boundingSphere),wh.applyMatrix4(i),wh.radius+=s,e.ray.intersectsSphere(wh)===!1)return;Lw.copy(i).invert(),$p.copy(e.ray).applyMatrix4(Lw);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a;if(n.isBufferGeometry){const h=n.index,c=n.attributes.position;if(h!==null){const f=Math.max(0,o.start),d=Math.min(h.count,o.start+o.count);for(let p=f,m=d;p<m;p++){const y=h.getX(p);bh.fromBufferAttribute(c,y),Dw(bh,y,l,i,e,t,this)}}else{const f=Math.max(0,o.start),d=Math.min(c.count,o.start+o.count);for(let p=f,m=d;p<m;p++)bh.fromBufferAttribute(c,p),Dw(bh,p,l,i,e,t,this)}}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=i.length;s<o;s++){const a=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}else{const t=e.morphTargets;t!==void 0&&t.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}Da.prototype.isPoints=!0;function Dw(r,e,t,n,i,s,o){const a=$p.distanceSqToPoint(r);if(a<t){const l=new X;$p.closestPointToPoint(r,l),l.applyMatrix4(n);const h=i.ray.origin.distanceTo(l);if(h<i.near||h>i.far)return;s.push({distance:h,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}class Fw extends Qt{constructor(e,t,n,i,s,o,a,l,h){super(e,t,n,i,s,o,a,l,h);this.format=a!==void 0?a:An,this.minFilter=o!==void 0?o:ft,this.magFilter=s!==void 0?s:ft,this.generateMipmaps=!1;const u=this;function c(){u.needsUpdate=!0,e.requestVideoFrameCallback(c)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(c)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}Fw.prototype.isVideoTexture=!0;class Ow extends Qt{constructor(e,t,n){super({width:e,height:t});this.format=n,this.magFilter=Ut,this.minFilter=Ut,this.generateMipmaps=!1,this.needsUpdate=!0}}Ow.prototype.isFramebufferTexture=!0;class nc extends Qt{constructor(e,t,n,i,s,o,a,l,h,u,c,f){super(null,o,a,l,h,u,i,s,c,f);this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}nc.prototype.isCompressedTexture=!0;class zw extends Qt{constructor(e,t,n,i,s,o,a,l,h){super(e,t,n,i,s,o,a,l,h);this.needsUpdate=!0}}zw.prototype.isCanvasTexture=!0;class Fa extends rt{constructor(e=1,t=8,n=0,i=Math.PI*2){super();this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},t=Math.max(3,t);const s=[],o=[],a=[],l=[],h=new X,u=new Ae;o.push(0,0,0),a.push(0,0,1),l.push(.5,.5);for(let c=0,f=3;c<=t;c++,f+=3){const d=n+c/t*i;h.x=e*Math.cos(d),h.y=e*Math.sin(d),o.push(h.x,h.y,h.z),a.push(0,0,1),u.x=(o[f]/e+1)/2,u.y=(o[f+1]/e+1)/2,l.push(u.x,u.y)}for(let c=1;c<=t;c++)s.push(c,c+1,0);this.setIndex(s),this.setAttribute("position",new je(o,3)),this.setAttribute("normal",new je(a,3)),this.setAttribute("uv",new je(l,2))}static fromJSON(e){return new Fa(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class As extends rt{constructor(e=1,t=1,n=1,i=8,s=1,o=!1,a=0,l=Math.PI*2){super();this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const h=this;i=Math.floor(i),s=Math.floor(s);const u=[],c=[],f=[],d=[];let p=0;const m=[],y=n/2;let g=0;v(),o===!1&&(e>0&&x(!0),t>0&&x(!1)),this.setIndex(u),this.setAttribute("position",new je(c,3)),this.setAttribute("normal",new je(f,3)),this.setAttribute("uv",new je(d,2));function v(){const w=new X,b=new X;let M=0;const A=(t-e)/n;for(let E=0;E<=s;E++){const N=[],R=E/s,_=R*(t-e)+e;for(let S=0;S<=i;S++){const L=S/i,k=L*l+a,H=Math.sin(k),O=Math.cos(k);b.x=_*H,b.y=-R*n+y,b.z=_*O,c.push(b.x,b.y,b.z),w.set(H,A,O).normalize(),f.push(w.x,w.y,w.z),d.push(L,1-R),N.push(p++)}m.push(N)}for(let E=0;E<i;E++)for(let N=0;N<s;N++){const R=m[N][E],_=m[N+1][E],S=m[N+1][E+1],L=m[N][E+1];u.push(R,_,L),u.push(_,S,L),M+=6}h.addGroup(g,M,0),g+=M}function x(w){const b=p,M=new Ae,A=new X;let E=0;const N=w===!0?e:t,R=w===!0?1:-1;for(let S=1;S<=i;S++)c.push(0,y*R,0),f.push(0,R,0),d.push(.5,.5),p++;const _=p;for(let S=0;S<=i;S++){const k=S/i*l+a,H=Math.cos(k),O=Math.sin(k);A.x=N*O,A.y=y*R,A.z=N*H,c.push(A.x,A.y,A.z),f.push(0,R,0),M.x=H*.5+.5,M.y=O*.5*R+.5,d.push(M.x,M.y),p++}for(let S=0;S<i;S++){const L=b+S,k=_+S;w===!0?u.push(k,k+1,L):u.push(k+1,k,L),E+=3}h.addGroup(g,E,w===!0?1:2),g+=E}}static fromJSON(e){return new As(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Oa extends As{constructor(e=1,t=1,n=8,i=1,s=!1,o=0,a=Math.PI*2){super(0,e,t,n,i,s,o,a);this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(e){return new Oa(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class ai extends rt{constructor(e=[],t=[],n=1,i=0){super();this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i};const s=[],o=[];a(i),h(n),u(),this.setAttribute("position",new je(s,3)),this.setAttribute("normal",new je(s.slice(),3)),this.setAttribute("uv",new je(o,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function a(v){const x=new X,w=new X,b=new X;for(let M=0;M<t.length;M+=3)d(t[M+0],x),d(t[M+1],w),d(t[M+2],b),l(x,w,b,v)}function l(v,x,w,b){const M=b+1,A=[];for(let E=0;E<=M;E++){A[E]=[];const N=v.clone().lerp(w,E/M),R=x.clone().lerp(w,E/M),_=M-E;for(let S=0;S<=_;S++)S===0&&E===M?A[E][S]=N:A[E][S]=N.clone().lerp(R,S/_)}for(let E=0;E<M;E++)for(let N=0;N<2*(M-E)-1;N++){const R=Math.floor(N/2);N%2==0?(f(A[E][R+1]),f(A[E+1][R]),f(A[E][R])):(f(A[E][R+1]),f(A[E+1][R+1]),f(A[E+1][R]))}}function h(v){const x=new X;for(let w=0;w<s.length;w+=3)x.x=s[w+0],x.y=s[w+1],x.z=s[w+2],x.normalize().multiplyScalar(v),s[w+0]=x.x,s[w+1]=x.y,s[w+2]=x.z}function u(){const v=new X;for(let x=0;x<s.length;x+=3){v.x=s[x+0],v.y=s[x+1],v.z=s[x+2];const w=y(v)/2/Math.PI+.5,b=g(v)/Math.PI+.5;o.push(w,1-b)}p(),c()}function c(){for(let v=0;v<o.length;v+=6){const x=o[v+0],w=o[v+2],b=o[v+4],M=Math.max(x,w,b),A=Math.min(x,w,b);M>.9&&A<.1&&(x<.2&&(o[v+0]+=1),w<.2&&(o[v+2]+=1),b<.2&&(o[v+4]+=1))}}function f(v){s.push(v.x,v.y,v.z)}function d(v,x){const w=v*3;x.x=e[w+0],x.y=e[w+1],x.z=e[w+2]}function p(){const v=new X,x=new X,w=new X,b=new X,M=new Ae,A=new Ae,E=new Ae;for(let N=0,R=0;N<s.length;N+=9,R+=6){v.set(s[N+0],s[N+1],s[N+2]),x.set(s[N+3],s[N+4],s[N+5]),w.set(s[N+6],s[N+7],s[N+8]),M.set(o[R+0],o[R+1]),A.set(o[R+2],o[R+3]),E.set(o[R+4],o[R+5]),b.copy(v).add(x).add(w).divideScalar(3);const _=y(b);m(M,R+0,v,_),m(A,R+2,x,_),m(E,R+4,w,_)}}function m(v,x,w,b){b<0&&v.x===1&&(o[x]=v.x-1),w.x===0&&w.z===0&&(o[x]=b/2/Math.PI+.5)}function y(v){return Math.atan2(v.z,-v.x)}function g(v){return Math.atan2(-v.y,Math.sqrt(v.x*v.x+v.z*v.z))}}static fromJSON(e){return new ai(e.vertices,e.indices,e.radius,e.details)}}class za extends ai{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,i=1/n,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,o,e,t);this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new za(e.radius,e.detail)}}const Mh=new X,Ah=new X,em=new X,Sh=new jt;class tm extends rt{constructor(e=null,t=1){super();if(this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const i=Math.pow(10,4),s=Math.cos(io*t),o=e.getIndex(),a=e.getAttribute("position"),l=o?o.count:a.count,h=[0,0,0],u=["a","b","c"],c=new Array(3),f={},d=[];for(let p=0;p<l;p+=3){o?(h[0]=o.getX(p),h[1]=o.getX(p+1),h[2]=o.getX(p+2)):(h[0]=p,h[1]=p+1,h[2]=p+2);const{a:m,b:y,c:g}=Sh;if(m.fromBufferAttribute(a,h[0]),y.fromBufferAttribute(a,h[1]),g.fromBufferAttribute(a,h[2]),Sh.getNormal(em),c[0]=`${Math.round(m.x*i)},${Math.round(m.y*i)},${Math.round(m.z*i)}`,c[1]=`${Math.round(y.x*i)},${Math.round(y.y*i)},${Math.round(y.z*i)}`,c[2]=`${Math.round(g.x*i)},${Math.round(g.y*i)},${Math.round(g.z*i)}`,!(c[0]===c[1]||c[1]===c[2]||c[2]===c[0]))for(let v=0;v<3;v++){const x=(v+1)%3,w=c[v],b=c[x],M=Sh[u[v]],A=Sh[u[x]],E=`${w}_${b}`,N=`${b}_${w}`;N in f&&f[N]?(em.dot(f[N].normal)<=s&&(d.push(M.x,M.y,M.z),d.push(A.x,A.y,A.z)),f[N]=null):E in f||(f[E]={index0:h[v],index1:h[x],normal:em.clone()})}}for(const p in f)if(f[p]){const{index0:m,index1:y}=f[p];Mh.fromBufferAttribute(a,m),Ah.fromBufferAttribute(a,y),d.push(Mh.x,Mh.y,Mh.z),d.push(Ah.x,Ah.y,Ah.z)}this.setAttribute("position",new je(d,3))}}}class br{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,i=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)n=this.getPoint(o/e),s+=n.distanceTo(i),t.push(s),i=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let i=0;const s=n.length;let o;t?o=t:o=e*n[s-1];let a=0,l=s-1,h;for(;a<=l;)if(i=Math.floor(a+(l-a)/2),h=n[i]-o,h<0)a=i+1;else if(h>0)l=i-1;else{l=i;break}if(i=l,n[i]===o)return i/(s-1);const u=n[i],f=n[i+1]-u,d=(o-u)/f;return(i+d)/(s-1)}getTangent(e,t){const n=1e-4;let i=e-n,s=e+n;i<0&&(i=0),s>1&&(s=1);const o=this.getPoint(i),a=this.getPoint(s),l=t||(o.isVector2?new Ae:new X);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new X,i=[],s=[],o=[],a=new X,l=new Ye;for(let d=0;d<=e;d++){const p=d/e;i[d]=this.getTangentAt(p,new X)}s[0]=new X,o[0]=new X;let h=Number.MAX_VALUE;const u=Math.abs(i[0].x),c=Math.abs(i[0].y),f=Math.abs(i[0].z);u<=h&&(h=u,n.set(1,0,0)),c<=h&&(h=c,n.set(0,1,0)),f<=h&&n.set(0,0,1),a.crossVectors(i[0],n).normalize(),s[0].crossVectors(i[0],a),o[0].crossVectors(i[0],s[0]);for(let d=1;d<=e;d++){if(s[d]=s[d-1].clone(),o[d]=o[d-1].clone(),a.crossVectors(i[d-1],i[d]),a.length()>Number.EPSILON){a.normalize();const p=Math.acos(In(i[d-1].dot(i[d]),-1,1));s[d].applyMatrix4(l.makeRotationAxis(a,p))}o[d].crossVectors(i[d],s[d])}if(t===!0){let d=Math.acos(In(s[0].dot(s[e]),-1,1));d/=e,i[0].dot(a.crossVectors(s[0],s[e]))>0&&(d=-d);for(let p=1;p<=e;p++)s[p].applyMatrix4(l.makeRotationAxis(i[p],d*p)),o[p].crossVectors(i[p],s[p])}return{tangents:i,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class rc extends br{constructor(e=0,t=0,n=1,i=1,s=0,o=Math.PI*2,a=!1,l=0){super();this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=i,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,t){const n=t||new Ae,i=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=i;for(;s>i;)s-=i;s<Number.EPSILON&&(o?s=0:s=i),this.aClockwise===!0&&!o&&(s===i?s=-i:s=s-i);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),h=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const u=Math.cos(this.aRotation),c=Math.sin(this.aRotation),f=l-this.aX,d=h-this.aY;l=f*u-d*c+this.aX,h=f*c+d*u+this.aY}return n.set(l,h)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}rc.prototype.isEllipseCurve=!0;class nm extends rc{constructor(e,t,n,i,s,o){super(e,t,n,n,i,s,o);this.type="ArcCurve"}}nm.prototype.isArcCurve=!0;function rm(){let r=0,e=0,t=0,n=0;function i(s,o,a,l){r=s,e=a,t=-3*s+3*o-2*a-l,n=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,h){i(o,a,h*(a-s),h*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,h,u,c){let f=(o-s)/h-(a-s)/(h+u)+(a-o)/u,d=(a-o)/u-(l-o)/(u+c)+(l-a)/c;f*=u,d*=u,i(o,a,f,d)},calc:function(s){const o=s*s,a=o*s;return r+e*s+t*o+n*a}}}const Eh=new X,im=new rm,sm=new rm,om=new rm;class am extends br{constructor(e=[],t=!1,n="centripetal",i=.5){super();this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=i}getPoint(e,t=new X){const n=t,i=this.points,s=i.length,o=(s-(this.closed?0:1))*e;let a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:l===0&&a===s-1&&(a=s-2,l=1);let h,u;this.closed||a>0?h=i[(a-1)%s]:(Eh.subVectors(i[0],i[1]).add(i[0]),h=Eh);const c=i[a%s],f=i[(a+1)%s];if(this.closed||a+2<s?u=i[(a+2)%s]:(Eh.subVectors(i[s-1],i[s-2]).add(i[s-1]),u=Eh),this.curveType==="centripetal"||this.curveType==="chordal"){const d=this.curveType==="chordal"?.5:.25;let p=Math.pow(h.distanceToSquared(c),d),m=Math.pow(c.distanceToSquared(f),d),y=Math.pow(f.distanceToSquared(u),d);m<1e-4&&(m=1),p<1e-4&&(p=m),y<1e-4&&(y=m),im.initNonuniformCatmullRom(h.x,c.x,f.x,u.x,p,m,y),sm.initNonuniformCatmullRom(h.y,c.y,f.y,u.y,p,m,y),om.initNonuniformCatmullRom(h.z,c.z,f.z,u.z,p,m,y)}else this.curveType==="catmullrom"&&(im.initCatmullRom(h.x,c.x,f.x,u.x,this.tension),sm.initCatmullRom(h.y,c.y,f.y,u.y,this.tension),om.initCatmullRom(h.z,c.z,f.z,u.z,this.tension));return n.set(im.calc(l),sm.calc(l),om.calc(l)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(new X().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}am.prototype.isCatmullRomCurve3=!0;function Uw(r,e,t,n,i){const s=(n-e)*.5,o=(i-t)*.5,a=r*r,l=r*a;return(2*t-2*n+s+o)*l+(-3*t+3*n-2*s-o)*a+s*r+t}function f3(r,e){const t=1-r;return t*t*e}function d3(r,e){return 2*(1-r)*r*e}function p3(r,e){return r*r*e}function ic(r,e,t,n){return f3(r,e)+d3(r,t)+p3(r,n)}function m3(r,e){const t=1-r;return t*t*t*e}function g3(r,e){const t=1-r;return 3*t*t*r*e}function v3(r,e){return 3*(1-r)*r*r*e}function y3(r,e){return r*r*r*e}function sc(r,e,t,n,i){return m3(r,e)+g3(r,t)+v3(r,n)+y3(r,i)}class _h extends br{constructor(e=new Ae,t=new Ae,n=new Ae,i=new Ae){super();this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e,t=new Ae){const n=t,i=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(sc(e,i.x,s.x,o.x,a.x),sc(e,i.y,s.y,o.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}_h.prototype.isCubicBezierCurve=!0;class lm extends br{constructor(e=new X,t=new X,n=new X,i=new X){super();this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e,t=new X){const n=t,i=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(sc(e,i.x,s.x,o.x,a.x),sc(e,i.y,s.y,o.y,a.y),sc(e,i.z,s.z,o.z,a.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}lm.prototype.isCubicBezierCurve3=!0;class oc extends br{constructor(e=new Ae,t=new Ae){super();this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Ae){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){const n=t||new Ae;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}oc.prototype.isLineCurve=!0;class Hw extends br{constructor(e=new X,t=new X){super();this.type="LineCurve3",this.isLineCurve3=!0,this.v1=e,this.v2=t}getPoint(e,t=new X){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Th extends br{constructor(e=new Ae,t=new Ae,n=new Ae){super();this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new Ae){const n=t,i=this.v0,s=this.v1,o=this.v2;return n.set(ic(e,i.x,s.x,o.x),ic(e,i.y,s.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Th.prototype.isQuadraticBezierCurve=!0;class Ch extends br{constructor(e=new X,t=new X,n=new X){super();this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new X){const n=t,i=this.v0,s=this.v1,o=this.v2;return n.set(ic(e,i.x,s.x,o.x),ic(e,i.y,s.y,o.y),ic(e,i.z,s.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Ch.prototype.isQuadraticBezierCurve3=!0;class Rh extends br{constructor(e=[]){super();this.type="SplineCurve",this.points=e}getPoint(e,t=new Ae){const n=t,i=this.points,s=(i.length-1)*e,o=Math.floor(s),a=s-o,l=i[o===0?o:o-1],h=i[o],u=i[o>i.length-2?i.length-1:o+1],c=i[o>i.length-3?i.length-1:o+2];return n.set(Uw(a,l.x,h.x,u.x,c.x),Uw(a,l.y,h.y,u.y,c.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(new Ae().fromArray(i))}return this}}Rh.prototype.isSplineCurve=!0;var cm=Object.freeze({__proto__:null,ArcCurve:nm,CatmullRomCurve3:am,CubicBezierCurve:_h,CubicBezierCurve3:lm,EllipseCurve:rc,LineCurve:oc,LineCurve3:Hw,QuadraticBezierCurve:Th,QuadraticBezierCurve3:Ch,SplineCurve:Rh});class Gw extends br{constructor(){super();this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new oc(t,e))}getPoint(e,t){const n=e*this.getLength(),i=this.getCurveLengths();let s=0;for(;s<i.length;){if(i[s]>=n){const o=i[s]-n,a=this.curves[s],l=a.getLength(),h=l===0?0:1-o/l;return a.getPointAt(h,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,i=this.curves.length;n<i;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let i=0,s=this.curves;i<s.length;i++){const o=s[i],a=o&&o.isEllipseCurve?e*2:o&&(o.isLineCurve||o.isLineCurve3)?1:o&&o.isSplineCurve?e*o.points.length:e,l=o.getPoints(a);for(let h=0;h<l.length;h++){const u=l[h];n&&n.equals(u)||(t.push(u),n=u)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const i=e.curves[t];this.curves.push(new cm[i.type]().fromJSON(i))}return this}}class ac extends Gw{constructor(e){super();this.type="Path",this.currentPoint=new Ae,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new oc(this.currentPoint.clone(),new Ae(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,i){const s=new Th(this.currentPoint.clone(),new Ae(e,t),new Ae(n,i));return this.curves.push(s),this.currentPoint.set(n,i),this}bezierCurveTo(e,t,n,i,s,o){const a=new _h(this.currentPoint.clone(),new Ae(e,t),new Ae(n,i),new Ae(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new Rh(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,i,s,o){const a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+a,t+l,n,i,s,o),this}absarc(e,t,n,i,s,o){return this.absellipse(e,t,n,n,i,s,o),this}ellipse(e,t,n,i,s,o,a,l){const h=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+h,t+u,n,i,s,o,a,l),this}absellipse(e,t,n,i,s,o,a,l){const h=new rc(e,t,n,i,s,o,a,l);if(this.curves.length>0){const c=h.getPoint(0);c.equals(this.currentPoint)||this.lineTo(c.x,c.y)}this.curves.push(h);const u=h.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class li extends ac{constructor(e){super(e);this.uuid=vr(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,i=this.holes.length;n<i;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const i=e.holes[t];this.holes.push(new ac().fromJSON(i))}return this}}const x3={triangulate:function(r,e,t=2){const n=e&&e.length,i=n?e[0]*t:r.length;let s=kw(r,0,i,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,h,u,c,f,d;if(n&&(s=S3(r,e,s,t)),r.length>80*t){a=h=r[0],l=u=r[1];for(let p=t;p<i;p+=t)c=r[p],f=r[p+1],c<a&&(a=c),f<l&&(l=f),c>h&&(h=c),f>u&&(u=f);d=Math.max(h-a,u-l),d=d!==0?1/d:0}return lc(s,o,t,a,l,d),o}};function kw(r,e,t,n,i){let s,o;if(i===D3(r,e,t,n)>0)for(s=e;s<t;s+=n)o=qw(s,r[s],r[s+1],o);else for(s=t-n;s>=e;s-=n)o=qw(s,r[s],r[s+1],o);return o&&Nh(o,o.next)&&(uc(o),o=o.next),o}function Ss(r,e){if(!r)return r;e||(e=r);let t=r,n;do if(n=!1,!t.steiner&&(Nh(t,t.next)||en(t.prev,t,t.next)===0)){if(uc(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function lc(r,e,t,n,i,s,o){if(!r)return;!o&&s&&R3(r,n,i,s);let a=r,l,h;for(;r.prev!==r.next;){if(l=r.prev,h=r.next,s?b3(r,n,i,s):w3(r)){e.push(l.i/t),e.push(r.i/t),e.push(h.i/t),uc(r),r=h.next,a=h.next;continue}if(r=h,r===a){o?o===1?(r=M3(Ss(r),e,t),lc(r,e,t,n,i,s,2)):o===2&&A3(r,e,t,n,i,s):lc(Ss(r),e,t,n,i,s,1);break}}}function w3(r){const e=r.prev,t=r,n=r.next;if(en(e,t,n)>=0)return!1;let i=r.next.next;for(;i!==r.prev;){if(Ua(e.x,e.y,t.x,t.y,n.x,n.y,i.x,i.y)&&en(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function b3(r,e,t,n){const i=r.prev,s=r,o=r.next;if(en(i,s,o)>=0)return!1;const a=i.x<s.x?i.x<o.x?i.x:o.x:s.x<o.x?s.x:o.x,l=i.y<s.y?i.y<o.y?i.y:o.y:s.y<o.y?s.y:o.y,h=i.x>s.x?i.x>o.x?i.x:o.x:s.x>o.x?s.x:o.x,u=i.y>s.y?i.y>o.y?i.y:o.y:s.y>o.y?s.y:o.y,c=um(a,l,e,t,n),f=um(h,u,e,t,n);let d=r.prevZ,p=r.nextZ;for(;d&&d.z>=c&&p&&p.z<=f;){if(d!==r.prev&&d!==r.next&&Ua(i.x,i.y,s.x,s.y,o.x,o.y,d.x,d.y)&&en(d.prev,d,d.next)>=0||(d=d.prevZ,p!==r.prev&&p!==r.next&&Ua(i.x,i.y,s.x,s.y,o.x,o.y,p.x,p.y)&&en(p.prev,p,p.next)>=0))return!1;p=p.nextZ}for(;d&&d.z>=c;){if(d!==r.prev&&d!==r.next&&Ua(i.x,i.y,s.x,s.y,o.x,o.y,d.x,d.y)&&en(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;p&&p.z<=f;){if(p!==r.prev&&p!==r.next&&Ua(i.x,i.y,s.x,s.y,o.x,o.y,p.x,p.y)&&en(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function M3(r,e,t){let n=r;do{const i=n.prev,s=n.next.next;!Nh(i,s)&&Vw(i,n,n.next,s)&&cc(i,s)&&cc(s,i)&&(e.push(i.i/t),e.push(n.i/t),e.push(s.i/t),uc(n),uc(n.next),n=r=s),n=n.next}while(n!==r);return Ss(n)}function A3(r,e,t,n,i,s){let o=r;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&P3(o,a)){let l=Ww(o,a);o=Ss(o,o.next),l=Ss(l,l.next),lc(o,e,t,n,i,s),lc(l,e,t,n,i,s);return}a=a.next}o=o.next}while(o!==r)}function S3(r,e,t,n){const i=[];let s,o,a,l,h;for(s=0,o=e.length;s<o;s++)a=e[s]*n,l=s<o-1?e[s+1]*n:r.length,h=kw(r,a,l,n,!1),h===h.next&&(h.steiner=!0),i.push(I3(h));for(i.sort(E3),s=0;s<i.length;s++)_3(i[s],t),t=Ss(t,t.next);return t}function E3(r,e){return r.x-e.x}function _3(r,e){if(e=T3(r,e),e){const t=Ww(e,r);Ss(e,e.next),Ss(t,t.next)}}function T3(r,e){let t=e;const n=r.x,i=r.y;let s=-1/0,o;do{if(i<=t.y&&i>=t.next.y&&t.next.y!==t.y){const f=t.x+(i-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(f<=n&&f>s){if(s=f,f===n){if(i===t.y)return t;if(i===t.next.y)return t.next}o=t.x<t.next.x?t:t.next}}t=t.next}while(t!==e);if(!o)return null;if(n===s)return o;const a=o,l=o.x,h=o.y;let u=1/0,c;t=o;do n>=t.x&&t.x>=l&&n!==t.x&&Ua(i<h?n:s,i,l,h,i<h?s:n,i,t.x,t.y)&&(c=Math.abs(i-t.y)/(n-t.x),cc(t,r)&&(c<u||c===u&&(t.x>o.x||t.x===o.x&&C3(o,t)))&&(o=t,u=c)),t=t.next;while(t!==a);return o}function C3(r,e){return en(r.prev,r,e.prev)<0&&en(e.next,r,r.next)<0}function R3(r,e,t,n){let i=r;do i.z===null&&(i.z=um(i.x,i.y,e,t,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==r);i.prevZ.nextZ=null,i.prevZ=null,N3(i)}function N3(r){let e,t,n,i,s,o,a,l,h=1;do{for(t=r,r=null,s=null,o=0;t;){for(o++,n=t,a=0,e=0;e<h&&(a++,n=n.nextZ,!!n);e++);for(l=h;a>0||l>0&&n;)a!==0&&(l===0||!n||t.z<=n.z)?(i=t,t=t.nextZ,a--):(i=n,n=n.nextZ,l--),s?s.nextZ=i:r=i,i.prevZ=s,s=i;t=n}s.nextZ=null,h*=2}while(o>1);return r}function um(r,e,t,n,i){return r=32767*(r-t)*i,e=32767*(e-n)*i,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,r|e<<1}function I3(r){let e=r,t=r;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==r);return t}function Ua(r,e,t,n,i,s,o,a){return(i-o)*(e-a)-(r-o)*(s-a)>=0&&(r-o)*(n-a)-(t-o)*(e-a)>=0&&(t-o)*(s-a)-(i-o)*(n-a)>=0}function P3(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!B3(r,e)&&(cc(r,e)&&cc(e,r)&&L3(r,e)&&(en(r.prev,r,e.prev)||en(r,e.prev,e))||Nh(r,e)&&en(r.prev,r,r.next)>0&&en(e.prev,e,e.next)>0)}function en(r,e,t){return(e.y-r.y)*(t.x-e.x)-(e.x-r.x)*(t.y-e.y)}function Nh(r,e){return r.x===e.x&&r.y===e.y}function Vw(r,e,t,n){const i=Ph(en(r,e,t)),s=Ph(en(r,e,n)),o=Ph(en(t,n,r)),a=Ph(en(t,n,e));return!!(i!==s&&o!==a||i===0&&Ih(r,t,e)||s===0&&Ih(r,n,e)||o===0&&Ih(t,r,n)||a===0&&Ih(t,e,n))}function Ih(r,e,t){return e.x<=Math.max(r.x,t.x)&&e.x>=Math.min(r.x,t.x)&&e.y<=Math.max(r.y,t.y)&&e.y>=Math.min(r.y,t.y)}function Ph(r){return r>0?1:r<0?-1:0}function B3(r,e){let t=r;do{if(t.i!==r.i&&t.next.i!==r.i&&t.i!==e.i&&t.next.i!==e.i&&Vw(t,t.next,r,e))return!0;t=t.next}while(t!==r);return!1}function cc(r,e){return en(r.prev,r,r.next)<0?en(r,e,r.next)>=0&&en(r,r.prev,e)>=0:en(r,e,r.prev)<0||en(r,r.next,e)<0}function L3(r,e){let t=r,n=!1;const i=(r.x+e.x)/2,s=(r.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&i<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==r);return n}function Ww(r,e){const t=new hm(r.i,r.x,r.y),n=new hm(e.i,e.x,e.y),i=r.next,s=e.prev;return r.next=e,e.prev=r,t.next=i,i.prev=t,n.next=t,t.prev=n,s.next=n,n.prev=s,n}function qw(r,e,t,n){const i=new hm(r,e,t);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function uc(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function hm(r,e,t){this.i=r,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function D3(r,e,t,n){let i=0;for(let s=e,o=t-n;s<t;s+=n)i+=(r[o]-r[s])*(r[s+1]+r[o+1]),o=s;return i}class ci{static area(e){const t=e.length;let n=0;for(let i=t-1,s=0;s<t;i=s++)n+=e[i].x*e[s].y-e[s].x*e[i].y;return n*.5}static isClockWise(e){return ci.area(e)<0}static triangulateShape(e,t){const n=[],i=[],s=[];Yw(e),Xw(n,e);let o=e.length;t.forEach(Yw);for(let l=0;l<t.length;l++)i.push(o),o+=t[l].length,Xw(n,t[l]);const a=x3.triangulate(n,i);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function Yw(r){const e=r.length;e>2&&r[e-1].equals(r[0])&&r.pop()}function Xw(r,e){for(let t=0;t<e.length;t++)r.push(e[t].x),r.push(e[t].y)}class ui extends rt{constructor(e=new li([new Ae(.5,.5),new Ae(-.5,.5),new Ae(-.5,-.5),new Ae(.5,-.5)]),t={}){super();this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,i=[],s=[];for(let a=0,l=e.length;a<l;a++){const h=e[a];o(h)}this.setAttribute("position",new je(i,3)),this.setAttribute("uv",new je(s,2)),this.computeVertexNormals();function o(a){const l=[],h=t.curveSegments!==void 0?t.curveSegments:12,u=t.steps!==void 0?t.steps:1;let c=t.depth!==void 0?t.depth:1,f=t.bevelEnabled!==void 0?t.bevelEnabled:!0,d=t.bevelThickness!==void 0?t.bevelThickness:.2,p=t.bevelSize!==void 0?t.bevelSize:d-.1,m=t.bevelOffset!==void 0?t.bevelOffset:0,y=t.bevelSegments!==void 0?t.bevelSegments:3;const g=t.extrudePath,v=t.UVGenerator!==void 0?t.UVGenerator:F3;t.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),c=t.amount);let x,w=!1,b,M,A,E;g&&(x=g.getSpacedPoints(u),w=!0,f=!1,b=g.computeFrenetFrames(u,!1),M=new X,A=new X,E=new X),f||(y=0,d=0,p=0,m=0);const N=a.extractPoints(h);let R=N.shape;const _=N.holes;if(!ci.isClockWise(R)){R=R.reverse();for(let pe=0,G=_.length;pe<G;pe++){const q=_[pe];ci.isClockWise(q)&&(_[pe]=q.reverse())}}const L=ci.triangulateShape(R,_),k=R;for(let pe=0,G=_.length;pe<G;pe++){const q=_[pe];R=R.concat(q)}function H(pe,G,q){return G||console.error("THREE.ExtrudeGeometry: vec does not exist"),G.clone().multiplyScalar(q).add(pe)}const O=R.length,T=L.length;function V(pe,G,q){let B,D,$;const ne=pe.x-G.x,U=pe.y-G.y,W=q.x-pe.x,P=q.y-pe.y,C=ne*ne+U*U,ee=ne*P-U*W;if(Math.abs(ee)>Number.EPSILON){const ae=Math.sqrt(C),le=Math.sqrt(W*W+P*P),ce=G.x-U/ae,ye=G.y+ne/ae,we=q.x-P/le,be=q.y+W/le,oe=((we-ce)*P-(be-ye)*W)/(ne*P-U*W);B=ce+ne*oe-pe.x,D=ye+U*oe-pe.y;const Ie=B*B+D*D;if(Ie<=2)return new Ae(B,D);$=Math.sqrt(Ie/2)}else{let ae=!1;ne>Number.EPSILON?W>Number.EPSILON&&(ae=!0):ne<-Number.EPSILON?W<-Number.EPSILON&&(ae=!0):Math.sign(U)===Math.sign(P)&&(ae=!0),ae?(B=-U,D=ne,$=Math.sqrt(C)):(B=ne,D=U,$=Math.sqrt(C/2))}return new Ae(B/$,D/$)}const F=[];for(let pe=0,G=k.length,q=G-1,B=pe+1;pe<G;pe++,q++,B++)q===G&&(q=0),B===G&&(B=0),F[pe]=V(k[pe],k[q],k[B]);const J=[];let Y,te=F.concat();for(let pe=0,G=_.length;pe<G;pe++){const q=_[pe];Y=[];for(let B=0,D=q.length,$=D-1,ne=B+1;B<D;B++,$++,ne++)$===D&&($=0),ne===D&&(ne=0),Y[B]=V(q[B],q[$],q[ne]);J.push(Y),te=te.concat(Y)}for(let pe=0;pe<y;pe++){const G=pe/y,q=d*Math.cos(G*Math.PI/2),B=p*Math.sin(G*Math.PI/2)+m;for(let D=0,$=k.length;D<$;D++){const ne=H(k[D],F[D],B);me(ne.x,ne.y,-q)}for(let D=0,$=_.length;D<$;D++){const ne=_[D];Y=J[D];for(let U=0,W=ne.length;U<W;U++){const P=H(ne[U],Y[U],B);me(P.x,P.y,-q)}}}const z=p+m;for(let pe=0;pe<O;pe++){const G=f?H(R[pe],te[pe],z):R[pe];w?(A.copy(b.normals[0]).multiplyScalar(G.x),M.copy(b.binormals[0]).multiplyScalar(G.y),E.copy(x[0]).add(A).add(M),me(E.x,E.y,E.z)):me(G.x,G.y,0)}for(let pe=1;pe<=u;pe++)for(let G=0;G<O;G++){const q=f?H(R[G],te[G],z):R[G];w?(A.copy(b.normals[pe]).multiplyScalar(q.x),M.copy(b.binormals[pe]).multiplyScalar(q.y),E.copy(x[pe]).add(A).add(M),me(E.x,E.y,E.z)):me(q.x,q.y,c/u*pe)}for(let pe=y-1;pe>=0;pe--){const G=pe/y,q=d*Math.cos(G*Math.PI/2),B=p*Math.sin(G*Math.PI/2)+m;for(let D=0,$=k.length;D<$;D++){const ne=H(k[D],F[D],B);me(ne.x,ne.y,c+q)}for(let D=0,$=_.length;D<$;D++){const ne=_[D];Y=J[D];for(let U=0,W=ne.length;U<W;U++){const P=H(ne[U],Y[U],B);w?me(P.x,P.y+x[u-1].y,x[u-1].x+q):me(P.x,P.y,c+q)}}}K(),Z();function K(){const pe=i.length/3;if(f){let G=0,q=O*G;for(let B=0;B<T;B++){const D=L[B];ge(D[2]+q,D[1]+q,D[0]+q)}G=u+y*2,q=O*G;for(let B=0;B<T;B++){const D=L[B];ge(D[0]+q,D[1]+q,D[2]+q)}}else{for(let G=0;G<T;G++){const q=L[G];ge(q[2],q[1],q[0])}for(let G=0;G<T;G++){const q=L[G];ge(q[0]+O*u,q[1]+O*u,q[2]+O*u)}}n.addGroup(pe,i.length/3-pe,0)}function Z(){const pe=i.length/3;let G=0;Q(k,G),G+=k.length;for(let q=0,B=_.length;q<B;q++){const D=_[q];Q(D,G),G+=D.length}n.addGroup(pe,i.length/3-pe,1)}function Q(pe,G){let q=pe.length;for(;--q>=0;){const B=q;let D=q-1;D<0&&(D=pe.length-1);for(let $=0,ne=u+y*2;$<ne;$++){const U=O*$,W=O*($+1),P=G+B+U,C=G+D+U,ee=G+D+W,ae=G+B+W;se(P,C,ee,ae)}}}function me(pe,G,q){l.push(pe),l.push(G),l.push(q)}function ge(pe,G,q){he(pe),he(G),he(q);const B=i.length/3,D=v.generateTopUV(n,i,B-3,B-2,B-1);xe(D[0]),xe(D[1]),xe(D[2])}function se(pe,G,q,B){he(pe),he(G),he(B),he(G),he(q),he(B);const D=i.length/3,$=v.generateSideWallUV(n,i,D-6,D-3,D-2,D-1);xe($[0]),xe($[1]),xe($[3]),xe($[1]),xe($[2]),xe($[3])}function he(pe){i.push(l[pe*3+0]),i.push(l[pe*3+1]),i.push(l[pe*3+2])}function xe(pe){s.push(pe.x),s.push(pe.y)}}}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,n=this.parameters.options;return O3(t,n,e)}static fromJSON(e,t){const n=[];for(let s=0,o=e.shapes.length;s<o;s++){const a=t[e.shapes[s]];n.push(a)}const i=e.options.extrudePath;return i!==void 0&&(e.options.extrudePath=new cm[i.type]().fromJSON(i)),new ui(n,e.options)}}const F3={generateTopUV:function(r,e,t,n,i){const s=e[t*3],o=e[t*3+1],a=e[n*3],l=e[n*3+1],h=e[i*3],u=e[i*3+1];return[new Ae(s,o),new Ae(a,l),new Ae(h,u)]},generateSideWallUV:function(r,e,t,n,i,s){const o=e[t*3],a=e[t*3+1],l=e[t*3+2],h=e[n*3],u=e[n*3+1],c=e[n*3+2],f=e[i*3],d=e[i*3+1],p=e[i*3+2],m=e[s*3],y=e[s*3+1],g=e[s*3+2];return Math.abs(a-u)<Math.abs(o-h)?[new Ae(o,1-l),new Ae(h,1-c),new Ae(f,1-p),new Ae(m,1-g)]:[new Ae(a,1-l),new Ae(u,1-c),new Ae(d,1-p),new Ae(y,1-g)]}};function O3(r,e,t){if(t.shapes=[],Array.isArray(r))for(let n=0,i=r.length;n<i;n++){const s=r[n];t.shapes.push(s.uuid)}else t.shapes.push(r.uuid);return e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class Ha extends ai{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,i=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,s,e,t);this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Ha(e.radius,e.detail)}}class Ga extends rt{constructor(e=[new Ae(0,.5),new Ae(.5,0),new Ae(0,-.5)],t=12,n=0,i=Math.PI*2){super();this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},t=Math.floor(t),i=In(i,0,Math.PI*2);const s=[],o=[],a=[],l=[],h=[],u=1/t,c=new X,f=new Ae,d=new X,p=new X,m=new X;let y=0,g=0;for(let v=0;v<=e.length-1;v++)switch(v){case 0:y=e[v+1].x-e[v].x,g=e[v+1].y-e[v].y,d.x=g*1,d.y=-y,d.z=g*0,m.copy(d),d.normalize(),l.push(d.x,d.y,d.z);break;case e.length-1:l.push(m.x,m.y,m.z);break;default:y=e[v+1].x-e[v].x,g=e[v+1].y-e[v].y,d.x=g*1,d.y=-y,d.z=g*0,p.copy(d),d.x+=m.x,d.y+=m.y,d.z+=m.z,d.normalize(),l.push(d.x,d.y,d.z),m.copy(p)}for(let v=0;v<=t;v++){const x=n+v*u*i,w=Math.sin(x),b=Math.cos(x);for(let M=0;M<=e.length-1;M++){c.x=e[M].x*w,c.y=e[M].y,c.z=e[M].x*b,o.push(c.x,c.y,c.z),f.x=v/t,f.y=M/(e.length-1),a.push(f.x,f.y);const A=l[3*M+0]*w,E=l[3*M+1],N=l[3*M+0]*b;h.push(A,E,N)}}for(let v=0;v<t;v++)for(let x=0;x<e.length-1;x++){const w=x+v*e.length,b=w,M=w+e.length,A=w+e.length+1,E=w+1;s.push(b,M,E),s.push(M,A,E)}this.setIndex(s),this.setAttribute("position",new je(o,3)),this.setAttribute("uv",new je(a,2)),this.setAttribute("normal",new je(h,3))}static fromJSON(e){return new Ga(e.points,e.segments,e.phiStart,e.phiLength)}}class po extends ai{constructor(e=1,t=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],i=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,i,e,t);this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new po(e.radius,e.detail)}}class ka extends rt{constructor(e=.5,t=1,n=8,i=1,s=0,o=Math.PI*2){super();this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:s,thetaLength:o},n=Math.max(3,n),i=Math.max(1,i);const a=[],l=[],h=[],u=[];let c=e;const f=(t-e)/i,d=new X,p=new Ae;for(let m=0;m<=i;m++){for(let y=0;y<=n;y++){const g=s+y/n*o;d.x=c*Math.cos(g),d.y=c*Math.sin(g),l.push(d.x,d.y,d.z),h.push(0,0,1),p.x=(d.x/t+1)/2,p.y=(d.y/t+1)/2,u.push(p.x,p.y)}c+=f}for(let m=0;m<i;m++){const y=m*(n+1);for(let g=0;g<n;g++){const v=g+y,x=v,w=v+n+1,b=v+n+2,M=v+1;a.push(x,w,M),a.push(w,b,M)}}this.setIndex(a),this.setAttribute("position",new je(l,3)),this.setAttribute("normal",new je(h,3)),this.setAttribute("uv",new je(u,2))}static fromJSON(e){return new ka(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class mo extends rt{constructor(e=new li([new Ae(0,.5),new Ae(-.5,-.5),new Ae(.5,-.5)]),t=12){super();this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],i=[],s=[],o=[];let a=0,l=0;if(Array.isArray(e)===!1)h(e);else for(let u=0;u<e.length;u++)h(e[u]),this.addGroup(a,l,u),a+=l,l=0;this.setIndex(n),this.setAttribute("position",new je(i,3)),this.setAttribute("normal",new je(s,3)),this.setAttribute("uv",new je(o,2));function h(u){const c=i.length/3,f=u.extractPoints(t);let d=f.shape;const p=f.holes;ci.isClockWise(d)===!1&&(d=d.reverse());for(let y=0,g=p.length;y<g;y++){const v=p[y];ci.isClockWise(v)===!0&&(p[y]=v.reverse())}const m=ci.triangulateShape(d,p);for(let y=0,g=p.length;y<g;y++){const v=p[y];d=d.concat(v)}for(let y=0,g=d.length;y<g;y++){const v=d[y];i.push(v.x,v.y,0),s.push(0,0,1),o.push(v.x,v.y)}for(let y=0,g=m.length;y<g;y++){const v=m[y],x=v[0]+c,w=v[1]+c,b=v[2]+c;n.push(x,w,b),l+=3}}}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return z3(t,e)}static fromJSON(e,t){const n=[];for(let i=0,s=e.shapes.length;i<s;i++){const o=t[e.shapes[i]];n.push(o)}return new mo(n,e.curveSegments)}}function z3(r,e){if(e.shapes=[],Array.isArray(r))for(let t=0,n=r.length;t<n;t++){const i=r[t];e.shapes.push(i.uuid)}else e.shapes.push(r.uuid);return e}class go extends rt{constructor(e=1,t=32,n=16,i=0,s=Math.PI*2,o=0,a=Math.PI){super();this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const l=Math.min(o+a,Math.PI);let h=0;const u=[],c=new X,f=new X,d=[],p=[],m=[],y=[];for(let g=0;g<=n;g++){const v=[],x=g/n;let w=0;g==0&&o==0?w=.5/t:g==n&&l==Math.PI&&(w=-.5/t);for(let b=0;b<=t;b++){const M=b/t;c.x=-e*Math.cos(i+M*s)*Math.sin(o+x*a),c.y=e*Math.cos(o+x*a),c.z=e*Math.sin(i+M*s)*Math.sin(o+x*a),p.push(c.x,c.y,c.z),f.copy(c).normalize(),m.push(f.x,f.y,f.z),y.push(M+w,1-x),v.push(h++)}u.push(v)}for(let g=0;g<n;g++)for(let v=0;v<t;v++){const x=u[g][v+1],w=u[g][v],b=u[g+1][v],M=u[g+1][v+1];(g!==0||o>0)&&d.push(x,w,M),(g!==n-1||l<Math.PI)&&d.push(w,b,M)}this.setIndex(d),this.setAttribute("position",new je(p,3)),this.setAttribute("normal",new je(m,3)),this.setAttribute("uv",new je(y,2))}static fromJSON(e){return new go(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Va extends ai{constructor(e=1,t=0){const n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],i=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,i,e,t);this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Va(e.radius,e.detail)}}class Wa extends rt{constructor(e=1,t=.4,n=8,i=6,s=Math.PI*2){super();this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:s},n=Math.floor(n),i=Math.floor(i);const o=[],a=[],l=[],h=[],u=new X,c=new X,f=new X;for(let d=0;d<=n;d++)for(let p=0;p<=i;p++){const m=p/i*s,y=d/n*Math.PI*2;c.x=(e+t*Math.cos(y))*Math.cos(m),c.y=(e+t*Math.cos(y))*Math.sin(m),c.z=t*Math.sin(y),a.push(c.x,c.y,c.z),u.x=e*Math.cos(m),u.y=e*Math.sin(m),f.subVectors(c,u).normalize(),l.push(f.x,f.y,f.z),h.push(p/i),h.push(d/n)}for(let d=1;d<=n;d++)for(let p=1;p<=i;p++){const m=(i+1)*d+p-1,y=(i+1)*(d-1)+p-1,g=(i+1)*(d-1)+p,v=(i+1)*d+p;o.push(m,y,v),o.push(y,g,v)}this.setIndex(o),this.setAttribute("position",new je(a,3)),this.setAttribute("normal",new je(l,3)),this.setAttribute("uv",new je(h,2))}static fromJSON(e){return new Wa(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class qa extends rt{constructor(e=1,t=.4,n=64,i=8,s=2,o=3){super();this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:s,q:o},n=Math.floor(n),i=Math.floor(i);const a=[],l=[],h=[],u=[],c=new X,f=new X,d=new X,p=new X,m=new X,y=new X,g=new X;for(let x=0;x<=n;++x){const w=x/n*s*Math.PI*2;v(w,s,o,e,d),v(w+.01,s,o,e,p),y.subVectors(p,d),g.addVectors(p,d),m.crossVectors(y,g),g.crossVectors(m,y),m.normalize(),g.normalize();for(let b=0;b<=i;++b){const M=b/i*Math.PI*2,A=-t*Math.cos(M),E=t*Math.sin(M);c.x=d.x+(A*g.x+E*m.x),c.y=d.y+(A*g.y+E*m.y),c.z=d.z+(A*g.z+E*m.z),l.push(c.x,c.y,c.z),f.subVectors(c,d).normalize(),h.push(f.x,f.y,f.z),u.push(x/n),u.push(b/i)}}for(let x=1;x<=n;x++)for(let w=1;w<=i;w++){const b=(i+1)*(x-1)+(w-1),M=(i+1)*x+(w-1),A=(i+1)*x+w,E=(i+1)*(x-1)+w;a.push(b,M,E),a.push(M,A,E)}this.setIndex(a),this.setAttribute("position",new je(l,3)),this.setAttribute("normal",new je(h,3)),this.setAttribute("uv",new je(u,2));function v(x,w,b,M,A){const E=Math.cos(x),N=Math.sin(x),R=b/w*x,_=Math.cos(R);A.x=M*(2+_)*.5*E,A.y=M*(2+_)*N*.5,A.z=M*Math.sin(R)*.5}}static fromJSON(e){return new qa(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class Ya extends rt{constructor(e=new Ch(new X(-1,-1,0),new X(-1,1,0),new X(1,1,0)),t=64,n=1,i=8,s=!1){super();this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:i,closed:s};const o=e.computeFrenetFrames(t,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new X,l=new X,h=new Ae;let u=new X;const c=[],f=[],d=[],p=[];m(),this.setIndex(p),this.setAttribute("position",new je(c,3)),this.setAttribute("normal",new je(f,3)),this.setAttribute("uv",new je(d,2));function m(){for(let x=0;x<t;x++)y(x);y(s===!1?t:0),v(),g()}function y(x){u=e.getPointAt(x/t,u);const w=o.normals[x],b=o.binormals[x];for(let M=0;M<=i;M++){const A=M/i*Math.PI*2,E=Math.sin(A),N=-Math.cos(A);l.x=N*w.x+E*b.x,l.y=N*w.y+E*b.y,l.z=N*w.z+E*b.z,l.normalize(),f.push(l.x,l.y,l.z),a.x=u.x+n*l.x,a.y=u.y+n*l.y,a.z=u.z+n*l.z,c.push(a.x,a.y,a.z)}}function g(){for(let x=1;x<=t;x++)for(let w=1;w<=i;w++){const b=(i+1)*(x-1)+(w-1),M=(i+1)*x+(w-1),A=(i+1)*x+w,E=(i+1)*(x-1)+w;p.push(b,M,E),p.push(M,A,E)}}function v(){for(let x=0;x<=t;x++)for(let w=0;w<=i;w++)h.x=x/t,h.y=w/i,d.push(h.x,h.y)}}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new Ya(new cm[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class Bh extends rt{constructor(e=null){super();if(this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],n=new Set,i=new X,s=new X;if(e.index!==null){const o=e.attributes.position,a=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:a.count,materialIndex:0}]);for(let h=0,u=l.length;h<u;++h){const c=l[h],f=c.start,d=c.count;for(let p=f,m=f+d;p<m;p+=3)for(let y=0;y<3;y++){const g=a.getX(p+y),v=a.getX(p+(y+1)%3);i.fromBufferAttribute(o,g),s.fromBufferAttribute(o,v),Qw(i,s,n)===!0&&(t.push(i.x,i.y,i.z),t.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let a=0,l=o.count/3;a<l;a++)for(let h=0;h<3;h++){const u=3*a+h,c=3*a+(h+1)%3;i.fromBufferAttribute(o,u),s.fromBufferAttribute(o,c),Qw(i,s,n)===!0&&(t.push(i.x,i.y,i.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new je(t,3))}}}function Qw(r,e,t){const n=`${r.x},${r.y},${r.z}-${e.x},${e.y},${e.z}`,i=`${e.x},${e.y},${e.z}-${r.x},${r.y},${r.z}`;return t.has(n)===!0||t.has(i)===!0?!1:(t.add(n,i),!0)}var jw=Object.freeze({__proto__:null,BoxGeometry:Fi,BoxBufferGeometry:Fi,CircleGeometry:Fa,CircleBufferGeometry:Fa,ConeGeometry:Oa,ConeBufferGeometry:Oa,CylinderGeometry:As,CylinderBufferGeometry:As,DodecahedronGeometry:za,DodecahedronBufferGeometry:za,EdgesGeometry:tm,ExtrudeGeometry:ui,ExtrudeBufferGeometry:ui,IcosahedronGeometry:Ha,IcosahedronBufferGeometry:Ha,LatheGeometry:Ga,LatheBufferGeometry:Ga,OctahedronGeometry:po,OctahedronBufferGeometry:po,PlaneGeometry:co,PlaneBufferGeometry:co,PolyhedronGeometry:ai,PolyhedronBufferGeometry:ai,RingGeometry:ka,RingBufferGeometry:ka,ShapeGeometry:mo,ShapeBufferGeometry:mo,SphereGeometry:go,SphereBufferGeometry:go,TetrahedronGeometry:Va,TetrahedronBufferGeometry:Va,TorusGeometry:Wa,TorusBufferGeometry:Wa,TorusKnotGeometry:qa,TorusKnotBufferGeometry:qa,TubeGeometry:Ya,TubeBufferGeometry:Ya,WireframeGeometry:Bh});class fm extends an{constructor(e){super();this.type="ShadowMaterial",this.color=new He(0),this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this}}fm.prototype.isShadowMaterial=!0;class vo extends an{constructor(e){super();this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new He(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new He(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=cs,this.normalScale=new Ae(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}vo.prototype.isMeshStandardMaterial=!0;class Oi extends vo{constructor(e){super();this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Ae(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return In(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.sheenColor=new He(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new He(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new He(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}Oi.prototype.isMeshPhysicalMaterial=!0;class dm extends an{constructor(e){super();this.type="MeshPhongMaterial",this.color=new He(16777215),this.specular=new He(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new He(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=cs,this.normalScale=new Ae(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Cl,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}dm.prototype.isMeshPhongMaterial=!0;class pm extends an{constructor(e){super();this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new He(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new He(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=cs,this.normalScale=new Ae(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}pm.prototype.isMeshToonMaterial=!0;class Lh extends an{constructor(e){super();this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=cs,this.normalScale=new Ae(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}Lh.prototype.isMeshNormalMaterial=!0;class mm extends an{constructor(e){super();this.type="MeshLambertMaterial",this.color=new He(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new He(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Cl,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}mm.prototype.isMeshLambertMaterial=!0;class gm extends an{constructor(e){super();this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new He(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=cs,this.normalScale=new Ae(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this}}gm.prototype.isMeshMatcapMaterial=!0;class vm extends gn{constructor(e){super();this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}vm.prototype.isLineDashedMaterial=!0;var U3=Object.freeze({__proto__:null,ShadowMaterial:fm,SpriteMaterial:hh,RawShaderMaterial:_a,ShaderMaterial:Pn,PointsMaterial:Ms,MeshPhysicalMaterial:Oi,MeshStandardMaterial:vo,MeshPhongMaterial:dm,MeshToonMaterial:pm,MeshNormalMaterial:Lh,MeshLambertMaterial:mm,MeshDepthMaterial:ch,MeshDistanceMaterial:uh,MeshBasicMaterial:ir,MeshMatcapMaterial:gm,LineDashedMaterial:vm,LineBasicMaterial:gn,Material:an});const Vt={arraySlice:function(r,e,t){return Vt.isTypedArray(r)?new r.constructor(r.subarray(e,t!==void 0?t:r.length)):r.slice(e,t)},convertArray:function(r,e,t){return!r||!t&&r.constructor===e?r:typeof e.BYTES_PER_ELEMENT=="number"?new e(r):Array.prototype.slice.call(r)},isTypedArray:function(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)},getKeyframeOrder:function(r){function e(i,s){return r[i]-r[s]}const t=r.length,n=new Array(t);for(let i=0;i!==t;++i)n[i]=i;return n.sort(e),n},sortedArray:function(r,e,t){const n=r.length,i=new r.constructor(n);for(let s=0,o=0;o!==n;++s){const a=t[s]*e;for(let l=0;l!==e;++l)i[o++]=r[a+l]}return i},flattenJSON:function(r,e,t,n){let i=1,s=r[0];for(;s!==void 0&&s[n]===void 0;)s=r[i++];if(s===void 0)return;let o=s[n];if(o!==void 0)if(Array.isArray(o))do o=s[n],o!==void 0&&(e.push(s.time),t.push.apply(t,o)),s=r[i++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[n],o!==void 0&&(e.push(s.time),o.toArray(t,t.length)),s=r[i++];while(s!==void 0);else do o=s[n],o!==void 0&&(e.push(s.time),t.push(o)),s=r[i++];while(s!==void 0)},subclip:function(r,e,t,n,i=30){const s=r.clone();s.name=e;const o=[];for(let l=0;l<s.tracks.length;++l){const h=s.tracks[l],u=h.getValueSize(),c=[],f=[];for(let d=0;d<h.times.length;++d){const p=h.times[d]*i;if(!(p<t||p>=n)){c.push(h.times[d]);for(let m=0;m<u;++m)f.push(h.values[d*u+m])}}c.length!==0&&(h.times=Vt.convertArray(c,h.times.constructor),h.values=Vt.convertArray(f,h.values.constructor),o.push(h))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s},makeClipAdditive:function(r,e=0,t=r,n=30){n<=0&&(n=30);const i=t.tracks.length,s=e/n;for(let o=0;o<i;++o){const a=t.tracks[o],l=a.ValueTypeName;if(l==="bool"||l==="string")continue;const h=r.tracks.find(function(g){return g.name===a.name&&g.ValueTypeName===l});if(h===void 0)continue;let u=0;const c=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=c/3);let f=0;const d=h.getValueSize();h.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(f=d/3);const p=a.times.length-1;let m;if(s<=a.times[0]){const g=u,v=c-u;m=Vt.arraySlice(a.values,g,v)}else if(s>=a.times[p]){const g=p*c+u,v=g+c-u;m=Vt.arraySlice(a.values,g,v)}else{const g=a.createInterpolant(),v=u,x=c-u;g.evaluate(s),m=Vt.arraySlice(g.resultBuffer,v,x)}l==="quaternion"&&new Sn().fromArray(m).normalize().conjugate().toArray(m);const y=h.times.length;for(let g=0;g<y;++g){const v=g*d+f;if(l==="quaternion")Sn.multiplyQuaternionsFlat(h.values,v,m,0,h.values,v);else{const x=d-f*2;for(let w=0;w<x;++w)h.values[v+w]-=m[w]}}}return r.blendMode=pp,r}};class hi{constructor(e,t,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,i=t[n],s=t[n-1];e:{t:{let o;n:{r:if(!(e<i)){for(let a=n+2;;){if(i===void 0){if(e<s)break r;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,s)}if(n===a)break;if(s=i,i=t[++n],e<i)break t}o=t.length;break n}if(!(e>=s)){const a=t[1];e<a&&(n=2,s=a);for(let l=n-2;;){if(s===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,i);if(n===l)break;if(i=s,s=t[--n-1],e>=s)break t}o=n,n=0;break n}break e}for(;n<o;){const a=n+o>>>1;e<t[a]?o=a:n=a+1}if(i=t[n],s=t[n-1],s===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,i);if(i===void 0)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,s,e)}this._cachedIndex=n,this.intervalChanged_(n,s,i)}return this.interpolate_(n,s,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,s=e*i;for(let o=0;o!==i;++o)t[o]=n[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}hi.prototype.beforeStart_=hi.prototype.copySampleValue_;hi.prototype.afterEnd_=hi.prototype.copySampleValue_;class Zw extends hi{constructor(e,t,n,i){super(e,t,n,i);this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:no,endingEnd:no}}intervalChanged_(e,t,n){const i=this.parameterPositions;let s=e-2,o=e+1,a=i[s],l=i[o];if(a===void 0)switch(this.getSettings_().endingStart){case ro:s=e,a=2*t-n;break;case Dl:s=i.length-2,a=t+i[s]-i[s+1];break;default:s=e,a=n}if(l===void 0)switch(this.getSettings_().endingEnd){case ro:o=e,l=2*n-t;break;case Dl:o=1,l=n+i[1]-i[0];break;default:o=e-1,l=t}const h=(n-t)*.5,u=this.valueSize;this._weightPrev=h/(t-a),this._weightNext=h/(l-n),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(e,t,n,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,h=l-a,u=this._offsetPrev,c=this._offsetNext,f=this._weightPrev,d=this._weightNext,p=(n-t)/(i-t),m=p*p,y=m*p,g=-f*y+2*f*m-f*p,v=(1+f)*y+(-1.5-2*f)*m+(-.5+f)*p+1,x=(-1-d)*y+(1.5+d)*m+.5*p,w=d*y-d*m;for(let b=0;b!==a;++b)s[b]=g*o[u+b]+v*o[h+b]+x*o[l+b]+w*o[c+b];return s}}class ym extends hi{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,h=l-a,u=(n-t)/(i-t),c=1-u;for(let f=0;f!==a;++f)s[f]=o[h+f]*c+o[l+f]*u;return s}}class Jw extends hi{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class Gr{constructor(e,t,n,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Vt.convertArray(t,this.TimeBufferType),this.values=Vt.convertArray(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:Vt.convertArray(e.times,Array),values:Vt.convertArray(e.values,Array)};const i=e.getInterpolation();i!==e.DefaultInterpolation&&(n.interpolation=i)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new Jw(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new ym(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Zw(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case ia:t=this.InterpolantFactoryMethodDiscrete;break;case to:t=this.InterpolantFactoryMethodLinear;break;case Cu:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return ia;case this.InterpolantFactoryMethodLinear:return to;case this.InterpolantFactoryMethodSmooth:return Cu}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]*=e}return this}trim(e,t){const n=this.times,i=n.length;let s=0,o=i-1;for(;s!==i&&n[s]<e;)++s;for(;o!==-1&&n[o]>t;)--o;if(++o,s!==0||o!==i){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=Vt.arraySlice(n,s,o),this.values=Vt.arraySlice(this.values,s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,i=this.values,s=n.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=n[a];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(o!==null&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(i!==void 0&&Vt.isTypedArray(i))for(let a=0,l=i.length;a!==l;++a){const h=i[a];if(isNaN(h)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,h),e=!1;break}}return e}optimize(){const e=Vt.arraySlice(this.times),t=Vt.arraySlice(this.values),n=this.getValueSize(),i=this.getInterpolation()===Cu,s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const h=e[a],u=e[a+1];if(h!==u&&(a!==1||h!==e[0]))if(i)l=!0;else{const c=a*n,f=c-n,d=c+n;for(let p=0;p!==n;++p){const m=t[c+p];if(m!==t[f+p]||m!==t[d+p]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const c=a*n,f=o*n;for(let d=0;d!==n;++d)t[f+d]=t[c+d]}++o}}if(s>0){e[o]=e[s];for(let a=s*n,l=o*n,h=0;h!==n;++h)t[l+h]=t[a+h];++o}return o!==e.length?(this.times=Vt.arraySlice(e,0,o),this.values=Vt.arraySlice(t,0,o*n)):(this.times=e,this.values=t),this}clone(){const e=Vt.arraySlice(this.times,0),t=Vt.arraySlice(this.values,0),n=this.constructor,i=new n(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}}Gr.prototype.TimeBufferType=Float32Array;Gr.prototype.ValueBufferType=Float32Array;Gr.prototype.DefaultInterpolation=to;class yo extends Gr{}yo.prototype.ValueTypeName="bool";yo.prototype.ValueBufferType=Array;yo.prototype.DefaultInterpolation=ia;yo.prototype.InterpolantFactoryMethodLinear=void 0;yo.prototype.InterpolantFactoryMethodSmooth=void 0;class xm extends Gr{}xm.prototype.ValueTypeName="color";class Xa extends Gr{}Xa.prototype.ValueTypeName="number";class Kw extends hi{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(n-t)/(i-t);let h=e*a;for(let u=h+a;h!==u;h+=4)Sn.slerpFlat(s,0,o,h-a,o,h,l);return s}}class Es extends Gr{InterpolantFactoryMethodLinear(e){return new Kw(this.times,this.values,this.getValueSize(),e)}}Es.prototype.ValueTypeName="quaternion";Es.prototype.DefaultInterpolation=to;Es.prototype.InterpolantFactoryMethodSmooth=void 0;class xo extends Gr{}xo.prototype.ValueTypeName="string";xo.prototype.ValueBufferType=Array;xo.prototype.DefaultInterpolation=ia;xo.prototype.InterpolantFactoryMethodLinear=void 0;xo.prototype.InterpolantFactoryMethodSmooth=void 0;class Qa extends Gr{}Qa.prototype.ValueTypeName="vector";class ja{constructor(e,t=-1,n,i=Ru){this.name=e,this.tracks=n,this.duration=t,this.blendMode=i,this.uuid=vr(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,i=1/(e.fps||1);for(let o=0,a=n.length;o!==a;++o)t.push(G3(n[o]).scale(i));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],n=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=n.length;s!==o;++s)t.push(Gr.toJSON(n[s]));return i}static CreateFromMorphTargetSequence(e,t,n,i){const s=t.length,o=[];for(let a=0;a<s;a++){let l=[],h=[];l.push((a+s-1)%s,a,(a+1)%s),h.push(0,1,0);const u=Vt.getKeyframeOrder(l);l=Vt.sortedArray(l,1,u),h=Vt.sortedArray(h,1,u),!i&&l[0]===0&&(l.push(s),h.push(h[0])),o.push(new Xa(".morphTargetInfluences["+t[a].name+"]",l,h).scale(1/n))}return new this(e,-1,o)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const i=e;n=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const i={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const h=e[a],u=h.name.match(s);if(u&&u.length>1){const c=u[1];let f=i[c];f||(i[c]=f=[]),f.push(h)}}const o=[];for(const a in i)o.push(this.CreateFromMorphTargetSequence(a,i[a],t,n));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(c,f,d,p,m){if(d.length!==0){const y=[],g=[];Vt.flattenJSON(d,y,g,p),y.length!==0&&m.push(new c(f,y,g))}},i=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const h=e.hierarchy||[];for(let c=0;c<h.length;c++){const f=h[c].keys;if(!(!f||f.length===0))if(f[0].morphTargets){const d={};let p;for(p=0;p<f.length;p++)if(f[p].morphTargets)for(let m=0;m<f[p].morphTargets.length;m++)d[f[p].morphTargets[m]]=-1;for(const m in d){const y=[],g=[];for(let v=0;v!==f[p].morphTargets.length;++v){const x=f[p];y.push(x.time),g.push(x.morphTarget===m?1:0)}i.push(new Xa(".morphTargetInfluence["+m+"]",y,g))}l=d.length*(o||1)}else{const d=".bones["+t[c].name+"]";n(Qa,d+".position",f,"pos",i),n(Es,d+".quaternion",f,"rot",i),n(Qa,d+".scale",f,"scl",i)}}return i.length===0?null:new this(s,l,i,a)}resetDuration(){const e=this.tracks;let t=0;for(let n=0,i=e.length;n!==i;++n){const s=this.tracks[n];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function H3(r){switch(r.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Xa;case"vector":case"vector2":case"vector3":case"vector4":return Qa;case"color":return xm;case"quaternion":return Es;case"bool":case"boolean":return yo;case"string":return xo}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+r)}function G3(r){if(r.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=H3(r.type);if(r.times===void 0){const t=[],n=[];Vt.flattenJSON(r.keys,t,n,"value"),r.times=t,r.values=n}return e.parse!==void 0?e.parse(r):new e(r.name,r.times,r.values,r.interpolation)}const wo={enabled:!1,files:{},add:function(r,e){this.enabled!==!1&&(this.files[r]=e)},get:function(r){if(this.enabled!==!1)return this.files[r]},remove:function(r){delete this.files[r]},clear:function(){this.files={}}};class wm{constructor(e,t,n){const i=this;let s=!1,o=0,a=0,l;const h=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(u){a++,s===!1&&i.onStart!==void 0&&i.onStart(u,o,a),s=!0},this.itemEnd=function(u){o++,i.onProgress!==void 0&&i.onProgress(u,o,a),o===a&&(s=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(u){i.onError!==void 0&&i.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,c){return h.push(u,c),this},this.removeHandler=function(u){const c=h.indexOf(u);return c!==-1&&h.splice(c,2),this},this.getHandler=function(u){for(let c=0,f=h.length;c<f;c+=2){const d=h[c],p=h[c+1];if(d.global&&(d.lastIndex=0),d.test(u))return p}return null}}}const $w=new wm;class Bn{constructor(e){this.manager=e!==void 0?e:$w,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(i,s){n.load(e,i,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const zi={};class Zn extends Bn{constructor(e){super(e)}load(e,t,n,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=wo.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(zi[e]!==void 0){zi[e].push({onLoad:t,onProgress:n,onError:i});return}zi[e]=[],zi[e].push({onLoad:t,onProgress:n,onError:i});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"});fetch(o).then(a=>{if(a.status===200||a.status===0){if(a.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream=="undefined"||a.body.getReader===void 0)return a;const l=zi[e],h=a.body.getReader(),u=a.headers.get("Content-Length"),c=u?parseInt(u):0,f=c!==0;let d=0;const p=new ReadableStream({start(m){y();function y(){h.read().then(({done:g,value:v})=>{if(g)m.close();else{d+=v.byteLength;const x=new ProgressEvent("progress",{lengthComputable:f,loaded:d,total:c});for(let w=0,b=l.length;w<b;w++){const M=l[w];M.onProgress&&M.onProgress(x)}m.enqueue(v),y()}})}}});return new Response(p)}else throw Error(`fetch for "${a.url}" responded with ${a.status}: ${a.statusText}`)}).then(a=>{switch(this.responseType){case"arraybuffer":return a.arrayBuffer();case"blob":return a.blob();case"document":return a.text().then(l=>new DOMParser().parseFromString(l,this.mimeType));case"json":return a.json();default:return a.text()}}).then(a=>{wo.add(e,a);const l=zi[e];delete zi[e];for(let h=0,u=l.length;h<u;h++){const c=l[h];c.onLoad&&c.onLoad(a)}}).catch(a=>{const l=zi[e];if(l===void 0)throw this.manager.itemError(e),a;delete zi[e];for(let h=0,u=l.length;h<u;h++){const c=l[h];c.onError&&c.onError(a)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class k3 extends Bn{constructor(e){super(e)}load(e,t,n,i){const s=this,o=new Zn(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},n,i)}parse(e){const t=[];for(let n=0;n<e.length;n++){const i=ja.parse(e[n]);t.push(i)}return t}}class V3 extends Bn{constructor(e){super(e)}load(e,t,n,i){const s=this,o=[],a=new nc,l=new Zn(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(s.withCredentials);let h=0;function u(c){l.load(e[c],function(f){const d=s.parse(f,!0);o[c]={width:d.width,height:d.height,format:d.format,mipmaps:d.mipmaps},h+=1,h===6&&(d.mipmapCount===1&&(a.minFilter=ft),a.image=o,a.format=d.format,a.needsUpdate=!0,t&&t(a))},n,i)}if(Array.isArray(e))for(let c=0,f=e.length;c<f;++c)u(c);else l.load(e,function(c){const f=s.parse(c,!0);if(f.isCubemap){const d=f.mipmaps.length/f.mipmapCount;for(let p=0;p<d;p++){o[p]={mipmaps:[]};for(let m=0;m<f.mipmapCount;m++)o[p].mipmaps.push(f.mipmaps[p*f.mipmapCount+m]),o[p].format=f.format,o[p].width=f.width,o[p].height=f.height}a.image=o}else a.image.width=f.width,a.image.height=f.height,a.mipmaps=f.mipmaps;f.mipmapCount===1&&(a.minFilter=ft),a.format=f.format,a.needsUpdate=!0,t&&t(a)},n,i);return a}}class hc extends Bn{constructor(e){super(e)}load(e,t,n,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=wo.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=Bu("img");function l(){u(),wo.add(e,this),t&&t(this),s.manager.itemEnd(e)}function h(c){u(),i&&i(c),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){a.removeEventListener("load",l,!1),a.removeEventListener("error",h,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",h,!1),e.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class e1 extends Bn{constructor(e){super(e)}load(e,t,n,i){const s=new Aa,o=new hc(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(h){o.load(e[h],function(u){s.images[h]=u,a++,a===6&&(s.needsUpdate=!0,t&&t(s))},void 0,i)}for(let h=0;h<e.length;++h)l(h);return s}}class t1 extends Bn{constructor(e){super(e)}load(e,t,n,i){const s=this,o=new bs,a=new Zn(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(e,function(l){const h=s.parse(l);!h||(h.image!==void 0?o.image=h.image:h.data!==void 0&&(o.image.width=h.width,o.image.height=h.height,o.image.data=h.data),o.wrapS=h.wrapS!==void 0?h.wrapS:Mn,o.wrapT=h.wrapT!==void 0?h.wrapT:Mn,o.magFilter=h.magFilter!==void 0?h.magFilter:ft,o.minFilter=h.minFilter!==void 0?h.minFilter:ft,o.anisotropy=h.anisotropy!==void 0?h.anisotropy:1,h.encoding!==void 0&&(o.encoding=h.encoding),h.flipY!==void 0&&(o.flipY=h.flipY),h.format!==void 0&&(o.format=h.format),h.type!==void 0&&(o.type=h.type),h.mipmaps!==void 0&&(o.mipmaps=h.mipmaps,o.minFilter=ti),h.mipmapCount===1&&(o.minFilter=ft),h.generateMipmaps!==void 0&&(o.generateMipmaps=h.generateMipmaps),o.needsUpdate=!0,t&&t(o,h))},n,i),o}}class bm extends Bn{constructor(e){super(e)}load(e,t,n,i){const s=new Qt,o=new hc(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,t!==void 0&&t(s)},n,i),s}}class kr extends dt{constructor(e,t=1){super();this.type="Light",this.color=new He(e),this.intensity=t}dispose(){}copy(e){return super.copy(e),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}kr.prototype.isLight=!0;class Mm extends kr{constructor(e,t,n){super(e,n);this.type="HemisphereLight",this.position.copy(dt.DefaultUp),this.updateMatrix(),this.groundColor=new He(t)}copy(e){return kr.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}Mm.prototype.isHemisphereLight=!0;const n1=new Ye,r1=new X,i1=new X;class Am{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Ae(512,512),this.map=null,this.mapPass=null,this.matrix=new Ye,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Vl,this._frameExtents=new Ae(1,1),this._viewportCount=1,this._viewports=[new At(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;r1.setFromMatrixPosition(e.matrixWorld),t.position.copy(r1),i1.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(i1),t.updateMatrixWorld(),n1.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(n1),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class s1 extends Am{constructor(){super(new ln(50,1,.5,500));this.focus=1}updateMatrices(e){const t=this.camera,n=Ol*2*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(n!==t.fov||i!==t.aspect||s!==t.far)&&(t.fov=n,t.aspect=i,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}s1.prototype.isSpotLightShadow=!0;class Dh extends kr{constructor(e,t,n=0,i=Math.PI/3,s=0,o=1){super(e,t);this.type="SpotLight",this.position.copy(dt.DefaultUp),this.updateMatrix(),this.target=new dt,this.distance=n,this.angle=i,this.penumbra=s,this.decay=o,this.shadow=new s1}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}Dh.prototype.isSpotLight=!0;const o1=new Ye,fc=new X,Sm=new X;class a1 extends Am{constructor(){super(new ln(90,1,.5,500));this._frameExtents=new Ae(4,2),this._viewportCount=6,this._viewports=[new At(2,1,1,1),new At(0,1,1,1),new At(3,1,1,1),new At(1,1,1,1),new At(3,0,1,1),new At(1,0,1,1)],this._cubeDirections=[new X(1,0,0),new X(-1,0,0),new X(0,0,1),new X(0,0,-1),new X(0,1,0),new X(0,-1,0)],this._cubeUps=[new X(0,1,0),new X(0,1,0),new X(0,1,0),new X(0,1,0),new X(0,0,1),new X(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,i=this.matrix,s=e.distance||n.far;s!==n.far&&(n.far=s,n.updateProjectionMatrix()),fc.setFromMatrixPosition(e.matrixWorld),n.position.copy(fc),Sm.copy(n.position),Sm.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(Sm),n.updateMatrixWorld(),i.makeTranslation(-fc.x,-fc.y,-fc.z),o1.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(o1)}}a1.prototype.isPointLightShadow=!0;class Fh extends kr{constructor(e,t,n=0,i=1){super(e,t);this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new a1}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}Fh.prototype.isPointLight=!0;class l1 extends Am{constructor(){super(new Ea(-5,5,5,-5,.5,500))}}l1.prototype.isDirectionalLightShadow=!0;class Oh extends kr{constructor(e,t){super(e,t);this.type="DirectionalLight",this.position.copy(dt.DefaultUp),this.updateMatrix(),this.target=new dt,this.shadow=new l1}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}Oh.prototype.isDirectionalLight=!0;class Em extends kr{constructor(e,t){super(e,t);this.type="AmbientLight"}}Em.prototype.isAmbientLight=!0;class _m extends kr{constructor(e,t,n=10,i=10){super(e,t);this.type="RectAreaLight",this.width=n,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}_m.prototype.isRectAreaLight=!0;class Tm{constructor(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new X)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,i=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*i),t.addScaledVector(o[2],.488603*s),t.addScaledVector(o[3],.488603*n),t.addScaledVector(o[4],1.092548*(n*i)),t.addScaledVector(o[5],1.092548*(i*s)),t.addScaledVector(o[6],.315392*(3*s*s-1)),t.addScaledVector(o[7],1.092548*(n*s)),t.addScaledVector(o[8],.546274*(n*n-i*i)),t}getIrradianceAt(e,t){const n=e.x,i=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],2*.511664*i),t.addScaledVector(o[2],2*.511664*s),t.addScaledVector(o[3],2*.511664*n),t.addScaledVector(o[4],2*.429043*n*i),t.addScaledVector(o[5],2*.429043*i*s),t.addScaledVector(o[6],.743125*s*s-.247708),t.addScaledVector(o[7],2*.429043*n*s),t.addScaledVector(o[8],.429043*(n*n-i*i)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].fromArray(e,t+i*3);return this}toArray(e=[],t=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].toArray(e,t+i*3);return e}static getBasisAt(e,t){const n=e.x,i=e.y,s=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*s,t[3]=.488603*n,t[4]=1.092548*n*i,t[5]=1.092548*i*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*n*s,t[8]=.546274*(n*n-i*i)}}Tm.prototype.isSphericalHarmonics3=!0;class dc extends kr{constructor(e=new Tm,t=1){super(void 0,t);this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}dc.prototype.isLightProbe=!0;class c1 extends Bn{constructor(e){super(e);this.textures={}}load(e,t,n,i){const s=this,o=new Zn(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},n,i)}parse(e){const t=this.textures;function n(s){return t[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),t[s]}const i=new U3[e.type];if(e.uuid!==void 0&&(i.uuid=e.uuid),e.name!==void 0&&(i.name=e.name),e.color!==void 0&&i.color!==void 0&&i.color.setHex(e.color),e.roughness!==void 0&&(i.roughness=e.roughness),e.metalness!==void 0&&(i.metalness=e.metalness),e.sheen!==void 0&&(i.sheen=e.sheen),e.sheenColor!==void 0&&(i.sheenColor=new He().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(i.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&i.emissive!==void 0&&i.emissive.setHex(e.emissive),e.specular!==void 0&&i.specular!==void 0&&i.specular.setHex(e.specular),e.specularIntensity!==void 0&&(i.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&i.specularColor!==void 0&&i.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(i.shininess=e.shininess),e.clearcoat!==void 0&&(i.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=e.clearcoatRoughness),e.transmission!==void 0&&(i.transmission=e.transmission),e.thickness!==void 0&&(i.thickness=e.thickness),e.attenuationDistance!==void 0&&(i.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&i.attenuationColor!==void 0&&i.attenuationColor.setHex(e.attenuationColor),e.fog!==void 0&&(i.fog=e.fog),e.flatShading!==void 0&&(i.flatShading=e.flatShading),e.blending!==void 0&&(i.blending=e.blending),e.combine!==void 0&&(i.combine=e.combine),e.side!==void 0&&(i.side=e.side),e.shadowSide!==void 0&&(i.shadowSide=e.shadowSide),e.opacity!==void 0&&(i.opacity=e.opacity),e.format!==void 0&&(i.format=e.format),e.transparent!==void 0&&(i.transparent=e.transparent),e.alphaTest!==void 0&&(i.alphaTest=e.alphaTest),e.depthTest!==void 0&&(i.depthTest=e.depthTest),e.depthWrite!==void 0&&(i.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(i.colorWrite=e.colorWrite),e.stencilWrite!==void 0&&(i.stencilWrite=e.stencilWrite),e.stencilWriteMask!==void 0&&(i.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(i.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(i.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(i.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(i.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(i.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(i.stencilZPass=e.stencilZPass),e.wireframe!==void 0&&(i.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(i.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(i.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(i.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(i.rotation=e.rotation),e.linewidth!==1&&(i.linewidth=e.linewidth),e.dashSize!==void 0&&(i.dashSize=e.dashSize),e.gapSize!==void 0&&(i.gapSize=e.gapSize),e.scale!==void 0&&(i.scale=e.scale),e.polygonOffset!==void 0&&(i.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(i.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(i.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(i.dithering=e.dithering),e.alphaToCoverage!==void 0&&(i.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(i.premultipliedAlpha=e.premultipliedAlpha),e.visible!==void 0&&(i.visible=e.visible),e.toneMapped!==void 0&&(i.toneMapped=e.toneMapped),e.userData!==void 0&&(i.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const o=e.uniforms[s];switch(i.uniforms[s]={},o.type){case"t":i.uniforms[s].value=n(o.value);break;case"c":i.uniforms[s].value=new He().setHex(o.value);break;case"v2":i.uniforms[s].value=new Ae().fromArray(o.value);break;case"v3":i.uniforms[s].value=new X().fromArray(o.value);break;case"v4":i.uniforms[s].value=new At().fromArray(o.value);break;case"m3":i.uniforms[s].value=new yn().fromArray(o.value);break;case"m4":i.uniforms[s].value=new Ye().fromArray(o.value);break;default:i.uniforms[s].value=o.value}}if(e.defines!==void 0&&(i.defines=e.defines),e.vertexShader!==void 0&&(i.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(i.fragmentShader=e.fragmentShader),e.extensions!==void 0)for(const s in e.extensions)i.extensions[s]=e.extensions[s];if(e.shading!==void 0&&(i.flatShading=e.shading===1),e.size!==void 0&&(i.size=e.size),e.sizeAttenuation!==void 0&&(i.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(i.map=n(e.map)),e.matcap!==void 0&&(i.matcap=n(e.matcap)),e.alphaMap!==void 0&&(i.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(i.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(i.bumpScale=e.bumpScale),e.normalMap!==void 0&&(i.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(i.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),i.normalScale=new Ae().fromArray(s)}return e.displacementMap!==void 0&&(i.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(i.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(i.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(i.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(i.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(i.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(i.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(i.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(i.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(i.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(i.envMap=n(e.envMap)),e.envMapIntensity!==void 0&&(i.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(i.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(i.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(i.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(i.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(i.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(i.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(i.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(i.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(i.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(i.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(i.clearcoatNormalScale=new Ae().fromArray(e.clearcoatNormalScale)),e.transmissionMap!==void 0&&(i.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(i.thicknessMap=n(e.thicknessMap)),e.sheenColorMap!==void 0&&(i.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(i.sheenRoughnessMap=n(e.sheenRoughnessMap)),i}setTextures(e){return this.textures=e,this}}class Vr{static decodeText(e){if(typeof TextDecoder!="undefined")return new TextDecoder().decode(e);let t="";for(let n=0,i=e.length;n<i;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.substr(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class zh extends rt{constructor(){super();this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return new this.constructor().copy(this)}toJSON(){const e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}zh.prototype.isInstancedBufferGeometry=!0;class u1 extends Bn{constructor(e){super(e)}load(e,t,n,i){const s=this,o=new Zn(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},n,i)}parse(e){const t={},n={};function i(d,p){if(t[p]!==void 0)return t[p];const y=d.interleavedBuffers[p],g=s(d,y.buffer),v=aa(y.type,g),x=new ws(v,y.stride);return x.uuid=y.uuid,t[p]=x,x}function s(d,p){if(n[p]!==void 0)return n[p];const y=d.arrayBuffers[p],g=new Uint32Array(y).buffer;return n[p]=g,g}const o=e.isInstancedBufferGeometry?new zh:new rt,a=e.data.index;if(a!==void 0){const d=aa(a.type,a.array);o.setIndex(new ut(d,1))}const l=e.data.attributes;for(const d in l){const p=l[d];let m;if(p.isInterleavedBufferAttribute){const y=i(e.data,p.data);m=new Qn(y,p.itemSize,p.offset,p.normalized)}else{const y=aa(p.type,p.array),g=p.isInstancedBufferAttribute?fo:ut;m=new g(y,p.itemSize,p.normalized)}p.name!==void 0&&(m.name=p.name),p.usage!==void 0&&m.setUsage(p.usage),p.updateRange!==void 0&&(m.updateRange.offset=p.updateRange.offset,m.updateRange.count=p.updateRange.count),o.setAttribute(d,m)}const h=e.data.morphAttributes;if(h)for(const d in h){const p=h[d],m=[];for(let y=0,g=p.length;y<g;y++){const v=p[y];let x;if(v.isInterleavedBufferAttribute){const w=i(e.data,v.data);x=new Qn(w,v.itemSize,v.offset,v.normalized)}else{const w=aa(v.type,v.array);x=new ut(w,v.itemSize,v.normalized)}v.name!==void 0&&(x.name=v.name),m.push(x)}o.morphAttributes[d]=m}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const c=e.data.groups||e.data.drawcalls||e.data.offsets;if(c!==void 0)for(let d=0,p=c.length;d!==p;++d){const m=c[d];o.addGroup(m.start,m.count,m.materialIndex)}const f=e.data.boundingSphere;if(f!==void 0){const d=new X;f.center!==void 0&&d.fromArray(f.center),o.boundingSphere=new yr(d,f.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class W3 extends Bn{constructor(e){super(e)}load(e,t,n,i){const s=this,o=this.path===""?Vr.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const a=new Zn(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){let h=null;try{h=JSON.parse(l)}catch(c){i!==void 0&&i(c),console.error("THREE:ObjectLoader: Can't parse "+e+".",c.message);return}const u=h.metadata;if(u===void 0||u.type===void 0||u.type.toLowerCase()==="geometry"){console.error("THREE.ObjectLoader: Can't load "+e);return}s.parse(h,t)},n,i)}async loadAsync(e,t){const n=this,i=this.path===""?Vr.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||i;const s=new Zn(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const o=await s.loadAsync(e,t),a=JSON.parse(o),l=a.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await n.parseAsync(a)}parse(e,t){const n=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,i),o=this.parseImages(e.images,function(){t!==void 0&&t(h)}),a=this.parseTextures(e.textures,o),l=this.parseMaterials(e.materials,a),h=this.parseObject(e.object,s,l,a,n),u=this.parseSkeletons(e.skeletons,h);if(this.bindSkeletons(h,u),t!==void 0){let c=!1;for(const f in o)if(o[f]instanceof HTMLImageElement){c=!0;break}c===!1&&t(h)}return h}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,n),s=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,s),a=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,i,a,o,t),h=this.parseSkeletons(e.skeletons,l);return this.bindSkeletons(l,h),l}parseShapes(e){const t={};if(e!==void 0)for(let n=0,i=e.length;n<i;n++){const s=new li().fromJSON(e[n]);t[s.uuid]=s}return t}parseSkeletons(e,t){const n={},i={};if(t.traverse(function(s){s.isBone&&(i[s.uuid]=s)}),e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=new ec().fromJSON(e[s],i);n[a.uuid]=a}return n}parseGeometries(e,t){const n={};if(e!==void 0){const i=new u1;for(let s=0,o=e.length;s<o;s++){let a;const l=e[s];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":a=i.parse(l);break;case"Geometry":console.error("THREE.ObjectLoader: The legacy Geometry type is no longer supported.");break;default:l.type in jw?a=jw[l.type].fromJSON(l,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${l.type}"`)}a.uuid=l.uuid,l.name!==void 0&&(a.name=l.name),a.isBufferGeometry===!0&&l.userData!==void 0&&(a.userData=l.userData),n[l.uuid]=a}}return n}parseMaterials(e,t){const n={},i={};if(e!==void 0){const s=new c1;s.setTextures(t);for(let o=0,a=e.length;o<a;o++){const l=e[o];if(l.type==="MultiMaterial"){const h=[];for(let u=0;u<l.materials.length;u++){const c=l.materials[u];n[c.uuid]===void 0&&(n[c.uuid]=s.parse(c)),h.push(n[c.uuid])}i[l.uuid]=h}else n[l.uuid]===void 0&&(n[l.uuid]=s.parse(l)),i[l.uuid]=n[l.uuid]}}return i}parseAnimations(e){const t={};if(e!==void 0)for(let n=0;n<e.length;n++){const i=e[n],s=ja.parse(i);t[s.uuid]=s}return t}parseImages(e,t){const n=this,i={};let s;function o(l){return n.manager.itemStart(l),s.load(l,function(){n.manager.itemEnd(l)},void 0,function(){n.manager.itemError(l),n.manager.itemEnd(l)})}function a(l){if(typeof l=="string"){const h=l,u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(h)?h:n.resourcePath+h;return o(u)}else return l.data?{data:aa(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){const l=new wm(t);s=new hc(l),s.setCrossOrigin(this.crossOrigin);for(let h=0,u=e.length;h<u;h++){const c=e[h],f=c.url;if(Array.isArray(f)){i[c.uuid]=[];for(let d=0,p=f.length;d<p;d++){const m=f[d],y=a(m);y!==null&&(y instanceof HTMLImageElement?i[c.uuid].push(y):i[c.uuid].push(new bs(y.data,y.width,y.height)))}}else{const d=a(c.url);d!==null&&(i[c.uuid]=d)}}}return i}async parseImagesAsync(e){const t=this,n={};let i;async function s(o){if(typeof o=="string"){const a=o,l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:t.resourcePath+a;return await i.loadAsync(l)}else return o.data?{data:aa(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){i=new hc(this.manager),i.setCrossOrigin(this.crossOrigin);for(let o=0,a=e.length;o<a;o++){const l=e[o],h=l.url;if(Array.isArray(h)){n[l.uuid]=[];for(let u=0,c=h.length;u<c;u++){const f=h[u],d=await s(f);d!==null&&(d instanceof HTMLImageElement?n[l.uuid].push(d):n[l.uuid].push(new bs(d.data,d.width,d.height)))}}else{const u=await s(l.url);u!==null&&(n[l.uuid]=u)}}}return n}parseTextures(e,t){function n(s,o){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const i={};if(e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=e[s];a.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),t[a.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",a.image);let l;const h=t[a.image];Array.isArray(h)?(l=new Aa(h),h.length===6&&(l.needsUpdate=!0)):(h&&h.data?l=new bs(h.data,h.width,h.height):l=new Qt(h),h&&(l.needsUpdate=!0)),l.uuid=a.uuid,a.name!==void 0&&(l.name=a.name),a.mapping!==void 0&&(l.mapping=n(a.mapping,q3)),a.offset!==void 0&&l.offset.fromArray(a.offset),a.repeat!==void 0&&l.repeat.fromArray(a.repeat),a.center!==void 0&&l.center.fromArray(a.center),a.rotation!==void 0&&(l.rotation=a.rotation),a.wrap!==void 0&&(l.wrapS=n(a.wrap[0],h1),l.wrapT=n(a.wrap[1],h1)),a.format!==void 0&&(l.format=a.format),a.type!==void 0&&(l.type=a.type),a.encoding!==void 0&&(l.encoding=a.encoding),a.minFilter!==void 0&&(l.minFilter=n(a.minFilter,f1)),a.magFilter!==void 0&&(l.magFilter=n(a.magFilter,f1)),a.anisotropy!==void 0&&(l.anisotropy=a.anisotropy),a.flipY!==void 0&&(l.flipY=a.flipY),a.premultiplyAlpha!==void 0&&(l.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(l.unpackAlignment=a.unpackAlignment),a.userData!==void 0&&(l.userData=a.userData),i[a.uuid]=l}return i}parseObject(e,t,n,i,s){let o;function a(f){return t[f]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",f),t[f]}function l(f){if(f!==void 0){if(Array.isArray(f)){const d=[];for(let p=0,m=f.length;p<m;p++){const y=f[p];n[y]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",y),d.push(n[y])}return d}return n[f]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",f),n[f]}}function h(f){return i[f]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",f),i[f]}let u,c;switch(e.type){case"Scene":o=new xs,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new He(e.background):o.background=h(e.background)),e.environment!==void 0&&(o.environment=h(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new Ql(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new Xl(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":o=new ln(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new Ea(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new Em(e.color,e.intensity);break;case"DirectionalLight":o=new Oh(e.color,e.intensity);break;case"PointLight":o=new Fh(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new _m(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new Dh(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new Mm(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=new dc().fromJSON(e);break;case"SkinnedMesh":u=a(e.geometry),c=l(e.material),o=new Kl(u,c),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":u=a(e.geometry),c=l(e.material),o=new Gt(u,c);break;case"InstancedMesh":u=a(e.geometry),c=l(e.material);const f=e.count,d=e.instanceMatrix,p=e.instanceColor;o=new Jp(u,c,f),o.instanceMatrix=new fo(new Float32Array(d.array),16),p!==void 0&&(o.instanceColor=new fo(new Float32Array(p.array),p.itemSize));break;case"LOD":o=new bw;break;case"Line":o=new oi(a(e.geometry),l(e.material));break;case"LineLoop":o=new xh(a(e.geometry),l(e.material));break;case"LineSegments":o=new jn(a(e.geometry),l(e.material));break;case"PointCloud":case"Points":o=new Da(a(e.geometry),l(e.material));break;case"Sprite":o=new ph(l(e.material));break;case"Group":o=new si;break;case"Bone":o=new $l;break;default:o=new dt}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const f=e.children;for(let d=0;d<f.length;d++)o.add(this.parseObject(f[d],t,n,i,s))}if(e.animations!==void 0){const f=e.animations;for(let d=0;d<f.length;d++){const p=f[d];o.animations.push(s[p])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const f=e.levels;for(let d=0;d<f.length;d++){const p=f[d],m=o.getObjectByProperty("uuid",p.object);m!==void 0&&o.addLevel(m,p.distance)}}return o}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){const i=t[n.skeleton];i===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(i,n.bindMatrix)}})}setTexturePath(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}const q3={UVMapping:wu,CubeReflectionMapping:$s,CubeRefractionMapping:eo,EquirectangularReflectionMapping:Rl,EquirectangularRefractionMapping:Nl,CubeUVReflectionMapping:ea,CubeUVRefractionMapping:Il},h1={RepeatWrapping:Ri,ClampToEdgeWrapping:Mn,MirroredRepeatWrapping:ta},f1={NearestFilter:Ut,NearestMipmapNearestFilter:Pl,NearestMipmapLinearFilter:Bl,LinearFilter:ft,LinearMipmapNearestFilter:bu,LinearMipmapLinearFilter:ti};class Cm extends Bn{constructor(e){super(e);typeof createImageBitmap=="undefined"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch=="undefined"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=wo.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){wo.add(e,l),t&&t(l),s.manager.itemEnd(e)}).catch(function(l){i&&i(l),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}Cm.prototype.isImageBitmapLoader=!0;let Uh;const Rm={getContext:function(){return Uh===void 0&&(Uh=new(window.AudioContext||window.webkitAudioContext)),Uh},setContext:function(r){Uh=r}};class d1 extends Bn{constructor(e){super(e)}load(e,t,n,i){const s=this,o=new Zn(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{const l=a.slice(0);Rm.getContext().decodeAudioData(l,function(u){t(u)})}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},n,i)}}class p1 extends dc{constructor(e,t,n=1){super(void 0,n);const i=new He().set(e),s=new He().set(t),o=new X(i.r,i.g,i.b),a=new X(s.r,s.g,s.b),l=Math.sqrt(Math.PI),h=l*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(a).multiplyScalar(l),this.sh.coefficients[1].copy(o).sub(a).multiplyScalar(h)}}p1.prototype.isHemisphereLightProbe=!0;class m1 extends dc{constructor(e,t=1){super(void 0,t);const n=new He().set(e);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}}m1.prototype.isAmbientLightProbe=!0;const g1=new Ye,v1=new Ye,bo=new Ye;class Y3{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new ln,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new ln,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,bo.copy(e.projectionMatrix);const i=t.eyeSep/2,s=i*t.near/t.focus,o=t.near*Math.tan(io*t.fov*.5)/t.zoom;let a,l;v1.elements[12]=-i,g1.elements[12]=i,a=-o*t.aspect+s,l=o*t.aspect+s,bo.elements[0]=2*t.near/(l-a),bo.elements[8]=(l+a)/(l-a),this.cameraL.projectionMatrix.copy(bo),a=-o*t.aspect-s,l=o*t.aspect-s,bo.elements[0]=2*t.near/(l-a),bo.elements[8]=(l+a)/(l-a),this.cameraR.projectionMatrix.copy(bo)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(v1),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(g1)}}class y1{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=x1(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=x1();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function x1(){return(typeof performance=="undefined"?Date:performance).now()}const Mo=new X,w1=new Sn,X3=new X,Ao=new X;class Q3 extends dt{constructor(){super();this.type="AudioListener",this.context=Rm.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new y1}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Mo,w1,X3),Ao.set(0,0,-1).applyQuaternion(w1),t.positionX){const i=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Mo.x,i),t.positionY.linearRampToValueAtTime(Mo.y,i),t.positionZ.linearRampToValueAtTime(Mo.z,i),t.forwardX.linearRampToValueAtTime(Ao.x,i),t.forwardY.linearRampToValueAtTime(Ao.y,i),t.forwardZ.linearRampToValueAtTime(Ao.z,i),t.upX.linearRampToValueAtTime(n.x,i),t.upY.linearRampToValueAtTime(n.y,i),t.upZ.linearRampToValueAtTime(n.z,i)}else t.setPosition(Mo.x,Mo.y,Mo.z),t.setOrientation(Ao.x,Ao.y,Ao.z,n.x,n.y,n.z)}}class Nm extends dt{constructor(e){super();this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const So=new X,b1=new Sn,j3=new X,Eo=new X;class Z3 extends Nm{constructor(e){super(e);this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(So,b1,j3),Eo.set(0,0,1).applyQuaternion(b1);const t=this.panner;if(t.positionX){const n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(So.x,n),t.positionY.linearRampToValueAtTime(So.y,n),t.positionZ.linearRampToValueAtTime(So.z,n),t.orientationX.linearRampToValueAtTime(Eo.x,n),t.orientationY.linearRampToValueAtTime(Eo.y,n),t.orientationZ.linearRampToValueAtTime(Eo.z,n)}else t.setPosition(So.x,So.y,So.z),t.setOrientation(Eo.x,Eo.y,Eo.z)}}class M1{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class A1{constructor(e,t,n){this.binding=e,this.valueSize=n;let i,s,o;switch(t){case"quaternion":i=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":i=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:i=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,i=this.valueSize,s=e*i+i;let o=this.cumulativeWeight;if(o===0){for(let a=0;a!==i;++a)n[s+a]=n[a];o=t}else{o+=t;const a=t/o;this._mixBufferRegion(n,s,0,a,i)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,i=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,i=e*t+t,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const l=t*this._origIndex;this._mixBufferRegion(n,i,l,1-s,t)}o>0&&this._mixBufferRegionAdditive(n,i,this._addIndex*t,1,t);for(let l=t,h=t+t;l!==h;++l)if(n[l]!==n[l+t]){a.setValue(n,i);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,i=n*this._origIndex;e.getValue(t,i);for(let s=n,o=i;s!==o;++s)t[s]=t[i+s%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,i,s){if(i>=.5)for(let o=0;o!==s;++o)e[t+o]=e[n+o]}_slerp(e,t,n,i){Sn.slerpFlat(e,t,e,t,e,n,i)}_slerpAdditive(e,t,n,i,s){const o=this._workIndex*s;Sn.multiplyQuaternionsFlat(e,o,e,t,e,n),Sn.slerpFlat(e,t,e,t,e,o,i)}_lerp(e,t,n,i,s){const o=1-i;for(let a=0;a!==s;++a){const l=t+a;e[l]=e[l]*o+e[n+a]*i}}_lerpAdditive(e,t,n,i,s){for(let o=0;o!==s;++o){const a=t+o;e[a]=e[a]+e[n+o]*i}}}const Im="\\[\\]\\.:\\/",J3=new RegExp("["+Im+"]","g"),Pm="[^"+Im+"]",K3="[^"+Im.replace("\\.","")+"]",$3=/((?:WC+[\/:])*)/.source.replace("WC",Pm),eI=/(WCOD+)?/.source.replace("WCOD",K3),tI=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Pm),nI=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Pm),rI=new RegExp("^"+$3+eI+tI+nI+"$"),iI=["material","materials","bones"];class sI{constructor(e,t,n){const i=n||wt.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,i=this._bindings[n];i!==void 0&&i.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,s=n.length;i!==s;++i)n[i].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}class wt{constructor(e,t,n){this.path=t,this.parsedPath=n||wt.parseTrackName(t),this.node=wt.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new wt.Composite(e,t,n):new wt(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(J3,"")}static parseTrackName(e){const t=rI.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){const s=n.nodeName.substring(i+1);iI.indexOf(s)!==-1&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=s)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(!t||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){const n=function(s){for(let o=0;o<s.length;o++){const a=s[o];if(a.name===t||a.uuid===t)return a;const l=n(a.children);if(l)return l}return null},i=n(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let i=0,s=n.length;i!==s;++i)e[t++]=n[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let i=0,s=n.length;i!==s;++i)n[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,s=n.length;i!==s;++i)n[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,s=n.length;i!==s;++i)n[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,i=t.propertyName;let s=t.propertyIndex;if(e||(e=wt.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(n){let h=t.objectIndex;switch(n){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let u=0;u<e.length;u++)if(e[u].name===h){h=u;break}break;default:if(e[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(h!==void 0){if(e[h]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[h]}}const o=e[i];if(o===void 0){const h=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+h+"."+i+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}l=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(l=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=i;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}wt.Composite=sI;wt.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};wt.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};wt.prototype.GetterByBindingType=[wt.prototype._getValue_direct,wt.prototype._getValue_array,wt.prototype._getValue_arrayElement,wt.prototype._getValue_toArray];wt.prototype.SetterByBindingTypeAndVersioning=[[wt.prototype._setValue_direct,wt.prototype._setValue_direct_setNeedsUpdate,wt.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[wt.prototype._setValue_array,wt.prototype._setValue_array_setNeedsUpdate,wt.prototype._setValue_array_setMatrixWorldNeedsUpdate],[wt.prototype._setValue_arrayElement,wt.prototype._setValue_arrayElement_setNeedsUpdate,wt.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[wt.prototype._setValue_fromArray,wt.prototype._setValue_fromArray_setNeedsUpdate,wt.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class S1{constructor(){this.uuid=vr(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,i=arguments.length;n!==i;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,i=this._parsedPaths,s=this._bindings,o=s.length;let a,l=e.length,h=this.nCachedObjects_;for(let u=0,c=arguments.length;u!==c;++u){const f=arguments[u],d=f.uuid;let p=t[d];if(p===void 0){p=l++,t[d]=p,e.push(f);for(let m=0,y=o;m!==y;++m)s[m].push(new wt(f,n[m],i[m]))}else if(p<h){a=e[p];const m=--h,y=e[m];t[y.uuid]=p,e[p]=y,t[d]=m,e[m]=f;for(let g=0,v=o;g!==v;++g){const x=s[g],w=x[m];let b=x[p];x[p]=w,b===void 0&&(b=new wt(f,n[g],i[g])),x[m]=b}}else e[p]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=h}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let s=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const l=arguments[o],h=l.uuid,u=t[h];if(u!==void 0&&u>=s){const c=s++,f=e[c];t[f.uuid]=u,e[u]=f,t[h]=c,e[c]=l;for(let d=0,p=i;d!==p;++d){const m=n[d],y=m[c],g=m[u];m[u]=y,m[c]=g}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let s=this.nCachedObjects_,o=e.length;for(let a=0,l=arguments.length;a!==l;++a){const h=arguments[a],u=h.uuid,c=t[u];if(c!==void 0)if(delete t[u],c<s){const f=--s,d=e[f],p=--o,m=e[p];t[d.uuid]=c,e[c]=d,t[m.uuid]=f,e[f]=m,e.pop();for(let y=0,g=i;y!==g;++y){const v=n[y],x=v[f],w=v[p];v[c]=x,v[f]=w,v.pop()}}else{const f=--o,d=e[f];f>0&&(t[d.uuid]=c),e[c]=d,e.pop();for(let p=0,m=i;p!==m;++p){const y=n[p];y[c]=y[f],y.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){const n=this._bindingsIndicesByPath;let i=n[e];const s=this._bindings;if(i!==void 0)return s[i];const o=this._paths,a=this._parsedPaths,l=this._objects,h=l.length,u=this.nCachedObjects_,c=new Array(h);i=s.length,n[e]=i,o.push(e),a.push(t),s.push(c);for(let f=u,d=l.length;f!==d;++f){const p=l[f];c[f]=new wt(p,e,t)}return c}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){const i=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length-1,l=o[a],h=e[a];t[h]=n,o[n]=l,o.pop(),s[n]=s[a],s.pop(),i[n]=i[a],i.pop()}}}S1.prototype.isAnimationObjectGroup=!0;class oI{constructor(e,t,n=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=i;const s=t.tracks,o=s.length,a=new Array(o),l={endingStart:no,endingEnd:no};for(let h=0;h!==o;++h){const u=s[h].createInterpolant(null);a[h]=u,u.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=ix,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){const i=this._clip.duration,s=e._clip.duration,o=s/i,a=i/s;e.warp(1,o,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const i=this._mixer,s=i.time,o=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=i._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,h=a.sampleValues;return l[0]=s,l[1]=s+n,h[0]=e/o,h[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,i){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const l=(e-s)*n;if(l<0||n===0)return;this._startTime=null,t=n*l}t*=this._updateTimeScale(e);const o=this._updateTime(t),a=this._updateWeight(e);if(a>0){const l=this._interpolants,h=this._propertyBindings;switch(this.blendMode){case pp:for(let u=0,c=l.length;u!==c;++u)l[u].evaluate(o),h[u].accumulateAdditive(a);break;case Ru:default:for(let u=0,c=l.length;u!==c;++u)l[u].evaluate(o),h[u].accumulate(i,a)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(n!==null){const i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;n!==null&&(t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let i=this.time+e,s=this._loopCount;const o=n===sx;if(e===0)return s===-1?i:o&&(s&1)==1?t-i:i;if(n===rx){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else if(i<0)i=0;else{this.time=i;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),i>=t||i<0){const a=Math.floor(i/t);i-=t*a,s+=Math.abs(a);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){const h=e<0;this._setEndings(h,!h,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=i;if(o&&(s&1)==1)return t-i}return i}_setEndings(e,t,n){const i=this._interpolantSettings;n?(i.endingStart=ro,i.endingEnd=ro):(e?i.endingStart=this.zeroSlopeAtStart?ro:no:i.endingStart=Dl,t?i.endingEnd=this.zeroSlopeAtEnd?ro:no:i.endingEnd=Dl)}_scheduleFading(e,t,n){const i=this._mixer,s=i.time;let o=this._weightInterpolant;o===null&&(o=i._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,l[0]=t,a[1]=s+e,l[1]=n,this}}class E1 extends ri{constructor(e){super();this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,i=e._clip.tracks,s=i.length,o=e._propertyBindings,a=e._interpolants,l=n.uuid,h=this._bindingsByRootAndName;let u=h[l];u===void 0&&(u={},h[l]=u);for(let c=0;c!==s;++c){const f=i[c],d=f.name;let p=u[d];if(p!==void 0)o[c]=p;else{if(p=o[c],p!==void 0){p._cacheIndex===null&&(++p.referenceCount,this._addInactiveBinding(p,l,d));continue}const m=t&&t._propertyBindings[c].binding.parsedPath;p=new A1(wt.create(n,d,m),f.ValueTypeName,f.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,l,d),o[c]=p}a[c].resultBuffer=p.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,i=e._clip.uuid,s=this._actionsByClip[i];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,i,n)}const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const s=t[n];s.useCount++==0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const s=t[n];--s.useCount==0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){const i=this._actions,s=this._actionsByClip;let o=s[t];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=i.length,i.push(e),o.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],i=e._cacheIndex;n._cacheIndex=i,t[i]=n,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],l=a.knownActions,h=l[l.length-1],u=e._byClipCacheIndex;h._byClipCacheIndex=u,l[u]=h,l.pop(),e._byClipCacheIndex=null;const c=a.actionByRoot,f=(e._localRoot||this._root).uuid;delete c[f],l.length===0&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const s=t[n];--s.referenceCount==0&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,i=this._nActiveActions++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=n,t[n]=s}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,i=--this._nActiveActions,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=n,t[n]=s}_addInactiveBinding(e,t,n){const i=this._bindingsByRootAndName,s=this._bindings;let o=i[t];o===void 0&&(o={},i[t]=o),o[n]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,i=n.rootNode.uuid,s=n.path,o=this._bindingsByRootAndName,a=o[i],l=t[t.length-1],h=e._cacheIndex;l._cacheIndex=h,t[h]=l,t.pop(),delete a[s],Object.keys(a).length===0&&delete o[i]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,i=this._nActiveBindings++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=n,t[n]=s}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,i=--this._nActiveBindings,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=n,t[n]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return n===void 0&&(n=new ym(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,i=--this._nActiveControlInterpolants,s=t[i];e.__cacheIndex=i,t[i]=e,s.__cacheIndex=n,t[n]=s}clipAction(e,t,n){const i=t||this._root,s=i.uuid;let o=typeof e=="string"?ja.findByName(i,e):e;const a=o!==null?o.uuid:e,l=this._actionsByClip[a];let h=null;if(n===void 0&&(o!==null?n=o.blendMode:n=Ru),l!==void 0){const c=l.actionByRoot[s];if(c!==void 0&&c.blendMode===n)return c;h=l.knownActions[0],o===null&&(o=h._clip)}if(o===null)return null;const u=new oI(this,o,t,n);return this._bindAction(u,h),this._addInactiveAction(u,a,s),u}existingAction(e,t){const n=t||this._root,i=n.uuid,s=typeof e=="string"?ja.findByName(n,e):e,o=s?s.uuid:e,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[i]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let n=t-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,i=this.time+=e,s=Math.sign(e),o=this._accuIndex^=1;for(let h=0;h!==n;++h)t[h]._update(i,e,s,o);const a=this._bindings,l=this._nActiveBindings;for(let h=0;h!==l;++h)a[h].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,i=this._actionsByClip,s=i[n];if(s!==void 0){const o=s.knownActions;for(let a=0,l=o.length;a!==l;++a){const h=o[a];this._deactivateAction(h);const u=h._cacheIndex,c=t[t.length-1];h._cacheIndex=null,h._byClipCacheIndex=null,c._cacheIndex=u,t[u]=c,t.pop(),this._removeInactiveBindingsForAction(h)}delete i[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const o in n){const a=n[o].actionByRoot,l=a[t];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const i=this._bindingsByRootAndName,s=i[t];if(s!==void 0)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){const n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}E1.prototype._controlInterpolantsResultBuffer=new Float32Array(1);class tt{constructor(e){typeof e=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}clone(){return new tt(this.value.clone===void 0?this.value:this.value.clone())}}class pc extends ws{constructor(e,t,n=1){super(e,t);this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}pc.prototype.isInstancedInterleavedBuffer=!0;class _1{constructor(e,t,n,i,s){this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=i,this.count=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}_1.prototype.isGLBufferAttribute=!0;class aI{constructor(e,t,n=0,i=1/0){this.ray=new Pi(e,t),this.near=n,this.far=i,this.camera=null,this.layers=new Hu,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,n=[]){return Bm(e,this,n,t),n.sort(T1),n}intersectObjects(e,t=!0,n=[]){for(let i=0,s=e.length;i<s;i++)Bm(e[i],this,n,t);return n.sort(T1),n}}function T1(r,e){return r.distance-e.distance}function Bm(r,e,t,n){if(r.layers.test(e.layers)&&r.raycast(e,t),n===!0){const i=r.children;for(let s=0,o=i.length;s<o;s++)Bm(i[s],e,t,!0)}}class lI{constructor(e=1,t=0,n=0){return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){const e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(In(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class cI{constructor(e=1,t=0,n=0){return this.radius=e,this.theta=t,this.y=n,this}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return new this.constructor().copy(this)}}const C1=new Ae;class Za{constructor(e=new Ae(1/0,1/0),t=new Ae(-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=C1.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return C1.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}Za.prototype.isBox2=!0;const R1=new X,Hh=new X;class Ui{constructor(e=new X,t=new X){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){R1.subVectors(e,this.start),Hh.subVectors(this.end,this.start);const n=Hh.dot(Hh);let s=Hh.dot(R1)/n;return t&&(s=In(s,0,1)),s}closestPointToPoint(e,t,n){const i=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const N1=new X;class uI extends dt{constructor(e,t){super();this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;const n=new rt,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,l=32;o<l;o++,a++){const h=o/l*Math.PI*2,u=a/l*Math.PI*2;i.push(Math.cos(h),Math.sin(h),1,Math.cos(u),Math.sin(u),1)}n.setAttribute("position",new je(i,3));const s=new gn({fog:!1,toneMapped:!1});this.cone=new jn(n,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),N1.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(N1),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const _s=new X,Gh=new Ye,Lm=new Ye;class I1 extends jn{constructor(e){const t=P1(e),n=new rt,i=[],s=[],o=new He(0,0,1),a=new He(0,1,0);for(let h=0;h<t.length;h++){const u=t[h];u.parent&&u.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}n.setAttribute("position",new je(i,3)),n.setAttribute("color",new je(s,3));const l=new gn({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,l);this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,i=n.getAttribute("position");Lm.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<t.length;s++){const a=t[s];a.parent&&a.parent.isBone&&(Gh.multiplyMatrices(Lm,a.matrixWorld),_s.setFromMatrixPosition(Gh),i.setXYZ(o,_s.x,_s.y,_s.z),Gh.multiplyMatrices(Lm,a.parent.matrixWorld),_s.setFromMatrixPosition(Gh),i.setXYZ(o+1,_s.x,_s.y,_s.z),o+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}}function P1(r){const e=[];r&&r.isBone&&e.push(r);for(let t=0;t<r.children.length;t++)e.push.apply(e,P1(r.children[t]));return e}class hI extends Gt{constructor(e,t,n){const i=new go(t,4,2),s=new ir({wireframe:!0,fog:!1,toneMapped:!1});super(i,s);this.light=e,this.light.updateMatrixWorld(),this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const fI=new X,B1=new He,L1=new He;class dI extends dt{constructor(e,t,n){super();this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;const i=new po(t);i.rotateY(Math.PI*.5),this.material=new ir({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=i.getAttribute("position"),o=new Float32Array(s.count*3);i.setAttribute("color",new ut(o,3)),this.add(new Gt(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");B1.copy(this.light.color),L1.copy(this.light.groundColor);for(let n=0,i=t.count;n<i;n++){const s=n<i/2?B1:L1;t.setXYZ(n,s.r,s.g,s.b)}t.needsUpdate=!0}e.lookAt(fI.setFromMatrixPosition(this.light.matrixWorld).negate())}}class D1 extends jn{constructor(e=10,t=10,n=4473924,i=8947848){n=new He(n),i=new He(i);const s=t/2,o=e/t,a=e/2,l=[],h=[];for(let f=0,d=0,p=-a;f<=t;f++,p+=o){l.push(-a,0,p,a,0,p),l.push(p,0,-a,p,0,a);const m=f===s?n:i;m.toArray(h,d),d+=3,m.toArray(h,d),d+=3,m.toArray(h,d),d+=3,m.toArray(h,d),d+=3}const u=new rt;u.setAttribute("position",new je(l,3)),u.setAttribute("color",new je(h,3));const c=new gn({vertexColors:!0,toneMapped:!1});super(u,c);this.type="GridHelper"}}class pI extends jn{constructor(e=10,t=16,n=8,i=64,s=4473924,o=8947848){s=new He(s),o=new He(o);const a=[],l=[];for(let c=0;c<=t;c++){const f=c/t*(Math.PI*2),d=Math.sin(f)*e,p=Math.cos(f)*e;a.push(0,0,0),a.push(d,0,p);const m=c&1?s:o;l.push(m.r,m.g,m.b),l.push(m.r,m.g,m.b)}for(let c=0;c<=n;c++){const f=c&1?s:o,d=e-e/n*c;for(let p=0;p<i;p++){let m=p/i*(Math.PI*2),y=Math.sin(m)*d,g=Math.cos(m)*d;a.push(y,0,g),l.push(f.r,f.g,f.b),m=(p+1)/i*(Math.PI*2),y=Math.sin(m)*d,g=Math.cos(m)*d,a.push(y,0,g),l.push(f.r,f.g,f.b)}}const h=new rt;h.setAttribute("position",new je(a,3)),h.setAttribute("color",new je(l,3));const u=new gn({vertexColors:!0,toneMapped:!1});super(h,u);this.type="PolarGridHelper"}}const F1=new X,kh=new X,O1=new X;class mI extends dt{constructor(e,t,n){super();this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,t===void 0&&(t=1);let i=new rt;i.setAttribute("position",new je([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new gn({fog:!1,toneMapped:!1});this.lightPlane=new oi(i,s),this.add(this.lightPlane),i=new rt,i.setAttribute("position",new je([0,0,0,0,0,1],3)),this.targetLine=new oi(i,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){F1.setFromMatrixPosition(this.light.matrixWorld),kh.setFromMatrixPosition(this.light.target.matrixWorld),O1.subVectors(kh,F1),this.lightPlane.lookAt(kh),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(kh),this.targetLine.scale.z=O1.length()}}const Vh=new X,on=new wa;class gI extends jn{constructor(e){const t=new rt,n=new gn({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],s=[],o={},a=new He(16755200),l=new He(16711680),h=new He(43775),u=new He(16777215),c=new He(3355443);f("n1","n2",a),f("n2","n4",a),f("n4","n3",a),f("n3","n1",a),f("f1","f2",a),f("f2","f4",a),f("f4","f3",a),f("f3","f1",a),f("n1","f1",a),f("n2","f2",a),f("n3","f3",a),f("n4","f4",a),f("p","n1",l),f("p","n2",l),f("p","n3",l),f("p","n4",l),f("u1","u2",h),f("u2","u3",h),f("u3","u1",h),f("c","t",u),f("p","c",c),f("cn1","cn2",c),f("cn3","cn4",c),f("cf1","cf2",c),f("cf3","cf4",c);function f(p,m,y){d(p,y),d(m,y)}function d(p,m){i.push(0,0,0),s.push(m.r,m.g,m.b),o[p]===void 0&&(o[p]=[]),o[p].push(i.length/3-1)}t.setAttribute("position",new je(i,3)),t.setAttribute("color",new je(s,3));super(t,n);this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()}update(){const e=this.geometry,t=this.pointMap,n=1,i=1;on.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),un("c",t,e,on,0,0,-1),un("t",t,e,on,0,0,1),un("n1",t,e,on,-n,-i,-1),un("n2",t,e,on,n,-i,-1),un("n3",t,e,on,-n,i,-1),un("n4",t,e,on,n,i,-1),un("f1",t,e,on,-n,-i,1),un("f2",t,e,on,n,-i,1),un("f3",t,e,on,-n,i,1),un("f4",t,e,on,n,i,1),un("u1",t,e,on,n*.7,i*1.1,-1),un("u2",t,e,on,-n*.7,i*1.1,-1),un("u3",t,e,on,0,i*2,-1),un("cf1",t,e,on,-n,0,1),un("cf2",t,e,on,n,0,1),un("cf3",t,e,on,0,-i,1),un("cf4",t,e,on,0,i,1),un("cn1",t,e,on,-n,0,-1),un("cn2",t,e,on,n,0,-1),un("cn3",t,e,on,0,-i,-1),un("cn4",t,e,on,0,i,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function un(r,e,t,n,i,s,o){Vh.set(i,s,o).unproject(n);const a=e[r];if(a!==void 0){const l=t.getAttribute("position");for(let h=0,u=a.length;h<u;h++)l.setXYZ(a[h],Vh.x,Vh.y,Vh.z)}}const Wh=new Rt;class z1 extends jn{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(8*3),s=new rt;s.setIndex(new ut(n,1)),s.setAttribute("position",new ut(i,3));super(s,new gn({color:t,toneMapped:!1}));this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&Wh.setFromObject(this.object),Wh.isEmpty())return;const t=Wh.min,n=Wh.max,i=this.geometry.attributes.position,s=i.array;s[0]=n.x,s[1]=n.y,s[2]=n.z,s[3]=t.x,s[4]=n.y,s[5]=n.z,s[6]=t.x,s[7]=t.y,s[8]=n.z,s[9]=n.x,s[10]=t.y,s[11]=n.z,s[12]=n.x,s[13]=n.y,s[14]=t.z,s[15]=t.x,s[16]=n.y,s[17]=t.z,s[18]=t.x,s[19]=t.y,s[20]=t.z,s[21]=n.x,s[22]=t.y,s[23]=t.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e){return jn.prototype.copy.call(this,e),this.object=e.object,this}}class U1 extends jn{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new rt;s.setIndex(new ut(n,1)),s.setAttribute("position",new je(i,3));super(s,new gn({color:t,toneMapped:!1}));this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}}class vI extends oi{constructor(e,t=1,n=16776960){const i=n,s=[1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],o=new rt;o.setAttribute("position",new je(s,3)),o.computeBoundingSphere();super(o,new gn({color:i,toneMapped:!1}));this.type="PlaneHelper",this.plane=e,this.size=t;const a=[1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],l=new rt;l.setAttribute("position",new je(a,3)),l.computeBoundingSphere(),this.add(new Gt(l,new ir({color:i,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){let t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?zt:Ti,this.lookAt(this.plane.normal),super.updateMatrixWorld(e)}}const H1=new X;let qh,Dm;class yI extends dt{constructor(e=new X(0,0,1),t=new X(0,0,0),n=1,i=16776960,s=n*.2,o=s*.2){super();this.type="ArrowHelper",qh===void 0&&(qh=new rt,qh.setAttribute("position",new je([0,0,0,0,1,0],3)),Dm=new As(0,.5,1,5,1),Dm.translate(0,-.5,0)),this.position.copy(t),this.line=new oi(qh,new gn({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Gt(Dm,new ir({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,s,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{H1.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(H1,t)}}setLength(e,t=e*.2,n=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}}class G1 extends jn{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new rt;i.setAttribute("position",new je(t,3)),i.setAttribute("color",new je(n,3));const s=new gn({vertexColors:!0,toneMapped:!1});super(i,s);this.type="AxesHelper"}setColors(e,t,n){const i=new He,s=this.geometry.attributes.color.array;return i.set(e),i.toArray(s,0),i.toArray(s,3),i.set(t),i.toArray(s,6),i.toArray(s,9),i.set(n),i.toArray(s,12),i.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class xI{constructor(){this.type="ShapePath",this.color=new He,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new ac,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,i){return this.currentPath.quadraticCurveTo(e,t,n,i),this}bezierCurveTo(e,t,n,i,s,o){return this.currentPath.bezierCurveTo(e,t,n,i,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e,t){function n(v){const x=[];for(let w=0,b=v.length;w<b;w++){const M=v[w],A=new li;A.curves=M.curves,x.push(A)}return x}function i(v,x){const w=x.length;let b=!1;for(let M=w-1,A=0;A<w;M=A++){let E=x[M],N=x[A],R=N.x-E.x,_=N.y-E.y;if(Math.abs(_)>Number.EPSILON){if(_<0&&(E=x[A],R=-R,N=x[M],_=-_),v.y<E.y||v.y>N.y)continue;if(v.y===E.y){if(v.x===E.x)return!0}else{const S=_*(v.x-E.x)-R*(v.y-E.y);if(S===0)return!0;if(S<0)continue;b=!b}}else{if(v.y!==E.y)continue;if(N.x<=v.x&&v.x<=E.x||E.x<=v.x&&v.x<=N.x)return!0}}return b}const s=ci.isClockWise,o=this.subPaths;if(o.length===0)return[];if(t===!0)return n(o);let a,l,h;const u=[];if(o.length===1)return l=o[0],h=new li,h.curves=l.curves,u.push(h),u;let c=!s(o[0].getPoints());c=e?!c:c;const f=[],d=[];let p=[],m=0,y;d[m]=void 0,p[m]=[];for(let v=0,x=o.length;v<x;v++)l=o[v],y=l.getPoints(),a=s(y),a=e?!a:a,a?(!c&&d[m]&&m++,d[m]={s:new li,p:y},d[m].s.curves=l.curves,c&&m++,p[m]=[]):p[m].push({h:l,p:y[0]});if(!d[0])return n(o);if(d.length>1){let v=!1;const x=[];for(let w=0,b=d.length;w<b;w++)f[w]=[];for(let w=0,b=d.length;w<b;w++){const M=p[w];for(let A=0;A<M.length;A++){const E=M[A];let N=!0;for(let R=0;R<d.length;R++)i(E.p,d[R].p)&&(w!==R&&x.push({froms:w,tos:R,hole:A}),N?(N=!1,f[R].push(E)):v=!0);N&&f[w].push(E)}}x.length>0&&(v||(p=f))}let g;for(let v=0,x=d.length;v<x;v++){h=d[v].s,u.push(h),g=p[v];for(let w=0,b=g.length;w<b;w++)h.holes.push(g[w].h)}return u}}const k1=new Float32Array(1),wI=new Int32Array(k1.buffer);class bI{static toHalfFloat(e){e>65504&&(console.warn("THREE.DataUtils.toHalfFloat(): value exceeds 65504."),e=65504),k1[0]=e;const t=wI[0];let n=t>>16&32768,i=t>>12&2047;const s=t>>23&255;return s<103?n:s>142?(n|=31744,n|=(s==255?0:1)&&t&8388607,n):s<113?(i|=2048,n|=(i>>114-s)+(i>>113-s&1),n):(n|=s-112<<10|i>>1,n+=i&1,n)}}const MI=0,AI=1,SI=0,EI=1,_I=2;function TI(r){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),r}function CI(r=[]){return console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),r.isMultiMaterial=!0,r.materials=r,r.clone=function(){return r.slice()},r}function RI(r,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Da(r,e)}function NI(r){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new ph(r)}function II(r,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Da(r,e)}function PI(r){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Ms(r)}function BI(r){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Ms(r)}function LI(r){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Ms(r)}function DI(r,e,t){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new X(r,e,t)}function FI(r,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new ut(r,e).setUsage(oa)}function OI(r,e){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new _x(r,e)}function zI(r,e){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new Tx(r,e)}function UI(r,e){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new Cx(r,e)}function HI(r,e){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new Rx(r,e)}function GI(r,e){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new Wu(r,e)}function kI(r,e){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Nx(r,e)}function VI(r,e){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new qu(r,e)}function WI(r,e){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new je(r,e)}function qI(r,e){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Px(r,e)}br.create=function(r,e){return console.log("THREE.Curve.create() has been deprecated"),r.prototype=Object.create(br.prototype),r.prototype.constructor=r,r.prototype.getPoint=e,r};ac.prototype.fromPoints=function(r){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(r)};function YI(r){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new G1(r)}function XI(r,e){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new z1(r,e)}function QI(r,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new jn(new tm(r.geometry),new gn({color:e!==void 0?e:16777215}))}D1.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")};I1.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")};function jI(r,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new jn(new Bh(r.geometry),new gn({color:e!==void 0?e:16777215}))}Bn.prototype.extractUrlBase=function(r){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Vr.extractUrlBase(r)};Bn.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}};function ZI(r){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Zn(r)}function JI(r){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new t1(r)}Za.prototype.center=function(r){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(r)};Za.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()};Za.prototype.isIntersectionBox=function(r){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(r)};Za.prototype.size=function(r){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(r)};Rt.prototype.center=function(r){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(r)};Rt.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()};Rt.prototype.isIntersectionBox=function(r){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(r)};Rt.prototype.isIntersectionSphere=function(r){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(r)};Rt.prototype.size=function(r){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(r)};yr.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()};Vl.prototype.setFromMatrix=function(r){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(r)};Ui.prototype.center=function(r){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(r)};yn.prototype.flattenToArrayOffset=function(r,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(r,e)};yn.prototype.multiplyVector3=function(r){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),r.applyMatrix3(this)};yn.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")};yn.prototype.applyToBufferAttribute=function(r){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),r.applyMatrix3(this)};yn.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")};yn.prototype.getInverse=function(r){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(r).invert()};Ye.prototype.extractPosition=function(r){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(r)};Ye.prototype.flattenToArrayOffset=function(r,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(r,e)};Ye.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new X().setFromMatrixColumn(this,3)};Ye.prototype.setRotationFromQuaternion=function(r){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(r)};Ye.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")};Ye.prototype.multiplyVector3=function(r){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),r.applyMatrix4(this)};Ye.prototype.multiplyVector4=function(r){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),r.applyMatrix4(this)};Ye.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")};Ye.prototype.rotateAxis=function(r){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),r.transformDirection(this)};Ye.prototype.crossVector=function(r){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),r.applyMatrix4(this)};Ye.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")};Ye.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")};Ye.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")};Ye.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")};Ye.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")};Ye.prototype.applyToBufferAttribute=function(r){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),r.applyMatrix4(this)};Ye.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")};Ye.prototype.makeFrustum=function(r,e,t,n,i,s){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(r,e,n,t,i,s)};Ye.prototype.getInverse=function(r){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(r).invert()};Hr.prototype.isIntersectionLine=function(r){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(r)};Sn.prototype.multiplyVector3=function(r){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),r.applyQuaternion(this)};Sn.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()};Pi.prototype.isIntersectionBox=function(r){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(r)};Pi.prototype.isIntersectionPlane=function(r){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(r)};Pi.prototype.isIntersectionSphere=function(r){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(r)};jt.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()};jt.prototype.barycoordFromPoint=function(r,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(r,e)};jt.prototype.midpoint=function(r){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(r)};jt.prototypenormal=function(r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(r)};jt.prototype.plane=function(r){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(r)};jt.barycoordFromPoint=function(r,e,t,n,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),jt.getBarycoord(r,e,t,n,i)};jt.normal=function(r,e,t,n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),jt.getNormal(r,e,t,n)};li.prototype.extractAllPoints=function(r){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(r)};li.prototype.extrude=function(r){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new ui(this,r)};li.prototype.makeGeometry=function(r){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new mo(this,r)};Ae.prototype.fromAttribute=function(r,e,t){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(r,e,t)};Ae.prototype.distanceToManhattan=function(r){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(r)};Ae.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()};X.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")};X.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")};X.prototype.getPositionFromMatrix=function(r){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(r)};X.prototype.getScaleFromMatrix=function(r){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(r)};X.prototype.getColumnFromMatrix=function(r,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,r)};X.prototype.applyProjection=function(r){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(r)};X.prototype.fromAttribute=function(r,e,t){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(r,e,t)};X.prototype.distanceToManhattan=function(r){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(r)};X.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()};At.prototype.fromAttribute=function(r,e,t){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(r,e,t)};At.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()};dt.prototype.getChildByName=function(r){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(r)};dt.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")};dt.prototype.translate=function(r,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,r)};dt.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")};dt.prototype.applyMatrix=function(r){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(r)};Object.defineProperties(dt.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(r){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=r}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}});Gt.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")};Object.defineProperties(Gt.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),ox},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}});Kl.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")};ln.prototype.setLens=function(r,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),e!==void 0&&(this.filmGauge=e),this.setFocalLength(r)};Object.defineProperties(kr.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(r){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=r}},shadowCameraLeft:{set:function(r){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=r}},shadowCameraRight:{set:function(r){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=r}},shadowCameraTop:{set:function(r){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=r}},shadowCameraBottom:{set:function(r){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=r}},shadowCameraNear:{set:function(r){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=r}},shadowCameraFar:{set:function(r){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=r}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(r){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=r}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(r){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=r}},shadowMapHeight:{set:function(r){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=r}}});Object.defineProperties(ut.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===oa},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(oa)}}});ut.prototype.setDynamic=function(r){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(r===!0?oa:sa),this};ut.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},ut.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")};rt.prototype.addIndex=function(r){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(r)};rt.prototype.addAttribute=function(r,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),!(e&&e.isBufferAttribute)&&!(e&&e.isInterleavedBufferAttribute)?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(r,new ut(arguments[1],arguments[2]))):r==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(r,e)};rt.prototype.addDrawCall=function(r,e,t){t!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(r,e)};rt.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()};rt.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")};rt.prototype.removeAttribute=function(r){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(r)};rt.prototype.applyMatrix=function(r){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(r)};Object.defineProperties(rt.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}});ws.prototype.setDynamic=function(r){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(r===!0?oa:sa),this};ws.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")};ui.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")};ui.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")};ui.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")};xs.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")};tt.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this};Object.defineProperties(an.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new He}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(r){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=r===Jd}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(r){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=r}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}});Object.defineProperties(Pn.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(r){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=r}}});Nt.prototype.clearTarget=function(r,e,t,n){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(r),this.clear(e,t,n)};Nt.prototype.animate=function(r){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(r)};Nt.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()};Nt.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()};Nt.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision};Nt.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()};Nt.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")};Nt.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")};Nt.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")};Nt.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")};Nt.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")};Nt.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")};Nt.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures};Nt.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")};Nt.prototype.enableScissorTest=function(r){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(r)};Nt.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")};Nt.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")};Nt.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")};Nt.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")};Nt.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")};Nt.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")};Nt.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")};Nt.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")};Nt.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")};Nt.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()};Object.defineProperties(Nt.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(r){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=r}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(r){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=r}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(r){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=r===!0?Fr:gr}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}},gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}});Object.defineProperties(pw.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}});function KI(r,e,t){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new nh(r,t)}Object.defineProperties(mn.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(r){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=r}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(r){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=r}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(r){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=r}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(r){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=r}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(r){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=r}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(r){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=r}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(r){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=r}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(r){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=r}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(r){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=r}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(r){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=r}}});Nm.prototype.load=function(r){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const e=this;return new d1().load(r,function(n){e.setBuffer(n)}),this};M1.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()};th.prototype.updateCubeMap=function(r,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(r,e)};th.prototype.clear=function(r,e,t,n){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(r,e,t,n)};so.crossOrigin=void 0;so.loadTexture=function(r,e,t,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const i=new bm;i.setCrossOrigin(this.crossOrigin);const s=i.load(r,t,void 0,n);return e&&(s.mapping=e),s};so.loadTextureCube=function(r,e,t,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const i=new e1;i.setCrossOrigin(this.crossOrigin);const s=i.load(r,t,void 0,n);return e&&(s.mapping=e),s};so.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")};so.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};function $I(){console.error("THREE.CanvasRenderer has been removed")}function eP(){console.error("THREE.JSONLoader has been removed.")}const tP={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function nP(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}function rP(){return console.error("THREE.ParametricGeometry has been moved to /examples/jsm/geometries/ParametricGeometry.js"),new rt}function iP(){return console.error("THREE.TextGeometry has been moved to /examples/jsm/geometries/TextGeometry.js"),new rt}function sP(){console.error("THREE.FontLoader has been moved to /examples/jsm/loaders/FontLoader.js")}function oP(){console.error("THREE.Font has been moved to /examples/jsm/loaders/FontLoader.js")}function aP(){console.error("THREE.ImmediateRenderObject has been removed.")}typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:yu}}));typeof window!="undefined"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=yu);var g5=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",ACESFilmicToneMapping:gy,AddEquation:Ks,AddOperation:fy,AdditiveAnimationBlendMode:pp,AdditiveBlending:Kd,AlphaFormat:Sy,AlwaysDepth:sy,AlwaysStencilFunc:ux,AmbientLight:Em,AmbientLightProbe:m1,AnimationClip:ja,AnimationLoader:k3,AnimationMixer:E1,AnimationObjectGroup:S1,AnimationUtils:Vt,ArcCurve:nm,ArrayCamera:Qp,ArrowHelper:yI,Audio:Nm,AudioAnalyser:M1,AudioContext:Rm,AudioListener:Q3,AudioLoader:d1,AxesHelper:G1,AxisHelper:YI,BackSide:zt,BasicDepthPacking:Fl,BasicShadowMap:q_,BinaryTextureLoader:JI,Bone:$l,BooleanKeyframeTrack:yo,BoundingBoxHelper:XI,Box2:Za,Box3:Rt,Box3Helper:U1,BoxBufferGeometry:Fi,BoxGeometry:Fi,BoxHelper:z1,BufferAttribute:ut,BufferGeometry:rt,BufferGeometryLoader:u1,ByteType:yy,Cache:wo,Camera:wa,CameraHelper:gI,CanvasRenderer:$I,CanvasTexture:zw,CatmullRomCurve3:am,CineonToneMapping:my,CircleBufferGeometry:Fa,CircleGeometry:Fa,ClampToEdgeWrapping:Mn,Clock:y1,Color:He,ColorKeyframeTrack:xm,CompressedTexture:nc,CompressedTextureLoader:V3,ConeBufferGeometry:Oa,ConeGeometry:Oa,CubeCamera:th,CubeReflectionMapping:$s,CubeRefractionMapping:eo,CubeTexture:Aa,CubeTextureLoader:e1,CubeUVReflectionMapping:ea,CubeUVRefractionMapping:Il,CubicBezierCurve:_h,CubicBezierCurve3:lm,CubicInterpolant:Zw,CullFaceBack:jd,CullFaceFront:W0,CullFaceFrontBack:W_,CullFaceNone:V0,Curve:br,CurvePath:Gw,CustomBlending:Y0,CustomToneMapping:vy,CylinderBufferGeometry:As,CylinderGeometry:As,Cylindrical:cI,DataTexture:bs,DataTexture2DArray:ah,DataTexture3D:qp,DataTextureLoader:t1,DataUtils:bI,DecrementStencilOp:eT,DecrementWrapStencilOp:nT,DefaultLoadingManager:$w,DepthFormat:as,DepthStencilFormat:ls,DepthTexture:Yl,DirectionalLight:Oh,DirectionalLightHelper:mI,DiscreteInterpolant:Jw,DodecahedronBufferGeometry:za,DodecahedronGeometry:za,DoubleSide:mr,DstAlphaFactor:$0,DstColorFactor:ty,DynamicBufferAttribute:FI,DynamicCopyUsage:gT,DynamicDrawUsage:oa,DynamicReadUsage:dT,EdgesGeometry:tm,EdgesHelper:QI,EllipseCurve:rc,EqualDepth:ay,EqualStencilFunc:oT,EquirectangularReflectionMapping:Rl,EquirectangularRefractionMapping:Nl,Euler:lo,EventDispatcher:ri,ExtrudeBufferGeometry:ui,ExtrudeGeometry:ui,FaceColors:EI,FileLoader:Zn,FlatShading:Jd,Float16BufferAttribute:Ix,Float32Attribute:WI,Float32BufferAttribute:je,Float64Attribute:qI,Float64BufferAttribute:Px,FloatType:ni,Fog:Ql,FogExp2:Xl,Font:oP,FontLoader:sP,FramebufferTexture:Ow,FrontSide:Ti,Frustum:Vl,GLBufferAttribute:_1,GLSL1:yT,GLSL3:gp,GreaterDepth:cy,GreaterEqualDepth:ly,GreaterEqualStencilFunc:uT,GreaterStencilFunc:lT,GridHelper:D1,Group:si,HalfFloatType:ss,HemisphereLight:Mm,HemisphereLightHelper:dI,HemisphereLightProbe:p1,IcosahedronBufferGeometry:Ha,IcosahedronGeometry:Ha,ImageBitmapLoader:Cm,ImageLoader:hc,ImageUtils:so,ImmediateRenderObject:aP,IncrementStencilOp:$_,IncrementWrapStencilOp:tT,InstancedBufferAttribute:fo,InstancedBufferGeometry:zh,InstancedInterleavedBuffer:pc,InstancedMesh:Jp,Int16Attribute:HI,Int16BufferAttribute:Rx,Int32Attribute:kI,Int32BufferAttribute:Nx,Int8Attribute:OI,Int8BufferAttribute:_x,IntType:wy,InterleavedBuffer:ws,InterleavedBufferAttribute:Qn,Interpolant:hi,InterpolateDiscrete:ia,InterpolateLinear:to,InterpolateSmooth:Cu,InvertStencilOp:rT,JSONLoader:eP,KeepStencilOp:Nu,KeyframeTrack:Gr,LOD:bw,LatheBufferGeometry:Ga,LatheGeometry:Ga,Layers:Hu,LensFlare:nP,LessDepth:oy,LessEqualDepth:xu,LessEqualStencilFunc:aT,LessStencilFunc:sT,Light:kr,LightProbe:dc,Line:oi,Line3:Ui,LineBasicMaterial:gn,LineCurve:oc,LineCurve3:Hw,LineDashedMaterial:vm,LineLoop:xh,LinePieces:AI,LineSegments:jn,LineStrip:MI,LinearEncoding:gr,LinearFilter:ft,LinearInterpolant:ym,LinearMipMapLinearFilter:Z_,LinearMipMapNearestFilter:j_,LinearMipmapLinearFilter:ti,LinearMipmapNearestFilter:bu,LinearToneMapping:dy,Loader:Bn,LoaderUtils:Vr,LoadingManager:wm,LoopOnce:rx,LoopPingPong:sx,LoopRepeat:ix,LuminanceAlphaFormat:Ey,LuminanceFormat:Ll,MOUSE:k_,Material:an,MaterialLoader:c1,Math:Pu,MathUtils:Pu,Matrix3:yn,Matrix4:Ye,MaxEquation:np,Mesh:Gt,MeshBasicMaterial:ir,MeshDepthMaterial:ch,MeshDistanceMaterial:uh,MeshFaceMaterial:TI,MeshLambertMaterial:mm,MeshMatcapMaterial:gm,MeshNormalMaterial:Lh,MeshPhongMaterial:dm,MeshPhysicalMaterial:Oi,MeshStandardMaterial:vo,MeshToonMaterial:pm,MinEquation:tp,MirroredRepeatWrapping:ta,MixOperation:hy,MultiMaterial:CI,MultiplyBlending:ep,MultiplyOperation:Cl,NearestFilter:Ut,NearestMipMapLinearFilter:Q_,NearestMipMapNearestFilter:X_,NearestMipmapLinearFilter:Bl,NearestMipmapNearestFilter:Pl,NeverDepth:iy,NeverStencilFunc:iT,NoBlending:Un,NoColors:SI,NoToneMapping:Ci,NormalAnimationBlendMode:Ru,NormalBlending:$o,NotEqualDepth:uy,NotEqualStencilFunc:cT,NumberKeyframeTrack:Xa,Object3D:dt,ObjectLoader:W3,ObjectSpaceNormalMap:cx,OctahedronBufferGeometry:po,OctahedronGeometry:po,OneFactor:Z0,OneMinusDstAlphaFactor:ey,OneMinusDstColorFactor:ny,OneMinusSrcAlphaFactor:ip,OneMinusSrcColorFactor:K0,OrthographicCamera:Ea,PCFShadowMap:Zd,PCFSoftShadowMap:q0,PMREMGenerator:Hx,ParametricGeometry:rP,Particle:NI,ParticleBasicMaterial:BI,ParticleSystem:II,ParticleSystemMaterial:LI,Path:ac,PerspectiveCamera:ln,Plane:Hr,PlaneBufferGeometry:co,PlaneGeometry:co,PlaneHelper:vI,PointCloud:RI,PointCloudMaterial:PI,PointLight:Fh,PointLightHelper:hI,Points:Da,PointsMaterial:Ms,PolarGridHelper:pI,PolyhedronBufferGeometry:ai,PolyhedronGeometry:ai,PositionalAudio:Z3,PropertyBinding:wt,PropertyMixer:A1,QuadraticBezierCurve:Th,QuadraticBezierCurve3:Ch,Quaternion:Sn,QuaternionKeyframeTrack:Es,QuaternionLinearInterpolant:Kw,REVISION:yu,RGBADepthPacking:lx,RGBAFormat:Lt,RGBAIntegerFormat:Ry,RGBA_ASTC_10x10_Format:Hy,RGBA_ASTC_10x5_Format:Oy,RGBA_ASTC_10x6_Format:zy,RGBA_ASTC_10x8_Format:Uy,RGBA_ASTC_12x10_Format:Gy,RGBA_ASTC_12x12_Format:ky,RGBA_ASTC_4x4_Format:fp,RGBA_ASTC_5x4_Format:Ny,RGBA_ASTC_5x5_Format:Iy,RGBA_ASTC_6x5_Format:Py,RGBA_ASTC_6x6_Format:By,RGBA_ASTC_8x5_Format:Ly,RGBA_ASTC_8x6_Format:Dy,RGBA_ASTC_8x8_Format:Fy,RGBA_BPTC_Format:dp,RGBA_ETC2_EAC_Format:Tu,RGBA_PVRTC_2BPPV1_Format:up,RGBA_PVRTC_4BPPV1_Format:Eu,RGBA_S3TC_DXT1_Format:ap,RGBA_S3TC_DXT3_Format:lp,RGBA_S3TC_DXT5_Format:Au,RGBFormat:An,RGBIntegerFormat:Cy,RGB_ETC1_Format:hp,RGB_ETC2_Format:_u,RGB_PVRTC_2BPPV1_Format:cp,RGB_PVRTC_4BPPV1_Format:Su,RGB_S3TC_DXT1_Format:Mu,RGFormat:op,RGIntegerFormat:Ty,RawShaderMaterial:_a,Ray:Pi,Raycaster:aI,RectAreaLight:_m,RedFormat:sp,RedIntegerFormat:_y,ReinhardToneMapping:py,RepeatWrapping:Ri,ReplaceStencilOp:K_,ReverseSubtractEquation:Q0,RingBufferGeometry:ka,RingGeometry:ka,SRGB8_ALPHA8_ASTC_10x10_Format:ex,SRGB8_ALPHA8_ASTC_10x5_Format:Jy,SRGB8_ALPHA8_ASTC_10x6_Format:Ky,SRGB8_ALPHA8_ASTC_10x8_Format:$y,SRGB8_ALPHA8_ASTC_12x10_Format:tx,SRGB8_ALPHA8_ASTC_12x12_Format:nx,SRGB8_ALPHA8_ASTC_4x4_Format:Vy,SRGB8_ALPHA8_ASTC_5x4_Format:Wy,SRGB8_ALPHA8_ASTC_5x5_Format:qy,SRGB8_ALPHA8_ASTC_6x5_Format:Yy,SRGB8_ALPHA8_ASTC_6x6_Format:Xy,SRGB8_ALPHA8_ASTC_8x5_Format:Qy,SRGB8_ALPHA8_ASTC_8x6_Format:jy,SRGB8_ALPHA8_ASTC_8x8_Format:Zy,Scene:xs,SceneUtils:tP,ShaderChunk:pt,ShaderLib:Yn,ShaderMaterial:Pn,ShadowMaterial:fm,Shape:li,ShapeBufferGeometry:mo,ShapeGeometry:mo,ShapePath:xI,ShapeUtils:ci,ShortType:xy,Skeleton:ec,SkeletonHelper:I1,SkinnedMesh:Kl,SmoothShading:Y_,Sphere:yr,SphereBufferGeometry:go,SphereGeometry:go,Spherical:lI,SphericalHarmonics3:Tm,SplineCurve:Rh,SpotLight:Dh,SpotLightHelper:uI,Sprite:ph,SpriteMaterial:hh,SrcAlphaFactor:rp,SrcAlphaSaturateFactor:ry,SrcColorFactor:J0,StaticCopyUsage:mT,StaticDrawUsage:sa,StaticReadUsage:fT,StereoCamera:Y3,StreamCopyUsage:vT,StreamDrawUsage:hT,StreamReadUsage:pT,StringKeyframeTrack:xo,SubtractEquation:X0,SubtractiveBlending:$d,TOUCH:V_,TangentSpaceNormalMap:cs,TetrahedronBufferGeometry:Va,TetrahedronGeometry:Va,TextGeometry:iP,Texture:Qt,TextureLoader:bm,TorusBufferGeometry:Wa,TorusGeometry:Wa,TorusKnotBufferGeometry:qa,TorusKnotGeometry:qa,Triangle:jt,TriangleFanDrawMode:mp,TriangleStripDrawMode:ax,TrianglesDrawMode:ox,TubeBufferGeometry:Ya,TubeGeometry:Ya,UVMapping:wu,Uint16Attribute:GI,Uint16BufferAttribute:Wu,Uint32Attribute:VI,Uint32BufferAttribute:qu,Uint8Attribute:zI,Uint8BufferAttribute:Tx,Uint8ClampedAttribute:UI,Uint8ClampedBufferAttribute:Cx,Uniform:tt,UniformsLib:Ve,UniformsUtils:eh,UnsignedByteType:pn,UnsignedInt248Type:os,UnsignedIntType:ra,UnsignedShort4444Type:by,UnsignedShort5551Type:My,UnsignedShort565Type:Ay,UnsignedShortType:na,VSMShadowMap:Ko,Vector2:Ae,Vector3:X,Vector4:At,VectorKeyframeTrack:Qa,Vertex:DI,VertexColors:_I,VideoTexture:Fw,WebGL1Renderer:gw,WebGLCubeRenderTarget:nh,WebGLMultipleRenderTargets:px,WebGLMultisampleRenderTarget:ca,WebGLRenderTarget:mn,WebGLRenderTargetCube:KI,WebGLRenderer:Nt,WebGLUtils:mw,WireframeGeometry:Bh,WireframeHelper:jI,WrapAroundEnding:Dl,XHRLoader:ZI,ZeroCurvatureEnding:no,ZeroFactor:j0,ZeroSlopeEnding:ro,ZeroStencilOp:J_,sRGBEncoding:Fr}),V1=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function W1(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function Yh(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var q1={exports:{}};(function(r,e){(function(t,n){r.exports=n()})(V1,function(){var t=function(){function n(d){return o.appendChild(d.dom),d}function i(d){for(var p=0;p<o.children.length;p++)o.children[p].style.display=p===d?"block":"none";s=d}var s=0,o=document.createElement("div");o.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",o.addEventListener("click",function(d){d.preventDefault(),i(++s%o.children.length)},!1);var a=(performance||Date).now(),l=a,h=0,u=n(new t.Panel("FPS","#0ff","#002")),c=n(new t.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var f=n(new t.Panel("MB","#f08","#201"));return i(0),{REVISION:16,dom:o,addPanel:n,showPanel:i,begin:function(){a=(performance||Date).now()},end:function(){h++;var d=(performance||Date).now();if(c.update(d-a,200),d>l+1e3&&(u.update(1e3*h/(d-l),100),l=d,h=0,f)){var p=performance.memory;f.update(p.usedJSHeapSize/1048576,p.jsHeapSizeLimit/1048576)}return d},update:function(){a=this.end()},domElement:o,setMode:i}};return t.Panel=function(n,i,s){var o=1/0,a=0,l=Math.round,h=l(window.devicePixelRatio||1),u=80*h,c=48*h,f=3*h,d=2*h,p=3*h,m=15*h,y=74*h,g=30*h,v=document.createElement("canvas");v.width=u,v.height=c,v.style.cssText="width:80px;height:48px";var x=v.getContext("2d");return x.font="bold "+9*h+"px Helvetica,Arial,sans-serif",x.textBaseline="top",x.fillStyle=s,x.fillRect(0,0,u,c),x.fillStyle=i,x.fillText(n,f,d),x.fillRect(p,m,y,g),x.fillStyle=s,x.globalAlpha=.9,x.fillRect(p,m,y,g),{dom:v,update:function(w,b){o=Math.min(o,w),a=Math.max(a,w),x.fillStyle=s,x.globalAlpha=1,x.fillRect(0,0,u,m),x.fillStyle=i,x.fillText(l(w)+" "+n+" ("+l(o)+"-"+l(a)+")",f,d),x.drawImage(v,p+h,m,y-h,g,p,m,y-h,g),x.fillRect(p+y-h,m,h,g),x.fillStyle=s,x.globalAlpha=.9,x.fillRect(p+y-h,m,h,l((1-w/b)*g))}}},t})})(q1);var v5=q1.exports;/**
 * postprocessing v6.23.4 build Sun Jan 09 2022
 * https://github.com/vanruesc/postprocessing
 * Copyright 2022 Raoul van Rüschen
 * @license Zlib
 */var Y1="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",lP=`varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
#if EDGE_DETECTION_MODE == 1
#include <common>
#endif
#if EDGE_DETECTION_MODE == 0 || PREDICATION_MODE == 1
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}vec3 gatherNeighbors(){float p=readDepth(vUv);float pLeft=readDepth(vUv0);float pTop=readDepth(vUv1);return vec3(p,pLeft,pTop);}
#elif PREDICATION_MODE == 2
uniform sampler2D predicationBuffer;vec3 gatherNeighbors(){float p=texture2D(predicationBuffer,vUv).r;float pLeft=texture2D(predicationBuffer,vUv0).r;float pTop=texture2D(predicationBuffer,vUv1).r;return vec3(p,pLeft,pTop);}
#endif
#if PREDICATION_MODE != 0
vec2 calculatePredicatedThreshold(){vec3 neighbours=gatherNeighbors();vec2 delta=abs(neighbours.xx-neighbours.yz);vec2 edges=step(PREDICATION_THRESHOLD,delta);return PREDICATION_SCALE*EDGE_THRESHOLD*(1.0-PREDICATION_STRENGTH*edges);}
#endif
#if EDGE_DETECTION_MODE != 0
uniform sampler2D inputBuffer;
#endif
void main(){
#if EDGE_DETECTION_MODE == 0
const vec2 threshold=vec2(DEPTH_THRESHOLD);
#elif PREDICATION_MODE != 0
vec2 threshold=calculatePredicatedThreshold();
#else
const vec2 threshold=vec2(EDGE_THRESHOLD);
#endif
#if EDGE_DETECTION_MODE == 0
vec3 neighbors=gatherNeighbors();vec2 delta=abs(neighbors.xx-vec2(neighbors.y,neighbors.z));vec2 edges=step(threshold,delta);if(dot(edges,vec2(1.0))==0.0){discard;}gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 1
float l=linearToRelativeLuminance(texture2D(inputBuffer,vUv).rgb);float lLeft=linearToRelativeLuminance(texture2D(inputBuffer,vUv0).rgb);float lTop=linearToRelativeLuminance(texture2D(inputBuffer,vUv1).rgb);vec4 delta;delta.xy=abs(l-vec2(lLeft,lTop));vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}float lRight=linearToRelativeLuminance(texture2D(inputBuffer,vUv2).rgb);float lBottom=linearToRelativeLuminance(texture2D(inputBuffer,vUv3).rgb);delta.zw=abs(l-vec2(lRight,lBottom));vec2 maxDelta=max(delta.xy,delta.zw);float lLeftLeft=linearToRelativeLuminance(texture2D(inputBuffer,vUv4).rgb);float lTopTop=linearToRelativeLuminance(texture2D(inputBuffer,vUv5).rgb);delta.zw=abs(vec2(lLeft,lTop)-vec2(lLeftLeft,lTopTop));maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges.xy*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 2
vec4 delta;vec3 c=texture2D(inputBuffer,vUv).rgb;vec3 cLeft=texture2D(inputBuffer,vUv0).rgb;vec3 t=abs(c-cLeft);delta.x=max(max(t.r,t.g),t.b);vec3 cTop=texture2D(inputBuffer,vUv1).rgb;t=abs(c-cTop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}vec3 cRight=texture2D(inputBuffer,vUv2).rgb;t=abs(c-cRight);delta.z=max(max(t.r,t.g),t.b);vec3 cBottom=texture2D(inputBuffer,vUv3).rgb;t=abs(c-cBottom);delta.w=max(max(t.r,t.g),t.b);vec2 maxDelta=max(delta.xy,delta.zw);vec3 cLeftLeft=texture2D(inputBuffer,vUv4).rgb;t=abs(c-cLeftLeft);delta.z=max(max(t.r,t.g),t.b);vec3 cTopTop=texture2D(inputBuffer,vUv5).rgb;t=abs(c-cTopTop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#endif
}`,cP=`uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,0.0);vUv1=vUv+texelSize*vec2(0.0,-1.0);
#if EDGE_DETECTION_MODE != 0
vUv2=vUv+texelSize*vec2(1.0,0.0);vUv3=vUv+texelSize*vec2(0.0,1.0);vUv4=vUv+texelSize*vec2(-2.0,0.0);vUv5=vUv+texelSize*vec2(0.0,-2.0);
#endif
gl_Position=vec4(position.xy,1.0,1.0);}`,uP=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <dithering_fragment>
}`,hP="uniform vec2 texelSize;uniform vec2 halfTexelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize*vec2(kernel)+halfTexelSize)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",X1=class extends Pn{constructor(r=new Ae){super({name:"ConvolutionMaterial",uniforms:{inputBuffer:new tt(null),texelSize:new tt(new Ae),halfTexelSize:new tt(new Ae),kernel:new tt(0),scale:new tt(1)},blending:Un,depthWrite:!1,depthTest:!1,fragmentShader:uP,vertexShader:hP});this.toneMapped=!1,this.setTexelSize(r.x,r.y),this.kernelSize=Fm.LARGE}getKernel(){return fP[this.kernelSize]}setTexelSize(r,e){this.uniforms.texelSize.value.set(r,e),this.uniforms.halfTexelSize.value.set(r,e).multiplyScalar(.5)}},fP=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],Fm={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},dP=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <encodings_fragment>
}`,pP=class extends Pn{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new tt(null),opacity:new tt(1)},blending:Un,depthWrite:!1,depthTest:!1,fragmentShader:dP,vertexShader:Y1});this.toneMapped=!1}},mP=class extends Pn{constructor(r=new Ae,e=Q1.COLOR){super({name:"EdgeDetectionMaterial",defines:{LOCAL_CONTRAST_ADAPTATION_FACTOR:"2.0",EDGE_THRESHOLD:"0.1",DEPTH_THRESHOLD:"0.01",PREDICATION_MODE:"0",PREDICATION_THRESHOLD:"0.01",PREDICATION_SCALE:"2.0",PREDICATION_STRENGTH:"1.0",DEPTH_PACKING:"0"},uniforms:{inputBuffer:new tt(null),depthBuffer:new tt(null),predicationBuffer:new tt(null),texelSize:new tt(r)},blending:Un,depthWrite:!1,depthTest:!1,fragmentShader:lP,vertexShader:cP});this.toneMapped=!1,this.setEdgeDetectionMode(e)}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(r){this.defines.DEPTH_PACKING=r.toFixed(0),this.needsUpdate=!0}setEdgeDetectionMode(r){this.defines.EDGE_DETECTION_MODE=r.toFixed(0),this.needsUpdate=!0}setLocalContrastAdaptationFactor(r){this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR=r.toFixed("6"),this.needsUpdate=!0}setEdgeDetectionThreshold(r){this.defines.EDGE_THRESHOLD=r.toFixed("6"),this.defines.DEPTH_THRESHOLD=(r*.1).toFixed("6"),this.needsUpdate=!0}setPredicationMode(r){this.defines.PREDICATION_MODE=r.toFixed(0),this.needsUpdate=!0}setPredicationBuffer(r){this.uniforms.predicationBuffer.value=r}setPredicationThreshold(r){this.defines.PREDICATION_THRESHOLD=r.toFixed("6"),this.needsUpdate=!0}setPredicationScale(r){this.defines.PREDICATION_SCALE=r.toFixed("6"),this.needsUpdate=!0}setPredicationStrength(r){this.defines.PREDICATION_STRENGTH=r.toFixed("6"),this.needsUpdate=!0}},Q1={DEPTH:0,LUMA:1,COLOR:2},gP=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}FRAGMENT_HEADvoid main(){FRAGMENT_MAIN_UVvec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGEgl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <encodings_fragment>
#endif
#include <dithering_fragment>
}`,vP="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEADvoid main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORTgl_Position=vec4(position.xy,1.0,1.0);}",yP=class extends Pn{constructor(r,e,t,n,i=!1){super({type:"EffectMaterial",defines:{DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new tt(null),depthBuffer:new tt(null),resolution:new tt(new Ae),texelSize:new tt(new Ae),cameraNear:new tt(.3),cameraFar:new tt(1e3),aspect:new tt(1),time:new tt(0)},blending:Un,depthWrite:!1,depthTest:!1,dithering:i});this.toneMapped=!1,r&&this.setShaderParts(r),e&&this.setDefines(e),t&&this.setUniforms(t),this.adoptCameraSettings(n)}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(r){this.defines.DEPTH_PACKING=r.toFixed(0),this.needsUpdate=!0}setShaderParts(r){return this.fragmentShader=gP.replace(St.FRAGMENT_HEAD,r.get(St.FRAGMENT_HEAD)).replace(St.FRAGMENT_MAIN_UV,r.get(St.FRAGMENT_MAIN_UV)).replace(St.FRAGMENT_MAIN_IMAGE,r.get(St.FRAGMENT_MAIN_IMAGE)),this.vertexShader=vP.replace(St.VERTEX_HEAD,r.get(St.VERTEX_HEAD)).replace(St.VERTEX_MAIN_SUPPORT,r.get(St.VERTEX_MAIN_SUPPORT)),this.needsUpdate=!0,this}setDefines(r){for(const e of r.entries())this.defines[e[0]]=e[1];return this.needsUpdate=!0,this}setUniforms(r){for(const e of r.entries())this.uniforms[e[0]]=e[1];return this}adoptCameraSettings(r=null){r!==null&&(this.uniforms.cameraNear.value=r.near,this.uniforms.cameraFar.value=r.far,r instanceof ln?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(r,e){const t=Math.max(r,1),n=Math.max(e,1);this.uniforms.resolution.value.set(t,n),this.uniforms.texelSize.value.set(1/t,1/n),this.uniforms.aspect.value=t/n}},St={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},xP=`#include <common>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=linearToRelativeLuminance(texel.rgb);
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);l*=low*high;
#elif defined(THRESHOLD)
l=smoothstep(threshold,threshold+smoothing,l);
#endif
#ifdef COLOR
gl_FragColor=vec4(texel.rgb*l,l);
#else
gl_FragColor=vec4(l);
#endif
}`,wP=class extends Pn{constructor(r=!1,e=null){const t=e!==null;super({name:"LuminanceMaterial",uniforms:{inputBuffer:new tt(null),threshold:new tt(0),smoothing:new tt(1),range:new tt(t?e:new Ae)},blending:Un,depthWrite:!1,depthTest:!1,fragmentShader:xP,vertexShader:Y1});this.toneMapped=!1,this.colorOutput=r,this.useThreshold=!0,this.useRange=t}get threshold(){return this.uniforms.threshold.value}set threshold(r){this.uniforms.threshold.value=r}get smoothing(){return this.uniforms.smoothing.value}set smoothing(r){this.uniforms.smoothing.value=r}get useThreshold(){return this.defines.THRESHOLD!==void 0}set useThreshold(r){r?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.needsUpdate=!0}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(r){r?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}setColorOutputEnabled(r){this.colorOutput=r}get useRange(){return this.defines.RANGE!==void 0}set useRange(r){r?this.defines.RANGE="1":delete this.defines.RANGE,this.needsUpdate=!0}get luminanceRange(){return this.useRange}set luminanceRange(r){this.useRange=r}setLuminanceRangeEnabled(r){this.useRange=r}},bP=`#define sampleLevelZeroOffset(t, coord, offset) texture2D(t, coord + offset * texelSize)
#if __VERSION__ < 300
#define round(v) floor(v + 0.5)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D areaTexture;uniform lowp sampler2D searchTexture;uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}vec2 decodeDiagBilinearAccess(in vec2 e){e.r=e.r*abs(5.0*e.r-5.0*0.75);return round(e);}vec4 decodeDiagBilinearAccess(in vec4 e){e.rb=e.rb*abs(5.0*e.rb-5.0*0.75);return round(e);}vec2 searchDiag1(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 searchDiag2(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);coord.x+=0.25*texelSize.x;vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;e=decodeDiagBilinearAccess(e);coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 areaDiag(const in vec2 dist,const in vec2 e,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE_DIAG,AREATEX_MAX_DISTANCE_DIAG)*e+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.x+=0.5;texCoord.y+=AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTexture,texCoord).rg;}vec2 calculateDiagWeights(const in vec2 texCoord,const in vec2 e,const in vec4 subsampleIndices){vec2 weights=vec2(0.0);vec4 d;vec2 end;if(e.r>0.0){d.xz=searchDiag1(texCoord,vec2(-1.0,1.0),end);d.x+=float(end.y>0.9);}else{d.xz=vec2(0.0);}d.yw=searchDiag1(texCoord,vec2(1.0,-1.0),end);if(d.x+d.y>2.0){vec4 coords=vec4(-d.x+0.25,d.x,d.y,-d.y-0.25)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.xy=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).rg;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).rg;c.yxwz=decodeDiagBilinearAccess(c.xyzw);vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.z);}d.xz=searchDiag2(texCoord,vec2(-1.0,-1.0),end);if(sampleLevelZeroOffset(inputBuffer,texCoord,vec2(1,0)).r>0.0){d.yw=searchDiag2(texCoord,vec2(1.0),end);d.y+=float(end.y>0.9);}else{d.yw=vec2(0.0);}if(d.x+d.y>2.0){vec4 coords=vec4(-d.x,-d.x,d.y,d.y)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.x=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).g;c.y=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(0,-1)).r;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).gr;vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.w).gr;}return weights;}float searchLength(const in vec2 e,const in float offset){vec2 scale=SEARCHTEX_SIZE*vec2(0.5,-1.0);vec2 bias=SEARCHTEX_SIZE*vec2(offset,1.0);scale+=vec2(-1.0,1.0);bias+=vec2(0.5,-0.5);scale*=1.0/SEARCHTEX_PACKED_SIZE;bias*=1.0/SEARCHTEX_PACKED_SIZE;return texture2D(searchTexture,scale*e+bias).r;}float searchXLeft(in vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x>end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(-2.0,0.0)*texelSize+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.0)+3.25;return texelSize.x*offset+texCoord.x;}float searchXRight(vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x<end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(2.0,0.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.5)+3.25;return-texelSize.x*offset+texCoord.x;}float searchYUp(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.y>end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=-vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.0)+3.25;return texelSize.y*offset+texCoord.y;}float searchYDown(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;i++){if(!(texCoord.y<end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.5)+3.25;return-texelSize.y*offset+texCoord.y;}vec2 area(const in vec2 dist,const in float e1,const in float e2,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.y=AREATEX_SUBTEX_SIZE*offset+texCoord.y;return texture2D(areaTexture,texCoord).rg;}void detectHorizontalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,1)).r;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).r;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,-2)).r;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,-2)).r;weights*=clamp(factor,0.0,1.0);
#endif
}void detectVerticalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(1,0)).g;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).g;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(-2,0)).g;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(-2,1)).g;weights*=clamp(factor,0.0,1.0);
#endif
}void main(){vec4 weights=vec4(0.0);vec4 subsampleIndices=vec4(0.0);vec2 e=texture2D(inputBuffer,vUv).rg;if(e.g>0.0){
#if !defined(DISABLE_DIAG_DETECTION)
weights.rg=calculateDiagWeights(vUv,e,subsampleIndices);if(weights.r==-weights.g){
#endif
vec2 d;vec3 coords;coords.x=searchXLeft(vOffset[0].xy,vOffset[2].x);coords.y=vOffset[1].y;d.x=coords.x;float e1=texture2D(inputBuffer,coords.xy).r;coords.z=searchXRight(vOffset[0].zw,vOffset[2].y);d.y=coords.z;d=round(resolution.xx*d+-vPixCoord.xx);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.zy,vec2(1,0)).r;weights.rg=area(sqrtD,e1,e2,subsampleIndices.y);coords.y=vUv.y;detectHorizontalCornerPattern(weights.rg,coords.xyzy,d);
#if !defined(DISABLE_DIAG_DETECTION)
}else{e.r=0.0;}
#endif
}if(e.r>0.0){vec2 d;vec3 coords;coords.y=searchYUp(vOffset[1].xy,vOffset[2].z);coords.x=vOffset[0].x;d.x=coords.y;float e1=texture2D(inputBuffer,coords.xy).g;coords.z=searchYDown(vOffset[1].zw,vOffset[2].w);d.y=coords.z;d=round(resolution.yy*d-vPixCoord.yy);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.xz,vec2(0,1)).g;weights.ba=area(sqrtD,e1,e2,subsampleIndices.x);coords.x=vUv.x;detectVerticalCornerPattern(weights.ba,coords.xyxz,d);}gl_FragColor=weights;}`,MP="uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void main(){vUv=position.xy*0.5+0.5;vPixCoord=vUv*resolution;vOffset[0]=vUv.xyxy+texelSize.xyxy*vec4(-0.25,-0.125,1.25,-0.125);vOffset[1]=vUv.xyxy+texelSize.xyxy*vec4(-0.125,-0.25,-0.125,1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*texelSize.xxyy*MAX_SEARCH_STEPS_FLOAT;gl_Position=vec4(position.xy,1.0,1.0);}",AP=class extends Pn{constructor(r=new Ae,e=new Ae){super({name:"SMAAWeightsMaterial",defines:{MAX_SEARCH_STEPS_INT:"16",MAX_SEARCH_STEPS_FLOAT:"16.0",MAX_SEARCH_STEPS_DIAG_INT:"8",MAX_SEARCH_STEPS_DIAG_FLOAT:"8.0",CORNER_ROUNDING:"25",CORNER_ROUNDING_NORM:"0.25",AREATEX_MAX_DISTANCE:"16.0",AREATEX_MAX_DISTANCE_DIAG:"20.0",AREATEX_PIXEL_SIZE:"(1.0 / vec2(160.0, 560.0))",AREATEX_SUBTEX_SIZE:"(1.0 / 7.0)",SEARCHTEX_SIZE:"vec2(66.0, 33.0)",SEARCHTEX_PACKED_SIZE:"vec2(64.0, 16.0)"},uniforms:{inputBuffer:new tt(null),areaTexture:new tt(null),searchTexture:new tt(null),texelSize:new tt(r),resolution:new tt(e)},blending:Un,depthWrite:!1,depthTest:!1,fragmentShader:bP,vertexShader:MP});this.toneMapped=!1}setOrthogonalSearchSteps(r){const e=Math.min(Math.max(r,0),112);this.defines.MAX_SEARCH_STEPS_INT=e.toFixed("0"),this.defines.MAX_SEARCH_STEPS_FLOAT=e.toFixed("1"),this.needsUpdate=!0}setDiagonalSearchSteps(r){const e=Math.min(Math.max(r,0),20);this.defines.MAX_SEARCH_STEPS_DIAG_INT=e.toFixed("0"),this.defines.MAX_SEARCH_STEPS_DIAG_FLOAT=e.toFixed("1"),this.needsUpdate=!0}setCornerRounding(r){const e=Math.min(Math.max(r,0),100);this.defines.CORNER_ROUNDING=e.toFixed("4"),this.defines.CORNER_ROUNDING_NORM=(e/100).toFixed("4"),this.needsUpdate=!0}get diagonalDetection(){return this.defines.DISABLE_DIAG_DETECTION===void 0}set diagonalDetection(r){r?delete this.defines.DISABLE_DIAG_DETECTION:this.defines.DISABLE_DIAG_DETECTION="1",this.needsUpdate=!0}get cornerRounding(){return this.defines.DISABLE_CORNER_DETECTION===void 0}set cornerRounding(r){r?delete this.defines.DISABLE_CORNER_DETECTION:this.defines.DISABLE_CORNER_DETECTION="1",this.needsUpdate=!0}},SP=`#include <common>
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D normalDepthBuffer;
#else
uniform mediump sampler2D normalDepthBuffer;
#endif
#ifndef NORMAL_DEPTH
uniform lowp sampler2D normalBuffer;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(normalDepthBuffer,uv));
#else
return texture2D(normalDepthBuffer,uv).r;
#endif
}
#endif
uniform lowp sampler2D noiseTexture;uniform mat4 inverseProjectionMatrix;uniform mat4 projectionMatrix;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float minRadiusScale;uniform float intensity;uniform float fade;uniform float bias;uniform vec2 distanceCutoff;uniform vec2 proximityCutoff;varying vec2 vUv;varying vec2 vUv2;float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}vec3 getViewPosition(const in vec2 screenPosition,const in float depth,const in float viewZ){vec4 clipPosition=vec4(vec3(screenPosition,depth)*2.0-1.0,1.0);float clipW=projectionMatrix[2][3]*viewZ+projectionMatrix[3][3];clipPosition*=clipW;return(inverseProjectionMatrix*clipPosition).xyz;}float getAmbientOcclusion(const in vec3 p,const in vec3 n,const in float depth,const in vec2 uv){
#ifdef DISTANCE_SCALING
float radiusScale=1.0-smoothstep(0.0,distanceCutoff.y,depth);radiusScale=radiusScale*(1.0-minRadiusScale)+minRadiusScale;float radius=RADIUS*radiusScale;
#else
float radius=RADIUS;
#endif
float noise=texture2D(noiseTexture,vUv2).r;float baseAngle=noise*PI2;float invSamples=1.0/SAMPLES_FLOAT;float rings=SPIRAL_TURNS*PI2;float occlusion=0.0;int taps=0;for(int i=0;i<SAMPLES_INT;++i){float alpha=(float(i)+0.5)*invSamples;float angle=alpha*rings+baseAngle;vec2 coord=alpha*radius*vec2(cos(angle),sin(angle))*texelSize+uv;if(coord.s<0.0||coord.s>1.0||coord.t<0.0||coord.t>1.0){continue;}
#ifdef NORMAL_DEPTH
float sampleDepth=texture2D(normalDepthBuffer,coord).a;
#else
float sampleDepth=readDepth(coord);
#endif
float viewZ=getViewZ(sampleDepth);
#ifdef PERSPECTIVE_CAMERA
float linearSampleDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);
#else
float linearSampleDepth=sampleDepth;
#endif
float proximity=abs(depth-linearSampleDepth);if(proximity<proximityCutoff.y){float falloff=1.0-smoothstep(proximityCutoff.x,proximityCutoff.y,proximity);vec3 Q=getViewPosition(coord,sampleDepth,viewZ);vec3 v=Q-p;float vv=dot(v,v);float vn=dot(v,n)-bias;float f=max(RADIUS_SQ-vv,0.0)/RADIUS_SQ;occlusion+=(f*f*f*max(vn/(fade+vv),0.0))*falloff;}++taps;}return occlusion/(4.0*max(float(taps),1.0));}void main(){
#ifdef NORMAL_DEPTH
vec4 normalDepth=texture2D(normalDepthBuffer,vUv);
#else
vec4 normalDepth=vec4(texture2D(normalBuffer,vUv).rgb,readDepth(vUv));
#endif
float ao=1.0;float depth=normalDepth.a;float viewZ=getViewZ(depth);
#ifdef PERSPECTIVE_CAMERA
float linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);
#else
float linearDepth=depth;
#endif
if(linearDepth<distanceCutoff.y){vec3 viewPosition=getViewPosition(vUv,depth,viewZ);vec3 viewNormal=unpackRGBToNormal(normalDepth.rgb);ao-=getAmbientOcclusion(viewPosition,viewNormal,linearDepth,vUv);float d=smoothstep(distanceCutoff.x,distanceCutoff.y,linearDepth);ao=mix(ao,1.0,d);ao=clamp(pow(ao,abs(intensity)),0.0,1.0);}gl_FragColor.r=ao;}`,EP="uniform vec2 noiseScale;varying vec2 vUv;varying vec2 vUv2;void main(){vUv=position.xy*0.5+0.5;vUv2=vUv*noiseScale;gl_Position=vec4(position.xy,1.0,1.0);}",_P=class extends Pn{constructor(r){super({name:"SSAOMaterial",defines:{SAMPLES_INT:"0",SAMPLES_FLOAT:"0.0",SPIRAL_TURNS:"0.0",RADIUS:"1.0",RADIUS_SQ:"1.0",DISTANCE_SCALING:"1",DEPTH_PACKING:"0"},uniforms:{normalBuffer:new tt(null),normalDepthBuffer:new tt(null),noiseTexture:new tt(null),inverseProjectionMatrix:new tt(new Ye),projectionMatrix:new tt(new Ye),texelSize:new tt(new Ae),cameraNear:new tt(0),cameraFar:new tt(0),distanceCutoff:new tt(new Ae),proximityCutoff:new tt(new Ae),noiseScale:new tt(new Ae),minRadiusScale:new tt(.33),intensity:new tt(1),fade:new tt(.01),bias:new tt(0)},blending:Un,depthWrite:!1,depthTest:!1,fragmentShader:SP,vertexShader:EP});this.toneMapped=!1,this.adoptCameraSettings(r)}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(r){this.defines.DEPTH_PACKING=r.toFixed(0),this.needsUpdate=!0}setTexelSize(r,e){this.uniforms.texelSize.value.set(r,e)}adoptCameraSettings(r=null){if(r!==null){const e=this.uniforms;e.cameraNear.value=r.near,e.cameraFar.value=r.far,r instanceof ln?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0}}},TP=new wa,Ts=null;function CP(){if(Ts===null){const r=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),e=new Float32Array([0,0,2,0,0,2]);Ts=new rt,Ts.setAttribute!==void 0?(Ts.setAttribute("position",new ut(r,3)),Ts.setAttribute("uv",new ut(e,2))):(Ts.addAttribute("position",new ut(r,3)),Ts.addAttribute("uv",new ut(e,2)))}return Ts}var Hi=class{constructor(r="Pass",e=new xs,t=TP){this.name=r,this.scene=e,this.camera=t,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(r){if(this.rtt===r){const e=this.getFullscreenMaterial();e!==null&&(e.needsUpdate=!0),this.rtt=!r}}isEnabled(){return this.enabled}setEnabled(r){this.enabled=r}getFullscreenMaterial(){return this.screen!==null?this.screen.material:null}setFullscreenMaterial(r){let e=this.screen;e!==null?e.material=r:(e=new Gt(CP(),r),e.frustumCulled=!1,this.scene===null&&(this.scene=new xs),this.scene.add(e),this.screen=e)}getDepthTexture(){return null}setDepthTexture(r,e=0){}render(r,e,t,n,i){throw new Error("Render method not implemented!")}setSize(r,e){}initialize(r,e,t){}dispose(){const r=this.getFullscreenMaterial();r!==null&&r.dispose();for(const e of Object.keys(this)){const t=this[e];if(t!==null&&typeof t.dispose=="function"){if(t instanceof xs)continue;this[e].dispose()}}}},Gi=-1,Jn=class{constructor(r,e=Gi,t=Gi,n=1){this.resizable=r,this.base=new Ae(1,1),this.target=new Ae(e,t),this.s=n}get scale(){return this.s}set scale(r){this.s=r,this.target.x=Gi,this.target.y=Gi,this.resizable.setSize(this.base.x,this.base.y)}get width(){const r=this.base,e=this.target;let t;return e.x!==Gi?t=e.x:e.y!==Gi?t=Math.round(e.y*(r.x/r.y)):t=Math.round(r.x*this.s),t}set width(r){this.target.x=r,this.resizable.setSize(this.base.x,this.base.y)}get height(){const r=this.base,e=this.target;let t;return e.y!==Gi?t=e.y:e.x!==Gi?t=Math.round(e.x/(r.x/r.y)):t=Math.round(r.y*this.s),t}set height(r){this.target.y=r,this.resizable.setSize(this.base.x,this.base.y)}static get AUTO_SIZE(){return Gi}},RP=class extends Hi{constructor({resolutionScale:r=.5,width:e=Jn.AUTO_SIZE,height:t=Jn.AUTO_SIZE,kernelSize:n=Fm.LARGE}={}){super("BlurPass");this.renderTargetA=new mn(1,1,{minFilter:ft,magFilter:ft,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B",this.resolution=new Jn(this,e,t,r),this.convolutionMaterial=new X1,this.ditheredConvolutionMaterial=new X1,this.ditheredConvolutionMaterial.dithering=!0,this.dithering=!1,this.kernelSize=n}get width(){return this.resolution.width}set width(r){this.resolution.width=r}get height(){return this.resolution.height}set height(r){this.resolution.height=r}get scale(){return this.convolutionMaterial.uniforms.scale.value}set scale(r){this.convolutionMaterial.uniforms.scale.value=r,this.ditheredConvolutionMaterial.uniforms.scale.value=r}get kernelSize(){return this.convolutionMaterial.kernelSize}set kernelSize(r){this.convolutionMaterial.kernelSize=r,this.ditheredConvolutionMaterial.kernelSize=r}getResolutionScale(){return this.resolution.scale}setResolutionScale(r){this.resolution.scale=r}render(r,e,t,n,i){const s=this.scene,o=this.camera,a=this.renderTargetA,l=this.renderTargetB;let h=this.convolutionMaterial,u=h.uniforms;const c=h.getKernel();let f=e,d,p,m;for(this.setFullscreenMaterial(h),p=0,m=c.length-1;p<m;++p)d=(p&1)==0?a:l,u.kernel.value=c[p],u.inputBuffer.value=f.texture,r.setRenderTarget(d),r.render(s,o),f=d;this.dithering&&(h=this.ditheredConvolutionMaterial,u=h.uniforms,this.setFullscreenMaterial(h)),u.kernel.value=c[p],u.inputBuffer.value=f.texture,r.setRenderTarget(this.renderToScreen?null:t),r.render(s,o)}setSize(r,e){const t=this.resolution;t.base.set(r,e);const n=t.width,i=t.height;this.renderTargetA.setSize(n,i),this.renderTargetB.setSize(n,i),this.convolutionMaterial.setTexelSize(1/n,1/i),this.ditheredConvolutionMaterial.setTexelSize(1/n,1/i)}initialize(r,e,t){if(!e&&t===pn&&(this.renderTargetA.texture.format=An,this.renderTargetB.texture.format=An),t!==void 0&&(this.renderTargetA.texture.type=t,this.renderTargetB.texture.type=t,t!==pn)){const n=this.convolutionMaterial,i=this.ditheredConvolutionMaterial;n.defines.FRAMEBUFFER_PRECISION_HIGH="1",i.defines.FRAMEBUFFER_PRECISION_HIGH="1"}}static get AUTO_SIZE(){return Jn.AUTO_SIZE}},NP=class extends Hi{constructor(){super("ClearMaskPass",null,null);this.needsSwap=!1}render(r,e,t,n,i){const s=r.state.buffers.stencil;s.setLocked(!1),s.setTest(!1)}},Om=new He,zm=class extends Hi{constructor(r=!0,e=!0,t=!1){super("ClearPass",null,null);this.needsSwap=!1,this.color=r,this.depth=e,this.stencil=t,this.overrideClearColor=null,this.overrideClearAlpha=-1}render(r,e,t,n,i){const s=this.overrideClearColor,o=this.overrideClearAlpha,a=r.getClearAlpha(),l=s!==null,h=o>=0;l?(Om.copy(r.getClearColor(Om)),r.setClearColor(s,h?o:a)):h&&r.setClearAlpha(o),r.setRenderTarget(this.renderToScreen?null:e),r.clear(this.color,this.depth,this.stencil),l?r.setClearColor(Om,a):h&&r.setClearAlpha(a)}},Um=!1,j1=class{constructor(r=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(r),this.meshCount=0,this.replaceMaterial=e=>{if(e.isMesh){let t;if(e.material.flatShading)switch(e.material.side){case mr:t=this.materialsFlatShadedDoubleSide;break;case zt:t=this.materialsFlatShadedBackSide;break;default:t=this.materialsFlatShaded;break}else switch(e.material.side){case mr:t=this.materialsDoubleSide;break;case zt:t=this.materialsBackSide;break;default:t=this.materials;break}this.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=t[2]:e.isInstancedMesh?e.material=t[1]:e.material=t[0],++this.meshCount}}}setMaterial(r){if(this.disposeMaterials(),this.material=r,r!==null){const e=this.materials=[r.clone(),r.clone(),r.clone()];for(const t of e)t.uniforms=Object.assign({},r.uniforms),t.side=Ti;e[2].skinning=!0,this.materialsBackSide=e.map(t=>{const n=t.clone();return n.uniforms=Object.assign({},r.uniforms),n.side=zt,n}),this.materialsDoubleSide=e.map(t=>{const n=t.clone();return n.uniforms=Object.assign({},r.uniforms),n.side=mr,n}),this.materialsFlatShaded=e.map(t=>{const n=t.clone();return n.uniforms=Object.assign({},r.uniforms),n.flatShading=!0,n}),this.materialsFlatShadedBackSide=e.map(t=>{const n=t.clone();return n.uniforms=Object.assign({},r.uniforms),n.flatShading=!0,n.side=zt,n}),this.materialsFlatShadedDoubleSide=e.map(t=>{const n=t.clone();return n.uniforms=Object.assign({},r.uniforms),n.flatShading=!0,n.side=mr,n})}}render(r,e,t){const n=r.shadowMap.enabled;if(r.shadowMap.enabled=!1,Um){const i=this.originalMaterials;this.meshCount=0,e.traverse(this.replaceMaterial),r.render(e,t);for(const s of i)s[0].material=s[1];this.meshCount!==i.size&&i.clear()}else{const i=e.overrideMaterial;e.overrideMaterial=this.material,r.render(e,t),e.overrideMaterial=i}r.shadowMap.enabled=n}disposeMaterials(){if(this.material!==null){const r=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const e of r)e.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return Um}static set workaroundEnabled(r){Um=r}},IP=class extends Hi{constructor(r,e,t=null){super("RenderPass",r,e);this.needsSwap=!1,this.clearPass=new zm,this.overrideMaterialManager=t===null?null:new j1(t),this.backgroundDisabled=!1,this.shadowMapDisabled=!1,this.selection=null}get renderToScreen(){return super.renderToScreen}set renderToScreen(r){super.renderToScreen=r,this.clearPass.renderToScreen=r}get overrideMaterial(){const r=this.overrideMaterialManager;return r!==null?r.material:null}set overrideMaterial(r){const e=this.overrideMaterialManager;r!==null?e!==null?e.setMaterial(r):this.overrideMaterialManager=new j1(r):e!==null&&(e.dispose(),this.overrideMaterialManager=null)}get clear(){return this.clearPass.enabled}set clear(r){this.clearPass.enabled=r}getSelection(){return this.selection}setSelection(r){this.selection=r}isBackgroundDisabled(){return this.backgroundDisabled}setBackgroundDisabled(r){this.backgroundDisabled=r}isShadowMapDisabled(){return this.shadowMapDisabled}setShadowMapDisabled(r){this.shadowMapDisabled=r}getClearPass(){return this.clearPass}render(r,e,t,n,i){const s=this.scene,o=this.camera,a=this.selection,l=o.layers.mask,h=s.background,u=r.shadowMap.autoUpdate,c=this.renderToScreen?null:e;a!==null&&o.layers.set(a.getLayer()),this.shadowMapDisabled&&(r.shadowMap.autoUpdate=!1),(this.backgroundDisabled||this.clearPass.overrideClearColor!==null)&&(s.background=null),this.clear&&this.clearPass.render(r,e),r.setRenderTarget(c),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(r,s,o):r.render(s,o),o.layers.mask=l,s.background=h,r.shadowMap.autoUpdate=u}},Zt={SKIP:0,ADD:1,ALPHA:2,AVERAGE:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,EXCLUSION:8,LIGHTEN:9,MULTIPLY:10,DIVIDE:11,NEGATION:12,NORMAL:13,OVERLAY:14,REFLECT:15,SCREEN:16,SOFT_LIGHT:17,SUBTRACT:18},PP="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x+y,1.0)*opacity+x*(1.0-opacity);}",BP="vec3 blend(const in vec3 x,const in vec3 y,const in float opacity){return y*opacity+x*(1.0-opacity);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){float a=min(y.a,opacity);return vec4(blend(x.rgb,y.rgb,a),max(x.a,a));}",LP="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y)*0.5*opacity+x*(1.0-opacity);}",DP="float blend(const in float x,const in float y){return(y==0.0)? y : max(1.0-(1.0-x)/y,0.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",FP="float blend(const in float x,const in float y){return(y==1.0)? y : min(x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",OP="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x,y)*opacity+x*(1.0-opacity);}",zP="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return abs(x-y)*opacity+x*(1.0-opacity);}",UP="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y-2.0*x*y)*opacity+x*(1.0-opacity);}",HP="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x,y)*opacity+x*(1.0-opacity);}",GP="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return x*y*opacity+x*(1.0-opacity);}",kP="float blend(const in float x,const in float y){return(y>0.0)? min(x/y,1.0): 1.0;}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",VP="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-abs(1.0-x-y))*opacity+x*(1.0-opacity);}",WP="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y*opacity+x*(1.0-opacity);}",qP="float blend(const in float x,const in float y){return(x<0.5)?(2.0*x*y):(1.0-2.0*(1.0-x)*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",YP="float blend(const in float x,const in float y){return(y==1.0)? y : min(x*x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",XP="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-(1.0-x)*(1.0-y))*opacity+x*(1.0-opacity);}",QP="float blend(const in float x,const in float y){return(y<0.5)?(2.0*x*y+x*x*(1.0-2.0*y)):(sqrt(x)*(2.0*y-1.0)+2.0*x*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",jP="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x+y-1.0,0.0)*opacity+x*(1.0-opacity);}",ZP=new Map([[Zt.SKIP,null],[Zt.ADD,PP],[Zt.ALPHA,BP],[Zt.AVERAGE,LP],[Zt.COLOR_BURN,DP],[Zt.COLOR_DODGE,FP],[Zt.DARKEN,OP],[Zt.DIFFERENCE,zP],[Zt.EXCLUSION,UP],[Zt.LIGHTEN,HP],[Zt.MULTIPLY,GP],[Zt.DIVIDE,kP],[Zt.NEGATION,VP],[Zt.NORMAL,WP],[Zt.OVERLAY,qP],[Zt.REFLECT,YP],[Zt.SCREEN,XP],[Zt.SOFT_LIGHT,QP],[Zt.SUBTRACT,jP]]),JP=class extends ri{constructor(r,e=1){super();this.blendFunction=r,this.opacity=new tt(e)}getBlendFunction(){return this.blendFunction}setBlendFunction(r){this.blendFunction=r,this.dispatchEvent({type:"change"})}getShaderCode(){return ZP.get(this.blendFunction)}},Hm=class extends ri{constructor(r,e,{attributes:t=ki.NONE,blendFunction:n=Zt.SCREEN,defines:i=new Map,uniforms:s=new Map,extensions:o=null,vertexShader:a=null}={}){super();this.name=r,this.attributes=t,this.fragmentShader=e,this.vertexShader=a,this.defines=i,this.uniforms=s,this.extensions=o,this.blendMode=new JP(n),this.blendMode.addEventListener("change",l=>this.setChanged())}setChanged(){this.dispatchEvent({type:"change"})}getAttributes(){return this.attributes}setAttributes(r){this.attributes=r,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(r){this.fragmentShader=r,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(r){this.vertexShader=r,this.setChanged()}setDepthTexture(r,e=0){}update(r,e,t){}setSize(r,e){}initialize(r,e,t){}dispose(){for(const r of Object.keys(this)){const e=this[r];if(e!==null&&typeof e.dispose=="function"){if(e instanceof xs)continue;this[r].dispose()}}}},ki={NONE:0,DEPTH:1,CONVOLUTION:2};function Z1(r,e,t){for(const n of e){const i="$1"+r+n.charAt(0).toUpperCase()+n.slice(1),s=new RegExp("([^\\.])(\\b"+n+"\\b)","g");for(const o of t.entries())o[1]!==null&&t.set(o[0],o[1].replace(s,i))}}function KP(r,e,t,n,i,s,o){const a=new Map([["fragment",e.getFragmentShader()],["vertex",e.getVertexShader()]]),l=a.get("fragment")!==void 0&&/mainImage/.test(a.get("fragment")),h=a.get("fragment")!==void 0&&/mainUv/.test(a.get("fragment"));let u=[],c=[],f=!1,d=!1;if(a.get("fragment")===void 0)console.error("Missing fragment shader",e);else if(h&&(o&ki.CONVOLUTION)!=0)console.error("Effects that transform UV coordinates are incompatible with convolution effects",e);else if(!l&&!h)console.error("The fragment shader contains neither a mainImage nor a mainUv function",e);else{const p=/(?:\w+\s+(\w+)\([\w\s,]*\)\s*{[^}]+})/g;if(h){const y="	"+r+`MainUv(UV);
`;t.set(St.FRAGMENT_MAIN_UV,t.get(St.FRAGMENT_MAIN_UV)+y),f=!0}if(a.get("vertex")!==null&&/mainSupport/.test(a.get("vertex"))){let y="	"+r+"MainSupport(";y+=/mainSupport *\([\w\s]*?uv\s*?\)/.test(a.get("vertex"))?`vUv);
`:`);
`,t.set(St.VERTEX_MAIN_SUPPORT,t.get(St.VERTEX_MAIN_SUPPORT)+y),u=u.concat([...a.get("vertex").matchAll(/(?:varying\s+\w+\s+(\w*))/g)].map(g=>g[1])),c=c.concat(u).concat([...a.get("vertex").matchAll(p)].map(g=>g[1]))}c=c.concat([...a.get("fragment").matchAll(p)].map(y=>y[1])),c=c.concat([...e.defines.keys()].map(y=>y.replace(/\([\w\s,]*\)/g,""))),c=c.concat([...e.uniforms.keys()]),e.uniforms.forEach((y,g)=>s.set(r+g.charAt(0).toUpperCase()+g.slice(1),y)),e.defines.forEach((y,g)=>i.set(r+g.charAt(0).toUpperCase()+g.slice(1),y)),Z1(r,c,i),Z1(r,c,a);const m=e.blendMode;if(n.set(m.blendFunction,m),l){const y=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;let g=r+"MainImage(color0, UV, ";(o&ki.DEPTH)!=0&&y.test(a.get("fragment"))&&(g+="depth, ",d=!0),g+=`color1);
	`;const v=r+"BlendOpacity";s.set(v,m.opacity),g+="color0 = blend"+m.getBlendFunction()+"(color0, color1, "+v+`);

	`,t.set(St.FRAGMENT_MAIN_IMAGE,t.get(St.FRAGMENT_MAIN_IMAGE)+g),g="uniform float "+v+`;

`,t.set(St.FRAGMENT_HEAD,t.get(St.FRAGMENT_HEAD)+g)}t.set(St.FRAGMENT_HEAD,t.get(St.FRAGMENT_HEAD)+a.get("fragment")+`
`),a.get("vertex")!==null&&t.set(St.VERTEX_HEAD,t.get(St.VERTEX_HEAD)+a.get("vertex")+`
`)}return{varyings:u,transformedUv:f,readDepth:d}}var y5=class extends Hi{constructor(r,...e){super("EffectPass");this.setFullscreenMaterial(new yP(null,null,null,r)),this.effects=e.sort((t,n)=>n.attributes-t.attributes),this.skipRendering=!1,this.uniformCount=0,this.varyingCount=0,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY}get encodeOutput(){return this.getFullscreenMaterial().defines.ENCODE_OUTPUT!==void 0}set encodeOutput(r){if(this.encodeOutput!==r){const e=this.getFullscreenMaterial();e.needsUpdate=!0,r?e.defines.ENCODE_OUTPUT="1":delete e.defines.ENCODE_OUTPUT}}get dithering(){return this.getFullscreenMaterial().dithering}set dithering(r){const e=this.getFullscreenMaterial();e.dithering!==r&&(e.dithering=r,e.needsUpdate=!0)}verifyResources(r){const e=r.capabilities;let t=Math.min(e.maxFragmentUniforms,e.maxVertexUniforms);this.uniformCount>t&&console.warn("The current rendering context doesn't support more than "+t+" uniforms, but "+this.uniformCount+" were defined"),t=e.maxVaryings,this.varyingCount>t&&console.warn("The current rendering context doesn't support more than "+t+" varyings, but "+this.varyingCount+" were defined")}updateMaterial(){const r=new Map([[St.FRAGMENT_HEAD,""],[St.FRAGMENT_MAIN_UV,""],[St.FRAGMENT_MAIN_IMAGE,""],[St.VERTEX_HEAD,""],[St.VERTEX_MAIN_SUPPORT,""]]),e=new Map,t=new Map,n=new Map,i=new Set;let s=0,o=0,a=0,l=!1,h=!1;for(const f of this.effects)if(f.blendMode.getBlendFunction()===Zt.SKIP)a|=f.getAttributes()&ki.DEPTH;else if((a&f.getAttributes()&ki.CONVOLUTION)!=0)console.error("Convolution effects cannot be merged",f);else{a|=f.getAttributes();const d=KP("e"+s++,f,r,e,t,n,a);if(o+=d.varyings.length,l=l||d.transformedUv,h=h||d.readDepth,f.extensions!==null)for(const p of f.extensions)i.add(p)}const u=/\bblend\b/g;for(const f of e.values()){const d=f.getShaderCode().replace(u,"blend"+f.getBlendFunction());r.set(St.FRAGMENT_HEAD,r.get(St.FRAGMENT_HEAD)+d+`
`)}if((a&ki.DEPTH)!=0){if(h){const f=`float depth = readDepth(UV);

	`;r.set(St.FRAGMENT_MAIN_IMAGE,f+r.get(St.FRAGMENT_MAIN_IMAGE))}this.needsDepthTexture=this.getDepthTexture()===null}else this.needsDepthTexture=!1;if(l){const f=`vec2 transformedUv = vUv;
`;r.set(St.FRAGMENT_MAIN_UV,f+r.get(St.FRAGMENT_MAIN_UV)),t.set("UV","transformedUv")}else t.set("UV","vUv");r.forEach((f,d,p)=>p.set(d,f.trim().replace(/^#/,`
#`))),this.uniformCount=n.size,this.varyingCount=o,this.skipRendering=s===0,this.needsSwap=!this.skipRendering;const c=this.getFullscreenMaterial();if(c.setShaderParts(r),c.setDefines(t),c.setUniforms(n),c.extensions={},i.size>0)for(const f of i)c.extensions[f]=!0;this.needsUpdate=!1}recompile(r){this.updateMaterial(),r!==void 0&&this.verifyResources(r)}getDepthTexture(){return this.getFullscreenMaterial().uniforms.depthBuffer.value}setDepthTexture(r,e=Fl){const t=this.getFullscreenMaterial();t.uniforms.depthBuffer.value=r,t.depthPacking=e,t.needsUpdate=!0;for(const n of this.effects)n.setDepthTexture(r,e)}render(r,e,t,n,i){const s=this.getFullscreenMaterial(),o=s.uniforms.time.value+n;this.needsUpdate&&this.recompile(r);for(const a of this.effects)a.update(r,e,n);(!this.skipRendering||this.renderToScreen)&&(s.uniforms.inputBuffer.value=e.texture,s.uniforms.time.value=o<=this.maxTime?o:this.minTime,r.setRenderTarget(this.renderToScreen?null:t),r.render(this.scene,this.camera))}setSize(r,e){this.getFullscreenMaterial().setSize(r,e);for(const t of this.effects)t.setSize(r,e)}initialize(r,e,t){for(const n of this.effects)n.initialize(r,e,t),n.addEventListener("change",i=>this.handleEvent(i));if(this.updateMaterial(),this.verifyResources(r),t!==void 0&&t!==pn){const n=this.getFullscreenMaterial();n.defines.FRAMEBUFFER_PRECISION_HIGH="1"}}dispose(){super.dispose();for(const r of this.effects)r.dispose()}handleEvent(r){switch(r.type){case"change":this.needsUpdate=!0;break}}},$P=class extends Hi{constructor({width:r=Jn.AUTO_SIZE,height:e=Jn.AUTO_SIZE,renderTarget:t,luminanceRange:n,colorOutput:i}={}){super("LuminancePass");this.setFullscreenMaterial(new wP(i,n)),this.needsSwap=!1,this.renderTarget=t,this.renderTarget===void 0&&(this.renderTarget=new mn(1,1,{minFilter:ft,magFilter:ft,format:i?Lt:Ll,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target",this.renderTarget.texture.generateMipmaps=!1),this.resolution=new Jn(this,r,e)}get texture(){return this.renderTarget.texture}render(r,e,t,n,i){const s=this.getFullscreenMaterial();s.uniforms.inputBuffer.value=e.texture,r.setRenderTarget(this.renderToScreen?null:this.renderTarget),r.render(this.scene,this.camera)}setSize(r,e){const t=this.resolution;t.base.set(r,e),this.renderTarget.setSize(t.width,t.height)}initialize(r,e,t){if(t!==void 0&&t!==pn){const n=this.getFullscreenMaterial();n.defines.FRAMEBUFFER_PRECISION_HIGH="1"}}},eB=class extends Hi{constructor(r,e){super("MaskPass",r,e);this.needsSwap=!1,this.clearPass=new zm(!1,!1,!0),this.inverse=!1}get clear(){return this.clearPass.enabled}set clear(r){this.clearPass.enabled=r}render(r,e,t,n,i){const s=r.getContext(),o=r.state.buffers,a=this.scene,l=this.camera,h=this.clearPass,u=this.inverse?0:1,c=1-u;o.color.setMask(!1),o.depth.setMask(!1),o.color.setLocked(!0),o.depth.setLocked(!0),o.stencil.setTest(!0),o.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),o.stencil.setFunc(s.ALWAYS,u,4294967295),o.stencil.setClear(c),o.stencil.setLocked(!0),this.clear&&(this.renderToScreen?h.render(r,null):(h.render(r,e),h.render(r,t))),this.renderToScreen?(r.setRenderTarget(null),r.render(a,l)):(r.setRenderTarget(e),r.render(a,l),r.setRenderTarget(t),r.render(a,l)),o.color.setLocked(!1),o.depth.setLocked(!1),o.stencil.setLocked(!1),o.stencil.setFunc(s.EQUAL,1,4294967295),o.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),o.stencil.setLocked(!0)}},x5=class extends Hi{constructor(r,e,{resolutionScale:t=1,width:n=Jn.AUTO_SIZE,height:i=Jn.AUTO_SIZE,renderTarget:s}={}){super("NormalPass");this.needsSwap=!1,this.renderPass=new IP(r,e,new Lh);const o=this.renderPass;o.setBackgroundDisabled(!0),o.setShadowMapDisabled(!0);const a=o.getClearPass();a.overrideClearColor=new He(7829503),a.overrideClearAlpha=1,this.renderTarget=s,this.renderTarget===void 0&&(this.renderTarget=new mn(1,1,{minFilter:Ut,magFilter:Ut,format:An,stencilBuffer:!1}),this.renderTarget.texture.name="NormalPass.Target"),this.resolution=new Jn(this,n,i,t)}get texture(){return this.renderTarget.texture}getResolutionScale(){return this.resolutionScale}setResolutionScale(r){this.resolutionScale=r,this.setSize(this.resolution.base.x,this.resolution.base.y)}render(r,e,t,n,i){const s=this.renderToScreen?null:this.renderTarget;this.renderPass.render(r,s,s)}setSize(r,e){const t=this.resolution;t.base.set(r,e),this.renderTarget.setSize(t.width,t.height)}},Xh=class extends Hi{constructor(r,e="inputBuffer"){super("ShaderPass");this.setFullscreenMaterial(r),this.uniform=null,this.setInput(e)}setInput(r){const e=this.getFullscreenMaterial();if(this.uniform=null,e!==null){const t=e.uniforms;t!==void 0&&t[r]!==void 0&&(this.uniform=t[r])}}render(r,e,t,n,i){this.uniform!==null&&e!==null&&(this.uniform.value=e.texture),r.setRenderTarget(this.renderToScreen?null:t),r.render(this.scene,this.camera)}initialize(r,e,t){if(t!==void 0&&t!==pn){const n=this.getFullscreenMaterial();n.defines.FRAMEBUFFER_PRECISION_HIGH="1"}}},Gm=1/1e3,tB=1e3,nB=class{constructor(){this.previousTime=0,this.currentTime=0,this.delta=0,this.fixedDelta=1e3/60,this.elapsed=0,this.timescale=1,this.fixedDeltaEnabled=!1}setFixedDeltaEnabled(r){return this.fixedDeltaEnabled=r,this}setAutoResetEnabled(r){return typeof document!="undefined"&&document.hidden!==void 0&&(r?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this)),this}getDelta(){return this.delta*Gm}getFixedDelta(){return this.fixedDelta*Gm}setFixedDelta(r){return this.fixedDelta=r*tB,this}getElapsed(){return this.elapsed*Gm}getTimescale(){return this.timescale}setTimescale(r){return this.timescale=r,this}update(r){return this.fixedDeltaEnabled?this.delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=r!==void 0?r:performance.now(),this.delta=this.currentTime-this.previousTime),this.delta*=this.timescale,this.elapsed+=this.delta,this}reset(){return this.delta=0,this.elapsed=0,this.currentTime=performance.now(),this}handleEvent(r){document.hidden||(this.currentTime=performance.now())}dispose(){typeof document!="undefined"&&document.removeEventListener("visibilitychange",this)}},w5=class{constructor(r=null,{depthBuffer:e=!0,stencilBuffer:t=!1,alpha:n=!1,multisampling:i=0,frameBufferType:s}={}){this.renderer=r,this.alpha=n,this.inputBuffer=null,this.outputBuffer=null,this.renderer!==null&&(this.renderer.autoClear=!1,this.renderer.info.autoReset=!1,this.inputBuffer=this.createBuffer(e,t,s,i),this.outputBuffer=this.inputBuffer.clone()),this.copyPass=new Xh(new pP),this.depthTexture=null,this.passes=[],this.timer=new nB,this.autoRenderToScreen=!0}get multisampling(){return this.inputBuffer instanceof ca?this.inputBuffer.samples:0}set multisampling(r){const e=this.inputBuffer,t=this.multisampling;t>0&&r>0?(this.inputBuffer.samples=r,this.outputBuffer.samples=r,this.inputBuffer.dispose(),this.outputBuffer.dispose()):t!==r&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(e.depthBuffer,e.stencilBuffer,e.texture.type,r),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}replaceRenderer(r,e=!0){const t=this.renderer;if(t!==null&&t!==r){const n=t.getSize(new Ae),i=r.getSize(new Ae),s=t.domElement.parentNode;this.renderer=r,this.renderer.autoClear=!1,this.renderer.info.autoReset=!1,n.equals(i)||this.setSize(),e&&s!==null&&(s.removeChild(t.domElement),s.appendChild(r.domElement))}return t}createDepthTexture(){const r=this.depthTexture=new Yl;return this.inputBuffer.depthTexture=r,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(r.format=ls,r.type=os):r.type=ra,r}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const r of this.passes)r.setDepthTexture(null)}}createBuffer(r,e,t,n){const i=this.renderer,s=i.getContext(),o=i.getDrawingBufferSize(new Ae),l={format:!(this.alpha||s.getContextAttributes().alpha)&&t===pn?An:Lt,minFilter:ft,magFilter:ft,stencilBuffer:e,depthBuffer:r,type:t},h=n>0?new ca(o.width,o.height,l):new mn(o.width,o.height,l);return n>0&&(h.samples=n),h.texture.name="EffectComposer.Buffer",h.texture.generateMipmaps=!1,h}addPass(r,e){const t=this.passes,n=this.renderer,i=n.getDrawingBufferSize(new Ae),s=n.getContext().getContextAttributes().alpha,o=this.inputBuffer.texture.type;if(r.setSize(i.width,i.height),r.initialize(n,s,o),this.autoRenderToScreen&&(t.length>0&&(t[t.length-1].renderToScreen=!1),r.renderToScreen&&(this.autoRenderToScreen=!1)),e!==void 0?t.splice(e,0,r):t.push(r),this.autoRenderToScreen&&(t[t.length-1].renderToScreen=!0),r.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const a=this.createDepthTexture();for(r of t)r.setDepthTexture(a)}else r.setDepthTexture(this.depthTexture)}removePass(r){const e=this.passes,t=e.indexOf(r);if(t!==-1&&e.splice(t,1).length>0){if(this.depthTexture!==null){const s=(a,l)=>a||l.needsDepthTexture;e.reduce(s,!1)||(r.getDepthTexture()===this.depthTexture&&r.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&t===e.length&&(r.renderToScreen=!1,e.length>0&&(e[e.length-1].renderToScreen=!0))}}removeAllPasses(){const r=this.passes;this.deleteDepthTexture(),r.length>0&&(this.autoRenderToScreen&&(r[r.length-1].renderToScreen=!1),this.passes=[])}render(r){const e=this.renderer,t=this.copyPass;let n=this.inputBuffer,i=this.outputBuffer,s=!1,o,a,l;r===void 0&&(r=this.timer.update().getDelta()),e.info.reset();for(const h of this.passes)h.isEnabled()&&(h.render(e,n,i,r,s),h.needsSwap&&(s&&(t.renderToScreen=h.renderToScreen,o=e.getContext(),a=e.state.buffers.stencil,a.setFunc(o.NOTEQUAL,1,4294967295),t.render(e,n,i,r,s),a.setFunc(o.EQUAL,1,4294967295)),l=n,n=i,i=l),h instanceof eB?s=!0:h instanceof NP&&(s=!1))}setSize(r,e,t){const n=this.renderer;if(r===void 0||e===void 0){const a=n.getSize(new Ae);r=a.width,e=a.height}else n.setSize(r,e,t);const i=n.getDrawingBufferSize(new Ae),s=this.inputBuffer,o=this.outputBuffer;s.setSize(i.width,i.height),o.setSize(i.width,i.height);for(const a of this.passes)a.setSize(i.width,i.height)}reset(){this.dispose(),this.autoRenderToScreen=!0}dispose(){for(const r of this.passes)r.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose()}},rB=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=clamp(texture2D(map,uv)*intensity,0.0,1.0);}`,b5=class extends Hm{constructor({blendFunction:r=Zt.SCREEN,luminanceThreshold:e=.9,luminanceSmoothing:t=.025,resolutionScale:n=.5,intensity:i=1,width:s=Jn.AUTO_SIZE,height:o=Jn.AUTO_SIZE,kernelSize:a=Fm.LARGE}={}){super("BloomEffect",rB,{blendFunction:r,uniforms:new Map([["map",new tt(null)],["intensity",new tt(i)]])});this.renderTarget=new mn(1,1,{minFilter:ft,magFilter:ft,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.renderTarget.texture.generateMipmaps=!1,this.uniforms.get("map").value=this.renderTarget.texture,this.blurPass=new RP({resolutionScale:n,width:s,height:o,kernelSize:a}),this.blurPass.resolution.resizable=this,this.luminancePass=new $P({renderTarget:this.renderTarget,colorOutput:!0}),this.luminancePass.resolution=this.resolution,this.luminanceMaterial.threshold=e,this.luminanceMaterial.smoothing=t}get texture(){return this.renderTarget.texture}get luminanceMaterial(){return this.luminancePass.getFullscreenMaterial()}get resolution(){return this.blurPass.resolution}get width(){return this.resolution.width}set width(r){this.resolution.width=r}get height(){return this.resolution.height}set height(r){this.resolution.height=r}get dithering(){return this.blurPass.dithering}set dithering(r){this.blurPass.dithering=r}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(r){this.blurPass.kernelSize=r}get distinction(){return console.warn(this.name,"The distinction field has been removed, use .threshold and .smoothing instead."),1}set distinction(r){console.warn(this.name,"The distinction field has been removed, use .threshold and .smoothing instead.")}get intensity(){return this.uniforms.get("intensity").value}set intensity(r){this.uniforms.get("intensity").value=r}getResolutionScale(){return this.resolution.scale}setResolutionScale(r){this.resolution.scale=r}update(r,e,t){const n=this.renderTarget;this.luminancePass.isEnabled()?(this.luminancePass.render(r,e,n),this.blurPass.render(r,n,n)):this.blurPass.render(r,e,n)}setSize(r,e){this.blurPass.setSize(r,e),this.renderTarget.setSize(this.resolution.width,this.resolution.height)}initialize(r,e,t){this.blurPass.initialize(r,e,t),!e&&t===pn&&(this.renderTarget.texture.format=An),t!==void 0&&(this.renderTarget.texture.type=t)}};function iB(r,e,t){const n=new Map([[Ll,1],[sp,1],[op,2],[An,3],[Lt,4]]);let i;if(n.has(e)||console.error("Invalid noise texture format"),t===pn){i=new Uint8Array(r*n.get(e));for(let s=0,o=i.length;s<o;++s)i[s]=Math.random()*255}else{i=new Float32Array(r*n.get(e));for(let s=0,o=i.length;s<o;++s)i[s]=Math.random()}return i}var sB=class extends bs{constructor(r,e,t=Ll,n=pn){super(iB(r*e,t,n),r,e,t,n);this.needsUpdate=!0}};new X;new Ye;new He;new X;new X;var oB="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAYAAACm53kpAAAAeElEQVRYR+2XSwqAMAxEJ168ePEqwRSKhIIiuHjJqiU0gWE+1CQdApcVAMUAuARaMGCX1MIL/Ow13++9lW2s3mW9MWvsnWc/2fvGygwPAN4E8QzAA4CXAB6AHjG4JTHYI1ey3pcx6FHnEfhLDOIBKAmUBK6/ANUDTlROXAHd9EC1AAAAAElFTkSuQmCC",aB="data:image/png;base64,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",lB="uniform sampler2D weightMap;varying vec2 vOffset0;varying vec2 vOffset1;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 a;a.x=texture2D(weightMap,vOffset0).a;a.y=texture2D(weightMap,vOffset1).g;a.wz=texture2D(weightMap,uv).rb;vec4 color=inputColor;if(dot(a,vec4(1.0))>=1e-5){bool h=max(a.x,a.z)>max(a.y,a.w);vec4 blendingOffset=vec4(0.0,a.y,0.0,a.w);vec2 blendingWeight=a.yw;movec(bvec4(h),blendingOffset,vec4(a.x,0.0,a.z,0.0));movec(bvec2(h),blendingWeight,a.xz);blendingWeight/=dot(blendingWeight,vec2(1.0));vec4 blendingCoord=blendingOffset*vec4(texelSize,-texelSize)+uv.xyxy;color=blendingWeight.x*texture2D(inputBuffer,blendingCoord.xy);color+=blendingWeight.y*texture2D(inputBuffer,blendingCoord.zw);}outputColor=color;}",cB="varying vec2 vOffset0;varying vec2 vOffset1;void mainSupport(const in vec2 uv){vOffset0=uv+texelSize*vec2(1.0,0.0);vOffset1=uv+texelSize*vec2(0.0,1.0);}",M5=class extends Hm{constructor(r,e,t=mc.HIGH,n=Q1.COLOR){super("SMAAEffect",lB,{vertexShader:cB,blendFunction:Zt.NORMAL,attributes:ki.CONVOLUTION|ki.DEPTH,uniforms:new Map([["weightMap",new tt(null)]])});this.renderTargetEdges=new mn(1,1,{minFilter:ft,stencilBuffer:!1,depthBuffer:!1,format:An}),this.renderTargetEdges.texture.name="SMAA.Edges",this.renderTargetWeights=this.renderTargetEdges.clone(),this.renderTargetWeights.texture.name="SMAA.Weights",this.renderTargetWeights.texture.format=Lt,this.uniforms.get("weightMap").value=this.renderTargetWeights.texture,this.clearPass=new zm(!0,!1,!1),this.clearPass.overrideClearColor=new He(0),this.clearPass.overrideClearAlpha=1,this.edgeDetectionPass=new Xh(new mP(new Ae,n)),this.weightsPass=new Xh(new AP);const i=new Qt(r);i.name="SMAA.Search",i.magFilter=Ut,i.minFilter=Ut,i.format=Lt,i.generateMipmaps=!1,i.needsUpdate=!0,i.flipY=!0;const s=new Qt(e);s.name="SMAA.Area",s.magFilter=ft,s.minFilter=ft,s.format=Lt,s.generateMipmaps=!1,s.needsUpdate=!0,s.flipY=!1;const o=this.weightsPass.getFullscreenMaterial();o.uniforms.searchTexture.value=i,o.uniforms.areaTexture.value=s,this.applyPreset(t)}get edgeDetectionMaterial(){return this.edgeDetectionPass.getFullscreenMaterial()}get colorEdgesMaterial(){return this.edgeDetectionMaterial}get weightsMaterial(){return this.weightsPass.getFullscreenMaterial()}setEdgeDetectionThreshold(r){this.edgeDetectionPass.getFullscreenMaterial().setEdgeDetectionThreshold(r)}setOrthogonalSearchSteps(r){this.weightsPass.getFullscreenMaterial().setOrthogonalSearchSteps(r)}applyPreset(r){const e=this.edgeDetectionMaterial,t=this.weightsMaterial;switch(r){case mc.LOW:e.setEdgeDetectionThreshold(.15),t.setOrthogonalSearchSteps(4),t.diagonalDetection=!1,t.cornerRounding=!1;break;case mc.MEDIUM:e.setEdgeDetectionThreshold(.1),t.setOrthogonalSearchSteps(8),t.diagonalDetection=!1,t.cornerRounding=!1;break;case mc.HIGH:e.setEdgeDetectionThreshold(.1),t.setOrthogonalSearchSteps(16),t.setDiagonalSearchSteps(8),t.setCornerRounding(25),t.diagonalDetection=!0,t.cornerRounding=!0;break;case mc.ULTRA:e.setEdgeDetectionThreshold(.05),t.setOrthogonalSearchSteps(32),t.setDiagonalSearchSteps(16),t.setCornerRounding(25),t.diagonalDetection=!0,t.cornerRounding=!0;break}}setDepthTexture(r,e=Fl){const t=this.edgeDetectionMaterial;t.uniforms.depthBuffer.value=r,t.depthPacking=e}update(r,e,t){this.clearPass.render(r,this.renderTargetEdges),this.edgeDetectionPass.render(r,e,this.renderTargetEdges),this.weightsPass.render(r,this.renderTargetEdges,this.renderTargetWeights)}setSize(r,e){const t=this.weightsPass.getFullscreenMaterial(),n=this.edgeDetectionPass.getFullscreenMaterial();this.renderTargetEdges.setSize(r,e),this.renderTargetWeights.setSize(r,e),t.uniforms.resolution.value.set(r,e),t.uniforms.texelSize.value.set(1/r,1/e),n.uniforms.texelSize.value.copy(t.uniforms.texelSize.value)}dispose(){const r=this.weightsPass.getFullscreenMaterial().uniforms;r.searchTexture.value.dispose(),r.areaTexture.value.dispose(),super.dispose()}static get searchImageDataURL(){return oB}static get areaImageDataURL(){return aB}},mc={LOW:0,MEDIUM:1,HIGH:2,ULTRA:3},uB=`uniform lowp sampler2D aoBuffer;uniform float luminanceInfluence;
#ifdef DEPTH_AWARE_UPSAMPLING
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D normalDepthBuffer;
#else
uniform mediump sampler2D normalDepthBuffer;
#endif
#endif
#ifdef COLORIZE
uniform vec3 color;
#endif
void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){float aoLinear=texture2D(aoBuffer,uv).r;
#if defined(DEPTH_AWARE_UPSAMPLING) && __VERSION__ == 300
vec4 normalDepth[4];normalDepth[0]=textureOffset(normalDepthBuffer,uv,ivec2(0,0));normalDepth[1]=textureOffset(normalDepthBuffer,uv,ivec2(0,1));normalDepth[2]=textureOffset(normalDepthBuffer,uv,ivec2(1,0));normalDepth[3]=textureOffset(normalDepthBuffer,uv,ivec2(1,1));float dot01=dot(normalDepth[0].rgb,normalDepth[1].rgb);float dot02=dot(normalDepth[0].rgb,normalDepth[2].rgb);float dot03=dot(normalDepth[0].rgb,normalDepth[3].rgb);float minDot=min(dot01,min(dot02,dot03));float s=step(THRESHOLD,minDot);float smallestDistance=1.0;int index;for(int i=0;i<4;++i){float distance=abs(depth-normalDepth[i].a);if(distance<smallestDistance){smallestDistance=distance;index=i;}}ivec2 offsets[4];offsets[0]=ivec2(0,0);offsets[1]=ivec2(0,1);offsets[2]=ivec2(1,0);offsets[3]=ivec2(1,1);ivec2 coord=ivec2(uv*vec2(textureSize(aoBuffer,0)))+offsets[index];float aoNearest=texelFetch(aoBuffer,coord,0).r;float ao=mix(aoNearest,aoLinear,s);
#else
float ao=aoLinear;
#endif
float l=linearToRelativeLuminance(inputColor.rgb);ao=mix(ao,1.0,l*luminanceInfluence);
#ifdef COLORIZE
outputColor=vec4(1.0-(1.0-ao)*(1.0-color),inputColor.a);
#else
outputColor=vec4(vec3(ao),inputColor.a);
#endif
}`,km=64,A5=class extends Hm{constructor(r,e,{blendFunction:t=Zt.MULTIPLY,distanceScaling:n=!0,depthAwareUpsampling:i=!0,normalDepthBuffer:s=null,samples:o=9,rings:a=7,distanceThreshold:l=.97,distanceFalloff:h=.03,rangeThreshold:u=5e-4,rangeFalloff:c=.001,minRadiusScale:f=.33,luminanceInfluence:d=.7,radius:p=.1825,intensity:m=1,bias:y=.025,fade:g=.01,color:v=null,resolutionScale:x=1,width:w=Jn.AUTO_SIZE,height:b=Jn.AUTO_SIZE}={}){super("SSAOEffect",uB,{blendFunction:t,attributes:ki.DEPTH,defines:new Map([["THRESHOLD","0.997"]]),uniforms:new Map([["aoBuffer",new tt(null)],["normalDepthBuffer",new tt(null)],["luminanceInfluence",new tt(d)],["color",new tt(null)],["scale",new tt(0)]])});this.renderTargetAO=new mn(1,1,{minFilter:ft,magFilter:ft,stencilBuffer:!1,depthBuffer:!1,format:An}),this.renderTargetAO.texture.name="AO.Target",this.renderTargetAO.texture.generateMipmaps=!1,this.uniforms.get("aoBuffer").value=this.renderTargetAO.texture,this.resolution=new Jn(this,w,b,x),this.r=1,this.camera=r,this.ssaoPass=new Xh((()=>{const M=new sB(km,km,An);M.wrapS=M.wrapT=Ri;const A=new _P(r);return A.uniforms.noiseTexture.value=M,A.uniforms.intensity.value=m,A.uniforms.minRadiusScale.value=f,A.uniforms.fade.value=g,A.uniforms.bias.value=y,s!==null?(A.uniforms.normalDepthBuffer.value=s,A.defines.NORMAL_DEPTH="1",i&&(this.depthAwareUpsampling=i,this.uniforms.get("normalDepthBuffer").value=s)):A.uniforms.normalBuffer.value=e,A})()),this.distanceScaling=n,this.samples=o,this.rings=a,this.color=v,this.radius=p>1?p/100:p,this.setDistanceCutoff(l,h),this.setProximityCutoff(u,c)}get ssaoMaterial(){return this.ssaoPass.getFullscreenMaterial()}get samples(){return Number(this.ssaoMaterial.defines.SAMPLES_INT)}set samples(r){const e=this.ssaoMaterial;e.defines.SAMPLES_INT=r.toFixed(0),e.defines.SAMPLES_FLOAT=r.toFixed(1),e.needsUpdate=!0}get rings(){return Number(this.ssaoMaterial.defines.SPIRAL_TURNS)}set rings(r){const e=this.ssaoMaterial;e.defines.SPIRAL_TURNS=r.toFixed(1),e.needsUpdate=!0}get radius(){return this.r}set radius(r){this.r=Math.min(Math.max(r,1e-6),1);const e=this.r*this.resolution.height,t=this.ssaoMaterial;t.defines.RADIUS=e.toFixed(11),t.defines.RADIUS_SQ=(e*e).toFixed(11),t.needsUpdate=!0}get depthAwareUpsampling(){return this.defines.has("DEPTH_AWARE_UPSAMPLING")}set depthAwareUpsampling(r){this.depthAwareUpsampling!==r&&(r?this.defines.set("DEPTH_AWARE_UPSAMPLING","1"):this.defines.delete("DEPTH_AWARE_UPSAMPLING"),this.setChanged())}get distanceScaling(){return this.ssaoMaterial.defines.DISTANCE_SCALING!==void 0}set distanceScaling(r){if(this.distanceScaling!==r){const e=this.ssaoMaterial;r?e.defines.DISTANCE_SCALING="1":delete e.defines.DISTANCE_SCALING,e.needsUpdate=!0}}get color(){return this.uniforms.get("color").value}set color(r){const e=this.uniforms,t=this.defines;r!==null?t.has("COLORIZE")?e.get("color").value.set(r):(t.set("COLORIZE","1"),e.get("color").value=new He(r),this.setChanged()):t.has("COLORIZE")&&(t.delete("COLORIZE"),e.get("color").value=null,this.setChanged())}setDistanceCutoff(r,e){this.ssaoMaterial.uniforms.distanceCutoff.value.set(Math.min(Math.max(r,0),1),Math.min(Math.max(r+e,0),1))}setProximityCutoff(r,e){this.ssaoMaterial.uniforms.proximityCutoff.value.set(Math.min(Math.max(r,0),1),Math.min(Math.max(r+e,0),1))}setDepthTexture(r,e=Fl){const t=this.ssaoMaterial;t.defines.NORMAL_DEPTH===void 0&&(t.uniforms.normalDepthBuffer.value=r,t.depthPacking=e)}update(r,e,t){this.ssaoPass.render(r,null,this.renderTargetAO)}setSize(r,e){const t=this.resolution;t.base.set(r,e);const n=t.width,i=t.height;this.renderTargetAO.setSize(n,i),this.ssaoMaterial.setTexelSize(1/n,1/i);const s=this.camera,o=this.ssaoMaterial.uniforms;o.noiseScale.value.set(n,i).divideScalar(km),o.projectionMatrix.value.copy(s.projectionMatrix),o.inverseProjectionMatrix.value.copy(s.projectionMatrix).invert(),this.radius=this.r}};class S5 extends Bn{constructor(e){super(e);this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new pB(t)}),this.register(function(t){return new wB(t)}),this.register(function(t){return new bB(t)}),this.register(function(t){return new mB(t)}),this.register(function(t){return new gB(t)}),this.register(function(t){return new vB(t)}),this.register(function(t){return new yB(t)}),this.register(function(t){return new xB(t)}),this.register(function(t){return new fB(t)}),this.register(function(t){return new MB(t)})}load(e,t,n,i){const s=this;let o;this.resourcePath!==""?o=this.resourcePath:this.path!==""?o=this.path:o=Vr.extractUrlBase(e),this.manager.itemStart(e);const a=function(h){i?i(h):console.error(h),s.manager.itemError(e),s.manager.itemEnd(e)},l=new Zn(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(h){try{s.parse(h,o,function(u){t(u),s.manager.itemEnd(e)},a)}catch(u){a(u)}},n,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,i){let s;const o={},a={};if(typeof e=="string")s=e;else if(Vr.decodeText(new Uint8Array(e,0,4))===J1){try{o[vt.KHR_BINARY_GLTF]=new AB(e)}catch(c){i&&i(c);return}s=o[vt.KHR_BINARY_GLTF].content}else s=Vr.decodeText(new Uint8Array(e));const l=JSON.parse(s);if(l.asset===void 0||l.asset.version[0]<2){i&&i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const h=new DB(l,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});h.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){const c=this.pluginCallbacks[u](h);a[c.name]=c,o[c.name]=!0}if(l.extensionsUsed)for(let u=0;u<l.extensionsUsed.length;++u){const c=l.extensionsUsed[u],f=l.extensionsRequired||[];switch(c){case vt.KHR_MATERIALS_UNLIT:o[c]=new dB;break;case vt.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:o[c]=new _B;break;case vt.KHR_DRACO_MESH_COMPRESSION:o[c]=new SB(l,this.dracoLoader);break;case vt.KHR_TEXTURE_TRANSFORM:o[c]=new EB;break;case vt.KHR_MESH_QUANTIZATION:o[c]=new TB;break;default:f.indexOf(c)>=0&&a[c]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+c+'".')}}h.setExtensions(o),h.setPlugins(a),h.parse(n,i)}parseAsync(e,t){const n=this;return new Promise(function(i,s){n.parse(e,t,i,s)})}}function hB(){let r={};return{get:function(e){return r[e]},add:function(e,t){r[e]=t},remove:function(e){delete r[e]},removeAll:function(){r={}}}}const vt={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};class fB{constructor(e){this.parser=e,this.name=vt.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,i=t.length;n<i;n++){const s=t[n];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let i=t.cache.get(n);if(i)return i;const s=t.json,l=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let h;const u=new He(16777215);l.color!==void 0&&u.fromArray(l.color);const c=l.range!==void 0?l.range:0;switch(l.type){case"directional":h=new Oh(u),h.target.position.set(0,0,-1),h.add(h.target);break;case"point":h=new Fh(u),h.distance=c;break;case"spot":h=new Dh(u),h.distance=c,l.spot=l.spot||{},l.spot.innerConeAngle=l.spot.innerConeAngle!==void 0?l.spot.innerConeAngle:0,l.spot.outerConeAngle=l.spot.outerConeAngle!==void 0?l.spot.outerConeAngle:Math.PI/4,h.angle=l.spot.outerConeAngle,h.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,h.target.position.set(0,0,-1),h.add(h.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return h.position.set(0,0,0),h.decay=2,l.intensity!==void 0&&(h.intensity=l.intensity),h.name=t.createUniqueName(l.name||"light_"+e),i=Promise.resolve(h),t.cache.add(n,i),i}createNodeAttachment(e){const t=this,n=this.parser,s=n.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(l){return n._getNodeRef(t.cache,a,l)})}}class dB{constructor(){this.name=vt.KHR_MATERIALS_UNLIT}getMaterialType(){return ir}extendParams(e,t,n){const i=[];e.color=new He(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}s.baseColorTexture!==void 0&&i.push(n.assignTexture(e,"map",s.baseColorTexture))}return Promise.all(i)}}class pB{constructor(e){this.parser=e,this.name=vt.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Oi}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];if(o.clearcoatFactor!==void 0&&(t.clearcoat=o.clearcoatFactor),o.clearcoatTexture!==void 0&&s.push(n.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),o.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),o.clearcoatRoughnessTexture!==void 0&&s.push(n.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),o.clearcoatNormalTexture!==void 0&&(s.push(n.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),o.clearcoatNormalTexture.scale!==void 0)){const a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Ae(a,a)}return Promise.all(s)}}class mB{constructor(e){this.parser=e,this.name=vt.KHR_MATERIALS_SHEEN}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Oi}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new He(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=i.extensions[this.name];return o.sheenColorFactor!==void 0&&t.sheenColor.fromArray(o.sheenColorFactor),o.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=o.sheenRoughnessFactor),o.sheenColorTexture!==void 0&&s.push(n.assignTexture(t,"sheenColorMap",o.sheenColorTexture)),o.sheenRoughnessTexture!==void 0&&s.push(n.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class gB{constructor(e){this.parser=e,this.name=vt.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Oi}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];return o.transmissionFactor!==void 0&&(t.transmission=o.transmissionFactor),o.transmissionTexture!==void 0&&s.push(n.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class vB{constructor(e){this.parser=e,this.name=vt.KHR_MATERIALS_VOLUME}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Oi}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];t.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0,o.thicknessTexture!==void 0&&s.push(n.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||0;const a=o.attenuationColor||[1,1,1];return t.attenuationColor=new He(a[0],a[1],a[2]),Promise.all(s)}}class yB{constructor(e){this.parser=e,this.name=vt.KHR_MATERIALS_IOR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Oi}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=i.extensions[this.name];return t.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}}class xB{constructor(e){this.parser=e,this.name=vt.KHR_MATERIALS_SPECULAR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Oi}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];t.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1,o.specularTexture!==void 0&&s.push(n.assignTexture(t,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return t.specularColor=new He(a[0],a[1],a[2]),o.specularColorTexture!==void 0&&s.push(n.assignTexture(t,"specularColorMap",o.specularColorTexture).then(function(l){l.encoding=Fr})),Promise.all(s)}}class wB{constructor(e){this.parser=e,this.name=vt.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,i=n.textures[e];if(!i.extensions||!i.extensions[this.name])return null;const s=i.extensions[this.name],o=n.images[s.source],a=t.options.ktx2Loader;if(!a){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,o,a)}}class bB{constructor(e){this.parser=e,this.name=vt.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,i=n.json,s=i.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=i.images[o.source];let l=n.textureLoader;if(a.uri){const h=n.options.manager.getHandler(a.uri);h!==null&&(l=h)}return this.detectSupport().then(function(h){if(h)return n.loadTextureImage(e,a,l);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class MB{constructor(e){this.name=vt.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const i=n.extensions[this.name],s=this.parser.getDependency("buffer",i.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([s,o.ready]).then(function(a){const l=i.byteOffset||0,h=i.byteLength||0,u=i.count,c=i.byteStride,f=new ArrayBuffer(u*c),d=new Uint8Array(a[0],l,h);return o.decodeGltfBuffer(new Uint8Array(f),u,c,d,i.mode,i.filter),f})}else return null}}const J1="glTF",gc=12,K1={JSON:1313821514,BIN:5130562};class AB{constructor(e){this.name=vt.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,gc);if(this.header={magic:Vr.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==J1)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-gc,i=new DataView(e,gc);let s=0;for(;s<n;){const o=i.getUint32(s,!0);s+=4;const a=i.getUint32(s,!0);if(s+=4,a===K1.JSON){const l=new Uint8Array(e,gc+s,o);this.content=Vr.decodeText(l)}else if(a===K1.BIN){const l=gc+s;this.body=e.slice(l,l+o)}s+=o}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class SB{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=vt.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,i=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},h={};for(const u in o){const c=Wm[u]||u.toLowerCase();a[c]=o[u]}for(const u in e.attributes){const c=Wm[u]||u.toLowerCase();if(o[u]!==void 0){const f=n.accessors[e.attributes[u]],d=vc[f.componentType];h[c]=d,l[c]=f.normalized===!0}}return t.getDependency("bufferView",s).then(function(u){return new Promise(function(c){i.decodeDracoFile(u,function(f){for(const d in f.attributes){const p=f.attributes[d],m=l[d];m!==void 0&&(p.normalized=m)}c(f)},a,h)})})}}class EB{constructor(){this.name=vt.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return t.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class Vm extends vo{constructor(e){super();this.isGLTFSpecularGlossinessMaterial=!0;const t=["#ifdef USE_SPECULARMAP","	uniform sampler2D specularMap;","#endif"].join(`
`),n=["#ifdef USE_GLOSSINESSMAP","	uniform sampler2D glossinessMap;","#endif"].join(`
`),i=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","	vec4 texelSpecular = texture2D( specularMap, vUv );","	texelSpecular = sRGBToLinear( texelSpecular );","	// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","	specularFactor *= texelSpecular.rgb;","#endif"].join(`
`),s=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","	vec4 texelGlossiness = texture2D( glossinessMap, vUv );","	// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","	glossinessFactor *= texelGlossiness.a;","#endif"].join(`
`),o=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.specularColor = specularFactor;"].join(`
`),a={specular:{value:new He().setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=a,this.onBeforeCompile=function(l){for(const h in a)l.uniforms[h]=a[h];l.fragmentShader=l.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",t).replace("#include <metalnessmap_pars_fragment>",n).replace("#include <roughnessmap_fragment>",i).replace("#include <metalnessmap_fragment>",s).replace("#include <lights_physical_fragment>",o)},Object.defineProperties(this,{specular:{get:function(){return a.specular.value},set:function(l){a.specular.value=l}},specularMap:{get:function(){return a.specularMap.value},set:function(l){a.specularMap.value=l,l?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return a.glossiness.value},set:function(l){a.glossiness.value=l}},glossinessMap:{get:function(){return a.glossinessMap.value},set:function(l){a.glossinessMap.value=l,l?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}copy(e){return super.copy(e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}class _B{constructor(){this.name=vt.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"]}getMaterialType(){return Vm}extendParams(e,t,n){const i=t.extensions[this.name];e.color=new He(1,1,1),e.opacity=1;const s=[];if(Array.isArray(i.diffuseFactor)){const o=i.diffuseFactor;e.color.fromArray(o),e.opacity=o[3]}if(i.diffuseTexture!==void 0&&s.push(n.assignTexture(e,"map",i.diffuseTexture)),e.emissive=new He(0,0,0),e.glossiness=i.glossinessFactor!==void 0?i.glossinessFactor:1,e.specular=new He(1,1,1),Array.isArray(i.specularFactor)&&e.specular.fromArray(i.specularFactor),i.specularGlossinessTexture!==void 0){const o=i.specularGlossinessTexture;s.push(n.assignTexture(e,"glossinessMap",o)),s.push(n.assignTexture(e,"specularMap",o))}return Promise.all(s)}createMaterial(e){const t=new Vm(e);return t.fog=!0,t.color=e.color,t.map=e.map===void 0?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=e.aoMap===void 0?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=e.emissiveMap===void 0?null:e.emissiveMap,t.bumpMap=e.bumpMap===void 0?null:e.bumpMap,t.bumpScale=1,t.normalMap=e.normalMap===void 0?null:e.normalMap,t.normalMapType=cs,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=e.specularMap===void 0?null:e.specularMap,t.specular=e.specular,t.glossinessMap=e.glossinessMap===void 0?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=e.envMap===void 0?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t}}class TB{constructor(){this.name=vt.KHR_MESH_QUANTIZATION}}class _o extends hi{constructor(e,t,n,i){super(e,t,n,i)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,s=e*i*3+i;for(let o=0;o!==i;o++)t[o]=n[s+o];return t}}_o.prototype.beforeStart_=_o.prototype.copySampleValue_;_o.prototype.afterEnd_=_o.prototype.copySampleValue_;_o.prototype.interpolate_=function(r,e,t,n){const i=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=o*2,l=o*3,h=n-e,u=(t-e)/h,c=u*u,f=c*u,d=r*l,p=d-l,m=-2*f+3*c,y=f-c,g=1-m,v=y-c+u;for(let x=0;x!==o;x++){const w=s[p+x+o],b=s[p+x+a]*h,M=s[d+x+o],A=s[d+x]*h;i[x]=g*w+v*b+m*M+y*A}return i};const CB=new Sn;class RB extends _o{interpolate_(e,t,n,i){const s=super.interpolate_(e,t,n,i);return CB.fromArray(s).normalize().toArray(s),s}}const Vi={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},vc={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},$1={9728:Ut,9729:ft,9984:Pl,9985:bu,9986:Bl,9987:ti},eb={33071:Mn,33648:ta,10497:Ri},tb={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Wm={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Cs={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},NB={CUBICSPLINE:void 0,LINEAR:to,STEP:ia},qm={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function IB(r){return r.DefaultMaterial===void 0&&(r.DefaultMaterial=new vo({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Ti})),r.DefaultMaterial}function yc(r,e,t){for(const n in t.extensions)r[n]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function To(r,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(r.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function PB(r,e,t){let n=!1,i=!1;for(let a=0,l=e.length;a<l;a++){const h=e[a];if(h.POSITION!==void 0&&(n=!0),h.NORMAL!==void 0&&(i=!0),n&&i)break}if(!n&&!i)return Promise.resolve(r);const s=[],o=[];for(let a=0,l=e.length;a<l;a++){const h=e[a];if(n){const u=h.POSITION!==void 0?t.getDependency("accessor",h.POSITION):r.attributes.position;s.push(u)}if(i){const u=h.NORMAL!==void 0?t.getDependency("accessor",h.NORMAL):r.attributes.normal;o.push(u)}}return Promise.all([Promise.all(s),Promise.all(o)]).then(function(a){const l=a[0],h=a[1];return n&&(r.morphAttributes.position=l),i&&(r.morphAttributes.normal=h),r.morphTargetsRelative=!0,r})}function BB(r,e){if(r.updateMorphTargets(),e.weights!==void 0)for(let t=0,n=e.weights.length;t<n;t++)r.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(r.morphTargetInfluences.length===t.length){r.morphTargetDictionary={};for(let n=0,i=t.length;n<i;n++)r.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function LB(r){const e=r.extensions&&r.extensions[vt.KHR_DRACO_MESH_COMPRESSION];let t;return e?t="draco:"+e.bufferView+":"+e.indices+":"+nb(e.attributes):t=r.indices+":"+nb(r.attributes)+":"+r.mode,t}function nb(r){let e="";const t=Object.keys(r).sort();for(let n=0,i=t.length;n<i;n++)e+=t[n]+":"+r[t[n]]+";";return e}function Ym(r){switch(r){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}class DB{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new hB,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.textureCache={},this.nodeNamesUsed={},typeof createImageBitmap!="undefined"&&/Firefox|Safari/.test(navigator.userAgent)===!1?this.textureLoader=new Cm(this.options.manager):this.textureLoader=new bm(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Zn(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,i=this.json,s=this.extensions;this.cache.removeAll(),this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(o){const a={scene:o[0][i.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:i.asset,parser:n,userData:{}};yc(s,a,i),To(a,i),Promise.all(n._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let i=0,s=t.length;i<s;i++){const o=t[i].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let i=0,s=e.length;i<s;i++){const o=e[i];o.mesh!==void 0&&(this._addNodeRef(this.meshCache,o.mesh),o.skin!==void 0&&(n[o.mesh].isSkinnedMesh=!0)),o.camera!==void 0&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const i=n.clone(),s=(o,a)=>{const l=this.associations.get(o);l!=null&&this.associations.set(a,l);for(const[h,u]of o.children.entries())s(u,a.children[h])};return s(n,i),i.name+="_instance_"+e.uses[t]++,i}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const i=e(t[n]);if(i)return i}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let i=0;i<t.length;i++){const s=e(t[i]);s&&n.push(s)}return n}getDependency(e,t){const n=e+":"+t;let i=this.cache.get(n);if(!i){switch(e){case"scene":i=this.loadScene(t);break;case"node":i=this.loadNode(t);break;case"mesh":i=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":i=this.loadAccessor(t);break;case"bufferView":i=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":i=this.loadBuffer(t);break;case"material":i=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":i=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":i=this.loadSkin(t);break;case"animation":i=this.loadAnimation(t);break;case"camera":i=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(n,i)}return i}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this,i=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(i.map(function(s,o){return n.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[vt.KHR_BINARY_GLTF].body);const i=this.options;return new Promise(function(s,o){n.load(Vr.resolveURL(t.uri,i.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(n){const i=t.byteLength||0,s=t.byteOffset||0;return n.slice(s,s+i)})}loadAccessor(e){const t=this,n=this.json,i=this.json.accessors[e];if(i.bufferView===void 0&&i.sparse===void 0)return Promise.resolve(null);const s=[];return i.bufferView!==void 0?s.push(this.getDependency("bufferView",i.bufferView)):s.push(null),i.sparse!==void 0&&(s.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],l=tb[i.type],h=vc[i.componentType],u=h.BYTES_PER_ELEMENT,c=u*l,f=i.byteOffset||0,d=i.bufferView!==void 0?n.bufferViews[i.bufferView].byteStride:void 0,p=i.normalized===!0;let m,y;if(d&&d!==c){const g=Math.floor(f/d),v="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+g+":"+i.count;let x=t.cache.get(v);x||(m=new h(a,g*d,i.count*d/u),x=new ws(m,d/u),t.cache.add(v,x)),y=new Qn(x,l,f%d/u,p)}else a===null?m=new h(i.count*l):m=new h(a,f,i.count*l),y=new ut(m,l,p);if(i.sparse!==void 0){const g=tb.SCALAR,v=vc[i.sparse.indices.componentType],x=i.sparse.indices.byteOffset||0,w=i.sparse.values.byteOffset||0,b=new v(o[1],x,i.sparse.count*g),M=new h(o[2],w,i.sparse.count*l);a!==null&&(y=new ut(y.array.slice(),y.itemSize,y.normalized));for(let A=0,E=b.length;A<E;A++){const N=b[A];if(y.setX(N,M[A*l]),l>=2&&y.setY(N,M[A*l+1]),l>=3&&y.setZ(N,M[A*l+2]),l>=4&&y.setW(N,M[A*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return y})}loadTexture(e){const t=this.json,n=this.options,i=t.textures[e],s=t.images[i.source];let o=this.textureLoader;if(s.uri){const a=n.manager.getHandler(s.uri);a!==null&&(o=a)}return this.loadTextureImage(e,s,o)}loadTextureImage(e,t,n){const i=this,s=this.json,o=this.options,a=s.textures[e],l=(t.uri||t.bufferView)+":"+a.sampler;if(this.textureCache[l])return this.textureCache[l];const h=self.URL||self.webkitURL;let u=t.uri||"",c=!1;if(t.bufferView!==void 0)u=i.getDependency("bufferView",t.bufferView).then(function(d){c=!0;const p=new Blob([d],{type:t.mimeType});return u=h.createObjectURL(p),u});else if(t.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const f=Promise.resolve(u).then(function(d){return new Promise(function(p,m){let y=p;n.isImageBitmapLoader===!0&&(y=function(g){const v=new Qt(g);v.needsUpdate=!0,p(v)}),n.load(Vr.resolveURL(d,o.path),y,void 0,m)})}).then(function(d){c===!0&&h.revokeObjectURL(u),d.flipY=!1,a.name&&(d.name=a.name);const m=(s.samplers||{})[a.sampler]||{};return d.magFilter=$1[m.magFilter]||ft,d.minFilter=$1[m.minFilter]||ti,d.wrapS=eb[m.wrapS]||Ri,d.wrapT=eb[m.wrapT]||Ri,i.associations.set(d,{textures:e}),d}).catch(function(){return console.error("THREE.GLTFLoader: Couldn't load texture",u),null});return this.textureCache[l]=f,f}assignTexture(e,t,n){const i=this;return this.getDependency("texture",n.index).then(function(s){if(n.texCoord!==void 0&&n.texCoord!=0&&!(t==="aoMap"&&n.texCoord==1)&&console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+t+" not yet supported."),i.extensions[vt.KHR_TEXTURE_TRANSFORM]){const o=n.extensions!==void 0?n.extensions[vt.KHR_TEXTURE_TRANSFORM]:void 0;if(o){const a=i.associations.get(s);s=i.extensions[vt.KHR_TEXTURE_TRANSFORM].extendTexture(s,o),i.associations.set(s,a)}}return e[t]=s,s})}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const i=t.attributes.tangent===void 0,s=t.attributes.color!==void 0,o=t.attributes.normal===void 0;if(e.isPoints){const a="PointsMaterial:"+n.uuid;let l=this.cache.get(a);l||(l=new Ms,an.prototype.copy.call(l,n),l.color.copy(n.color),l.map=n.map,l.sizeAttenuation=!1,this.cache.add(a,l)),n=l}else if(e.isLine){const a="LineBasicMaterial:"+n.uuid;let l=this.cache.get(a);l||(l=new gn,an.prototype.copy.call(l,n),l.color.copy(n.color),this.cache.add(a,l)),n=l}if(i||s||o){let a="ClonedMaterial:"+n.uuid+":";n.isGLTFSpecularGlossinessMaterial&&(a+="specular-glossiness:"),i&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=n.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),i&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(n))),n=l}n.aoMap&&t.attributes.uv2===void 0&&t.attributes.uv!==void 0&&t.setAttribute("uv2",t.attributes.uv),e.material=n}getMaterialType(){return vo}loadMaterial(e){const t=this,n=this.json,i=this.extensions,s=n.materials[e];let o;const a={},l=s.extensions||{},h=[];if(l[vt.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){const c=i[vt.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];o=c.getMaterialType(),h.push(c.extendParams(a,s,t))}else if(l[vt.KHR_MATERIALS_UNLIT]){const c=i[vt.KHR_MATERIALS_UNLIT];o=c.getMaterialType(),h.push(c.extendParams(a,s,t))}else{const c=s.pbrMetallicRoughness||{};if(a.color=new He(1,1,1),a.opacity=1,Array.isArray(c.baseColorFactor)){const f=c.baseColorFactor;a.color.fromArray(f),a.opacity=f[3]}c.baseColorTexture!==void 0&&h.push(t.assignTexture(a,"map",c.baseColorTexture)),a.metalness=c.metallicFactor!==void 0?c.metallicFactor:1,a.roughness=c.roughnessFactor!==void 0?c.roughnessFactor:1,c.metallicRoughnessTexture!==void 0&&(h.push(t.assignTexture(a,"metalnessMap",c.metallicRoughnessTexture)),h.push(t.assignTexture(a,"roughnessMap",c.metallicRoughnessTexture))),o=this._invokeOne(function(f){return f.getMaterialType&&f.getMaterialType(e)}),h.push(Promise.all(this._invokeAll(function(f){return f.extendMaterialParams&&f.extendMaterialParams(e,a)})))}s.doubleSided===!0&&(a.side=mr);const u=s.alphaMode||qm.OPAQUE;if(u===qm.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.format=An,a.transparent=!1,u===qm.MASK&&(a.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&o!==ir&&(h.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new Ae(1,1),s.normalTexture.scale!==void 0)){const c=s.normalTexture.scale;a.normalScale.set(c,c)}return s.occlusionTexture!==void 0&&o!==ir&&(h.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&o!==ir&&(a.emissive=new He().fromArray(s.emissiveFactor)),s.emissiveTexture!==void 0&&o!==ir&&h.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture)),Promise.all(h).then(function(){let c;return o===Vm?c=i[vt.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(a):c=new o(a),s.name&&(c.name=s.name),c.map&&(c.map.encoding=Fr),c.emissiveMap&&(c.emissiveMap.encoding=Fr),To(c,s),t.associations.set(c,{materials:e}),s.extensions&&yc(i,c,s),c})}createUniqueName(e){const t=wt.sanitizeNodeName(e||"");let n=t;for(let i=1;this.nodeNamesUsed[n];++i)n=t+"_"+i;return this.nodeNamesUsed[n]=!0,n}loadGeometries(e){const t=this,n=this.extensions,i=this.primitiveCache;function s(a){return n[vt.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(l){return ib(l,a,t)})}const o=[];for(let a=0,l=e.length;a<l;a++){const h=e[a],u=LB(h),c=i[u];if(c)o.push(c.promise);else{let f;h.extensions&&h.extensions[vt.KHR_DRACO_MESH_COMPRESSION]?f=s(h):f=ib(new rt,h,t),i[u]={primitive:h,promise:f},o.push(f)}}return Promise.all(o)}loadMesh(e){const t=this,n=this.json,i=this.extensions,s=n.meshes[e],o=s.primitives,a=[];for(let l=0,h=o.length;l<h;l++){const u=o[l].material===void 0?IB(this.cache):this.getDependency("material",o[l].material);a.push(u)}return a.push(t.loadGeometries(o)),Promise.all(a).then(function(l){const h=l.slice(0,l.length-1),u=l[l.length-1],c=[];for(let d=0,p=u.length;d<p;d++){const m=u[d],y=o[d];let g;const v=h[d];if(y.mode===Vi.TRIANGLES||y.mode===Vi.TRIANGLE_STRIP||y.mode===Vi.TRIANGLE_FAN||y.mode===void 0)g=s.isSkinnedMesh===!0?new Kl(m,v):new Gt(m,v),g.isSkinnedMesh===!0&&!g.geometry.attributes.skinWeight.normalized&&g.normalizeSkinWeights(),y.mode===Vi.TRIANGLE_STRIP?g.geometry=sb(g.geometry,ax):y.mode===Vi.TRIANGLE_FAN&&(g.geometry=sb(g.geometry,mp));else if(y.mode===Vi.LINES)g=new jn(m,v);else if(y.mode===Vi.LINE_STRIP)g=new oi(m,v);else if(y.mode===Vi.LINE_LOOP)g=new xh(m,v);else if(y.mode===Vi.POINTS)g=new Da(m,v);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+y.mode);Object.keys(g.geometry.morphAttributes).length>0&&BB(g,s),g.name=t.createUniqueName(s.name||"mesh_"+e),To(g,s),y.extensions&&yc(i,g,y),t.assignFinalMaterial(g),c.push(g)}for(let d=0,p=c.length;d<p;d++)t.associations.set(c[d],{meshes:e,primitives:d});if(c.length===1)return c[0];const f=new si;t.associations.set(f,{meshes:e});for(let d=0,p=c.length;d<p;d++)f.add(c[d]);return f})}loadCamera(e){let t;const n=this.json.cameras[e],i=n[n.type];if(!i){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return n.type==="perspective"?t=new ln(Pu.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):n.type==="orthographic"&&(t=new Ea(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),To(t,n),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],n={joints:t.joints};return t.inverseBindMatrices===void 0?Promise.resolve(n):this.getDependency("accessor",t.inverseBindMatrices).then(function(i){return n.inverseBindMatrices=i,n})}loadAnimation(e){const n=this.json.animations[e],i=[],s=[],o=[],a=[],l=[];for(let h=0,u=n.channels.length;h<u;h++){const c=n.channels[h],f=n.samplers[c.sampler],d=c.target,p=d.node!==void 0?d.node:d.id,m=n.parameters!==void 0?n.parameters[f.input]:f.input,y=n.parameters!==void 0?n.parameters[f.output]:f.output;i.push(this.getDependency("node",p)),s.push(this.getDependency("accessor",m)),o.push(this.getDependency("accessor",y)),a.push(f),l.push(d)}return Promise.all([Promise.all(i),Promise.all(s),Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(h){const u=h[0],c=h[1],f=h[2],d=h[3],p=h[4],m=[];for(let g=0,v=u.length;g<v;g++){const x=u[g],w=c[g],b=f[g],M=d[g],A=p[g];if(x===void 0)continue;x.updateMatrix(),x.matrixAutoUpdate=!0;let E;switch(Cs[A.path]){case Cs.weights:E=Xa;break;case Cs.rotation:E=Es;break;case Cs.position:case Cs.scale:default:E=Qa;break}const N=x.name?x.name:x.uuid,R=M.interpolation!==void 0?NB[M.interpolation]:to,_=[];Cs[A.path]===Cs.weights?x.traverse(function(L){L.morphTargetInfluences&&_.push(L.name?L.name:L.uuid)}):_.push(N);let S=b.array;if(b.normalized){const L=Ym(S.constructor),k=new Float32Array(S.length);for(let H=0,O=S.length;H<O;H++)k[H]=S[H]*L;S=k}for(let L=0,k=_.length;L<k;L++){const H=new E(_[L]+"."+Cs[A.path],w.array,S,R);M.interpolation==="CUBICSPLINE"&&(H.createInterpolant=function(T){const V=this instanceof Es?RB:_o;return new V(this.times,this.values,this.getValueSize()/3,T)},H.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),m.push(H)}}const y=n.name?n.name:"animation_"+e;return new ja(y,void 0,m)})}createNodeMesh(e){const t=this.json,n=this,i=t.nodes[e];return i.mesh===void 0?null:n.getDependency("mesh",i.mesh).then(function(s){const o=n._getNodeRef(n.meshCache,i.mesh,s);return i.weights!==void 0&&o.traverse(function(a){if(!!a.isMesh)for(let l=0,h=i.weights.length;l<h;l++)a.morphTargetInfluences[l]=i.weights[l]}),o})}loadNode(e){const t=this.json,n=this.extensions,i=this,s=t.nodes[e],o=s.name?i.createUniqueName(s.name):"";return function(){const a=[],l=i._invokeOne(function(h){return h.createNodeMesh&&h.createNodeMesh(e)});return l&&a.push(l),s.camera!==void 0&&a.push(i.getDependency("camera",s.camera).then(function(h){return i._getNodeRef(i.cameraCache,s.camera,h)})),i._invokeAll(function(h){return h.createNodeAttachment&&h.createNodeAttachment(e)}).forEach(function(h){a.push(h)}),Promise.all(a)}().then(function(a){let l;if(s.isBone===!0?l=new $l:a.length>1?l=new si:a.length===1?l=a[0]:l=new dt,l!==a[0])for(let h=0,u=a.length;h<u;h++)l.add(a[h]);if(s.name&&(l.userData.name=s.name,l.name=o),To(l,s),s.extensions&&yc(n,l,s),s.matrix!==void 0){const h=new Ye;h.fromArray(s.matrix),l.applyMatrix4(h)}else s.translation!==void 0&&l.position.fromArray(s.translation),s.rotation!==void 0&&l.quaternion.fromArray(s.rotation),s.scale!==void 0&&l.scale.fromArray(s.scale);return i.associations.has(l)||i.associations.set(l,{}),i.associations.get(l).nodes=e,l})}loadScene(e){const t=this.json,n=this.extensions,i=this.json.scenes[e],s=this,o=new si;i.name&&(o.name=s.createUniqueName(i.name)),To(o,i),i.extensions&&yc(n,o,i);const a=i.nodes||[],l=[];for(let h=0,u=a.length;h<u;h++)l.push(rb(a[h],o,t,s));return Promise.all(l).then(function(){const h=u=>{const c=new Map;for(const[f,d]of s.associations)(f instanceof an||f instanceof Qt)&&c.set(f,d);return u.traverse(f=>{const d=s.associations.get(f);d!=null&&c.set(f,d)}),c};return s.associations=h(o),o})}}function rb(r,e,t,n){const i=t.nodes[r];return n.getDependency("node",r).then(function(s){if(i.skin===void 0)return s;let o;return n.getDependency("skin",i.skin).then(function(a){o=a;const l=[];for(let h=0,u=o.joints.length;h<u;h++)l.push(n.getDependency("node",o.joints[h]));return Promise.all(l)}).then(function(a){return s.traverse(function(l){if(!l.isMesh)return;const h=[],u=[];for(let c=0,f=a.length;c<f;c++){const d=a[c];if(d){h.push(d);const p=new Ye;o.inverseBindMatrices!==void 0&&p.fromArray(o.inverseBindMatrices.array,c*16),u.push(p)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',o.joints[c])}l.bind(new ec(h,u),l.matrixWorld)}),s})}).then(function(s){e.add(s);const o=[];if(i.children){const a=i.children;for(let l=0,h=a.length;l<h;l++){const u=a[l];o.push(rb(u,s,t,n))}}return Promise.all(o)})}function FB(r,e,t){const n=e.attributes,i=new Rt;if(n.POSITION!==void 0){const a=t.json.accessors[n.POSITION],l=a.min,h=a.max;if(l!==void 0&&h!==void 0){if(i.set(new X(l[0],l[1],l[2]),new X(h[0],h[1],h[2])),a.normalized){const u=Ym(vc[a.componentType]);i.min.multiplyScalar(u),i.max.multiplyScalar(u)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const s=e.targets;if(s!==void 0){const a=new X,l=new X;for(let h=0,u=s.length;h<u;h++){const c=s[h];if(c.POSITION!==void 0){const f=t.json.accessors[c.POSITION],d=f.min,p=f.max;if(d!==void 0&&p!==void 0){if(l.setX(Math.max(Math.abs(d[0]),Math.abs(p[0]))),l.setY(Math.max(Math.abs(d[1]),Math.abs(p[1]))),l.setZ(Math.max(Math.abs(d[2]),Math.abs(p[2]))),f.normalized){const m=Ym(vc[f.componentType]);l.multiplyScalar(m)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(a)}r.boundingBox=i;const o=new yr;i.getCenter(o.center),o.radius=i.min.distanceTo(i.max)/2,r.boundingSphere=o}function ib(r,e,t){const n=e.attributes,i=[];function s(o,a){return t.getDependency("accessor",o).then(function(l){r.setAttribute(a,l)})}for(const o in n){const a=Wm[o]||o.toLowerCase();a in r.attributes||i.push(s(n[o],a))}if(e.indices!==void 0&&!r.index){const o=t.getDependency("accessor",e.indices).then(function(a){r.setIndex(a)});i.push(o)}return To(r,e),FB(r,e,t),Promise.all(i).then(function(){return e.targets!==void 0?PB(r,e.targets,t):r})}function sb(r,e){let t=r.getIndex();if(t===null){const o=[],a=r.getAttribute("position");if(a!==void 0){for(let l=0;l<a.count;l++)o.push(l);r.setIndex(o),t=r.getIndex()}else return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),r}const n=t.count-2,i=[];if(e===mp)for(let o=1;o<=n;o++)i.push(t.getX(0)),i.push(t.getX(o)),i.push(t.getX(o+1));else for(let o=0;o<n;o++)o%2==0?(i.push(t.getX(o)),i.push(t.getX(o+1)),i.push(t.getX(o+2))):(i.push(t.getX(o+2)),i.push(t.getX(o+1)),i.push(t.getX(o)));i.length/3!==n&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=r.clone();return s.setIndex(i),s}const ob=new Rt,Qh=new X;class ab extends zh{constructor(){super();this.type="LineSegmentsGeometry";const e=[-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],t=[-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],n=[0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5];this.setIndex(n),this.setAttribute("position",new je(e,3)),this.setAttribute("uv",new je(t,2))}applyMatrix4(e){const t=this.attributes.instanceStart,n=this.attributes.instanceEnd;return t!==void 0&&(t.applyMatrix4(e),n.applyMatrix4(e),t.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}setPositions(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const n=new pc(t,6,1);return this.setAttribute("instanceStart",new Qn(n,3,0)),this.setAttribute("instanceEnd",new Qn(n,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const n=new pc(t,6,1);return this.setAttribute("instanceColorStart",new Qn(n,3,0)),this.setAttribute("instanceColorEnd",new Qn(n,3,3)),this}fromWireframeGeometry(e){return this.setPositions(e.attributes.position.array),this}fromEdgesGeometry(e){return this.setPositions(e.attributes.position.array),this}fromMesh(e){return this.fromWireframeGeometry(new Bh(e.geometry)),this}fromLineSegments(e){const t=e.geometry;if(t.isGeometry){console.error("THREE.LineSegmentsGeometry no longer supports Geometry. Use THREE.BufferGeometry instead.");return}else t.isBufferGeometry&&this.setPositions(t.attributes.position.array);return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Rt);const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;e!==void 0&&t!==void 0&&(this.boundingBox.setFromBufferAttribute(e),ob.setFromBufferAttribute(t),this.boundingBox.union(ob))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new yr),this.boundingBox===null&&this.computeBoundingBox();const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;if(e!==void 0&&t!==void 0){const n=this.boundingSphere.center;this.boundingBox.getCenter(n);let i=0;for(let s=0,o=e.count;s<o;s++)Qh.fromBufferAttribute(e,s),i=Math.max(i,n.distanceToSquared(Qh)),Qh.fromBufferAttribute(t,s),i=Math.max(i,n.distanceToSquared(Qh));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(e){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(e)}}ab.prototype.isLineSegmentsGeometry=!0;Ve.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new Ae(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}};Yn.line={uniforms:eh.merge([Ve.common,Ve.fog,Ve.line]),vertexShader:`
		#include <common>
		#include <color_pars_vertex>
		#include <fog_pars_vertex>
		#include <logdepthbuf_pars_vertex>
		#include <clipping_planes_pars_vertex>

		uniform float linewidth;
		uniform vec2 resolution;

		attribute vec3 instanceStart;
		attribute vec3 instanceEnd;

		attribute vec3 instanceColorStart;
		attribute vec3 instanceColorEnd;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#ifdef USE_DASH

			uniform float dashScale;
			attribute float instanceDistanceStart;
			attribute float instanceDistanceEnd;
			varying float vLineDistance;

		#endif

		void trimSegment( const in vec4 start, inout vec4 end ) {

			// trim end segment so it terminates between the camera plane and the near plane

			// conservative estimate of the near plane
			float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
			float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
			float nearEstimate = - 0.5 * b / a;

			float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

			end.xyz = mix( start.xyz, end.xyz, alpha );

		}

		void main() {

			#ifdef USE_COLOR

				vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

			#endif

			#ifdef USE_DASH

				vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
				vUv = uv;

			#endif

			float aspect = resolution.x / resolution.y;

			// camera space
			vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
			vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

			#ifdef WORLD_UNITS

				worldStart = start.xyz;
				worldEnd = end.xyz;

			#else

				vUv = uv;

			#endif

			// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
			// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
			// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
			// perhaps there is a more elegant solution -- WestLangley

			bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

			if ( perspective ) {

				if ( start.z < 0.0 && end.z >= 0.0 ) {

					trimSegment( start, end );

				} else if ( end.z < 0.0 && start.z >= 0.0 ) {

					trimSegment( end, start );

				}

			}

			// clip space
			vec4 clipStart = projectionMatrix * start;
			vec4 clipEnd = projectionMatrix * end;

			// ndc space
			vec3 ndcStart = clipStart.xyz / clipStart.w;
			vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

			// direction
			vec2 dir = ndcEnd.xy - ndcStart.xy;

			// account for clip-space aspect ratio
			dir.x *= aspect;
			dir = normalize( dir );

			#ifdef WORLD_UNITS

				// get the offset direction as perpendicular to the view vector
				vec3 worldDir = normalize( end.xyz - start.xyz );
				vec3 offset;
				if ( position.y < 0.5 ) {

					offset = normalize( cross( start.xyz, worldDir ) );

				} else {

					offset = normalize( cross( end.xyz, worldDir ) );

				}

				// sign flip
				if ( position.x < 0.0 ) offset *= - 1.0;

				float forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );

				// don't extend the line if we're rendering dashes because we
				// won't be rendering the endcaps
				#ifndef USE_DASH

					// extend the line bounds to encompass  endcaps
					start.xyz += - worldDir * linewidth * 0.5;
					end.xyz += worldDir * linewidth * 0.5;

					// shift the position of the quad so it hugs the forward edge of the line
					offset.xy -= dir * forwardOffset;
					offset.z += 0.5;

				#endif

				// endcaps
				if ( position.y > 1.0 || position.y < 0.0 ) {

					offset.xy += dir * 2.0 * forwardOffset;

				}

				// adjust for linewidth
				offset *= linewidth * 0.5;

				// set the world position
				worldPos = ( position.y < 0.5 ) ? start : end;
				worldPos.xyz += offset;

				// project the worldpos
				vec4 clip = projectionMatrix * worldPos;

				// shift the depth of the projected points so the line
				// segements overlap neatly
				vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
				clip.z = clipPose.z * clip.w;

			#else

				vec2 offset = vec2( dir.y, - dir.x );
				// undo aspect ratio adjustment
				dir.x /= aspect;
				offset.x /= aspect;

				// sign flip
				if ( position.x < 0.0 ) offset *= - 1.0;

				// endcaps
				if ( position.y < 0.0 ) {

					offset += - dir;

				} else if ( position.y > 1.0 ) {

					offset += dir;

				}

				// adjust for linewidth
				offset *= linewidth;

				// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
				offset /= resolution.y;

				// select end
				vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

				// back to clip space
				offset *= clip.w;

				clip.xy += offset;

			#endif

			gl_Position = clip;

			vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

			#include <logdepthbuf_vertex>
			#include <clipping_planes_vertex>
			#include <fog_vertex>

		}
		`,fragmentShader:`
		uniform vec3 diffuse;
		uniform float opacity;
		uniform float linewidth;

		#ifdef USE_DASH

			uniform float dashOffset;
			uniform float dashSize;
			uniform float gapSize;

		#endif

		varying float vLineDistance;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#include <common>
		#include <color_pars_fragment>
		#include <fog_pars_fragment>
		#include <logdepthbuf_pars_fragment>
		#include <clipping_planes_pars_fragment>

		vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

			float mua;
			float mub;

			vec3 p13 = p1 - p3;
			vec3 p43 = p4 - p3;

			vec3 p21 = p2 - p1;

			float d1343 = dot( p13, p43 );
			float d4321 = dot( p43, p21 );
			float d1321 = dot( p13, p21 );
			float d4343 = dot( p43, p43 );
			float d2121 = dot( p21, p21 );

			float denom = d2121 * d4343 - d4321 * d4321;

			float numer = d1343 * d4321 - d1321 * d4343;

			mua = numer / denom;
			mua = clamp( mua, 0.0, 1.0 );
			mub = ( d1343 + d4321 * ( mua ) ) / d4343;
			mub = clamp( mub, 0.0, 1.0 );

			return vec2( mua, mub );

		}

		void main() {

			#include <clipping_planes_fragment>

			#ifdef USE_DASH

				if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

				if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

			#endif

			float alpha = opacity;

			#ifdef WORLD_UNITS

				// Find the closest points on the view ray and the line segment
				vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
				vec3 lineDir = worldEnd - worldStart;
				vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

				vec3 p1 = worldStart + lineDir * params.x;
				vec3 p2 = rayEnd * params.y;
				vec3 delta = p1 - p2;
				float len = length( delta );
				float norm = len / linewidth;

				#ifndef USE_DASH

					#ifdef USE_ALPHA_TO_COVERAGE

						float dnorm = fwidth( norm );
						alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

					#else

						if ( norm > 0.5 ) {

							discard;

						}

					#endif

				#endif

			#else

				#ifdef USE_ALPHA_TO_COVERAGE

					// artifacts appear on some hardware if a derivative is taken within a conditional
					float a = vUv.x;
					float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
					float len2 = a * a + b * b;
					float dlen = fwidth( len2 );

					if ( abs( vUv.y ) > 1.0 ) {

						alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

					}

				#else

					if ( abs( vUv.y ) > 1.0 ) {

						float a = vUv.x;
						float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
						float len2 = a * a + b * b;

						if ( len2 > 1.0 ) discard;

					}

				#endif

			#endif

			vec4 diffuseColor = vec4( diffuse, alpha );

			#include <logdepthbuf_fragment>
			#include <color_fragment>

			gl_FragColor = vec4( diffuseColor.rgb, alpha );

			#include <tonemapping_fragment>
			#include <encodings_fragment>
			#include <fog_fragment>
			#include <premultiplied_alpha_fragment>

		}
		`};class lb extends Pn{constructor(e){super({type:"LineMaterial",uniforms:eh.clone(Yn.line.uniforms),vertexShader:Yn.line.vertexShader,fragmentShader:Yn.line.fragmentShader,clipping:!0});Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(t){this.uniforms.diffuse.value=t}},worldUnits:{enumerable:!0,get:function(){return"WORLD_UNITS"in this.defines},set:function(t){t===!0?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(t){this.uniforms.linewidth.value=t}},dashed:{enumerable:!0,get:function(){return Boolean("USE_DASH"in this.defines)},set(t){Boolean(t)!==Boolean("USE_DASH"in this.defines)&&(this.needsUpdate=!0),t===!0?this.defines.USE_DASH="":delete this.defines.USE_DASH}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(t){this.uniforms.dashScale.value=t}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(t){this.uniforms.dashSize.value=t}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(t){this.uniforms.dashOffset.value=t}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(t){this.uniforms.gapSize.value=t}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(t){this.uniforms.opacity.value=t}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(t){this.uniforms.resolution.value.copy(t)}},alphaToCoverage:{enumerable:!0,get:function(){return Boolean("USE_ALPHA_TO_COVERAGE"in this.defines)},set:function(t){Boolean(t)!==Boolean("USE_ALPHA_TO_COVERAGE"in this.defines)&&(this.needsUpdate=!0),t===!0?(this.defines.USE_ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.USE_ALPHA_TO_COVERAGE,this.extensions.derivatives=!1)}}}),this.setValues(e)}}lb.prototype.isLineMaterial=!0;const cb=new X,ub=new X,Ln=new At,Dn=new At,fi=new At,Xm=new X,Qm=new Ye,Tr=new Ui,hb=new X,Wi=new Rt,jh=new yr,di=new At;function fb(r,e,t,n){return di.set(0,0,-e,1).applyMatrix4(r.projectionMatrix),di.multiplyScalar(1/di.w),di.x=t/n.width,di.y=t/n.height,di.applyMatrix4(r.projectionMatrixInverse),di.multiplyScalar(1/di.w),Math.abs(Math.max(di.x,di.y))}class OB extends Gt{constructor(e=new ab,t=new lb({color:Math.random()*16777215})){super(e,t);this.type="LineSegments2"}computeLineDistances(){const e=this.geometry,t=e.attributes.instanceStart,n=e.attributes.instanceEnd,i=new Float32Array(2*t.count);for(let o=0,a=0,l=t.count;o<l;o++,a+=2)cb.fromBufferAttribute(t,o),ub.fromBufferAttribute(n,o),i[a]=a===0?0:i[a-1],i[a+1]=i[a]+cb.distanceTo(ub);const s=new pc(i,2,1);return e.setAttribute("instanceDistanceStart",new Qn(s,1,0)),e.setAttribute("instanceDistanceEnd",new Qn(s,1,1)),this}raycast(e,t){e.camera===null&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2.');const n=e.params.Line2!==void 0&&e.params.Line2.threshold||0,i=e.ray,s=e.camera,o=s.projectionMatrix,a=this.matrixWorld,l=this.geometry,h=this.material,u=h.resolution,c=h.linewidth+n,f=l.attributes.instanceStart,d=l.attributes.instanceEnd,p=-s.near;l.boundingSphere===null&&l.computeBoundingSphere(),jh.copy(l.boundingSphere).applyMatrix4(a);const m=Math.max(s.near,jh.distanceToPoint(i.origin)),y=fb(s,m,c,u);if(jh.radius+=y,e.ray.intersectsSphere(jh)===!1)return;l.boundingBox===null&&l.computeBoundingBox(),Wi.copy(l.boundingBox).applyMatrix4(a);const g=Math.max(s.near,Wi.distanceToPoint(i.origin)),v=fb(s,g,c,u);if(Wi.max.x+=v,Wi.max.y+=v,Wi.max.z+=v,Wi.min.x-=v,Wi.min.y-=v,Wi.min.z-=v,e.ray.intersectsBox(Wi)!==!1){i.at(1,fi),fi.w=1,fi.applyMatrix4(s.matrixWorldInverse),fi.applyMatrix4(o),fi.multiplyScalar(1/fi.w),fi.x*=u.x/2,fi.y*=u.y/2,fi.z=0,Xm.copy(fi),Qm.multiplyMatrices(s.matrixWorldInverse,a);for(let w=0,b=f.count;w<b;w++){Ln.fromBufferAttribute(f,w),Dn.fromBufferAttribute(d,w),Ln.w=1,Dn.w=1,Ln.applyMatrix4(Qm),Dn.applyMatrix4(Qm);var x=Ln.z>p&&Dn.z>p;if(x)continue;if(Ln.z>p){const R=Ln.z-Dn.z,_=(Ln.z-p)/R;Ln.lerp(Dn,_)}else if(Dn.z>p){const R=Dn.z-Ln.z,_=(Dn.z-p)/R;Dn.lerp(Ln,_)}Ln.applyMatrix4(o),Dn.applyMatrix4(o),Ln.multiplyScalar(1/Ln.w),Dn.multiplyScalar(1/Dn.w),Ln.x*=u.x/2,Ln.y*=u.y/2,Dn.x*=u.x/2,Dn.y*=u.y/2,Tr.start.copy(Ln),Tr.start.z=0,Tr.end.copy(Dn),Tr.end.z=0;const M=Tr.closestPointToPointParameter(Xm,!0);Tr.at(M,hb);const A=Pu.lerp(Ln.z,Dn.z,M),E=A>=-1&&A<=1,N=Xm.distanceTo(hb)<c*.5;if(E&&N){Tr.start.fromBufferAttribute(f,w),Tr.end.fromBufferAttribute(d,w),Tr.start.applyMatrix4(a),Tr.end.applyMatrix4(a);const R=new X,_=new X;i.distanceSqToSegment(Tr.start,Tr.end,_,R),t.push({point:_,pointOnLine:R,distance:i.origin.distanceTo(_),object:this,face:null,faceIndex:w,uv:null,uv2:null})}}}}}OB.prototype.isLineSegments2=!0;function zB(r){if(r.sheet)return r.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===r)return document.styleSheets[e]}function UB(r){var e=document.createElement("style");return e.setAttribute("data-emotion",r.key),r.nonce!==void 0&&e.setAttribute("nonce",r.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var HB=function(){function r(t){var n=this;this._insertTag=function(i){var s;n.tags.length===0?s=n.prepend?n.container.firstChild:n.before:s=n.tags[n.tags.length-1].nextSibling,n.container.insertBefore(i,s),n.tags.push(i)},this.isSpeedy=t.speedy===void 0?!0:t.speedy,this.tags=[],this.ctr=0,this.nonce=t.nonce,this.key=t.key,this.container=t.container,this.prepend=t.prepend,this.before=null}var e=r.prototype;return e.hydrate=function(n){n.forEach(this._insertTag)},e.insert=function(n){this.ctr%(this.isSpeedy?65e3:1)==0&&this._insertTag(UB(this));var i=this.tags[this.tags.length-1];if(this.isSpeedy){var s=zB(i);try{s.insertRule(n,s.cssRules.length)}catch{}}else i.appendChild(document.createTextNode(n));this.ctr++},e.flush=function(){this.tags.forEach(function(n){return n.parentNode.removeChild(n)}),this.tags=[],this.ctr=0},r}(),kn="-ms-",Zh="-moz-",Tt="-webkit-",db="comm",jm="rule",Zm="decl",GB="@import",kB="@keyframes",VB=Math.abs,Jh=String.fromCharCode;function WB(r,e){return(((e<<2^sr(r,0))<<2^sr(r,1))<<2^sr(r,2))<<2^sr(r,3)}function pb(r){return r.trim()}function qB(r,e){return(r=e.exec(r))?r[0]:r}function It(r,e,t){return r.replace(e,t)}function mb(r,e){return r.indexOf(e)}function sr(r,e){return r.charCodeAt(e)|0}function xc(r,e,t){return r.slice(e,t)}function pi(r){return r.length}function Jm(r){return r.length}function Kh(r,e){return e.push(r),r}function YB(r,e){return r.map(e).join("")}var $h=1,Ja=1,gb=0,Mr=0,vn=0,Ka="";function ef(r,e,t,n,i,s,o){return{value:r,root:e,parent:t,type:n,props:i,children:s,line:$h,column:Ja,length:o,return:""}}function wc(r,e,t){return ef(r,e.root,e.parent,t,e.props,e.children,0)}function XB(){return vn}function QB(){return vn=Mr>0?sr(Ka,--Mr):0,Ja--,vn===10&&(Ja=1,$h--),vn}function Cr(){return vn=Mr<gb?sr(Ka,Mr++):0,Ja++,vn===10&&(Ja=1,$h++),vn}function qi(){return sr(Ka,Mr)}function tf(){return Mr}function nf(r,e){return xc(Ka,r,e)}function rf(r){switch(r){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function vb(r){return $h=Ja=1,gb=pi(Ka=r),Mr=0,[]}function yb(r){return Ka="",r}function Km(r){return pb(nf(Mr-1,$m(r===91?r+2:r===40?r+1:r)))}function jB(r){for(;(vn=qi())&&vn<33;)Cr();return rf(r)>2||rf(vn)>3?"":" "}function ZB(r,e){for(;--e&&Cr()&&!(vn<48||vn>102||vn>57&&vn<65||vn>70&&vn<97););return nf(r,tf()+(e<6&&qi()==32&&Cr()==32))}function $m(r){for(;Cr();)switch(vn){case r:return Mr;case 34:case 39:return $m(r===34||r===39?r:vn);case 40:r===41&&$m(r);break;case 92:Cr();break}return Mr}function JB(r,e){for(;Cr()&&r+vn!==47+10;)if(r+vn===42+42&&qi()===47)break;return"/*"+nf(e,Mr-1)+"*"+Jh(r===47?r:Cr())}function xb(r){for(;!rf(qi());)Cr();return nf(r,Mr)}function KB(r){return yb(sf("",null,null,null,[""],r=vb(r),0,[0],r))}function sf(r,e,t,n,i,s,o,a,l){for(var h=0,u=0,c=o,f=0,d=0,p=0,m=1,y=1,g=1,v=0,x="",w=i,b=s,M=n,A=x;y;)switch(p=v,v=Cr()){case 34:case 39:case 91:case 40:A+=Km(v);break;case 9:case 10:case 13:case 32:A+=jB(p);break;case 92:A+=ZB(tf()-1,7);continue;case 47:switch(qi()){case 42:case 47:Kh($B(JB(Cr(),tf()),e,t),l);break;default:A+="/"}break;case 123*m:a[h++]=pi(A)*g;case 125*m:case 59:case 0:switch(v){case 0:case 125:y=0;case 59+u:d>0&&pi(A)-c&&Kh(d>32?bb(A+";",n,t,c-1):bb(It(A," ","")+";",n,t,c-2),l);break;case 59:A+=";";default:if(Kh(M=wb(A,e,t,h,u,i,a,x,w=[],b=[],c),s),v===123)if(u===0)sf(A,e,M,M,w,s,c,a,b);else switch(f){case 100:case 109:case 115:sf(r,M,M,n&&Kh(wb(r,M,M,0,0,i,a,x,i,w=[],c),b),i,b,c,a,n?w:b);break;default:sf(A,M,M,M,[""],b,c,a,b)}}h=u=d=0,m=g=1,x=A="",c=o;break;case 58:c=1+pi(A),d=p;default:if(m<1){if(v==123)--m;else if(v==125&&m++==0&&QB()==125)continue}switch(A+=Jh(v),v*m){case 38:g=u>0?1:(A+="\f",-1);break;case 44:a[h++]=(pi(A)-1)*g,g=1;break;case 64:qi()===45&&(A+=Km(Cr())),f=qi(),u=pi(x=A+=xb(tf())),v++;break;case 45:p===45&&pi(A)==2&&(m=0)}}return s}function wb(r,e,t,n,i,s,o,a,l,h,u){for(var c=i-1,f=i===0?s:[""],d=Jm(f),p=0,m=0,y=0;p<n;++p)for(var g=0,v=xc(r,c+1,c=VB(m=o[p])),x=r;g<d;++g)(x=pb(m>0?f[g]+" "+v:It(v,/&\f/g,f[g])))&&(l[y++]=x);return ef(r,e,t,i===0?jm:a,l,h,u)}function $B(r,e,t){return ef(r,e,t,db,Jh(XB()),xc(r,2,-2),0)}function bb(r,e,t,n){return ef(r,e,t,Zm,xc(r,0,n),xc(r,n+1,-1),n)}function Mb(r,e){switch(WB(r,e)){case 5103:return Tt+"print-"+r+r;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Tt+r+r;case 5349:case 4246:case 4810:case 6968:case 2756:return Tt+r+Zh+r+kn+r+r;case 6828:case 4268:return Tt+r+kn+r+r;case 6165:return Tt+r+kn+"flex-"+r+r;case 5187:return Tt+r+It(r,/(\w+).+(:[^]+)/,Tt+"box-$1$2"+kn+"flex-$1$2")+r;case 5443:return Tt+r+kn+"flex-item-"+It(r,/flex-|-self/,"")+r;case 4675:return Tt+r+kn+"flex-line-pack"+It(r,/align-content|flex-|-self/,"")+r;case 5548:return Tt+r+kn+It(r,"shrink","negative")+r;case 5292:return Tt+r+kn+It(r,"basis","preferred-size")+r;case 6060:return Tt+"box-"+It(r,"-grow","")+Tt+r+kn+It(r,"grow","positive")+r;case 4554:return Tt+It(r,/([^-])(transform)/g,"$1"+Tt+"$2")+r;case 6187:return It(It(It(r,/(zoom-|grab)/,Tt+"$1"),/(image-set)/,Tt+"$1"),r,"")+r;case 5495:case 3959:return It(r,/(image-set\([^]*)/,Tt+"$1$`$1");case 4968:return It(It(r,/(.+:)(flex-)?(.*)/,Tt+"box-pack:$3"+kn+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Tt+r+r;case 4095:case 3583:case 4068:case 2532:return It(r,/(.+)-inline(.+)/,Tt+"$1$2")+r;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(pi(r)-1-e>6)switch(sr(r,e+1)){case 109:if(sr(r,e+4)!==45)break;case 102:return It(r,/(.+:)(.+)-([^]+)/,"$1"+Tt+"$2-$3$1"+Zh+(sr(r,e+3)==108?"$3":"$2-$3"))+r;case 115:return~mb(r,"stretch")?Mb(It(r,"stretch","fill-available"),e)+r:r}break;case 4949:if(sr(r,e+1)!==115)break;case 6444:switch(sr(r,pi(r)-3-(~mb(r,"!important")&&10))){case 107:return It(r,":",":"+Tt)+r;case 101:return It(r,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Tt+(sr(r,14)===45?"inline-":"")+"box$3$1"+Tt+"$2$3$1"+kn+"$2box$3")+r}break;case 5936:switch(sr(r,e+11)){case 114:return Tt+r+kn+It(r,/[svh]\w+-[tblr]{2}/,"tb")+r;case 108:return Tt+r+kn+It(r,/[svh]\w+-[tblr]{2}/,"tb-rl")+r;case 45:return Tt+r+kn+It(r,/[svh]\w+-[tblr]{2}/,"lr")+r}return Tt+r+kn+r+r}return r}function bc(r,e){for(var t="",n=Jm(r),i=0;i<n;i++)t+=e(r[i],i,r,e)||"";return t}function eL(r,e,t,n){switch(r.type){case GB:case Zm:return r.return=r.return||r.value;case db:return"";case jm:r.value=r.props.join(",")}return pi(t=bc(r.children,n))?r.return=r.value+"{"+t+"}":""}function tL(r){var e=Jm(r);return function(t,n,i,s){for(var o="",a=0;a<e;a++)o+=r[a](t,n,i,s)||"";return o}}function nL(r){return function(e){e.root||(e=e.return)&&r(e)}}function rL(r,e,t,n){if(!r.return)switch(r.type){case Zm:r.return=Mb(r.value,r.length);break;case kB:return bc([wc(It(r.value,"@","@"+Tt),r,"")],n);case jm:if(r.length)return YB(r.props,function(i){switch(qB(i,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return bc([wc(It(i,/:(read-\w+)/,":"+Zh+"$1"),r,"")],n);case"::placeholder":return bc([wc(It(i,/:(plac\w+)/,":"+Tt+"input-$1"),r,""),wc(It(i,/:(plac\w+)/,":"+Zh+"$1"),r,""),wc(It(i,/:(plac\w+)/,kn+"input-$1"),r,"")],n)}return""})}}function iL(r){var e=Object.create(null);return function(t){return e[t]===void 0&&(e[t]=r(t)),e[t]}}var sL=function(e,t){var n=-1,i=44;do switch(rf(i)){case 0:i===38&&qi()===12&&(t[n]=1),e[n]+=xb(Mr-1);break;case 2:e[n]+=Km(i);break;case 4:if(i===44){e[++n]=qi()===58?"&\f":"",t[n]=e[n].length;break}default:e[n]+=Jh(i)}while(i=Cr());return e},oL=function(e,t){return yb(sL(vb(e),t))},Ab=new WeakMap,aL=function(e){if(!(e.type!=="rule"||!e.parent||!e.length)){for(var t=e.value,n=e.parent,i=e.column===n.column&&e.line===n.line;n.type!=="rule";)if(n=n.parent,!n)return;if(!(e.props.length===1&&t.charCodeAt(0)!==58&&!Ab.get(n))&&!i){Ab.set(e,!0);for(var s=[],o=oL(t,s),a=n.props,l=0,h=0;l<o.length;l++)for(var u=0;u<a.length;u++,h++)e.props[h]=s[l]?o[l].replace(/&\f/g,a[u]):a[u]+" "+o[l]}}},lL=function(e){if(e.type==="decl"){var t=e.value;t.charCodeAt(0)===108&&t.charCodeAt(2)===98&&(e.return="",e.value="")}},cL=[rL],uL=function(e){var t=e.key;if(t==="css"){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,function(m){var y=m.getAttribute("data-emotion");y.indexOf(" ")!==-1&&(document.head.appendChild(m),m.setAttribute("data-s",""))})}var i=e.stylisPlugins||cL,s={},o,a=[];o=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),function(m){for(var y=m.getAttribute("data-emotion").split(" "),g=1;g<y.length;g++)s[y[g]]=!0;a.push(m)});var l,h=[aL,lL];{var u,c=[eL,nL(function(m){u.insert(m)})],f=tL(h.concat(i,c)),d=function(y){return bc(KB(y),f)};l=function(y,g,v,x){u=v,d(y?y+"{"+g.styles+"}":g.styles),x&&(p.inserted[g.name]=!0)}}var p={key:t,sheet:new HB({key:t,container:o,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend}),nonce:e.nonce,inserted:s,registered:{},insert:l};return p.sheet.hydrate(a),p};function hL(r){for(var e=0,t,n=0,i=r.length;i>=4;++n,i-=4)t=r.charCodeAt(n)&255|(r.charCodeAt(++n)&255)<<8|(r.charCodeAt(++n)&255)<<16|(r.charCodeAt(++n)&255)<<24,t=(t&65535)*1540483477+((t>>>16)*59797<<16),t^=t>>>24,e=(t&65535)*1540483477+((t>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(i){case 3:e^=(r.charCodeAt(n+2)&255)<<16;case 2:e^=(r.charCodeAt(n+1)&255)<<8;case 1:e^=r.charCodeAt(n)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var fL={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},dL=/[A-Z]|^ms/g,pL=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Sb=function(e){return e.charCodeAt(1)===45},Eb=function(e){return e!=null&&typeof e!="boolean"},eg=iL(function(r){return Sb(r)?r:r.replace(dL,"-$&").toLowerCase()}),_b=function(e,t){switch(e){case"animation":case"animationName":if(typeof t=="string")return t.replace(pL,function(n,i,s){return mi={name:i,styles:s,next:mi},i})}return fL[e]!==1&&!Sb(e)&&typeof t=="number"&&t!==0?t+"px":t};function Mc(r,e,t){if(t==null)return"";if(t.__emotion_styles!==void 0)return t;switch(typeof t){case"boolean":return"";case"object":{if(t.anim===1)return mi={name:t.name,styles:t.styles,next:mi},t.name;if(t.styles!==void 0){var n=t.next;if(n!==void 0)for(;n!==void 0;)mi={name:n.name,styles:n.styles,next:mi},n=n.next;var i=t.styles+";";return i}return mL(r,e,t)}case"function":{if(r!==void 0){var s=mi,o=t(r);return mi=s,Mc(r,e,o)}break}}if(e==null)return t;var a=e[t];return a!==void 0?a:t}function mL(r,e,t){var n="";if(Array.isArray(t))for(var i=0;i<t.length;i++)n+=Mc(r,e,t[i])+";";else for(var s in t){var o=t[s];if(typeof o!="object")e!=null&&e[o]!==void 0?n+=s+"{"+e[o]+"}":Eb(o)&&(n+=eg(s)+":"+_b(s,o)+";");else if(Array.isArray(o)&&typeof o[0]=="string"&&(e==null||e[o[0]]===void 0))for(var a=0;a<o.length;a++)Eb(o[a])&&(n+=eg(s)+":"+_b(s,o[a])+";");else{var l=Mc(r,e,o);switch(s){case"animation":case"animationName":{n+=eg(s)+":"+l+";";break}default:n+=s+"{"+l+"}"}}}return n}var Tb=/label:\s*([^\s;\n{]+)\s*(;|$)/g,mi,tg=function(e,t,n){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var i=!0,s="";mi=void 0;var o=e[0];o==null||o.raw===void 0?(i=!1,s+=Mc(n,t,o)):s+=o[0];for(var a=1;a<e.length;a++)s+=Mc(n,t,e[a]),i&&(s+=o[a]);Tb.lastIndex=0;for(var l="",h;(h=Tb.exec(s))!==null;)l+="-"+h[1];var u=hL(s)+l;return{name:u,styles:s,next:mi}},gL=!0;function Cb(r,e,t){var n="";return t.split(" ").forEach(function(i){r[i]!==void 0?e.push(r[i]+";"):n+=i+" "}),n}var vL=function(e,t,n){var i=e.key+"-"+t.name;if((n===!1||gL===!1)&&e.registered[i]===void 0&&(e.registered[i]=t.styles),e.inserted[t.name]===void 0){var s=t;do e.insert(t===s?"."+i:"",s,e.sheet,!0),s=s.next;while(s!==void 0)}};function Rb(r,e){if(r.inserted[e.name]===void 0)return r.insert("",e,r.sheet,!0)}function Nb(r,e,t){var n=[],i=Cb(r,n,t);return n.length<2?t:i+e(n)}var yL=function(e){var t=uL(e);t.sheet.speedy=function(a){this.isSpeedy=a},t.compat=!0;var n=function(){for(var l=arguments.length,h=new Array(l),u=0;u<l;u++)h[u]=arguments[u];var c=tg(h,t.registered,void 0);return vL(t,c,!1),t.key+"-"+c.name},i=function(){for(var l=arguments.length,h=new Array(l),u=0;u<l;u++)h[u]=arguments[u];var c=tg(h,t.registered),f="animation-"+c.name;return Rb(t,{name:c.name,styles:"@keyframes "+f+"{"+c.styles+"}"}),f},s=function(){for(var l=arguments.length,h=new Array(l),u=0;u<l;u++)h[u]=arguments[u];var c=tg(h,t.registered);Rb(t,c)},o=function(){for(var l=arguments.length,h=new Array(l),u=0;u<l;u++)h[u]=arguments[u];return Nb(t.registered,n,xL(h))};return{css:n,cx:o,injectGlobal:s,keyframes:i,hydrate:function(l){l.forEach(function(h){t.inserted[h]=!0})},flush:function(){t.registered={},t.inserted={},t.sheet.flush()},sheet:t.sheet,cache:t,getRegisteredStyles:Cb.bind(null,t.registered),merge:Nb.bind(null,t.registered,n)}},xL=function r(e){for(var t="",n=0;n<e.length;n++){var i=e[n];if(i!=null){var s=void 0;switch(typeof i){case"boolean":break;case"object":{if(Array.isArray(i))s=r(i);else{s="";for(var o in i)i[o]&&o&&(s&&(s+=" "),s+=o)}break}default:s=i}s&&(t&&(t+=" "),t+=s)}}return t},wL=yL({key:"css"}),E5=wL.css;class of{constructor(e=0,t=0){this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6],this.y=i[1]*t+i[4]*n+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t,n){return n!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),i=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*n-o*i+e.x,this.y=s*i+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}of.prototype.isVector2=!0;const Fn=[];for(let r=0;r<256;r++)Fn[r]=(r<16?"0":"")+r.toString(16);let af=1234567;const Ib=Math.PI/180,Pb=180/Math.PI;function bL(){const r=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(Fn[r&255]+Fn[r>>8&255]+Fn[r>>16&255]+Fn[r>>24&255]+"-"+Fn[e&255]+Fn[e>>8&255]+"-"+Fn[e>>16&15|64]+Fn[e>>24&255]+"-"+Fn[t&63|128]+Fn[t>>8&255]+"-"+Fn[t>>16&255]+Fn[t>>24&255]+Fn[n&255]+Fn[n>>8&255]+Fn[n>>16&255]+Fn[n>>24&255]).toUpperCase()}function Rr(r,e,t){return Math.max(e,Math.min(t,r))}function ng(r,e){return(r%e+e)%e}function ML(r,e,t,n,i){return n+(r-e)*(i-n)/(t-e)}function AL(r,e,t){return r!==e?(t-r)/(e-r):0}function Ac(r,e,t){return(1-t)*r+t*e}function SL(r,e,t,n){return Ac(r,e,1-Math.exp(-t*n))}function EL(r,e=1){return e-Math.abs(ng(r,e*2)-e)}function _L(r,e,t){return r<=e?0:r>=t?1:(r=(r-e)/(t-e),r*r*(3-2*r))}function TL(r,e,t){return r<=e?0:r>=t?1:(r=(r-e)/(t-e),r*r*r*(r*(r*6-15)+10))}function CL(r,e){return r+Math.floor(Math.random()*(e-r+1))}function RL(r,e){return r+Math.random()*(e-r)}function NL(r){return r*(.5-Math.random())}function IL(r){return r!==void 0&&(af=r%2147483647),af=af*16807%2147483647,(af-1)/2147483646}function PL(r){return r*Ib}function BL(r){return r*Pb}function LL(r){return(r&r-1)==0&&r!==0}function DL(r){return Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))}function FL(r){return Math.pow(2,Math.floor(Math.log(r)/Math.LN2))}function OL(r,e,t,n,i){const s=Math.cos,o=Math.sin,a=s(t/2),l=o(t/2),h=s((e+n)/2),u=o((e+n)/2),c=s((e-n)/2),f=o((e-n)/2),d=s((n-e)/2),p=o((n-e)/2);switch(i){case"XYX":r.set(a*u,l*c,l*f,a*h);break;case"YZY":r.set(l*f,a*u,l*c,a*h);break;case"ZXZ":r.set(l*c,l*f,a*u,a*h);break;case"XZX":r.set(a*u,l*p,l*d,a*h);break;case"YXY":r.set(l*d,a*u,l*p,a*h);break;case"ZYZ":r.set(l*p,l*d,a*u,a*h);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}var _5=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",DEG2RAD:Ib,RAD2DEG:Pb,generateUUID:bL,clamp:Rr,euclideanModulo:ng,mapLinear:ML,inverseLerp:AL,lerp:Ac,damp:SL,pingpong:EL,smoothstep:_L,smootherstep:TL,randInt:CL,randFloat:RL,randFloatSpread:NL,seededRandom:IL,degToRad:PL,radToDeg:BL,isPowerOfTwo:LL,ceilPowerOfTwo:DL,floorPowerOfTwo:FL,setQuaternionFromProperEuler:OL});class rg{constructor(e=0,t=0,n=0,i=1){this._x=e,this._y=t,this._z=n,this._w=i}static slerp(e,t,n,i){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(e,t,i)}static slerpFlat(e,t,n,i,s,o,a){let l=n[i+0],h=n[i+1],u=n[i+2],c=n[i+3];const f=s[o+0],d=s[o+1],p=s[o+2],m=s[o+3];if(a===0){e[t+0]=l,e[t+1]=h,e[t+2]=u,e[t+3]=c;return}if(a===1){e[t+0]=f,e[t+1]=d,e[t+2]=p,e[t+3]=m;return}if(c!==m||l!==f||h!==d||u!==p){let y=1-a;const g=l*f+h*d+u*p+c*m,v=g>=0?1:-1,x=1-g*g;if(x>Number.EPSILON){const b=Math.sqrt(x),M=Math.atan2(b,g*v);y=Math.sin(y*M)/b,a=Math.sin(a*M)/b}const w=a*v;if(l=l*y+f*w,h=h*y+d*w,u=u*y+p*w,c=c*y+m*w,y===1-a){const b=1/Math.sqrt(l*l+h*h+u*u+c*c);l*=b,h*=b,u*=b,c*=b}}e[t]=l,e[t+1]=h,e[t+2]=u,e[t+3]=c}static multiplyQuaternionsFlat(e,t,n,i,s,o){const a=n[i],l=n[i+1],h=n[i+2],u=n[i+3],c=s[o],f=s[o+1],d=s[o+2],p=s[o+3];return e[t]=a*p+u*c+l*d-h*f,e[t+1]=l*p+u*f+h*c-a*d,e[t+2]=h*p+u*d+a*f-l*c,e[t+3]=u*p-a*c-l*f-h*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!(e&&e.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=e._x,i=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,h=a(n/2),u=a(i/2),c=a(s/2),f=l(n/2),d=l(i/2),p=l(s/2);switch(o){case"XYZ":this._x=f*u*c+h*d*p,this._y=h*d*c-f*u*p,this._z=h*u*p+f*d*c,this._w=h*u*c-f*d*p;break;case"YXZ":this._x=f*u*c+h*d*p,this._y=h*d*c-f*u*p,this._z=h*u*p-f*d*c,this._w=h*u*c+f*d*p;break;case"ZXY":this._x=f*u*c-h*d*p,this._y=h*d*c+f*u*p,this._z=h*u*p+f*d*c,this._w=h*u*c-f*d*p;break;case"ZYX":this._x=f*u*c-h*d*p,this._y=h*d*c+f*u*p,this._z=h*u*p-f*d*c,this._w=h*u*c+f*d*p;break;case"YZX":this._x=f*u*c+h*d*p,this._y=h*d*c+f*u*p,this._z=h*u*p-f*d*c,this._w=h*u*c-f*d*p;break;case"XZY":this._x=f*u*c-h*d*p,this._y=h*d*c-f*u*p,this._z=h*u*p+f*d*c,this._w=h*u*c+f*d*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],i=t[4],s=t[8],o=t[1],a=t[5],l=t[9],h=t[2],u=t[6],c=t[10],f=n+a+c;if(f>0){const d=.5/Math.sqrt(f+1);this._w=.25/d,this._x=(u-l)*d,this._y=(s-h)*d,this._z=(o-i)*d}else if(n>a&&n>c){const d=2*Math.sqrt(1+n-a-c);this._w=(u-l)/d,this._x=.25*d,this._y=(i+o)/d,this._z=(s+h)/d}else if(a>c){const d=2*Math.sqrt(1+a-n-c);this._w=(s-h)/d,this._x=(i+o)/d,this._y=.25*d,this._z=(l+u)/d}else{const d=2*Math.sqrt(1+c-n-a);this._w=(o-i)/d,this._x=(s+h)/d,this._y=(l+u)/d,this._z=.25*d}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Rr(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const i=Math.min(1,t/n);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,t){return t!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,i=e._y,s=e._z,o=e._w,a=t._x,l=t._y,h=t._z,u=t._w;return this._x=n*u+o*a+i*h-s*l,this._y=i*u+o*l+s*a-n*h,this._z=s*u+o*h+n*l-i*a,this._w=o*u-n*a-i*l-s*h,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const n=this._x,i=this._y,s=this._z,o=this._w;let a=o*e._w+n*e._x+i*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=n,this._y=i,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const d=1-t;return this._w=d*o+t*this._w,this._x=d*n+t*this._x,this._y=d*i+t*this._y,this._z=d*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const h=Math.sqrt(l),u=Math.atan2(h,a),c=Math.sin((1-t)*u)/h,f=Math.sin(t*u)/h;return this._w=o*c+this._w*f,this._x=n*c+this._x*f,this._y=i*c+this._y*f,this._z=s*c+this._z*f,this._onChangeCallback(),this}slerpQuaternions(e,t,n){this.copy(e).slerp(t,n)}random(){const e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),i=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(i),n*Math.sin(s),n*Math.cos(s),t*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}rg.prototype.isQuaternion=!0;class ot{constructor(e=0,t=0,n=0){this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e,t){return t!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Bb.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Bb.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6]*i,this.y=s[1]*t+s[4]*n+s[7]*i,this.z=s[2]*t+s[5]*n+s[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,s=e.elements,o=1/(s[3]*t+s[7]*n+s[11]*i+s[15]);return this.x=(s[0]*t+s[4]*n+s[8]*i+s[12])*o,this.y=(s[1]*t+s[5]*n+s[9]*i+s[13])*o,this.z=(s[2]*t+s[6]*n+s[10]*i+s[14])*o,this}applyQuaternion(e){const t=this.x,n=this.y,i=this.z,s=e.x,o=e.y,a=e.z,l=e.w,h=l*t+o*i-a*n,u=l*n+a*t-s*i,c=l*i+s*n-o*t,f=-s*t-o*n-a*i;return this.x=h*l+f*-s+u*-a-c*-o,this.y=u*l+f*-o+c*-s-h*-a,this.z=c*l+f*-a+h*-o-u*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*i,this.y=s[1]*t+s[5]*n+s[9]*i,this.z=s[2]*t+s[6]*n+s[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e,t){return t!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,i=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=i*l-s*a,this.y=s*o-n*l,this.z=n*a-i*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return ig.copy(this).projectOnVector(e),this.sub(ig)}reflect(e){return this.sub(ig.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Rr(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const i=Math.sin(t)*e;return this.x=i*Math.sin(n),this.y=Math.cos(t)*e,this.z=i*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t,n){return n!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,n=Math.sqrt(1-e**2);return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}ot.prototype.isVector3=!0;const ig=new ot,Bb=new rg;class zL{constructor(e=0,t=0,n=0,i=1){this.x=e,this.y=t,this.z=n,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*i+o[12]*s,this.y=o[1]*t+o[5]*n+o[9]*i+o[13]*s,this.z=o[2]*t+o[6]*n+o[10]*i+o[14]*s,this.w=o[3]*t+o[7]*n+o[11]*i+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,i,s;const o=.01,a=.1,l=e.elements,h=l[0],u=l[4],c=l[8],f=l[1],d=l[5],p=l[9],m=l[2],y=l[6],g=l[10];if(Math.abs(u-f)<o&&Math.abs(c-m)<o&&Math.abs(p-y)<o){if(Math.abs(u+f)<a&&Math.abs(c+m)<a&&Math.abs(p+y)<a&&Math.abs(h+d+g-3)<a)return this.set(1,0,0,0),this;t=Math.PI;const x=(h+1)/2,w=(d+1)/2,b=(g+1)/2,M=(u+f)/4,A=(c+m)/4,E=(p+y)/4;return x>w&&x>b?x<o?(n=0,i=.707106781,s=.707106781):(n=Math.sqrt(x),i=M/n,s=A/n):w>b?w<o?(n=.707106781,i=0,s=.707106781):(i=Math.sqrt(w),n=M/i,s=E/i):b<o?(n=.707106781,i=.707106781,s=0):(s=Math.sqrt(b),n=A/s,i=E/s),this.set(n,i,s,t),this}let v=Math.sqrt((y-p)*(y-p)+(c-m)*(c-m)+(f-u)*(f-u));return Math.abs(v)<.001&&(v=1),this.x=(y-p)/v,this.y=(c-m)/v,this.z=(f-u)/v,this.w=Math.acos((h+d+g-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t,n){return n!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}zL.prototype.isVector4=!0;class Sc{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,t,n,i,s,o,a,l,h,u,c,f,d,p,m,y){const g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=i,g[1]=s,g[5]=o,g[9]=a,g[13]=l,g[2]=h,g[6]=u,g[10]=c,g[14]=f,g[3]=d,g[7]=p,g[11]=m,g[15]=y,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Sc().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,i=1/$a.setFromMatrixColumn(e,0).length(),s=1/$a.setFromMatrixColumn(e,1).length(),o=1/$a.setFromMatrixColumn(e,2).length();return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=0,t[4]=n[4]*s,t[5]=n[5]*s,t[6]=n[6]*s,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const t=this.elements,n=e.x,i=e.y,s=e.z,o=Math.cos(n),a=Math.sin(n),l=Math.cos(i),h=Math.sin(i),u=Math.cos(s),c=Math.sin(s);if(e.order==="XYZ"){const f=o*u,d=o*c,p=a*u,m=a*c;t[0]=l*u,t[4]=-l*c,t[8]=h,t[1]=d+p*h,t[5]=f-m*h,t[9]=-a*l,t[2]=m-f*h,t[6]=p+d*h,t[10]=o*l}else if(e.order==="YXZ"){const f=l*u,d=l*c,p=h*u,m=h*c;t[0]=f+m*a,t[4]=p*a-d,t[8]=o*h,t[1]=o*c,t[5]=o*u,t[9]=-a,t[2]=d*a-p,t[6]=m+f*a,t[10]=o*l}else if(e.order==="ZXY"){const f=l*u,d=l*c,p=h*u,m=h*c;t[0]=f-m*a,t[4]=-o*c,t[8]=p+d*a,t[1]=d+p*a,t[5]=o*u,t[9]=m-f*a,t[2]=-o*h,t[6]=a,t[10]=o*l}else if(e.order==="ZYX"){const f=o*u,d=o*c,p=a*u,m=a*c;t[0]=l*u,t[4]=p*h-d,t[8]=f*h+m,t[1]=l*c,t[5]=m*h+f,t[9]=d*h-p,t[2]=-h,t[6]=a*l,t[10]=o*l}else if(e.order==="YZX"){const f=o*l,d=o*h,p=a*l,m=a*h;t[0]=l*u,t[4]=m-f*c,t[8]=p*c+d,t[1]=c,t[5]=o*u,t[9]=-a*u,t[2]=-h*u,t[6]=d*c+p,t[10]=f-m*c}else if(e.order==="XZY"){const f=o*l,d=o*h,p=a*l,m=a*h;t[0]=l*u,t[4]=-c,t[8]=h*u,t[1]=f*c+m,t[5]=o*u,t[9]=d*c-p,t[2]=p*c-d,t[6]=a*u,t[10]=m*c+f}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(UL,e,HL)}lookAt(e,t,n){const i=this.elements;return Ar.subVectors(e,t),Ar.lengthSq()===0&&(Ar.z=1),Ar.normalize(),Rs.crossVectors(n,Ar),Rs.lengthSq()===0&&(Math.abs(n.z)===1?Ar.x+=1e-4:Ar.z+=1e-4,Ar.normalize(),Rs.crossVectors(n,Ar)),Rs.normalize(),lf.crossVectors(Ar,Rs),i[0]=Rs.x,i[4]=lf.x,i[8]=Ar.x,i[1]=Rs.y,i[5]=lf.y,i[9]=Ar.y,i[2]=Rs.z,i[6]=lf.z,i[10]=Ar.z,this}multiply(e,t){return t!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,s=this.elements,o=n[0],a=n[4],l=n[8],h=n[12],u=n[1],c=n[5],f=n[9],d=n[13],p=n[2],m=n[6],y=n[10],g=n[14],v=n[3],x=n[7],w=n[11],b=n[15],M=i[0],A=i[4],E=i[8],N=i[12],R=i[1],_=i[5],S=i[9],L=i[13],k=i[2],H=i[6],O=i[10],T=i[14],V=i[3],F=i[7],J=i[11],Y=i[15];return s[0]=o*M+a*R+l*k+h*V,s[4]=o*A+a*_+l*H+h*F,s[8]=o*E+a*S+l*O+h*J,s[12]=o*N+a*L+l*T+h*Y,s[1]=u*M+c*R+f*k+d*V,s[5]=u*A+c*_+f*H+d*F,s[9]=u*E+c*S+f*O+d*J,s[13]=u*N+c*L+f*T+d*Y,s[2]=p*M+m*R+y*k+g*V,s[6]=p*A+m*_+y*H+g*F,s[10]=p*E+m*S+y*O+g*J,s[14]=p*N+m*L+y*T+g*Y,s[3]=v*M+x*R+w*k+b*V,s[7]=v*A+x*_+w*H+b*F,s[11]=v*E+x*S+w*O+b*J,s[15]=v*N+x*L+w*T+b*Y,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],i=e[8],s=e[12],o=e[1],a=e[5],l=e[9],h=e[13],u=e[2],c=e[6],f=e[10],d=e[14],p=e[3],m=e[7],y=e[11],g=e[15];return p*(+s*l*c-i*h*c-s*a*f+n*h*f+i*a*d-n*l*d)+m*(+t*l*d-t*h*f+s*o*f-i*o*d+i*h*u-s*l*u)+y*(+t*h*c-t*a*d-s*o*c+n*o*d+s*a*u-n*h*u)+g*(-i*a*u-t*l*c+t*a*f+i*o*c-n*o*f+n*l*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],h=e[7],u=e[8],c=e[9],f=e[10],d=e[11],p=e[12],m=e[13],y=e[14],g=e[15],v=c*y*h-m*f*h+m*l*d-a*y*d-c*l*g+a*f*g,x=p*f*h-u*y*h-p*l*d+o*y*d+u*l*g-o*f*g,w=u*m*h-p*c*h+p*a*d-o*m*d-u*a*g+o*c*g,b=p*c*l-u*m*l-p*a*f+o*m*f+u*a*y-o*c*y,M=t*v+n*x+i*w+s*b;if(M===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const A=1/M;return e[0]=v*A,e[1]=(m*f*s-c*y*s-m*i*d+n*y*d+c*i*g-n*f*g)*A,e[2]=(a*y*s-m*l*s+m*i*h-n*y*h-a*i*g+n*l*g)*A,e[3]=(c*l*s-a*f*s-c*i*h+n*f*h+a*i*d-n*l*d)*A,e[4]=x*A,e[5]=(u*y*s-p*f*s+p*i*d-t*y*d-u*i*g+t*f*g)*A,e[6]=(p*l*s-o*y*s-p*i*h+t*y*h+o*i*g-t*l*g)*A,e[7]=(o*f*s-u*l*s+u*i*h-t*f*h-o*i*d+t*l*d)*A,e[8]=w*A,e[9]=(p*c*s-u*m*s-p*n*d+t*m*d+u*n*g-t*c*g)*A,e[10]=(o*m*s-p*a*s+p*n*h-t*m*h-o*n*g+t*a*g)*A,e[11]=(u*a*s-o*c*s-u*n*h+t*c*h+o*n*d-t*a*d)*A,e[12]=b*A,e[13]=(u*m*i-p*c*i+p*n*f-t*m*f-u*n*y+t*c*y)*A,e[14]=(p*a*i-o*m*i-p*n*l+t*m*l+o*n*y-t*a*y)*A,e[15]=(o*c*i-u*a*i+u*n*l-t*c*l-o*n*f+t*a*f)*A,this}scale(e){const t=this.elements,n=e.x,i=e.y,s=e.z;return t[0]*=n,t[4]*=i,t[8]*=s,t[1]*=n,t[5]*=i,t[9]*=s,t[2]*=n,t[6]*=i,t[10]*=s,t[3]*=n,t[7]*=i,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,i))}makeTranslation(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),i=Math.sin(t),s=1-n,o=e.x,a=e.y,l=e.z,h=s*o,u=s*a;return this.set(h*o+n,h*a-i*l,h*l+i*a,0,h*a+i*l,u*a+n,u*l-i*o,0,h*l-i*a,u*l+i*o,s*l*l+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,i,s,o){return this.set(1,n,s,0,e,1,o,0,t,i,1,0,0,0,0,1),this}compose(e,t,n){const i=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,h=s+s,u=o+o,c=a+a,f=s*h,d=s*u,p=s*c,m=o*u,y=o*c,g=a*c,v=l*h,x=l*u,w=l*c,b=n.x,M=n.y,A=n.z;return i[0]=(1-(m+g))*b,i[1]=(d+w)*b,i[2]=(p-x)*b,i[3]=0,i[4]=(d-w)*M,i[5]=(1-(f+g))*M,i[6]=(y+v)*M,i[7]=0,i[8]=(p+x)*A,i[9]=(y-v)*A,i[10]=(1-(f+m))*A,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,n){const i=this.elements;let s=$a.set(i[0],i[1],i[2]).length();const o=$a.set(i[4],i[5],i[6]).length(),a=$a.set(i[8],i[9],i[10]).length();this.determinant()<0&&(s=-s),e.x=i[12],e.y=i[13],e.z=i[14],Wr.copy(this);const h=1/s,u=1/o,c=1/a;return Wr.elements[0]*=h,Wr.elements[1]*=h,Wr.elements[2]*=h,Wr.elements[4]*=u,Wr.elements[5]*=u,Wr.elements[6]*=u,Wr.elements[8]*=c,Wr.elements[9]*=c,Wr.elements[10]*=c,t.setFromRotationMatrix(Wr),n.x=s,n.y=o,n.z=a,this}makePerspective(e,t,n,i,s,o){o===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const a=this.elements,l=2*s/(t-e),h=2*s/(n-i),u=(t+e)/(t-e),c=(n+i)/(n-i),f=-(o+s)/(o-s),d=-2*o*s/(o-s);return a[0]=l,a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=h,a[9]=c,a[13]=0,a[2]=0,a[6]=0,a[10]=f,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,n,i,s,o){const a=this.elements,l=1/(t-e),h=1/(n-i),u=1/(o-s),c=(t+e)*l,f=(n+i)*h,d=(o+s)*u;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-c,a[1]=0,a[5]=2*h,a[9]=0,a[13]=-f,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<16;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}Sc.prototype.isMatrix4=!0;const $a=new ot,Wr=new Sc,UL=new ot(0,0,0),HL=new ot(1,1,1),Rs=new ot,lf=new ot,Ar=new ot,Lb=new Sc,Db=new rg;class Ec{constructor(e=0,t=0,n=0,i=Ec.DefaultOrder){this._x=e,this._y=t,this._z=n,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,i=this._order){return this._x=e,this._y=t,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const i=e.elements,s=i[0],o=i[4],a=i[8],l=i[1],h=i[5],u=i[9],c=i[2],f=i[6],d=i[10];switch(t){case"XYZ":this._y=Math.asin(Rr(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-u,d),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(f,h),this._z=0);break;case"YXZ":this._x=Math.asin(-Rr(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(a,d),this._z=Math.atan2(l,h)):(this._y=Math.atan2(-c,s),this._z=0);break;case"ZXY":this._x=Math.asin(Rr(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-c,d),this._z=Math.atan2(-o,h)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-Rr(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(f,d),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,h));break;case"YZX":this._z=Math.asin(Rr(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,h),this._y=Math.atan2(-c,s)):(this._x=0,this._y=Math.atan2(a,d));break;case"XZY":this._z=Math.asin(-Rr(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(f,h),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-u,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return Lb.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Lb,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return Db.setFromEuler(this),this.setFromQuaternion(Db,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}toVector3(e){return e?e.set(this._x,this._y,this._z):new ot(this._x,this._y,this._z)}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}Ec.prototype.isEuler=!0;Ec.DefaultOrder="XYZ";Ec.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];const Fb={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},qr={h:0,s:0,l:0},cf={h:0,s:0,l:0};function sg(r,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?r+(e-r)*6*t:t<1/2?e:t<2/3?r+(e-r)*6*(2/3-t):r}function og(r){return r<.04045?r*.0773993808:Math.pow(r*.9478672986+.0521327014,2.4)}function ag(r){return r<.0031308?r*12.92:1.055*Math.pow(r,.41666)-.055}class _c{constructor(e,t,n){return t===void 0&&n===void 0?this.set(e):this.setRGB(e,t,n)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,this}setRGB(e,t,n){return this.r=e,this.g=t,this.b=n,this}setHSL(e,t,n){if(e=ng(e,1),t=Rr(t,0,1),n=Rr(n,0,1),t===0)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+t):n+t-n*t,s=2*n-i;this.r=sg(s,i,e+1/3),this.g=sg(s,i,e),this.b=sg(s,i,e-1/3)}return this}setStyle(e){function t(i){i!==void 0&&parseFloat(i)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let i;const s=n[1],o=n[2];switch(s){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(i[1],10))/255,this.g=Math.min(255,parseInt(i[2],10))/255,this.b=Math.min(255,parseInt(i[3],10))/255,t(i[4]),this;if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(i[1],10))/100,this.g=Math.min(100,parseInt(i[2],10))/100,this.b=Math.min(100,parseInt(i[3],10))/100,t(i[4]),this;break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o)){const a=parseFloat(i[1])/360,l=parseInt(i[2],10)/100,h=parseInt(i[3],10)/100;return t(i[4]),this.setHSL(a,l,h)}break}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){const i=n[1],s=i.length;if(s===3)return this.r=parseInt(i.charAt(0)+i.charAt(0),16)/255,this.g=parseInt(i.charAt(1)+i.charAt(1),16)/255,this.b=parseInt(i.charAt(2)+i.charAt(2),16)/255,this;if(s===6)return this.r=parseInt(i.charAt(0)+i.charAt(1),16)/255,this.g=parseInt(i.charAt(2)+i.charAt(3),16)/255,this.b=parseInt(i.charAt(4)+i.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this}setColorName(e){const t=Fb[e.toLowerCase()];return t!==void 0?this.setHex(t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=og(e.r),this.g=og(e.g),this.b=og(e.b),this}copyLinearToSRGB(e){return this.r=ag(e.r),this.g=ag(e.g),this.b=ag(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return this.r*255<<16^this.g*255<<8^this.b*255<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(e){const t=this.r,n=this.g,i=this.b,s=Math.max(t,n,i),o=Math.min(t,n,i);let a,l;const h=(o+s)/2;if(o===s)a=0,l=0;else{const u=s-o;switch(l=h<=.5?u/(s+o):u/(2-s-o),s){case t:a=(n-i)/u+(n<i?6:0);break;case n:a=(i-t)/u+2;break;case i:a=(t-n)/u+4;break}a/=6}return e.h=a,e.s=l,e.l=h,e}getStyle(){return"rgb("+(this.r*255|0)+","+(this.g*255|0)+","+(this.b*255|0)+")"}offsetHSL(e,t,n){return this.getHSL(qr),qr.h+=e,qr.s+=t,qr.l+=n,this.setHSL(qr.h,qr.s,qr.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(qr),e.getHSL(cf);const n=Ac(qr.h,cf.h,t),i=Ac(qr.s,cf.s,t),s=Ac(qr.l,cf.l,t);return this.setHSL(n,i,s),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),e.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}_c.NAMES=Fb;_c.prototype.isColor=!0;_c.prototype.r=1;_c.prototype.g=1;_c.prototype.b=1;const Ob=new of;class GL{constructor(e=new of(1/0,1/0),t=new of(-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Ob.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Ob.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}GL.prototype.isBox2=!0;class zb{constructor(e=new ot(1/0,1/0,1/0),t=new ot(-1/0,-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,n=1/0,i=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,h=e.length;l<h;l+=3){const u=e[l],c=e[l+1],f=e[l+2];u<t&&(t=u),c<n&&(n=c),f<i&&(i=f),u>s&&(s=u),c>o&&(o=c),f>a&&(a=f)}return this.min.set(t,n,i),this.max.set(s,o,a),this}setFromBufferAttribute(e){let t=1/0,n=1/0,i=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,h=e.count;l<h;l++){const u=e.getX(l),c=e.getY(l),f=e.getZ(l);u<t&&(t=u),c<n&&(n=c),f<i&&(i=f),u>s&&(s=u),c>o&&(o=c),f>a&&(a=f)}return this.min.set(t,n,i),this.max.set(s,o,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Tc.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e){return this.makeEmpty(),this.expandByObject(e)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e){e.updateWorldMatrix(!1,!1);const t=e.geometry;t!==void 0&&(t.boundingBox===null&&t.computeBoundingBox(),lg.copy(t.boundingBox),lg.applyMatrix4(e.matrixWorld),this.union(lg));const n=e.children;for(let i=0,s=n.length;i<s;i++)this.expandByObject(n[i]);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Tc),Tc.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Cc),uf.subVectors(this.max,Cc),el.subVectors(e.a,Cc),tl.subVectors(e.b,Cc),nl.subVectors(e.c,Cc),Ns.subVectors(tl,el),Is.subVectors(nl,tl),Co.subVectors(el,nl);let t=[0,-Ns.z,Ns.y,0,-Is.z,Is.y,0,-Co.z,Co.y,Ns.z,0,-Ns.x,Is.z,0,-Is.x,Co.z,0,-Co.x,-Ns.y,Ns.x,0,-Is.y,Is.x,0,-Co.y,Co.x,0];return!cg(t,el,tl,nl,uf)||(t=[1,0,0,0,1,0,0,0,1],!cg(t,el,tl,nl,uf))?!1:(hf.crossVectors(Ns,Is),t=[hf.x,hf.y,hf.z],cg(t,el,tl,nl,uf))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Tc.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=this.getSize(Tc).length()*.5,e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Yi[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Yi[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Yi[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Yi[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Yi[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Yi[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Yi[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Yi[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Yi),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}zb.prototype.isBox3=!0;const Yi=[new ot,new ot,new ot,new ot,new ot,new ot,new ot,new ot],Tc=new ot,lg=new zb,el=new ot,tl=new ot,nl=new ot,Ns=new ot,Is=new ot,Co=new ot,Cc=new ot,uf=new ot,hf=new ot,Ro=new ot;function cg(r,e,t,n,i){for(let s=0,o=r.length-3;s<=o;s+=3){Ro.fromArray(r,s);const a=i.x*Math.abs(Ro.x)+i.y*Math.abs(Ro.y)+i.z*Math.abs(Ro.z),l=e.dot(Ro),h=t.dot(Ro),u=n.dot(Ro);if(Math.max(-Math.max(l,h,u),Math.min(l,h,u))>a)return!1}return!0}const Xi=new ot,ug=new ot,ff=new ot,Ps=new ot,hg=new ot,df=new ot,fg=new ot;class T5{constructor(e=new ot,t=new ot(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Xi)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Xi.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Xi.copy(this.direction).multiplyScalar(t).add(this.origin),Xi.distanceToSquared(e))}distanceSqToSegment(e,t,n,i){ug.copy(e).add(t).multiplyScalar(.5),ff.copy(t).sub(e).normalize(),Ps.copy(this.origin).sub(ug);const s=e.distanceTo(t)*.5,o=-this.direction.dot(ff),a=Ps.dot(this.direction),l=-Ps.dot(ff),h=Ps.lengthSq(),u=Math.abs(1-o*o);let c,f,d,p;if(u>0)if(c=o*l-a,f=o*a-l,p=s*u,c>=0)if(f>=-p)if(f<=p){const m=1/u;c*=m,f*=m,d=c*(c+o*f+2*a)+f*(o*c+f+2*l)+h}else f=s,c=Math.max(0,-(o*f+a)),d=-c*c+f*(f+2*l)+h;else f=-s,c=Math.max(0,-(o*f+a)),d=-c*c+f*(f+2*l)+h;else f<=-p?(c=Math.max(0,-(-o*s+a)),f=c>0?-s:Math.min(Math.max(-s,-l),s),d=-c*c+f*(f+2*l)+h):f<=p?(c=0,f=Math.min(Math.max(-s,-l),s),d=f*(f+2*l)+h):(c=Math.max(0,-(o*s+a)),f=c>0?s:Math.min(Math.max(-s,-l),s),d=-c*c+f*(f+2*l)+h);else f=o>0?-s:s,c=Math.max(0,-(o*f+a)),d=-c*c+f*(f+2*l)+h;return n&&n.copy(this.direction).multiplyScalar(c).add(this.origin),i&&i.copy(ff).multiplyScalar(f).add(ug),d}intersectSphere(e,t){Xi.subVectors(e.center,this.origin);const n=Xi.dot(this.direction),i=Xi.dot(Xi)-n*n,s=e.radius*e.radius;if(i>s)return null;const o=Math.sqrt(s-i),a=n-o,l=n+o;return a<0&&l<0?null:a<0?this.at(l,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,i,s,o,a,l;const h=1/this.direction.x,u=1/this.direction.y,c=1/this.direction.z,f=this.origin;return h>=0?(n=(e.min.x-f.x)*h,i=(e.max.x-f.x)*h):(n=(e.max.x-f.x)*h,i=(e.min.x-f.x)*h),u>=0?(s=(e.min.y-f.y)*u,o=(e.max.y-f.y)*u):(s=(e.max.y-f.y)*u,o=(e.min.y-f.y)*u),n>o||s>i||((s>n||n!==n)&&(n=s),(o<i||i!==i)&&(i=o),c>=0?(a=(e.min.z-f.z)*c,l=(e.max.z-f.z)*c):(a=(e.max.z-f.z)*c,l=(e.min.z-f.z)*c),n>l||a>i)||((a>n||n!==n)&&(n=a),(l<i||i!==i)&&(i=l),i<0)?null:this.at(n>=0?n:i,t)}intersectsBox(e){return this.intersectBox(e,Xi)!==null}intersectTriangle(e,t,n,i,s){hg.subVectors(t,e),df.subVectors(n,e),fg.crossVectors(hg,df);let o=this.direction.dot(fg),a;if(o>0){if(i)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Ps.subVectors(this.origin,e);const l=a*this.direction.dot(df.crossVectors(Ps,df));if(l<0)return null;const h=a*this.direction.dot(hg.cross(Ps));if(h<0||l+h>o)return null;const u=-a*Ps.dot(fg);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}const Ub=new ot,pf=new ot;class C5{constructor(e=new ot,t=new ot){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){Ub.subVectors(e,this.start),pf.subVectors(this.end,this.start);const n=pf.dot(pf);let s=pf.dot(Ub)/n;return t&&(s=Rr(s,0,1)),s}closestPointToPoint(e,t,n){const i=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}class Hb{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,t,n,i,s,o,a,l,h){const u=this.elements;return u[0]=e,u[1]=i,u[2]=a,u[3]=t,u[4]=s,u[5]=l,u[6]=n,u[7]=o,u[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,s=this.elements,o=n[0],a=n[3],l=n[6],h=n[1],u=n[4],c=n[7],f=n[2],d=n[5],p=n[8],m=i[0],y=i[3],g=i[6],v=i[1],x=i[4],w=i[7],b=i[2],M=i[5],A=i[8];return s[0]=o*m+a*v+l*b,s[3]=o*y+a*x+l*M,s[6]=o*g+a*w+l*A,s[1]=h*m+u*v+c*b,s[4]=h*y+u*x+c*M,s[7]=h*g+u*w+c*A,s[2]=f*m+d*v+p*b,s[5]=f*y+d*x+p*M,s[8]=f*g+d*w+p*A,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],h=e[7],u=e[8];return t*o*u-t*a*h-n*s*u+n*a*l+i*s*h-i*o*l}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],h=e[7],u=e[8],c=u*o-a*h,f=a*l-u*s,d=h*s-o*l,p=t*c+n*f+i*d;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);const m=1/p;return e[0]=c*m,e[1]=(i*h-u*n)*m,e[2]=(a*n-i*o)*m,e[3]=f*m,e[4]=(u*t-i*l)*m,e[5]=(i*s-a*t)*m,e[6]=d*m,e[7]=(n*l-h*t)*m,e[8]=(o*t-n*s)*m,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,i,s,o,a){const l=Math.cos(s),h=Math.sin(s);return this.set(n*l,n*h,-n*(l*o+h*a)+o+e,-i*h,i*l,-i*(-h*o+l*a)+a+t,0,0,1),this}scale(e,t){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this}rotate(e){const t=Math.cos(e),n=Math.sin(e),i=this.elements,s=i[0],o=i[3],a=i[6],l=i[1],h=i[4],u=i[7];return i[0]=t*s+n*l,i[3]=t*o+n*h,i[6]=t*a+n*u,i[1]=-n*s+t*l,i[4]=-n*o+t*h,i[7]=-n*a+t*u,this}translate(e,t){const n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<9;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}Hb.prototype.isMatrix3=!0;const dg=new ot,kL=new ot,VL=new Hb;class WL{constructor(e=new ot(1,0,0),t=0){this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const i=dg.subVectors(n,t).cross(kL.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const n=e.delta(dg),i=this.normal.dot(n);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/i;return s<0||s>1?null:t.copy(n).multiplyScalar(s).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||VL.getNormalMatrix(e),i=this.coplanarPoint(dg).applyMatrix4(e),s=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}WL.prototype.isPlane=!0;var Gb=1.525,Rc=function(r){return function(e){return 1-r(1-e)}},Nc=function(r){return function(e){return e<=.5?r(2*e)/2:(2-r(2*(1-e)))/2}},qL=Rc,YL=Nc,kb=function(r){return function(e){return Math.pow(e,r)}},pg=function(r){return function(e){return e*e*((r+1)*e-r)}},Vb=function(r){var e=pg(r);return function(t){return(t*=2)<1?.5*e(t):.5*(2-Math.pow(2,-10*(t-1)))}},XL=function(r){return r},mg=kb(2),QL=Rc(mg),jL=Nc(mg),Wb=function(r){return 1-Math.sin(Math.acos(r))},qb=Rc(Wb),ZL=Nc(qb),gg=pg(Gb),JL=Rc(gg),KL=Nc(gg),$L=Vb(Gb),eD=4/11,tD=8/11,nD=9/10,rD=4356/361,iD=35442/1805,sD=16061/1805,mf=function(r){var e=r*r;return r<eD?7.5625*e:r<tD?9.075*e-9.9*r+3.4:r<nD?rD*e-iD*r+sD:10.8*r*r-20.52*r+10.72},oD=function(r){return 1-mf(1-r)},aD=function(r){return r<.5?.5*(1-mf(1-r*2)):.5*mf(r*2-1)+.5},lD=8,cD=.001,uD=1e-7,hD=10,Ic=11,gf=1/(Ic-1),fD=typeof Float32Array!="undefined",Yb=function(r,e){return 1-3*e+3*r},Xb=function(r,e){return 3*e-6*r},Qb=function(r){return 3*r},jb=function(r,e,t){return 3*Yb(e,t)*r*r+2*Xb(e,t)*r+Qb(e)},vf=function(r,e,t){return((Yb(e,t)*r+Xb(e,t))*r+Qb(e))*r};function dD(r,e,t,n){var i=fD?new Float32Array(Ic):new Array(Ic),s=function(u,c,f){var d=0,p,m;do m=c+(f-c)/2,p=vf(m,r,t)-u,p>0?f=m:c=m;while(Math.abs(p)>uD&&++d<hD);return m},o=function(u,c){for(var f=0,d=0,p;f<lD;++f){if(d=jb(c,r,t),d===0)return c;p=vf(c,r,t)-u,c-=p/d}return c},a=function(){for(var u=0;u<Ic;++u)i[u]=vf(u*gf,r,t)},l=function(u){for(var c=0,f=1,d=Ic-1,p=0,m=0,y=0;f!==d&&i[f]<=u;++f)c+=gf;return--f,p=(u-i[f])/(i[f+1]-i[f]),m=c+p*gf,y=jb(m,r,t),y>=cD?o(u,m):y===0?m:s(u,c,c+gf)};a();var h=function(u){var c;return r===e&&t===n?c=u:u===0?c=0:u===1?c=1:c=vf(l(u),e,n),c};return h}var R5=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",reversed:Rc,mirrored:Nc,createReversedEasing:qL,createMirroredEasing:YL,createExpoIn:kb,createBackIn:pg,createAnticipateEasing:Vb,linear:XL,easeIn:mg,easeOut:QL,easeInOut:jL,circIn:Wb,circOut:qb,circInOut:ZL,backIn:gg,backOut:JL,backInOut:KL,anticipate:$L,bounceOut:mf,bounceIn:oD,bounceInOut:aD,cubicBezier:dD}),Zb={epsilon:1e-12,matrix:"Matrix",number:"number",precision:64,predictable:!1,randomSeed:null};function tn(r){return typeof r=="number"}function Wt(r){return r&&r.constructor.prototype.isBigNumber===!0||!1}function Qi(r){return r&&typeof r=="object"&&Object.getPrototypeOf(r).isComplex===!0||!1}function Pc(r){return r&&typeof r=="object"&&Object.getPrototypeOf(r).isFraction===!0||!1}function No(r){return r&&r.constructor.prototype.isUnit===!0||!1}function gi(r){return typeof r=="string"}var nn=Array.isArray;function hn(r){return r&&r.constructor.prototype.isMatrix===!0||!1}function vg(r){return Array.isArray(r)||hn(r)}function Jb(r){return r&&r.isDenseMatrix&&r.constructor.prototype.isMatrix===!0||!1}function Kb(r){return r&&r.isSparseMatrix&&r.constructor.prototype.isMatrix===!0||!1}function yg(r){return r&&r.constructor.prototype.isRange===!0||!1}function rl(r){return r&&r.constructor.prototype.isIndex===!0||!1}function $b(r){return typeof r=="boolean"}function xg(r){return r&&r.constructor.prototype.isResultSet===!0||!1}function wg(r){return r&&r.constructor.prototype.isHelp===!0||!1}function eM(r){return typeof r=="function"}function tM(r){return r instanceof Date}function nM(r){return r instanceof RegExp}function rM(r){return!!(r&&typeof r=="object"&&r.constructor===Object&&!Qi(r)&&!Pc(r))}function iM(r){return r===null}function sM(r){return r===void 0}function Io(r){return r&&r.isAccessorNode===!0&&r.constructor.prototype.isNode===!0||!1}function bg(r){return r&&r.isArrayNode===!0&&r.constructor.prototype.isNode===!0||!1}function oM(r){return r&&r.isAssignmentNode===!0&&r.constructor.prototype.isNode===!0||!1}function aM(r){return r&&r.isBlockNode===!0&&r.constructor.prototype.isNode===!0||!1}function lM(r){return r&&r.isConditionalNode===!0&&r.constructor.prototype.isNode===!0||!1}function Po(r){return r&&r.isConstantNode===!0&&r.constructor.prototype.isNode===!0||!1}function Mg(r){return r&&r.isFunctionAssignmentNode===!0&&r.constructor.prototype.isNode===!0||!1}function yf(r){return r&&r.isFunctionNode===!0&&r.constructor.prototype.isNode===!0||!1}function Bc(r){return r&&r.isIndexNode===!0&&r.constructor.prototype.isNode===!0||!1}function Jt(r){return r&&r.isNode===!0&&r.constructor.prototype.isNode===!0||!1}function Ag(r){return r&&r.isObjectNode===!0&&r.constructor.prototype.isNode===!0||!1}function Sg(r){return r&&r.isOperatorNode===!0&&r.constructor.prototype.isNode===!0||!1}function Eg(r){return r&&r.isParenthesisNode===!0&&r.constructor.prototype.isNode===!0||!1}function _g(r){return r&&r.isRangeNode===!0&&r.constructor.prototype.isNode===!0||!1}function or(r){return r&&r.isSymbolNode===!0&&r.constructor.prototype.isNode===!0||!1}function Tg(r){return r&&r.constructor.prototype.isChain===!0||!1}function Kn(r){var e=typeof r;return e==="object"?r===null?"null":Array.isArray(r)?"Array":r instanceof Date?"Date":r instanceof RegExp?"RegExp":Wt(r)?"BigNumber":Qi(r)?"Complex":Pc(r)?"Fraction":hn(r)?"Matrix":No(r)?"Unit":rl(r)?"Index":yg(r)?"Range":xg(r)?"ResultSet":Jt(r)?r.type:Tg(r)?"Chain":wg(r)?"Help":"Object":e==="function"?"Function":e}function Et(r){var e=typeof r;if(e==="number"||e==="string"||e==="boolean"||r===null||r===void 0)return r;if(typeof r.clone=="function")return r.clone();if(Array.isArray(r))return r.map(function(t){return Et(t)});if(r instanceof Date)return new Date(r.valueOf());if(Wt(r))return r;if(r instanceof RegExp)throw new TypeError("Cannot clone "+r);return Lc(r,Et)}function Lc(r,e){var t={};for(var n in r)Je(r,n)&&(t[n]=e(r[n]));return t}function Cg(r,e){for(var t in e)Je(e,t)&&(r[t]=e[t]);return r}function cM(r,e){if(Array.isArray(e))throw new TypeError("Arrays are not supported by deepExtend");for(var t in e)if(Je(e,t)&&!(t in Object.prototype)&&!(t in Function.prototype))if(e[t]&&e[t].constructor===Object)r[t]===void 0&&(r[t]={}),r[t]&&r[t].constructor===Object?cM(r[t],e[t]):r[t]=e[t];else{if(Array.isArray(e[t]))throw new TypeError("Arrays are not supported by deepExtend");r[t]=e[t]}return r}function il(r,e){var t,n,i;if(Array.isArray(r)){if(!Array.isArray(e)||r.length!==e.length)return!1;for(n=0,i=r.length;n<i;n++)if(!il(r[n],e[n]))return!1;return!0}else{if(typeof r=="function")return r===e;if(r instanceof Object){if(Array.isArray(e)||!(e instanceof Object))return!1;for(t in r)if(!(t in e)||!il(r[t],e[t]))return!1;for(t in e)if(!(t in r)||!il(r[t],e[t]))return!1;return!0}else return r===e}}function pD(r){var e={};return uM(r,e),e}function uM(r,e){for(var t in r)if(Je(r,t)){var n=r[t];typeof n=="object"&&n!==null?uM(n,e):e[t]=n}}function Rg(r,e,t){var n=!0,i;Object.defineProperty(r,e,{get:function(){return n&&(i=t(),n=!1),i},set:function(o){i=o,n=!1},configurable:!0,enumerable:!0})}function Je(r,e){return r&&Object.hasOwnProperty.call(r,e)}function mD(r){return r&&typeof r.factory=="function"}function gD(r,e){for(var t={},n=0;n<e.length;n++){var i=e[n],s=r[i];s!==void 0&&(t[i]=s)}return t}function hM(r){return Object.keys(r).map(e=>r[e])}var fM=["Matrix","Array"],dM=["number","BigNumber","Fraction"];function vD(r,e){function t(n){if(n){var i=Lc(r,Et);pM(n,"matrix",fM),pM(n,"number",dM),cM(r,n);var s=Lc(r,Et),o=Lc(n,Et);return e("config",s,i,o),s}else return Lc(r,Et)}return t.MATRIX_OPTIONS=fM,t.NUMBER_OPTIONS=dM,Object.keys(Zb).forEach(n=>{Object.defineProperty(t,n,{get:()=>r[n],enumerable:!0,configurable:!0})}),t}function yD(r,e){return r.indexOf(e)!==-1}function pM(r,e,t){r[e]!==void 0&&!yD(t,r[e])&&console.warn('Warning: Unknown value "'+r[e]+'" for configuration option "'+e+'". Available options: '+t.map(n=>JSON.stringify(n)).join(", ")+".")}var mM={exports:{}};(function(r,e){(function(t,n){r.exports=n()})(V1,function(){function t(){return!0}function n(){return!1}function i(){}function s(){var o=[{name:"number",test:function(U){return typeof U=="number"}},{name:"string",test:function(U){return typeof U=="string"}},{name:"boolean",test:function(U){return typeof U=="boolean"}},{name:"Function",test:function(U){return typeof U=="function"}},{name:"Array",test:Array.isArray},{name:"Date",test:function(U){return U instanceof Date}},{name:"RegExp",test:function(U){return U instanceof RegExp}},{name:"Object",test:function(U){return typeof U=="object"&&U!==null&&U.constructor===Object}},{name:"null",test:function(U){return U===null}},{name:"undefined",test:function(U){return U===void 0}}],a={name:"any",test:t},l=[],h=[],u={types:o,conversions:h,ignore:l};function c(U){var W=q(u.types,function(C){return C.name===U});if(W)return W;if(U==="any")return a;var P=q(u.types,function(C){return C.name.toLowerCase()===U.toLowerCase()});throw new TypeError('Unknown type "'+U+'"'+(P?'. Did you mean "'+P.name+'"?':""))}function f(U){return U===a?999:u.types.indexOf(U)}function d(U){var W=q(u.types,function(P){return P.test(U)});if(W)return W.name;throw new TypeError("Value has unknown type. Value: "+U)}function p(U,W){if(!U.signatures)throw new TypeError("Function is no typed-function");var P;if(typeof W=="string"){P=W.split(",");for(var C=0;C<P.length;C++)P[C]=P[C].trim()}else if(Array.isArray(W))P=W;else throw new TypeError("String array or a comma separated string expected");var ee=P.join(","),ae=U.signatures[ee];if(ae)return ae;throw new TypeError("Signature not found (signature: "+(U.name||"unnamed")+"("+P.join(", ")+"))")}function m(U,W){var P=d(U);if(W===P)return U;for(var C=0;C<u.conversions.length;C++){var ee=u.conversions[C];if(ee.from===P&&ee.to===W)return ee.convert(U)}throw new Error("Cannot convert from "+P+" to "+W)}function y(U){return U.map(function(W){var P=W.types.map(N);return(W.restParam?"...":"")+P.join("|")}).join(",")}function g(U,W){var P=U.indexOf("...")===0,C=P?U.length>3?U.slice(3):"any":U,ee=C.split("|").map(Z).filter(Q).filter(K),ae=T(W,ee),le=ee.map(function(ye){var we=c(ye);return{name:ye,typeIndex:f(we),test:we.test,conversion:null,conversionIndex:-1}}),ce=ae.map(function(ye){var we=c(ye.from);return{name:ye.from,typeIndex:f(we),test:we.test,conversion:ye,conversionIndex:W.indexOf(ye)}});return{types:le.concat(ce),restParam:P}}function v(U,W,P){var C=[];return U.trim()!==""&&(C=U.split(",").map(Z).map(function(ee,ae,le){var ce=g(ee,P);if(ce.restParam&&ae!==le.length-1)throw new SyntaxError('Unexpected rest parameter "'+ee+'": only allowed for the last parameter');return ce})),C.some(ge)?null:{params:C,fn:W}}function x(U){var W=he(U);return W?W.restParam:!1}function w(U){return U.types.some(function(W){return W.conversion!=null})}function b(U){if(!U||U.types.length===0)return t;if(U.types.length===1)return c(U.types[0].name).test;if(U.types.length===2){var W=c(U.types[0].name).test,P=c(U.types[1].name).test;return function(ae){return W(ae)||P(ae)}}else{var C=U.types.map(function(ee){return c(ee.name).test});return function(ae){for(var le=0;le<C.length;le++)if(C[le](ae))return!0;return!1}}}function M(U){var W,P,C;if(x(U)){W=se(U).map(b);var ee=W.length,ae=b(he(U)),le=function(ce){for(var ye=ee;ye<ce.length;ye++)if(!ae(ce[ye]))return!1;return!0};return function(ye){for(var we=0;we<W.length;we++)if(!W[we](ye[we]))return!1;return le(ye)&&ye.length>=ee+1}}else return U.length===0?function(ye){return ye.length===0}:U.length===1?(P=b(U[0]),function(ye){return P(ye[0])&&ye.length===1}):U.length===2?(P=b(U[0]),C=b(U[1]),function(ye){return P(ye[0])&&C(ye[1])&&ye.length===2}):(W=U.map(b),function(ye){for(var we=0;we<W.length;we++)if(!W[we](ye[we]))return!1;return ye.length===W.length})}function A(U,W){return W<U.params.length?U.params[W]:x(U.params)?he(U.params):null}function E(U,W,P){var C=A(U,W),ee=C?P?C.types.filter(R):C.types:[];return ee.map(N)}function N(U){return U.name}function R(U){return U.conversion===null||U.conversion===void 0}function _(U,W){var P=B(D(U,function(C){return E(C,W,!1)}));return P.indexOf("any")!==-1?["any"]:P}function S(U,W,P){var C,ee,ae=U||"unnamed",le=P,ce;for(ce=0;ce<W.length;ce++){var ye=le.filter(function(Ie){var Pe=b(A(Ie,ce));return(ce<Ie.params.length||x(Ie.params))&&Pe(W[ce])});if(ye.length===0){if(ee=_(le,ce),ee.length>0){var we=d(W[ce]);return C=new TypeError("Unexpected type of argument in function "+ae+" (expected: "+ee.join(" or ")+", actual: "+we+", index: "+ce+")"),C.data={category:"wrongType",fn:ae,index:ce,actual:we,expected:ee},C}}else le=ye}var be=le.map(function(Ie){return x(Ie.params)?1/0:Ie.params.length});if(W.length<Math.min.apply(null,be))return ee=_(le,ce),C=new TypeError("Too few arguments in function "+ae+" (expected: "+ee.join(" or ")+", index: "+W.length+")"),C.data={category:"tooFewArgs",fn:ae,index:W.length,expected:ee},C;var oe=Math.max.apply(null,be);return W.length>oe?(C=new TypeError("Too many arguments in function "+ae+" (expected: "+oe+", actual: "+W.length+")"),C.data={category:"tooManyArgs",fn:ae,index:W.length,expectedLength:oe},C):(C=new TypeError('Arguments of type "'+W.join(", ")+'" do not match any of the defined signatures of function '+ae+"."),C.data={category:"mismatch",actual:W.map(d)},C)}function L(U){for(var W=999,P=0;P<U.types.length;P++)R(U.types[P])&&(W=Math.min(W,U.types[P].typeIndex));return W}function k(U){for(var W=999,P=0;P<U.types.length;P++)R(U.types[P])||(W=Math.min(W,U.types[P].conversionIndex));return W}function H(U,W){var P;return P=U.restParam-W.restParam,P!==0||(P=w(U)-w(W),P!==0)||(P=L(U)-L(W),P!==0)?P:k(U)-k(W)}function O(U,W){var P=Math.min(U.params.length,W.params.length),C,ee;if(ee=U.params.some(w)-W.params.some(w),ee!==0)return ee;for(C=0;C<P;C++)if(ee=w(U.params[C])-w(W.params[C]),ee!==0)return ee;for(C=0;C<P;C++)if(ee=H(U.params[C],W.params[C]),ee!==0)return ee;return U.params.length-W.params.length}function T(U,W){var P={};return U.forEach(function(C){W.indexOf(C.from)===-1&&W.indexOf(C.to)!==-1&&!P[C.from]&&(P[C.from]=C)}),Object.keys(P).map(function(C){return P[C]})}function V(U,W){var P=W;if(U.some(w)){var C=x(U),ee=U.map(F);P=function(){for(var ye=[],we=C?arguments.length-1:arguments.length,be=0;be<we;be++)ye[be]=ee[be](arguments[be]);return C&&(ye[we]=arguments[we].map(ee[we])),W.apply(this,ye)}}var ae=P;if(x(U)){var le=U.length-1;ae=function(){return P.apply(this,xe(arguments,0,le).concat([xe(arguments,le)]))}}return ae}function F(U){var W,P,C,ee,ae=[],le=[];switch(U.types.forEach(function(ce){ce.conversion&&(ae.push(c(ce.conversion.from).test),le.push(ce.conversion.convert))}),le.length){case 0:return function(ye){return ye};case 1:return W=ae[0],C=le[0],function(ye){return W(ye)?C(ye):ye};case 2:return W=ae[0],P=ae[1],C=le[0],ee=le[1],function(ye){return W(ye)?C(ye):P(ye)?ee(ye):ye};default:return function(ye){for(var we=0;we<le.length;we++)if(ae[we](ye))return le[we](ye);return ye}}}function J(U){var W={};return U.forEach(function(P){P.params.some(w)||Y(P.params,!0).forEach(function(C){W[y(C)]=P.fn})}),W}function Y(U,W){function P(C,ee,ae){if(ee<C.length){var le=C[ee],ce=W?le.types.filter(R):le.types,ye;if(le.restParam){var we=ce.filter(R);ye=we.length<ce.length?[we,ce]:[ce]}else ye=ce.map(function(oe){return[oe]});return D(ye,function(oe){return P(C,ee+1,ae.concat([oe]))})}else{var be=ae.map(function(oe,Ie){return{types:oe,restParam:Ie===C.length-1&&x(C)}});return[be]}}return P(U,0,[])}function te(U,W){for(var P=Math.max(U.params.length,W.params.length),C=0;C<P;C++){var ee=E(U,C,!0),ae=E(W,C,!0);if(!G(ee,ae))return!1}var le=U.params.length,ce=W.params.length,ye=x(U.params),we=x(W.params);return ye?we?le===ce:ce>=le:we?le>=ce:le===ce}function z(U,W){if(Object.keys(W).length===0)throw new SyntaxError("No signatures provided");var P=[];Object.keys(W).map(function(Te){return v(Te,W[Te],u.conversions)}).filter(me).forEach(function(Te){var Me=q(P,function(Ee){return te(Ee,Te)});if(Me)throw new TypeError('Conflicting signatures "'+y(Me.params)+'" and "'+y(Te.params)+'".');P.push(Te)});var C=D(P,function(Te){var Me=Te?Y(Te.params,!1):[];return Me.map(function(Ee){return{params:Ee,fn:Te.fn}})}).filter(me);C.sort(O);var ee=C[0]&&C[0].params.length<=2&&!x(C[0].params),ae=C[1]&&C[1].params.length<=2&&!x(C[1].params),le=C[2]&&C[2].params.length<=2&&!x(C[2].params),ce=C[3]&&C[3].params.length<=2&&!x(C[3].params),ye=C[4]&&C[4].params.length<=2&&!x(C[4].params),we=C[5]&&C[5].params.length<=2&&!x(C[5].params),be=ee&&ae&&le&&ce&&ye&&we,oe=C.map(function(Te){return M(Te.params)}),Ie=ee?b(C[0].params[0]):n,Pe=ae?b(C[1].params[0]):n,Qe=le?b(C[2].params[0]):n,Ge=ce?b(C[3].params[0]):n,We=ye?b(C[4].params[0]):n,Fe=we?b(C[5].params[0]):n,I=ee?b(C[0].params[1]):n,re=ae?b(C[1].params[1]):n,ve=le?b(C[2].params[1]):n,Be=ce?b(C[3].params[1]):n,Ze=ye?b(C[4].params[1]):n,Ke=we?b(C[5].params[1]):n,Ft=C.map(function(Te){return V(Te.params,Te.fn)}),tr=ee?Ft[0]:i,Dr=ae?Ft[1]:i,ur=le?Ft[2]:i,Zr=ce?Ft[3]:i,qt=ye?Ft[4]:i,Se=we?Ft[5]:i,Re=ee?C[0].params.length:-1,Le=ae?C[1].params.length:-1,De=le?C[2].params.length:-1,j=ce?C[3].params.length:-1,ue=ye?C[4].params.length:-1,fe=we?C[5].params.length:-1,de=be?6:0,ie=C.length,_e=function(){for(var Me=de;Me<ie;Me++)if(oe[Me](arguments))return Ft[Me].apply(this,arguments);throw S(U,arguments,C)},Ce=function Te(Me,Ee){return arguments.length===Re&&Ie(Me)&&I(Ee)?tr.apply(Te,arguments):arguments.length===Le&&Pe(Me)&&re(Ee)?Dr.apply(Te,arguments):arguments.length===De&&Qe(Me)&&ve(Ee)?ur.apply(Te,arguments):arguments.length===j&&Ge(Me)&&Be(Ee)?Zr.apply(Te,arguments):arguments.length===ue&&We(Me)&&Ze(Ee)?qt.apply(Te,arguments):arguments.length===fe&&Fe(Me)&&Ke(Ee)?Se.apply(Te,arguments):_e.apply(Te,arguments)};try{Object.defineProperty(Ce,"name",{value:U})}catch{}return Ce.signatures=J(C),Ce}function K(U){return u.ignore.indexOf(U)===-1}function Z(U){return U.trim()}function Q(U){return!!U}function me(U){return U!==null}function ge(U){return U.types.length===0}function se(U){return U.slice(0,U.length-1)}function he(U){return U[U.length-1]}function xe(U,W,P){return Array.prototype.slice.call(U,W,P)}function pe(U,W){return U.indexOf(W)!==-1}function G(U,W){for(var P=0;P<U.length;P++)if(pe(W,U[P]))return!0;return!1}function q(U,W){for(var P=0;P<U.length;P++)if(W(U[P]))return U[P]}function B(U){for(var W={},P=0;P<U.length;P++)W[U[P]]=!0;return Object.keys(W)}function D(U,W){return Array.prototype.concat.apply([],U.map(W))}function $(U){for(var W="",P=0;P<U.length;P++){var C=U[P];if((typeof C.signatures=="object"||typeof C.signature=="string")&&C.name!==""){if(W==="")W=C.name;else if(W!==C.name){var ee=new Error("Function names do not match (expected: "+W+", actual: "+C.name+")");throw ee.data={actual:C.name,expected:W},ee}}}return W}function ne(U){var W,P={};function C(ce,ye){if(P.hasOwnProperty(ce)&&ye!==P[ce])throw W=new Error('Signature "'+ce+'" is defined twice'),W.data={signature:ce},W}for(var ee=0;ee<U.length;ee++){var ae=U[ee];if(typeof ae.signatures=="object")for(var le in ae.signatures)ae.signatures.hasOwnProperty(le)&&(C(le,ae.signatures[le]),P[le]=ae.signatures[le]);else if(typeof ae.signature=="string")C(ae.signature,ae),P[ae.signature]=ae;else throw W=new TypeError("Function is no typed-function (index: "+ee+")"),W.data={index:ee},W}return P}return u=z("typed",{"string, Object":z,Object:function(U){var W=[];for(var P in U)U.hasOwnProperty(P)&&W.push(U[P]);var C=$(W);return z(C,U)},"...Function":function(U){return z($(U),ne(U))},"string, ...Function":function(U,W){return z(U,ne(W))}}),u.create=s,u.types=o,u.conversions=h,u.ignore=l,u.convert=m,u.find=p,u.addType=function(U,W){if(!U||typeof U.name!="string"||typeof U.test!="function")throw new TypeError("Object with properties {name: string, test: function} expected");if(W!==!1){for(var P=0;P<u.types.length;P++)if(u.types[P].name==="Object"){u.types.splice(P,0,U);return}}u.types.push(U)},u.addConversion=function(U){if(!U||typeof U.from!="string"||typeof U.to!="string"||typeof U.convert!="function")throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");u.conversions.push(U)},u}return s()})})(mM);var gM=mM.exports;function fn(r){return typeof r=="boolean"?!0:isFinite(r)?r===Math.round(r):!1}var vM=Math.sign||function(r){return r>0?1:r<0?-1:0};function sl(r,e){if(typeof e=="function")return e(r);if(r===1/0)return"Infinity";if(r===-1/0)return"-Infinity";if(isNaN(r))return"NaN";var t="auto",n;switch(e&&(e.notation&&(t=e.notation),tn(e)?n=e:tn(e.precision)&&(n=e.precision)),t){case"fixed":return yM(r,n);case"exponential":return xM(r,n);case"engineering":return xD(r,n);case"auto":return wD(r,n,e&&e).replace(/((\.\d*?)(0+))($|e)/,function(){var i=arguments[2],s=arguments[4];return i!=="."?i+s:s});default:throw new Error('Unknown notation "'+t+'". Choose "auto", "exponential", or "fixed".')}}function xf(r){var e=String(r).toLowerCase().match(/^0*?(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!e)throw new SyntaxError("Invalid number "+r);var t=e[1],n=e[2],i=parseFloat(e[4]||"0"),s=n.indexOf(".");i+=s!==-1?s-1:n.length-1;var o=n.replace(".","").replace(/^0*/,function(a){return i-=a.length,""}).replace(/0*$/,"").split("").map(function(a){return parseInt(a)});return o.length===0&&(o.push(0),i++),{sign:t,coefficients:o,exponent:i}}function xD(r,e){if(isNaN(r)||!isFinite(r))return String(r);var t=xf(r),n=wf(t,e),i=n.exponent,s=n.coefficients,o=i%3==0?i:i<0?i-3-i%3:i-i%3;if(tn(e))for(;e>s.length||i-o+1>s.length;)s.push(0);else for(var a=Math.abs(i-o)-(s.length-1),l=0;l<a;l++)s.push(0);for(var h=Math.abs(i-o),u=1;h>0;)u++,h--;var c=s.slice(u).join(""),f=tn(e)&&c.length||c.match(/[1-9]/)?"."+c:"",d=s.slice(0,u).join("")+f+"e"+(i>=0?"+":"")+o.toString();return n.sign+d}function yM(r,e){if(isNaN(r)||!isFinite(r))return String(r);var t=xf(r),n=typeof e=="number"?wf(t,t.exponent+1+e):t,i=n.coefficients,s=n.exponent+1,o=s+(e||0);return i.length<o&&(i=i.concat(ol(o-i.length))),s<0&&(i=ol(-s+1).concat(i),s=1),s<i.length&&i.splice(s,0,s===0?"0.":"."),n.sign+i.join("")}function xM(r,e){if(isNaN(r)||!isFinite(r))return String(r);var t=xf(r),n=e?wf(t,e):t,i=n.coefficients,s=n.exponent;i.length<e&&(i=i.concat(ol(e-i.length)));var o=i.shift();return n.sign+o+(i.length>0?"."+i.join(""):"")+"e"+(s>=0?"+":"")+s}function wD(r,e,t){if(isNaN(r)||!isFinite(r))return String(r);var n=t&&t.lowerExp!==void 0?t.lowerExp:-3,i=t&&t.upperExp!==void 0?t.upperExp:5,s=xf(r),o=e?wf(s,e):s;if(o.exponent<n||o.exponent>=i)return xM(r,e);var a=o.coefficients,l=o.exponent;a.length<e&&(a=a.concat(ol(e-a.length))),a=a.concat(ol(l-a.length+1+(a.length<e?e-a.length:0))),a=ol(-l).concat(a);var h=l>0?l:0;return h<a.length-1&&a.splice(h+1,0,"."),o.sign+a.join("")}function wf(r,e){for(var t={sign:r.sign,coefficients:r.coefficients,exponent:r.exponent},n=t.coefficients;e<=0;)n.unshift(0),t.exponent++,e++;if(n.length>e){var i=n.splice(e,n.length-e);if(i[0]>=5){var s=e-1;for(n[s]++;n[s]===10;)n.pop(),s===0&&(n.unshift(0),t.exponent++,s++),s--,n[s]++}}return t}function ol(r){for(var e=[],t=0;t<r;t++)e.push(0);return e}function bD(r){return r.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length}var MD=Number.EPSILON||2220446049250313e-31;function vi(r,e,t){if(t==null)return r===e;if(r===e)return!0;if(isNaN(r)||isNaN(e))return!1;if(isFinite(r)&&isFinite(e)){var n=Math.abs(r-e);return n<MD?!0:n<=Math.max(Math.abs(r),Math.abs(e))*t}return!1}function AD(r,e){if(typeof e=="function")return e(r);if(!r.isFinite())return r.isNaN()?"NaN":r.gt(0)?"Infinity":"-Infinity";var t="auto",n;switch(e!==void 0&&(e.notation&&(t=e.notation),typeof e=="number"?n=e:e.precision&&(n=e.precision)),t){case"fixed":return ED(r,n);case"exponential":return wM(r,n);case"engineering":return SD(r,n);case"auto":{var i=e&&e.lowerExp!==void 0?e.lowerExp:-3,s=e&&e.upperExp!==void 0?e.upperExp:5;if(r.isZero())return"0";var o,a=r.toSignificantDigits(n),l=a.e;return l>=i&&l<s?o=a.toFixed():o=wM(r,n),o.replace(/((\.\d*?)(0+))($|e)/,function(){var h=arguments[2],u=arguments[4];return h!=="."?h+u:u})}default:throw new Error('Unknown notation "'+t+'". Choose "auto", "exponential", or "fixed".')}}function SD(r,e){var t=r.e,n=t%3==0?t:t<0?t-3-t%3:t-t%3,i=r.mul(Math.pow(10,-n)),s=i.toPrecision(e);return s.indexOf("e")!==-1&&(s=i.toString()),s+"e"+(t>=0?"+":"")+n.toString()}function wM(r,e){return e!==void 0?r.toExponential(e-1):r.toExponential()}function ED(r,e){return r.toFixed(e)}function _D(r,e){var t=r.length-e.length,n=r.length;return r.substring(t,n)===e}function rn(r,e){if(typeof r=="number")return sl(r,e);if(Wt(r))return AD(r,e);if(TD(r))return!e||e.fraction!=="decimal"?r.s*r.n+"/"+r.d:r.toString();if(Array.isArray(r))return bM(r,e);if(gi(r))return'"'+r+'"';if(typeof r=="function")return r.syntax?String(r.syntax):"function";if(r&&typeof r=="object"){if(typeof r.format=="function")return r.format(e);if(r&&r.toString(e)!=={}.toString())return r.toString(e);var t=Object.keys(r).map(n=>'"'+n+'": '+rn(r[n],e));return"{"+t.join(", ")+"}"}return String(r)}function bf(r){for(var e=String(r),t="",n=0;n<e.length;){var i=e.charAt(n);i==="\\"?(t+=i,n++,i=e.charAt(n),(i===""||'"\\/bfnrtu'.indexOf(i)===-1)&&(t+="\\"),t+=i):i==='"'?t+='\\"':t+=i,n++}return'"'+t+'"'}function Nr(r){var e=String(r);return e=e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),e}function bM(r,e){if(Array.isArray(r)){for(var t="[",n=r.length,i=0;i<n;i++)i!==0&&(t+=", "),t+=bM(r[i],e);return t+="]",t}else return rn(r,e)}function TD(r){return r&&typeof r=="object"&&typeof r.s=="number"&&typeof r.n=="number"&&typeof r.d=="number"||!1}function gt(r,e,t){if(!(this instanceof gt))throw new SyntaxError("Constructor must be called with the new operator");this.actual=r,this.expected=e,this.relation=t,this.message="Dimension mismatch ("+(Array.isArray(r)?"["+r.join(", ")+"]":r)+" "+(this.relation||"!=")+" "+(Array.isArray(e)?"["+e.join(", ")+"]":e)+")",this.stack=new Error().stack}gt.prototype=new RangeError;gt.prototype.constructor=RangeError;gt.prototype.name="DimensionError";gt.prototype.isDimensionError=!0;function Bs(r,e,t){if(!(this instanceof Bs))throw new SyntaxError("Constructor must be called with the new operator");this.index=r,arguments.length<3?(this.min=0,this.max=e):(this.min=e,this.max=t),this.min!==void 0&&this.index<this.min?this.message="Index out of range ("+this.index+" < "+this.min+")":this.max!==void 0&&this.index>=this.max?this.message="Index out of range ("+this.index+" > "+(this.max-1)+")":this.message="Index out of range ("+this.index+")",this.stack=new Error().stack}Bs.prototype=new RangeError;Bs.prototype.constructor=RangeError;Bs.prototype.name="IndexError";Bs.prototype.isIndexError=!0;function Ir(r){for(var e=[];Array.isArray(r);)e.push(r.length),r=r[0];return e}function MM(r,e,t){var n,i=r.length;if(i!==e[t])throw new gt(i,e[t]);if(t<e.length-1){var s=t+1;for(n=0;n<i;n++){var o=r[n];if(!Array.isArray(o))throw new gt(e.length-1,e.length,"<");MM(r[n],e,s)}}else for(n=0;n<i;n++)if(Array.isArray(r[n]))throw new gt(e.length+1,e.length,">")}function AM(r,e){var t=e.length===0;if(t){if(Array.isArray(r))throw new gt(r.length,0)}else MM(r,e,0)}function Kt(r,e){if(!tn(r)||!fn(r))throw new TypeError("Index must be an integer (value: "+r+")");if(r<0||typeof e=="number"&&r>=e)throw new Bs(r,e)}function Mf(r,e,t){if(!Array.isArray(r)||!Array.isArray(e))throw new TypeError("Array expected");if(e.length===0)throw new Error("Resizing to scalar is not supported");e.forEach(function(i){if(!tn(i)||!fn(i)||i<0)throw new TypeError("Invalid size, must contain positive integers (size: "+rn(e)+")")});var n=t!==void 0?t:0;return Ng(r,e,0,n),r}function Ng(r,e,t,n){var i,s,o=r.length,a=e[t],l=Math.min(o,a);if(r.length=a,t<e.length-1){var h=t+1;for(i=0;i<l;i++)s=r[i],Array.isArray(s)||(s=[s],r[i]=s),Ng(s,e,h,n);for(i=l;i<a;i++)s=[],r[i]=s,Ng(s,e,h,n)}else{for(i=0;i<l;i++)for(;Array.isArray(r[i]);)r[i]=r[i][0];for(i=l;i<a;i++)r[i]=n}}function CD(r,e){var t=ND(r),n;function i(a){return a.reduce((l,h)=>l*h)}if(!Array.isArray(r)||!Array.isArray(e))throw new TypeError("Array expected");if(e.length===0)throw new gt(0,i(Ir(r)),"!=");for(var s=1,o=0;o<e.length;o++)s*=e[o];if(t.length!==s)throw new gt(i(e),i(Ir(r)),"!=");try{n=RD(t,e)}catch(a){throw a instanceof gt?new gt(i(e),i(Ir(r)),"!="):a}return n}function RD(r,e){for(var t=r,n,i=e.length-1;i>0;i--){var s=e[i];n=[];for(var o=t.length/s,a=0;a<o;a++)n.push(t.slice(a*s,(a+1)*s));t=n}return t}function SM(r,e,t,n){var i=n||Ir(r);if(t)for(var s=0;s<t;s++)r=[r],i.unshift(1);for(r=EM(r,e,0);i.length<e;)i.push(1);return r}function EM(r,e,t){var n,i;if(Array.isArray(r)){var s=t+1;for(n=0,i=r.length;n<i;n++)r[n]=EM(r[n],e,s)}else for(var o=t;o<e;o++)r=[r];return r}function ND(r){if(!Array.isArray(r))return r;var e=[];return r.forEach(function t(n){Array.isArray(n)?n.forEach(t):e.push(n)}),e}function Pr(r,e){return Array.prototype.map.call(r,e)}function _M(r,e){Array.prototype.forEach.call(r,e)}function TM(r,e){return Array.prototype.join.call(r,e)}function Af(r,e){for(var t,n=0,i=0;i<r.length;i++){var s=r[i],o=Array.isArray(s);if(i===0&&o&&(n=s.length),o&&s.length!==n)return;var a=o?Af(s,e):e(s);if(t===void 0)t=a;else if(t!==a)return"mixed"}return t}function CM(r,e){return r.indexOf(e)!==-1}function ke(r,e,t,n){function i(s){var o=gD(s,e.map(RM));return ID(r,e,s),t(o)}return i.isFactory=!0,i.fn=r,i.dependencies=e.slice().sort(),n&&(i.meta=n),i}function Dc(r){return typeof r=="function"&&typeof r.fn=="string"&&Array.isArray(r.dependencies)}function ID(r,e,t){var n=e.filter(s=>!PD(s)).every(s=>t[s]!==void 0);if(!n){var i=e.filter(s=>t[s]===void 0);throw new Error('Cannot create function "'.concat(r,'", ')+"some dependencies are missing: ".concat(i.map(s=>'"'.concat(s,'"')).join(", "),"."))}}function PD(r){return r&&r[0]==="?"}function RM(r){return r&&r[0]==="?"?r.slice(1):r}var NM=function(){return NM=gM.create,gM},BD=["?BigNumber","?Complex","?DenseMatrix","?Fraction"],LD=ke("typed",BD,function(e){var{BigNumber:t,Complex:n,DenseMatrix:i,Fraction:s}=e,o=NM();return o.types=[{name:"number",test:tn},{name:"Complex",test:Qi},{name:"BigNumber",test:Wt},{name:"Fraction",test:Pc},{name:"Unit",test:No},{name:"string",test:gi},{name:"Chain",test:Tg},{name:"Array",test:nn},{name:"Matrix",test:hn},{name:"DenseMatrix",test:Jb},{name:"SparseMatrix",test:Kb},{name:"Range",test:yg},{name:"Index",test:rl},{name:"boolean",test:$b},{name:"ResultSet",test:xg},{name:"Help",test:wg},{name:"function",test:eM},{name:"Date",test:tM},{name:"RegExp",test:nM},{name:"null",test:iM},{name:"undefined",test:sM},{name:"AccessorNode",test:Io},{name:"ArrayNode",test:bg},{name:"AssignmentNode",test:oM},{name:"BlockNode",test:aM},{name:"ConditionalNode",test:lM},{name:"ConstantNode",test:Po},{name:"FunctionNode",test:yf},{name:"FunctionAssignmentNode",test:Mg},{name:"IndexNode",test:Bc},{name:"Node",test:Jt},{name:"ObjectNode",test:Ag},{name:"OperatorNode",test:Sg},{name:"ParenthesisNode",test:Eg},{name:"RangeNode",test:_g},{name:"SymbolNode",test:or},{name:"Object",test:rM}],o.conversions=[{from:"number",to:"BigNumber",convert:function(l){if(t||Ig(l),bD(l)>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+l+"). Use function bignumber(x) to convert to BigNumber.");return new t(l)}},{from:"number",to:"Complex",convert:function(l){return n||Sf(l),new n(l,0)}},{from:"number",to:"string",convert:function(l){return l+""}},{from:"BigNumber",to:"Complex",convert:function(l){return n||Sf(l),new n(l.toNumber(),0)}},{from:"Fraction",to:"BigNumber",convert:function(l){throw new TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(l){return n||Sf(l),new n(l.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(l){s||Pg(l);var h=new s(l);if(h.valueOf()!==l)throw new TypeError("Cannot implicitly convert a number to a Fraction when there will be a loss of precision (value: "+l+"). Use function fraction(x) to convert to Fraction.");return h}},{from:"string",to:"number",convert:function(l){var h=Number(l);if(isNaN(h))throw new Error('Cannot convert "'+l+'" to a number');return h}},{from:"string",to:"BigNumber",convert:function(l){t||Ig(l);try{return new t(l)}catch{throw new Error('Cannot convert "'+l+'" to BigNumber')}}},{from:"string",to:"Fraction",convert:function(l){s||Pg(l);try{return new s(l)}catch{throw new Error('Cannot convert "'+l+'" to Fraction')}}},{from:"string",to:"Complex",convert:function(l){n||Sf(l);try{return new n(l)}catch{throw new Error('Cannot convert "'+l+'" to Complex')}}},{from:"boolean",to:"number",convert:function(l){return+l}},{from:"boolean",to:"BigNumber",convert:function(l){return t||Ig(l),new t(+l)}},{from:"boolean",to:"Fraction",convert:function(l){return s||Pg(l),new s(+l)}},{from:"boolean",to:"string",convert:function(l){return String(l)}},{from:"Array",to:"Matrix",convert:function(l){return i||DD(),new i(l)}},{from:"Matrix",to:"Array",convert:function(l){return l.valueOf()}}],o});function Ig(r){throw new Error("Cannot convert value ".concat(r," into a BigNumber: no class 'BigNumber' provided"))}function Sf(r){throw new Error("Cannot convert value ".concat(r," into a Complex number: no class 'Complex' provided"))}function DD(){throw new Error("Cannot convert array into a Matrix: no class 'DenseMatrix' provided")}function Pg(r){throw new Error("Cannot convert value ".concat(r," into a Fraction, no class 'Fraction' provided."))}var FD="ResultSet",OD=[],zD=ke(FD,OD,()=>{function r(e){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");this.entries=e||[]}return r.prototype.type="ResultSet",r.prototype.isResultSet=!0,r.prototype.valueOf=function(){return this.entries},r.prototype.toString=function(){return"["+this.entries.join(", ")+"]"},r.prototype.toJSON=function(){return{mathjs:"ResultSet",entries:this.entries}},r.fromJSON=function(e){return new r(e.entries)},r},{isClass:!0}),al=9e15,Ls=1e9,Bg="0123456789abcdef",Ef="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",_f="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",Lg={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-al,maxE:al,crypto:!1},IM,ji,ct=!0,Tf="[DecimalError] ",Bo=Tf+"Invalid argument: ",PM=Tf+"Precision limit exceeded",BM=Tf+"crypto unavailable",Vn=Math.floor,xn=Math.pow,UD=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,HD=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,GD=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,kD=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Yr=1e7,it=7,VD=9007199254740991,WD=Ef.length-1,Dg=_f.length-1,ze={name:"[object Decimal]"};ze.absoluteValue=ze.abs=function(){var r=new this.constructor(this);return r.s<0&&(r.s=1),nt(r)};ze.ceil=function(){return nt(new this.constructor(this),this.e+1,2)};ze.comparedTo=ze.cmp=function(r){var e,t,n,i,s=this,o=s.d,a=(r=new s.constructor(r)).d,l=s.s,h=r.s;if(!o||!a)return!l||!h?NaN:l!==h?l:o===a?0:!o^l<0?1:-1;if(!o[0]||!a[0])return o[0]?l:a[0]?-h:0;if(l!==h)return l;if(s.e!==r.e)return s.e>r.e^l<0?1:-1;for(n=o.length,i=a.length,e=0,t=n<i?n:i;e<t;++e)if(o[e]!==a[e])return o[e]>a[e]^l<0?1:-1;return n===i?0:n>i^l<0?1:-1};ze.cosine=ze.cos=function(){var r,e,t=this,n=t.constructor;return t.d?t.d[0]?(r=n.precision,e=n.rounding,n.precision=r+Math.max(t.e,t.sd())+it,n.rounding=1,t=qD(n,HM(n,t)),n.precision=r,n.rounding=e,nt(ji==2||ji==3?t.neg():t,r,e,!0)):new n(1):new n(NaN)};ze.cubeRoot=ze.cbrt=function(){var r,e,t,n,i,s,o,a,l,h,u=this,c=u.constructor;if(!u.isFinite()||u.isZero())return new c(u);for(ct=!1,s=u.s*xn(u.s*u,1/3),!s||Math.abs(s)==1/0?(t=On(u.d),r=u.e,(s=(r-t.length+1)%3)&&(t+=s==1||s==-2?"0":"00"),s=xn(t,1/3),r=Vn((r+1)/3)-(r%3==(r<0?-1:2)),s==1/0?t="5e"+r:(t=s.toExponential(),t=t.slice(0,t.indexOf("e")+1)+r),n=new c(t),n.s=u.s):n=new c(s.toString()),o=(r=c.precision)+3;;)if(a=n,l=a.times(a).times(a),h=l.plus(u),n=Dt(h.plus(u).times(a),h.plus(l),o+2,1),On(a.d).slice(0,o)===(t=On(n.d)).slice(0,o))if(t=t.slice(o-3,o+1),t=="9999"||!i&&t=="4999"){if(!i&&(nt(a,r+1,0),a.times(a).times(a).eq(u))){n=a;break}o+=4,i=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(nt(n,r+1,1),e=!n.times(n).times(n).eq(u));break}return ct=!0,nt(n,r,c.rounding,e)};ze.decimalPlaces=ze.dp=function(){var r,e=this.d,t=NaN;if(e){if(r=e.length-1,t=(r-Vn(this.e/it))*it,r=e[r],r)for(;r%10==0;r/=10)t--;t<0&&(t=0)}return t};ze.dividedBy=ze.div=function(r){return Dt(this,new this.constructor(r))};ze.dividedToIntegerBy=ze.divToInt=function(r){var e=this,t=e.constructor;return nt(Dt(e,new t(r),0,1,1),t.precision,t.rounding)};ze.equals=ze.eq=function(r){return this.cmp(r)===0};ze.floor=function(){return nt(new this.constructor(this),this.e+1,3)};ze.greaterThan=ze.gt=function(r){return this.cmp(r)>0};ze.greaterThanOrEqualTo=ze.gte=function(r){var e=this.cmp(r);return e==1||e===0};ze.hyperbolicCosine=ze.cosh=function(){var r,e,t,n,i,s=this,o=s.constructor,a=new o(1);if(!s.isFinite())return new o(s.s?1/0:NaN);if(s.isZero())return a;t=o.precision,n=o.rounding,o.precision=t+Math.max(s.e,s.sd())+4,o.rounding=1,i=s.d.length,i<32?(r=Math.ceil(i/3),e=(1/If(4,r)).toString()):(r=16,e="2.3283064365386962890625e-10"),s=ll(o,1,s.times(e),new o(1),!0);for(var l,h=r,u=new o(8);h--;)l=s.times(s),s=a.minus(l.times(u.minus(l.times(u))));return nt(s,o.precision=t,o.rounding=n,!0)};ze.hyperbolicSine=ze.sinh=function(){var r,e,t,n,i=this,s=i.constructor;if(!i.isFinite()||i.isZero())return new s(i);if(e=s.precision,t=s.rounding,s.precision=e+Math.max(i.e,i.sd())+4,s.rounding=1,n=i.d.length,n<3)i=ll(s,2,i,i,!0);else{r=1.4*Math.sqrt(n),r=r>16?16:r|0,i=i.times(1/If(5,r)),i=ll(s,2,i,i,!0);for(var o,a=new s(5),l=new s(16),h=new s(20);r--;)o=i.times(i),i=i.times(a.plus(o.times(l.times(o).plus(h))))}return s.precision=e,s.rounding=t,nt(i,e,t,!0)};ze.hyperbolicTangent=ze.tanh=function(){var r,e,t=this,n=t.constructor;return t.isFinite()?t.isZero()?new n(t):(r=n.precision,e=n.rounding,n.precision=r+7,n.rounding=1,Dt(t.sinh(),t.cosh(),n.precision=r,n.rounding=e)):new n(t.s)};ze.inverseCosine=ze.acos=function(){var r,e=this,t=e.constructor,n=e.abs().cmp(1),i=t.precision,s=t.rounding;return n!==-1?n===0?e.isNeg()?Xr(t,i,s):new t(0):new t(NaN):e.isZero()?Xr(t,i+4,s).times(.5):(t.precision=i+6,t.rounding=1,e=e.asin(),r=Xr(t,i+4,s).times(.5),t.precision=i,t.rounding=s,r.minus(e))};ze.inverseHyperbolicCosine=ze.acosh=function(){var r,e,t=this,n=t.constructor;return t.lte(1)?new n(t.eq(1)?0:NaN):t.isFinite()?(r=n.precision,e=n.rounding,n.precision=r+Math.max(Math.abs(t.e),t.sd())+4,n.rounding=1,ct=!1,t=t.times(t).minus(1).sqrt().plus(t),ct=!0,n.precision=r,n.rounding=e,t.ln()):new n(t)};ze.inverseHyperbolicSine=ze.asinh=function(){var r,e,t=this,n=t.constructor;return!t.isFinite()||t.isZero()?new n(t):(r=n.precision,e=n.rounding,n.precision=r+2*Math.max(Math.abs(t.e),t.sd())+6,n.rounding=1,ct=!1,t=t.times(t).plus(1).sqrt().plus(t),ct=!0,n.precision=r,n.rounding=e,t.ln())};ze.inverseHyperbolicTangent=ze.atanh=function(){var r,e,t,n,i=this,s=i.constructor;return i.isFinite()?i.e>=0?new s(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(r=s.precision,e=s.rounding,n=i.sd(),Math.max(n,r)<2*-i.e-1?nt(new s(i),r,e,!0):(s.precision=t=n-i.e,i=Dt(i.plus(1),new s(1).minus(i),t+r,1),s.precision=r+4,s.rounding=1,i=i.ln(),s.precision=r,s.rounding=e,i.times(.5))):new s(NaN)};ze.inverseSine=ze.asin=function(){var r,e,t,n,i=this,s=i.constructor;return i.isZero()?new s(i):(e=i.abs().cmp(1),t=s.precision,n=s.rounding,e!==-1?e===0?(r=Xr(s,t+4,n).times(.5),r.s=i.s,r):new s(NaN):(s.precision=t+6,s.rounding=1,i=i.div(new s(1).minus(i.times(i)).sqrt().plus(1)).atan(),s.precision=t,s.rounding=n,i.times(2)))};ze.inverseTangent=ze.atan=function(){var r,e,t,n,i,s,o,a,l,h=this,u=h.constructor,c=u.precision,f=u.rounding;if(h.isFinite()){if(h.isZero())return new u(h);if(h.abs().eq(1)&&c+4<=Dg)return o=Xr(u,c+4,f).times(.25),o.s=h.s,o}else{if(!h.s)return new u(NaN);if(c+4<=Dg)return o=Xr(u,c+4,f).times(.5),o.s=h.s,o}for(u.precision=a=c+10,u.rounding=1,t=Math.min(28,a/it+2|0),r=t;r;--r)h=h.div(h.times(h).plus(1).sqrt().plus(1));for(ct=!1,e=Math.ceil(a/it),n=1,l=h.times(h),o=new u(h),i=h;r!==-1;)if(i=i.times(l),s=o.minus(i.div(n+=2)),i=i.times(l),o=s.plus(i.div(n+=2)),o.d[e]!==void 0)for(r=e;o.d[r]===s.d[r]&&r--;);return t&&(o=o.times(2<<t-1)),ct=!0,nt(o,u.precision=c,u.rounding=f,!0)};ze.isFinite=function(){return!!this.d};ze.isInteger=ze.isInt=function(){return!!this.d&&Vn(this.e/it)>this.d.length-2};ze.isNaN=function(){return!this.s};ze.isNegative=ze.isNeg=function(){return this.s<0};ze.isPositive=ze.isPos=function(){return this.s>0};ze.isZero=function(){return!!this.d&&this.d[0]===0};ze.lessThan=ze.lt=function(r){return this.cmp(r)<0};ze.lessThanOrEqualTo=ze.lte=function(r){return this.cmp(r)<1};ze.logarithm=ze.log=function(r){var e,t,n,i,s,o,a,l,h=this,u=h.constructor,c=u.precision,f=u.rounding,d=5;if(r==null)r=new u(10),e=!0;else{if(r=new u(r),t=r.d,r.s<0||!t||!t[0]||r.eq(1))return new u(NaN);e=r.eq(10)}if(t=h.d,h.s<0||!t||!t[0]||h.eq(1))return new u(t&&!t[0]?-1/0:h.s!=1?NaN:t?0:1/0);if(e)if(t.length>1)s=!0;else{for(i=t[0];i%10==0;)i/=10;s=i!==1}if(ct=!1,a=c+d,o=Fs(h,a),n=e?Nf(u,a+10):Fs(r,a),l=Dt(o,n,a,1),Fc(l.d,i=c,f))do if(a+=10,o=Fs(h,a),n=e?Nf(u,a+10):Fs(r,a),l=Dt(o,n,a,1),!s){+On(l.d).slice(i+1,i+15)+1==1e14&&(l=nt(l,c+1,0));break}while(Fc(l.d,i+=10,f));return ct=!0,nt(l,c,f)};ze.minus=ze.sub=function(r){var e,t,n,i,s,o,a,l,h,u,c,f,d=this,p=d.constructor;if(r=new p(r),!d.d||!r.d)return!d.s||!r.s?r=new p(NaN):d.d?r.s=-r.s:r=new p(r.d||d.s!==r.s?d:NaN),r;if(d.s!=r.s)return r.s=-r.s,d.plus(r);if(h=d.d,f=r.d,a=p.precision,l=p.rounding,!h[0]||!f[0]){if(f[0])r.s=-r.s;else if(h[0])r=new p(d);else return new p(l===3?-0:0);return ct?nt(r,a,l):r}if(t=Vn(r.e/it),u=Vn(d.e/it),h=h.slice(),s=u-t,s){for(c=s<0,c?(e=h,s=-s,o=f.length):(e=f,t=u,o=h.length),n=Math.max(Math.ceil(a/it),o)+2,s>n&&(s=n,e.length=1),e.reverse(),n=s;n--;)e.push(0);e.reverse()}else{for(n=h.length,o=f.length,c=n<o,c&&(o=n),n=0;n<o;n++)if(h[n]!=f[n]){c=h[n]<f[n];break}s=0}for(c&&(e=h,h=f,f=e,r.s=-r.s),o=h.length,n=f.length-o;n>0;--n)h[o++]=0;for(n=f.length;n>s;){if(h[--n]<f[n]){for(i=n;i&&h[--i]===0;)h[i]=Yr-1;--h[i],h[n]+=Yr}h[n]-=f[n]}for(;h[--o]===0;)h.pop();for(;h[0]===0;h.shift())--t;return h[0]?(r.d=h,r.e=Rf(h,t),ct?nt(r,a,l):r):new p(l===3?-0:0)};ze.modulo=ze.mod=function(r){var e,t=this,n=t.constructor;return r=new n(r),!t.d||!r.s||r.d&&!r.d[0]?new n(NaN):!r.d||t.d&&!t.d[0]?nt(new n(t),n.precision,n.rounding):(ct=!1,n.modulo==9?(e=Dt(t,r.abs(),0,3,1),e.s*=r.s):e=Dt(t,r,0,n.modulo,1),e=e.times(r),ct=!0,t.minus(e))};ze.naturalExponential=ze.exp=function(){return Fg(this)};ze.naturalLogarithm=ze.ln=function(){return Fs(this)};ze.negated=ze.neg=function(){var r=new this.constructor(this);return r.s=-r.s,nt(r)};ze.plus=ze.add=function(r){var e,t,n,i,s,o,a,l,h,u,c=this,f=c.constructor;if(r=new f(r),!c.d||!r.d)return!c.s||!r.s?r=new f(NaN):c.d||(r=new f(r.d||c.s===r.s?c:NaN)),r;if(c.s!=r.s)return r.s=-r.s,c.minus(r);if(h=c.d,u=r.d,a=f.precision,l=f.rounding,!h[0]||!u[0])return u[0]||(r=new f(c)),ct?nt(r,a,l):r;if(s=Vn(c.e/it),n=Vn(r.e/it),h=h.slice(),i=s-n,i){for(i<0?(t=h,i=-i,o=u.length):(t=u,n=s,o=h.length),s=Math.ceil(a/it),o=s>o?s+1:o+1,i>o&&(i=o,t.length=1),t.reverse();i--;)t.push(0);t.reverse()}for(o=h.length,i=u.length,o-i<0&&(i=o,t=u,u=h,h=t),e=0;i;)e=(h[--i]=h[i]+u[i]+e)/Yr|0,h[i]%=Yr;for(e&&(h.unshift(e),++n),o=h.length;h[--o]==0;)h.pop();return r.d=h,r.e=Rf(h,n),ct?nt(r,a,l):r};ze.precision=ze.sd=function(r){var e,t=this;if(r!==void 0&&r!==!!r&&r!==1&&r!==0)throw Error(Bo+r);return t.d?(e=LM(t.d),r&&t.e+1>e&&(e=t.e+1)):e=NaN,e};ze.round=function(){var r=this,e=r.constructor;return nt(new e(r),r.e+1,e.rounding)};ze.sine=ze.sin=function(){var r,e,t=this,n=t.constructor;return t.isFinite()?t.isZero()?new n(t):(r=n.precision,e=n.rounding,n.precision=r+Math.max(t.e,t.sd())+it,n.rounding=1,t=XD(n,HM(n,t)),n.precision=r,n.rounding=e,nt(ji>2?t.neg():t,r,e,!0)):new n(NaN)};ze.squareRoot=ze.sqrt=function(){var r,e,t,n,i,s,o=this,a=o.d,l=o.e,h=o.s,u=o.constructor;if(h!==1||!a||!a[0])return new u(!h||h<0&&(!a||a[0])?NaN:a?o:1/0);for(ct=!1,h=Math.sqrt(+o),h==0||h==1/0?(e=On(a),(e.length+l)%2==0&&(e+="0"),h=Math.sqrt(e),l=Vn((l+1)/2)-(l<0||l%2),h==1/0?e="5e"+l:(e=h.toExponential(),e=e.slice(0,e.indexOf("e")+1)+l),n=new u(e)):n=new u(h.toString()),t=(l=u.precision)+3;;)if(s=n,n=s.plus(Dt(o,s,t+2,1)).times(.5),On(s.d).slice(0,t)===(e=On(n.d)).slice(0,t))if(e=e.slice(t-3,t+1),e=="9999"||!i&&e=="4999"){if(!i&&(nt(s,l+1,0),s.times(s).eq(o))){n=s;break}t+=4,i=1}else{(!+e||!+e.slice(1)&&e.charAt(0)=="5")&&(nt(n,l+1,1),r=!n.times(n).eq(o));break}return ct=!0,nt(n,l,u.rounding,r)};ze.tangent=ze.tan=function(){var r,e,t=this,n=t.constructor;return t.isFinite()?t.isZero()?new n(t):(r=n.precision,e=n.rounding,n.precision=r+10,n.rounding=1,t=t.sin(),t.s=1,t=Dt(t,new n(1).minus(t.times(t)).sqrt(),r+10,0),n.precision=r,n.rounding=e,nt(ji==2||ji==4?t.neg():t,r,e,!0)):new n(NaN)};ze.times=ze.mul=function(r){var e,t,n,i,s,o,a,l,h,u=this,c=u.constructor,f=u.d,d=(r=new c(r)).d;if(r.s*=u.s,!f||!f[0]||!d||!d[0])return new c(!r.s||f&&!f[0]&&!d||d&&!d[0]&&!f?NaN:!f||!d?r.s/0:r.s*0);for(t=Vn(u.e/it)+Vn(r.e/it),l=f.length,h=d.length,l<h&&(s=f,f=d,d=s,o=l,l=h,h=o),s=[],o=l+h,n=o;n--;)s.push(0);for(n=h;--n>=0;){for(e=0,i=l+n;i>n;)a=s[i]+d[n]*f[i-n-1]+e,s[i--]=a%Yr|0,e=a/Yr|0;s[i]=(s[i]+e)%Yr|0}for(;!s[--o];)s.pop();return e?++t:s.shift(),r.d=s,r.e=Rf(s,t),ct?nt(r,c.precision,c.rounding):r};ze.toBinary=function(r,e){return Og(this,2,r,e)};ze.toDecimalPlaces=ze.toDP=function(r,e){var t=this,n=t.constructor;return t=new n(t),r===void 0?t:(ar(r,0,Ls),e===void 0?e=n.rounding:ar(e,0,8),nt(t,r+t.e+1,e))};ze.toExponential=function(r,e){var t,n=this,i=n.constructor;return r===void 0?t=yi(n,!0):(ar(r,0,Ls),e===void 0?e=i.rounding:ar(e,0,8),n=nt(new i(n),r+1,e),t=yi(n,!0,r+1)),n.isNeg()&&!n.isZero()?"-"+t:t};ze.toFixed=function(r,e){var t,n,i=this,s=i.constructor;return r===void 0?t=yi(i):(ar(r,0,Ls),e===void 0?e=s.rounding:ar(e,0,8),n=nt(new s(i),r+i.e+1,e),t=yi(n,!1,r+n.e+1)),i.isNeg()&&!i.isZero()?"-"+t:t};ze.toFraction=function(r){var e,t,n,i,s,o,a,l,h,u,c,f,d=this,p=d.d,m=d.constructor;if(!p)return new m(d);if(h=t=new m(1),n=l=new m(0),e=new m(n),s=e.e=LM(p)-d.e-1,o=s%it,e.d[0]=xn(10,o<0?it+o:o),r==null)r=s>0?e:h;else{if(a=new m(r),!a.isInt()||a.lt(h))throw Error(Bo+a);r=a.gt(e)?s>0?e:h:a}for(ct=!1,a=new m(On(p)),u=m.precision,m.precision=s=p.length*it*2;c=Dt(a,e,0,1,1),i=t.plus(c.times(n)),i.cmp(r)!=1;)t=n,n=i,i=h,h=l.plus(c.times(i)),l=i,i=e,e=a.minus(c.times(i)),a=i;return i=Dt(r.minus(t),n,0,1,1),l=l.plus(i.times(h)),t=t.plus(i.times(n)),l.s=h.s=d.s,f=Dt(h,n,s,1).minus(d).abs().cmp(Dt(l,t,s,1).minus(d).abs())<1?[h,n]:[l,t],m.precision=u,ct=!0,f};ze.toHexadecimal=ze.toHex=function(r,e){return Og(this,16,r,e)};ze.toNearest=function(r,e){var t=this,n=t.constructor;if(t=new n(t),r==null){if(!t.d)return t;r=new n(1),e=n.rounding}else{if(r=new n(r),e===void 0?e=n.rounding:ar(e,0,8),!t.d)return r.s?t:r;if(!r.d)return r.s&&(r.s=t.s),r}return r.d[0]?(ct=!1,t=Dt(t,r,0,e,1).times(r),ct=!0,nt(t)):(r.s=t.s,t=r),t};ze.toNumber=function(){return+this};ze.toOctal=function(r,e){return Og(this,8,r,e)};ze.toPower=ze.pow=function(r){var e,t,n,i,s,o,a=this,l=a.constructor,h=+(r=new l(r));if(!a.d||!r.d||!a.d[0]||!r.d[0])return new l(xn(+a,h));if(a=new l(a),a.eq(1))return a;if(n=l.precision,s=l.rounding,r.eq(1))return nt(a,n,s);if(e=Vn(r.e/it),e>=r.d.length-1&&(t=h<0?-h:h)<=VD)return i=DM(l,a,t,n),r.s<0?new l(1).div(i):nt(i,n,s);if(o=a.s,o<0){if(e<r.d.length-1)return new l(NaN);if((r.d[e]&1)==0&&(o=1),a.e==0&&a.d[0]==1&&a.d.length==1)return a.s=o,a}return t=xn(+a,h),e=t==0||!isFinite(t)?Vn(h*(Math.log("0."+On(a.d))/Math.LN10+a.e+1)):new l(t+"").e,e>l.maxE+1||e<l.minE-1?new l(e>0?o/0:0):(ct=!1,l.rounding=a.s=1,t=Math.min(12,(e+"").length),i=Fg(r.times(Fs(a,n+t)),n),i.d&&(i=nt(i,n+5,1),Fc(i.d,n,s)&&(e=n+10,i=nt(Fg(r.times(Fs(a,e+t)),e),e+5,1),+On(i.d).slice(n+1,n+15)+1==1e14&&(i=nt(i,n+1,0)))),i.s=o,ct=!0,l.rounding=s,nt(i,n,s))};ze.toPrecision=function(r,e){var t,n=this,i=n.constructor;return r===void 0?t=yi(n,n.e<=i.toExpNeg||n.e>=i.toExpPos):(ar(r,1,Ls),e===void 0?e=i.rounding:ar(e,0,8),n=nt(new i(n),r,e),t=yi(n,r<=n.e||n.e<=i.toExpNeg,r)),n.isNeg()&&!n.isZero()?"-"+t:t};ze.toSignificantDigits=ze.toSD=function(r,e){var t=this,n=t.constructor;return r===void 0?(r=n.precision,e=n.rounding):(ar(r,1,Ls),e===void 0?e=n.rounding:ar(e,0,8)),nt(new n(t),r,e)};ze.toString=function(){var r=this,e=r.constructor,t=yi(r,r.e<=e.toExpNeg||r.e>=e.toExpPos);return r.isNeg()&&!r.isZero()?"-"+t:t};ze.truncated=ze.trunc=function(){return nt(new this.constructor(this),this.e+1,1)};ze.valueOf=ze.toJSON=function(){var r=this,e=r.constructor,t=yi(r,r.e<=e.toExpNeg||r.e>=e.toExpPos);return r.isNeg()?"-"+t:t};function On(r){var e,t,n,i=r.length-1,s="",o=r[0];if(i>0){for(s+=o,e=1;e<i;e++)n=r[e]+"",t=it-n.length,t&&(s+=Ds(t)),s+=n;o=r[e],n=o+"",t=it-n.length,t&&(s+=Ds(t))}else if(o===0)return"0";for(;o%10==0;)o/=10;return s+o}function ar(r,e,t){if(r!==~~r||r<e||r>t)throw Error(Bo+r)}function Fc(r,e,t,n){var i,s,o,a;for(s=r[0];s>=10;s/=10)--e;return--e<0?(e+=it,i=0):(i=Math.ceil((e+1)/it),e%=it),s=xn(10,it-e),a=r[i]%s|0,n==null?e<3?(e==0?a=a/100|0:e==1&&(a=a/10|0),o=t<4&&a==99999||t>3&&a==49999||a==5e4||a==0):o=(t<4&&a+1==s||t>3&&a+1==s/2)&&(r[i+1]/s/100|0)==xn(10,e-2)-1||(a==s/2||a==0)&&(r[i+1]/s/100|0)==0:e<4?(e==0?a=a/1e3|0:e==1?a=a/100|0:e==2&&(a=a/10|0),o=(n||t<4)&&a==9999||!n&&t>3&&a==4999):o=((n||t<4)&&a+1==s||!n&&t>3&&a+1==s/2)&&(r[i+1]/s/1e3|0)==xn(10,e-3)-1,o}function Cf(r,e,t){for(var n,i=[0],s,o=0,a=r.length;o<a;){for(s=i.length;s--;)i[s]*=e;for(i[0]+=Bg.indexOf(r.charAt(o++)),n=0;n<i.length;n++)i[n]>t-1&&(i[n+1]===void 0&&(i[n+1]=0),i[n+1]+=i[n]/t|0,i[n]%=t)}return i.reverse()}function qD(r,e){var t,n,i=e.d.length;i<32?(t=Math.ceil(i/3),n=(1/If(4,t)).toString()):(t=16,n="2.3283064365386962890625e-10"),r.precision+=t,e=ll(r,1,e.times(n),new r(1));for(var s=t;s--;){var o=e.times(e);e=o.times(o).minus(o).times(8).plus(1)}return r.precision-=t,e}var Dt=function(){function r(n,i,s){var o,a=0,l=n.length;for(n=n.slice();l--;)o=n[l]*i+a,n[l]=o%s|0,a=o/s|0;return a&&n.unshift(a),n}function e(n,i,s,o){var a,l;if(s!=o)l=s>o?1:-1;else for(a=l=0;a<s;a++)if(n[a]!=i[a]){l=n[a]>i[a]?1:-1;break}return l}function t(n,i,s,o){for(var a=0;s--;)n[s]-=a,a=n[s]<i[s]?1:0,n[s]=a*o+n[s]-i[s];for(;!n[0]&&n.length>1;)n.shift()}return function(n,i,s,o,a,l){var h,u,c,f,d,p,m,y,g,v,x,w,b,M,A,E,N,R,_,S,L=n.constructor,k=n.s==i.s?1:-1,H=n.d,O=i.d;if(!H||!H[0]||!O||!O[0])return new L(!n.s||!i.s||(H?O&&H[0]==O[0]:!O)?NaN:H&&H[0]==0||!O?k*0:k/0);for(l?(d=1,u=n.e-i.e):(l=Yr,d=it,u=Vn(n.e/d)-Vn(i.e/d)),_=O.length,N=H.length,g=new L(k),v=g.d=[],c=0;O[c]==(H[c]||0);c++);if(O[c]>(H[c]||0)&&u--,s==null?(M=s=L.precision,o=L.rounding):a?M=s+(n.e-i.e)+1:M=s,M<0)v.push(1),p=!0;else{if(M=M/d+2|0,c=0,_==1){for(f=0,O=O[0],M++;(c<N||f)&&M--;c++)A=f*l+(H[c]||0),v[c]=A/O|0,f=A%O|0;p=f||c<N}else{for(f=l/(O[0]+1)|0,f>1&&(O=r(O,f,l),H=r(H,f,l),_=O.length,N=H.length),E=_,x=H.slice(0,_),w=x.length;w<_;)x[w++]=0;S=O.slice(),S.unshift(0),R=O[0],O[1]>=l/2&&++R;do f=0,h=e(O,x,_,w),h<0?(b=x[0],_!=w&&(b=b*l+(x[1]||0)),f=b/R|0,f>1?(f>=l&&(f=l-1),m=r(O,f,l),y=m.length,w=x.length,h=e(m,x,y,w),h==1&&(f--,t(m,_<y?S:O,y,l))):(f==0&&(h=f=1),m=O.slice()),y=m.length,y<w&&m.unshift(0),t(x,m,w,l),h==-1&&(w=x.length,h=e(O,x,_,w),h<1&&(f++,t(x,_<w?S:O,w,l))),w=x.length):h===0&&(f++,x=[0]),v[c++]=f,h&&x[0]?x[w++]=H[E]||0:(x=[H[E]],w=1);while((E++<N||x[0]!==void 0)&&M--);p=x[0]!==void 0}v[0]||v.shift()}if(d==1)g.e=u,IM=p;else{for(c=1,f=v[0];f>=10;f/=10)c++;g.e=c+u*d-1,nt(g,a?s+g.e+1:s,o,p)}return g}}();function nt(r,e,t,n){var i,s,o,a,l,h,u,c,f,d=r.constructor;e:if(e!=null){if(c=r.d,!c)return r;for(i=1,a=c[0];a>=10;a/=10)i++;if(s=e-i,s<0)s+=it,o=e,u=c[f=0],l=u/xn(10,i-o-1)%10|0;else if(f=Math.ceil((s+1)/it),a=c.length,f>=a)if(n){for(;a++<=f;)c.push(0);u=l=0,i=1,s%=it,o=s-it+1}else break e;else{for(u=a=c[f],i=1;a>=10;a/=10)i++;s%=it,o=s-it+i,l=o<0?0:u/xn(10,i-o-1)%10|0}if(n=n||e<0||c[f+1]!==void 0||(o<0?u:u%xn(10,i-o-1)),h=t<4?(l||n)&&(t==0||t==(r.s<0?3:2)):l>5||l==5&&(t==4||n||t==6&&(s>0?o>0?u/xn(10,i-o):0:c[f-1])%10&1||t==(r.s<0?8:7)),e<1||!c[0])return c.length=0,h?(e-=r.e+1,c[0]=xn(10,(it-e%it)%it),r.e=-e||0):c[0]=r.e=0,r;if(s==0?(c.length=f,a=1,f--):(c.length=f+1,a=xn(10,it-s),c[f]=o>0?(u/xn(10,i-o)%xn(10,o)|0)*a:0),h)for(;;)if(f==0){for(s=1,o=c[0];o>=10;o/=10)s++;for(o=c[0]+=a,a=1;o>=10;o/=10)a++;s!=a&&(r.e++,c[0]==Yr&&(c[0]=1));break}else{if(c[f]+=a,c[f]!=Yr)break;c[f--]=0,a=1}for(s=c.length;c[--s]===0;)c.pop()}return ct&&(r.e>d.maxE?(r.d=null,r.e=NaN):r.e<d.minE&&(r.e=0,r.d=[0])),r}function yi(r,e,t){if(!r.isFinite())return zM(r);var n,i=r.e,s=On(r.d),o=s.length;return e?(t&&(n=t-o)>0?s=s.charAt(0)+"."+s.slice(1)+Ds(n):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(r.e<0?"e":"e+")+r.e):i<0?(s="0."+Ds(-i-1)+s,t&&(n=t-o)>0&&(s+=Ds(n))):i>=o?(s+=Ds(i+1-o),t&&(n=t-i-1)>0&&(s=s+"."+Ds(n))):((n=i+1)<o&&(s=s.slice(0,n)+"."+s.slice(n)),t&&(n=t-o)>0&&(i+1===o&&(s+="."),s+=Ds(n))),s}function Rf(r,e){var t=r[0];for(e*=it;t>=10;t/=10)e++;return e}function Nf(r,e,t){if(e>WD)throw ct=!0,t&&(r.precision=t),Error(PM);return nt(new r(Ef),e,1,!0)}function Xr(r,e,t){if(e>Dg)throw Error(PM);return nt(new r(_f),e,t,!0)}function LM(r){var e=r.length-1,t=e*it+1;if(e=r[e],e){for(;e%10==0;e/=10)t--;for(e=r[0];e>=10;e/=10)t++}return t}function Ds(r){for(var e="";r--;)e+="0";return e}function DM(r,e,t,n){var i,s=new r(1),o=Math.ceil(n/it+4);for(ct=!1;;){if(t%2&&(s=s.times(e),GM(s.d,o)&&(i=!0)),t=Vn(t/2),t===0){t=s.d.length-1,i&&s.d[t]===0&&++s.d[t];break}e=e.times(e),GM(e.d,o)}return ct=!0,s}function FM(r){return r.d[r.d.length-1]&1}function OM(r,e,t){for(var n,i=new r(e[0]),s=0;++s<e.length;)if(n=new r(e[s]),n.s)i[t](n)&&(i=n);else{i=n;break}return i}function Fg(r,e){var t,n,i,s,o,a,l,h=0,u=0,c=0,f=r.constructor,d=f.rounding,p=f.precision;if(!r.d||!r.d[0]||r.e>17)return new f(r.d?r.d[0]?r.s<0?0:1/0:1:r.s?r.s<0?0:r:0/0);for(e==null?(ct=!1,l=p):l=e,a=new f(.03125);r.e>-2;)r=r.times(a),c+=5;for(n=Math.log(xn(2,c))/Math.LN10*2+5|0,l+=n,t=s=o=new f(1),f.precision=l;;){if(s=nt(s.times(r),l,1),t=t.times(++u),a=o.plus(Dt(s,t,l,1)),On(a.d).slice(0,l)===On(o.d).slice(0,l)){for(i=c;i--;)o=nt(o.times(o),l,1);if(e==null)if(h<3&&Fc(o.d,l-n,d,h))f.precision=l+=10,t=s=a=new f(1),u=0,h++;else return nt(o,f.precision=p,d,ct=!0);else return f.precision=p,o}o=a}}function Fs(r,e){var t,n,i,s,o,a,l,h,u,c,f,d=1,p=10,m=r,y=m.d,g=m.constructor,v=g.rounding,x=g.precision;if(m.s<0||!y||!y[0]||!m.e&&y[0]==1&&y.length==1)return new g(y&&!y[0]?-1/0:m.s!=1?NaN:y?0:m);if(e==null?(ct=!1,u=x):u=e,g.precision=u+=p,t=On(y),n=t.charAt(0),Math.abs(s=m.e)<15e14){for(;n<7&&n!=1||n==1&&t.charAt(1)>3;)m=m.times(r),t=On(m.d),n=t.charAt(0),d++;s=m.e,n>1?(m=new g("0."+t),s++):m=new g(n+"."+t.slice(1))}else return h=Nf(g,u+2,x).times(s+""),m=Fs(new g(n+"."+t.slice(1)),u-p).plus(h),g.precision=x,e==null?nt(m,x,v,ct=!0):m;for(c=m,l=o=m=Dt(m.minus(1),m.plus(1),u,1),f=nt(m.times(m),u,1),i=3;;){if(o=nt(o.times(f),u,1),h=l.plus(Dt(o,new g(i),u,1)),On(h.d).slice(0,u)===On(l.d).slice(0,u))if(l=l.times(2),s!==0&&(l=l.plus(Nf(g,u+2,x).times(s+""))),l=Dt(l,new g(d),u,1),e==null)if(Fc(l.d,u-p,v,a))g.precision=u+=p,h=o=m=Dt(c.minus(1),c.plus(1),u,1),f=nt(m.times(m),u,1),i=a=1;else return nt(l,g.precision=x,v,ct=!0);else return g.precision=x,l;l=h,i+=2}}function zM(r){return String(r.s*r.s/0)}function UM(r,e){var t,n,i;for((t=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(t<0&&(t=n),t+=+e.slice(n+1),e=e.substring(0,n)):t<0&&(t=e.length),n=0;e.charCodeAt(n)===48;n++);for(i=e.length;e.charCodeAt(i-1)===48;--i);if(e=e.slice(n,i),e){if(i-=n,r.e=t=t-n-1,r.d=[],n=(t+1)%it,t<0&&(n+=it),n<i){for(n&&r.d.push(+e.slice(0,n)),i-=it;n<i;)r.d.push(+e.slice(n,n+=it));e=e.slice(n),n=it-e.length}else n-=i;for(;n--;)e+="0";r.d.push(+e),ct&&(r.e>r.constructor.maxE?(r.d=null,r.e=NaN):r.e<r.constructor.minE&&(r.e=0,r.d=[0]))}else r.e=0,r.d=[0];return r}function YD(r,e){var t,n,i,s,o,a,l,h,u;if(e==="Infinity"||e==="NaN")return+e||(r.s=NaN),r.e=NaN,r.d=null,r;if(HD.test(e))t=16,e=e.toLowerCase();else if(UD.test(e))t=2;else if(GD.test(e))t=8;else throw Error(Bo+e);for(s=e.search(/p/i),s>0?(l=+e.slice(s+1),e=e.substring(2,s)):e=e.slice(2),s=e.indexOf("."),o=s>=0,n=r.constructor,o&&(e=e.replace(".",""),a=e.length,s=a-s,i=DM(n,new n(t),s,s*2)),h=Cf(e,t,Yr),u=h.length-1,s=u;h[s]===0;--s)h.pop();return s<0?new n(r.s*0):(r.e=Rf(h,u),r.d=h,ct=!1,o&&(r=Dt(r,i,a*4)),l&&(r=r.times(Math.abs(l)<54?xn(2,l):Lo.pow(2,l))),ct=!0,r)}function XD(r,e){var t,n=e.d.length;if(n<3)return ll(r,2,e,e);t=1.4*Math.sqrt(n),t=t>16?16:t|0,e=e.times(1/If(5,t)),e=ll(r,2,e,e);for(var i,s=new r(5),o=new r(16),a=new r(20);t--;)i=e.times(e),e=e.times(s.plus(i.times(o.times(i).minus(a))));return e}function ll(r,e,t,n,i){var s,o,a,l,h=r.precision,u=Math.ceil(h/it);for(ct=!1,l=t.times(t),a=new r(n);;){if(o=Dt(a.times(l),new r(e++*e++),h,1),a=i?n.plus(o):n.minus(o),n=Dt(o.times(l),new r(e++*e++),h,1),o=a.plus(n),o.d[u]!==void 0){for(s=u;o.d[s]===a.d[s]&&s--;);if(s==-1)break}s=a,a=n,n=o,o=s}return ct=!0,o.d.length=u+1,o}function If(r,e){for(var t=r;--e;)t*=r;return t}function HM(r,e){var t,n=e.s<0,i=Xr(r,r.precision,1),s=i.times(.5);if(e=e.abs(),e.lte(s))return ji=n?4:1,e;if(t=e.divToInt(i),t.isZero())ji=n?3:2;else{if(e=e.minus(t.times(i)),e.lte(s))return ji=FM(t)?n?2:3:n?4:1,e;ji=FM(t)?n?1:4:n?3:2}return e.minus(i).abs()}function Og(r,e,t,n){var i,s,o,a,l,h,u,c,f,d=r.constructor,p=t!==void 0;if(p?(ar(t,1,Ls),n===void 0?n=d.rounding:ar(n,0,8)):(t=d.precision,n=d.rounding),!r.isFinite())u=zM(r);else{for(u=yi(r),o=u.indexOf("."),p?(i=2,e==16?t=t*4-3:e==8&&(t=t*3-2)):i=e,o>=0&&(u=u.replace(".",""),f=new d(1),f.e=u.length-o,f.d=Cf(yi(f),10,i),f.e=f.d.length),c=Cf(u,10,i),s=l=c.length;c[--l]==0;)c.pop();if(!c[0])u=p?"0p+0":"0";else{if(o<0?s--:(r=new d(r),r.d=c,r.e=s,r=Dt(r,f,t,n,0,i),c=r.d,s=r.e,h=IM),o=c[t],a=i/2,h=h||c[t+1]!==void 0,h=n<4?(o!==void 0||h)&&(n===0||n===(r.s<0?3:2)):o>a||o===a&&(n===4||h||n===6&&c[t-1]&1||n===(r.s<0?8:7)),c.length=t,h)for(;++c[--t]>i-1;)c[t]=0,t||(++s,c.unshift(1));for(l=c.length;!c[l-1];--l);for(o=0,u="";o<l;o++)u+=Bg.charAt(c[o]);if(p){if(l>1)if(e==16||e==8){for(o=e==16?4:3,--l;l%o;l++)u+="0";for(c=Cf(u,i,e),l=c.length;!c[l-1];--l);for(o=1,u="1.";o<l;o++)u+=Bg.charAt(c[o])}else u=u.charAt(0)+"."+u.slice(1);u=u+(s<0?"p":"p+")+s}else if(s<0){for(;++s;)u="0"+u;u="0."+u}else if(++s>l)for(s-=l;s--;)u+="0";else s<l&&(u=u.slice(0,s)+"."+u.slice(s))}u=(e==16?"0x":e==2?"0b":e==8?"0o":"")+u}return r.s<0?"-"+u:u}function GM(r,e){if(r.length>e)return r.length=e,!0}function QD(r){return new this(r).abs()}function jD(r){return new this(r).acos()}function ZD(r){return new this(r).acosh()}function JD(r,e){return new this(r).plus(e)}function KD(r){return new this(r).asin()}function $D(r){return new this(r).asinh()}function eF(r){return new this(r).atan()}function tF(r){return new this(r).atanh()}function nF(r,e){r=new this(r),e=new this(e);var t,n=this.precision,i=this.rounding,s=n+4;return!r.s||!e.s?t=new this(NaN):!r.d&&!e.d?(t=Xr(this,s,1).times(e.s>0?.25:.75),t.s=r.s):!e.d||r.isZero()?(t=e.s<0?Xr(this,n,i):new this(0),t.s=r.s):!r.d||e.isZero()?(t=Xr(this,s,1).times(.5),t.s=r.s):e.s<0?(this.precision=s,this.rounding=1,t=this.atan(Dt(r,e,s,1)),e=Xr(this,s,1),this.precision=n,this.rounding=i,t=r.s<0?t.minus(e):t.plus(e)):t=this.atan(Dt(r,e,s,1)),t}function rF(r){return new this(r).cbrt()}function iF(r){return nt(r=new this(r),r.e+1,2)}function sF(r){if(!r||typeof r!="object")throw Error(Tf+"Object expected");var e,t,n,i=r.defaults===!0,s=["precision",1,Ls,"rounding",0,8,"toExpNeg",-al,0,"toExpPos",0,al,"maxE",0,al,"minE",-al,0,"modulo",0,9];for(e=0;e<s.length;e+=3)if(t=s[e],i&&(this[t]=Lg[t]),(n=r[t])!==void 0)if(Vn(n)===n&&n>=s[e+1]&&n<=s[e+2])this[t]=n;else throw Error(Bo+t+": "+n);if(t="crypto",i&&(this[t]=Lg[t]),(n=r[t])!==void 0)if(n===!0||n===!1||n===0||n===1)if(n)if(typeof crypto!="undefined"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[t]=!0;else throw Error(BM);else this[t]=!1;else throw Error(Bo+t+": "+n);return this}function oF(r){return new this(r).cos()}function aF(r){return new this(r).cosh()}function kM(r){var e,t,n;function i(s){var o,a,l,h=this;if(!(h instanceof i))return new i(s);if(h.constructor=i,s instanceof i){h.s=s.s,ct?!s.d||s.e>i.maxE?(h.e=NaN,h.d=null):s.e<i.minE?(h.e=0,h.d=[0]):(h.e=s.e,h.d=s.d.slice()):(h.e=s.e,h.d=s.d?s.d.slice():s.d);return}if(l=typeof s,l==="number"){if(s===0){h.s=1/s<0?-1:1,h.e=0,h.d=[0];return}if(s<0?(s=-s,h.s=-1):h.s=1,s===~~s&&s<1e7){for(o=0,a=s;a>=10;a/=10)o++;ct?o>i.maxE?(h.e=NaN,h.d=null):o<i.minE?(h.e=0,h.d=[0]):(h.e=o,h.d=[s]):(h.e=o,h.d=[s]);return}else if(s*0!=0){s||(h.s=NaN),h.e=NaN,h.d=null;return}return UM(h,s.toString())}else if(l!=="string")throw Error(Bo+s);return(a=s.charCodeAt(0))===45?(s=s.slice(1),h.s=-1):(a===43&&(s=s.slice(1)),h.s=1),kD.test(s)?UM(h,s):YD(h,s)}if(i.prototype=ze,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=sF,i.clone=kM,i.isDecimal=fF,i.abs=QD,i.acos=jD,i.acosh=ZD,i.add=JD,i.asin=KD,i.asinh=$D,i.atan=eF,i.atanh=tF,i.atan2=nF,i.cbrt=rF,i.ceil=iF,i.cos=oF,i.cosh=aF,i.div=lF,i.exp=cF,i.floor=uF,i.hypot=hF,i.ln=dF,i.log=pF,i.log10=gF,i.log2=mF,i.max=vF,i.min=yF,i.mod=xF,i.mul=wF,i.pow=bF,i.random=MF,i.round=AF,i.sign=SF,i.sin=EF,i.sinh=_F,i.sqrt=TF,i.sub=CF,i.tan=RF,i.tanh=NF,i.trunc=IF,r===void 0&&(r={}),r&&r.defaults!==!0)for(n=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],e=0;e<n.length;)r.hasOwnProperty(t=n[e++])||(r[t]=this[t]);return i.config(r),i}function lF(r,e){return new this(r).div(e)}function cF(r){return new this(r).exp()}function uF(r){return nt(r=new this(r),r.e+1,3)}function hF(){var r,e,t=new this(0);for(ct=!1,r=0;r<arguments.length;)if(e=new this(arguments[r++]),e.d)t.d&&(t=t.plus(e.times(e)));else{if(e.s)return ct=!0,new this(1/0);t=e}return ct=!0,t.sqrt()}function fF(r){return r instanceof Lo||r&&r.name==="[object Decimal]"||!1}function dF(r){return new this(r).ln()}function pF(r,e){return new this(r).log(e)}function mF(r){return new this(r).log(2)}function gF(r){return new this(r).log(10)}function vF(){return OM(this,arguments,"lt")}function yF(){return OM(this,arguments,"gt")}function xF(r,e){return new this(r).mod(e)}function wF(r,e){return new this(r).mul(e)}function bF(r,e){return new this(r).pow(e)}function MF(r){var e,t,n,i,s=0,o=new this(1),a=[];if(r===void 0?r=this.precision:ar(r,1,Ls),n=Math.ceil(r/it),this.crypto)if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(n));s<n;)i=e[s],i>=429e7?e[s]=crypto.getRandomValues(new Uint32Array(1))[0]:a[s++]=i%1e7;else if(crypto.randomBytes){for(e=crypto.randomBytes(n*=4);s<n;)i=e[s]+(e[s+1]<<8)+(e[s+2]<<16)+((e[s+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(e,s):(a.push(i%1e7),s+=4);s=n/4}else throw Error(BM);else for(;s<n;)a[s++]=Math.random()*1e7|0;for(n=a[--s],r%=it,n&&r&&(i=xn(10,it-r),a[s]=(n/i|0)*i);a[s]===0;s--)a.pop();if(s<0)t=0,a=[0];else{for(t=-1;a[0]===0;t-=it)a.shift();for(n=1,i=a[0];i>=10;i/=10)n++;n<it&&(t-=it-n)}return o.e=t,o.d=a,o}function AF(r){return nt(r=new this(r),r.e+1,this.rounding)}function SF(r){return r=new this(r),r.d?r.d[0]?r.s:0*r.s:r.s||NaN}function EF(r){return new this(r).sin()}function _F(r){return new this(r).sinh()}function TF(r){return new this(r).sqrt()}function CF(r,e){return new this(r).sub(e)}function RF(r){return new this(r).tan()}function NF(r){return new this(r).tanh()}function IF(r){return nt(r=new this(r),r.e+1,1)}ze[Symbol.for("nodejs.util.inspect.custom")]=ze.toString;ze[Symbol.toStringTag]="Decimal";var Lo=kM(Lg);Ef=new Lo(Ef);_f=new Lo(_f);var PF="BigNumber",BF=["?on","config"],LF=ke(PF,BF,r=>{var{on:e,config:t}=r,n=9,i=Lo.clone({precision:t.precision,modulo:n});return i.prototype.type="BigNumber",i.prototype.isBigNumber=!0,i.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},i.fromJSON=function(s){return new i(s.value)},e&&e("config",function(s,o){s.precision!==o.precision&&i.config({precision:s.precision})}),i},{isClass:!0}),VM={exports:{}};/**
 * @license Complex.js v2.0.13 12/05/2020
 *
 * Copyright (c) 2020, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/(function(r,e){(function(t){var n=function(c){return(Math.exp(c)+Math.exp(-c))*.5},i=function(c){return(Math.exp(c)-Math.exp(-c))*.5},s=function(c){var f=Math.PI/4;if(c<-f||c>f)return Math.cos(c)-1;var d=c*c;return d*(-.5+d*(1/24+d*(-1/720+d*(1/40320+d*(-1/3628800+d*(1/4790014600+d*(-1/87178291200+d*(1/20922789888e3))))))))},o=function(c,f){var d=Math.abs(c),p=Math.abs(f);return d<3e3&&p<3e3?Math.sqrt(d*d+p*p):(d<p?(d=p,p=c/f):p=f/c,d*Math.sqrt(1+p*p))},a=function(){throw SyntaxError("Invalid Param")};function l(c,f){var d=Math.abs(c),p=Math.abs(f);return c===0?Math.log(p):f===0?Math.log(d):d<3e3&&p<3e3?Math.log(c*c+f*f)*.5:Math.log(c/Math.cos(Math.atan2(f,c)))}var h=function(c,f){var d={re:0,im:0};if(c==null)d.re=d.im=0;else if(f!==void 0)d.re=c,d.im=f;else switch(typeof c){case"object":if("im"in c&&"re"in c)d.re=c.re,d.im=c.im;else if("abs"in c&&"arg"in c){if(!Number.isFinite(c.abs)&&Number.isFinite(c.arg))return u.INFINITY;d.re=c.abs*Math.cos(c.arg),d.im=c.abs*Math.sin(c.arg)}else if("r"in c&&"phi"in c){if(!Number.isFinite(c.r)&&Number.isFinite(c.phi))return u.INFINITY;d.re=c.r*Math.cos(c.phi),d.im=c.r*Math.sin(c.phi)}else c.length===2?(d.re=c[0],d.im=c[1]):a();break;case"string":d.im=d.re=0;var p=c.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),m=1,y=0;p===null&&a();for(var g=0;g<p.length;g++){var v=p[g];v===" "||v==="	"||v===`
`||(v==="+"?m++:v==="-"?y++:v==="i"||v==="I"?(m+y===0&&a(),p[g+1]!==" "&&!isNaN(p[g+1])?(d.im+=parseFloat((y%2?"-":"")+p[g+1]),g++):d.im+=parseFloat((y%2?"-":"")+"1"),m=y=0):((m+y===0||isNaN(v))&&a(),p[g+1]==="i"||p[g+1]==="I"?(d.im+=parseFloat((y%2?"-":"")+v),g++):d.re+=parseFloat((y%2?"-":"")+v),m=y=0))}m+y>0&&a();break;case"number":d.im=0,d.re=c;break;default:a()}return isNaN(d.re)||isNaN(d.im),d};function u(c,f){if(!(this instanceof u))return new u(c,f);var d=h(c,f);this.re=d.re,this.im=d.im}u.prototype={re:0,im:0,sign:function(){var c=this.abs();return new u(this.re/c,this.im/c)},add:function(c,f){var d=new u(c,f);return this.isInfinite()&&d.isInfinite()?u.NAN:this.isInfinite()||d.isInfinite()?u.INFINITY:new u(this.re+d.re,this.im+d.im)},sub:function(c,f){var d=new u(c,f);return this.isInfinite()&&d.isInfinite()?u.NAN:this.isInfinite()||d.isInfinite()?u.INFINITY:new u(this.re-d.re,this.im-d.im)},mul:function(c,f){var d=new u(c,f);return this.isInfinite()&&d.isZero()||this.isZero()&&d.isInfinite()?u.NAN:this.isInfinite()||d.isInfinite()?u.INFINITY:d.im===0&&this.im===0?new u(this.re*d.re,0):new u(this.re*d.re-this.im*d.im,this.re*d.im+this.im*d.re)},div:function(c,f){var d=new u(c,f);if(this.isZero()&&d.isZero()||this.isInfinite()&&d.isInfinite())return u.NAN;if(this.isInfinite()||d.isZero())return u.INFINITY;if(this.isZero()||d.isInfinite())return u.ZERO;c=this.re,f=this.im;var p=d.re,m=d.im,y,g;return m===0?new u(c/p,f/p):Math.abs(p)<Math.abs(m)?(g=p/m,y=p*g+m,new u((c*g+f)/y,(f*g-c)/y)):(g=m/p,y=m*g+p,new u((c+f*g)/y,(f-c*g)/y))},pow:function(c,f){var d=new u(c,f);if(c=this.re,f=this.im,d.isZero())return u.ONE;if(d.im===0){if(f===0&&c>0)return new u(Math.pow(c,d.re),0);if(c===0)switch((d.re%4+4)%4){case 0:return new u(Math.pow(f,d.re),0);case 1:return new u(0,Math.pow(f,d.re));case 2:return new u(-Math.pow(f,d.re),0);case 3:return new u(0,-Math.pow(f,d.re))}}if(c===0&&f===0&&d.re>0&&d.im>=0)return u.ZERO;var p=Math.atan2(f,c),m=l(c,f);return c=Math.exp(d.re*m-d.im*p),f=d.im*m+d.re*p,new u(c*Math.cos(f),c*Math.sin(f))},sqrt:function(){var c=this.re,f=this.im,d=this.abs(),p,m;if(c>=0){if(f===0)return new u(Math.sqrt(c),0);p=.5*Math.sqrt(2*(d+c))}else p=Math.abs(f)/Math.sqrt(2*(d-c));return c<=0?m=.5*Math.sqrt(2*(d-c)):m=Math.abs(f)/Math.sqrt(2*(d+c)),new u(p,f<0?-m:m)},exp:function(){var c=Math.exp(this.re);return this.im===0,new u(c*Math.cos(this.im),c*Math.sin(this.im))},expm1:function(){var c=this.re,f=this.im;return new u(Math.expm1(c)*Math.cos(f)+s(f),Math.exp(c)*Math.sin(f))},log:function(){var c=this.re,f=this.im;return new u(l(c,f),Math.atan2(f,c))},abs:function(){return o(this.re,this.im)},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var c=this.re,f=this.im;return new u(Math.sin(c)*n(f),Math.cos(c)*i(f))},cos:function(){var c=this.re,f=this.im;return new u(Math.cos(c)*n(f),-Math.sin(c)*i(f))},tan:function(){var c=2*this.re,f=2*this.im,d=Math.cos(c)+n(f);return new u(Math.sin(c)/d,i(f)/d)},cot:function(){var c=2*this.re,f=2*this.im,d=Math.cos(c)-n(f);return new u(-Math.sin(c)/d,i(f)/d)},sec:function(){var c=this.re,f=this.im,d=.5*n(2*f)+.5*Math.cos(2*c);return new u(Math.cos(c)*n(f)/d,Math.sin(c)*i(f)/d)},csc:function(){var c=this.re,f=this.im,d=.5*n(2*f)-.5*Math.cos(2*c);return new u(Math.sin(c)*n(f)/d,-Math.cos(c)*i(f)/d)},asin:function(){var c=this.re,f=this.im,d=new u(f*f-c*c+1,-2*c*f).sqrt(),p=new u(d.re-f,d.im+c).log();return new u(p.im,-p.re)},acos:function(){var c=this.re,f=this.im,d=new u(f*f-c*c+1,-2*c*f).sqrt(),p=new u(d.re-f,d.im+c).log();return new u(Math.PI/2-p.im,p.re)},atan:function(){var c=this.re,f=this.im;if(c===0){if(f===1)return new u(0,1/0);if(f===-1)return new u(0,-1/0)}var d=c*c+(1-f)*(1-f),p=new u((1-f*f-c*c)/d,-2*c/d).log();return new u(-.5*p.im,.5*p.re)},acot:function(){var c=this.re,f=this.im;if(f===0)return new u(Math.atan2(1,c),0);var d=c*c+f*f;return d!==0?new u(c/d,-f/d).atan():new u(c!==0?c/0:0,f!==0?-f/0:0).atan()},asec:function(){var c=this.re,f=this.im;if(c===0&&f===0)return new u(0,1/0);var d=c*c+f*f;return d!==0?new u(c/d,-f/d).acos():new u(c!==0?c/0:0,f!==0?-f/0:0).acos()},acsc:function(){var c=this.re,f=this.im;if(c===0&&f===0)return new u(Math.PI/2,1/0);var d=c*c+f*f;return d!==0?new u(c/d,-f/d).asin():new u(c!==0?c/0:0,f!==0?-f/0:0).asin()},sinh:function(){var c=this.re,f=this.im;return new u(i(c)*Math.cos(f),n(c)*Math.sin(f))},cosh:function(){var c=this.re,f=this.im;return new u(n(c)*Math.cos(f),i(c)*Math.sin(f))},tanh:function(){var c=2*this.re,f=2*this.im,d=n(c)+Math.cos(f);return new u(i(c)/d,Math.sin(f)/d)},coth:function(){var c=2*this.re,f=2*this.im,d=n(c)-Math.cos(f);return new u(i(c)/d,-Math.sin(f)/d)},csch:function(){var c=this.re,f=this.im,d=Math.cos(2*f)-n(2*c);return new u(-2*i(c)*Math.cos(f)/d,2*n(c)*Math.sin(f)/d)},sech:function(){var c=this.re,f=this.im,d=Math.cos(2*f)+n(2*c);return new u(2*n(c)*Math.cos(f)/d,-2*i(c)*Math.sin(f)/d)},asinh:function(){var c=this.im;this.im=-this.re,this.re=c;var f=this.asin();return this.re=-this.im,this.im=c,c=f.re,f.re=-f.im,f.im=c,f},acosh:function(){var c=this.acos();if(c.im<=0){var f=c.re;c.re=-c.im,c.im=f}else{var f=c.im;c.im=-c.re,c.re=f}return c},atanh:function(){var c=this.re,f=this.im,d=c>1&&f===0,p=1-c,m=1+c,y=p*p+f*f,g=y!==0?new u((m*p-f*f)/y,(f*p+m*f)/y):new u(c!==-1?c/0:0,f!==0?f/0:0),v=g.re;return g.re=l(g.re,g.im)/2,g.im=Math.atan2(g.im,v)/2,d&&(g.im=-g.im),g},acoth:function(){var c=this.re,f=this.im;if(c===0&&f===0)return new u(0,Math.PI/2);var d=c*c+f*f;return d!==0?new u(c/d,-f/d).atanh():new u(c!==0?c/0:0,f!==0?-f/0:0).atanh()},acsch:function(){var c=this.re,f=this.im;if(f===0)return new u(c!==0?Math.log(c+Math.sqrt(c*c+1)):1/0,0);var d=c*c+f*f;return d!==0?new u(c/d,-f/d).asinh():new u(c!==0?c/0:0,f!==0?-f/0:0).asinh()},asech:function(){var c=this.re,f=this.im;if(this.isZero())return u.INFINITY;var d=c*c+f*f;return d!==0?new u(c/d,-f/d).acosh():new u(c!==0?c/0:0,f!==0?-f/0:0).acosh()},inverse:function(){if(this.isZero())return u.INFINITY;if(this.isInfinite())return u.ZERO;var c=this.re,f=this.im,d=c*c+f*f;return new u(c/d,-f/d)},conjugate:function(){return new u(this.re,-this.im)},neg:function(){return new u(-this.re,-this.im)},ceil:function(c){return c=Math.pow(10,c||0),new u(Math.ceil(this.re*c)/c,Math.ceil(this.im*c)/c)},floor:function(c){return c=Math.pow(10,c||0),new u(Math.floor(this.re*c)/c,Math.floor(this.im*c)/c)},round:function(c){return c=Math.pow(10,c||0),new u(Math.round(this.re*c)/c,Math.round(this.im*c)/c)},equals:function(c,f){var d=new u(c,f);return Math.abs(d.re-this.re)<=u.EPSILON&&Math.abs(d.im-this.im)<=u.EPSILON},clone:function(){return new u(this.re,this.im)},toString:function(){var c=this.re,f=this.im,d="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(c)<u.EPSILON&&(c=0),Math.abs(f)<u.EPSILON&&(f=0),f===0?d+c:(c!==0?(d+=c,d+=" ",f<0?(f=-f,d+="-"):d+="+",d+=" "):f<0&&(f=-f,d+="-"),f!==1&&(d+=f),d+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return this.im===0?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return this.im===0&&this.re===0},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!(this.isNaN()||this.isFinite())}},u.ZERO=new u(0,0),u.ONE=new u(1,0),u.I=new u(0,1),u.PI=new u(Math.PI,0),u.E=new u(Math.E,0),u.INFINITY=new u(1/0,1/0),u.NAN=new u(NaN,NaN),u.EPSILON=1e-15,Object.defineProperty(u,"__esModule",{value:!0}),u.default=u,u.Complex=u,r.exports=u})()})(VM);var lr=W1(VM.exports),DF="Complex",FF=[],OF=ke(DF,FF,()=>(lr.prototype.type="Complex",lr.prototype.isComplex=!0,lr.prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},lr.prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},lr.prototype.format=function(r){var e="",t=this.im,n=this.re,i=sl(this.re,r),s=sl(this.im,r),o=tn(r)?r:r?r.precision:null;if(o!==null){var a=Math.pow(10,-o);Math.abs(n/t)<a&&(n=0),Math.abs(t/n)<a&&(t=0)}return t===0?e=i:n===0?t===1?e="i":t===-1?e="-i":e=s+"i":t<0?t===-1?e=i+" - i":e=i+" - "+s.substring(1)+"i":t===1?e=i+" + i":e=i+" + "+s+"i",e},lr.fromPolar=function(r){switch(arguments.length){case 1:{var e=arguments[0];if(typeof e=="object")return lr(e);throw new TypeError("Input has to be an object with r and phi keys.")}case 2:{var t=arguments[0],n=arguments[1];if(tn(t)){if(No(n)&&n.hasBase("ANGLE")&&(n=n.toNumber("rad")),tn(n))return new lr({r:t,phi:n});throw new TypeError("Phi is not a number nor an angle unit.")}else throw new TypeError("Radius r is not a number.")}default:throw new SyntaxError("Wrong number of arguments in function fromPolar")}},lr.prototype.valueOf=lr.prototype.toString,lr.fromJSON=function(r){return new lr(r)},lr.compare=function(r,e){return r.re>e.re?1:r.re<e.re?-1:r.im>e.im?1:r.im<e.im?-1:0},lr),{isClass:!0}),WM={exports:{}};/**
 * @license Fraction.js v4.1.1 23/05/2021
 * https://www.xarg.org/2014/03/rational-numbers-in-javascript/
 *
 * Copyright (c) 2021, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/(function(r,e){(function(t){var n=2e3,i={s:1,n:0,d:1};function s(g){function v(){var w=Error.apply(this,arguments);w.name=this.name=g,this.stack=w.stack,this.message=w.message}function x(){}return x.prototype=Error.prototype,v.prototype=new x,v}var o=y.DivisionByZero=s("DivisionByZero"),a=y.InvalidParameter=s("InvalidParameter");function l(g,v){return isNaN(g=parseInt(g,10))&&h(),g*v}function h(){throw new a}function u(g){for(var v={},x=g,w=2,b=4;b<=x;){for(;x%w==0;)x/=w,v[w]=(v[w]||0)+1;b+=1+2*w++}return x!==g?x>1&&(v[x]=(v[x]||0)+1):v[g]=(v[g]||0)+1,v}var c=function(g,v){var x=0,w=1,b=1,M=0,A=0,E=0,N=1,R=1,_=0,S=1,L=1,k=1,H=1e7,O;if(g!=null)if(v!==void 0)x=g,w=v,b=x*w;else switch(typeof g){case"object":{"d"in g&&"n"in g?(x=g.n,w=g.d,"s"in g&&(x*=g.s)):0 in g?(x=g[0],1 in g&&(w=g[1])):h(),b=x*w;break}case"number":{if(g<0&&(b=g,g=-g),g%1==0)x=g;else if(g>0){for(g>=1&&(R=Math.pow(10,Math.floor(1+Math.log(g)/Math.LN10)),g/=R);S<=H&&k<=H;)if(O=(_+L)/(S+k),g===O){S+k<=H?(x=_+L,w=S+k):k>S?(x=L,w=k):(x=_,w=S);break}else g>O?(_+=L,S+=k):(L+=_,k+=S),S>H?(x=L,w=k):(x=_,w=S);x*=R}else(isNaN(g)||isNaN(v))&&(w=x=NaN);break}case"string":if(S=g.match(/\d+|./g),S===null&&h(),S[_]==="-"?(b=-1,_++):S[_]==="+"&&_++,S.length===_+1?A=l(S[_++],b):S[_+1]==="."||S[_]==="."?(S[_]!=="."&&(M=l(S[_++],b)),_++,(_+1===S.length||S[_+1]==="("&&S[_+3]===")"||S[_+1]==="'"&&S[_+3]==="'")&&(A=l(S[_],b),N=Math.pow(10,S[_].length),_++),(S[_]==="("&&S[_+2]===")"||S[_]==="'"&&S[_+2]==="'")&&(E=l(S[_+1],b),R=Math.pow(10,S[_+1].length)-1,_+=3)):S[_+1]==="/"||S[_+1]===":"?(A=l(S[_],b),N=l(S[_+2],1),_+=3):S[_+3]==="/"&&S[_+1]===" "&&(M=l(S[_],b),A=l(S[_+2],b),N=l(S[_+4],1),_+=5),S.length<=_){w=N*R,b=x=E+w*M+R*A;break}default:h()}if(w===0)throw new o;i.s=b<0?-1:1,i.n=Math.abs(x),i.d=Math.abs(w)};function f(g,v,x){for(var w=1;v>0;g=g*g%x,v>>=1)v&1&&(w=w*g%x);return w}function d(g,v){for(;v%2==0;v/=2);for(;v%5==0;v/=5);if(v===1)return 0;for(var x=10%v,w=1;x!==1;w++)if(x=x*10%v,w>n)return 0;return w}function p(g,v,x){for(var w=1,b=f(10,x,v),M=0;M<300;M++){if(w===b)return M;w=w*10%v,b=b*10%v}return 0}function m(g,v){if(!g)return v;if(!v)return g;for(;;){if(g%=v,!g)return v;if(v%=g,!v)return g}}function y(g,v){if(!(this instanceof y))return new y(g,v);c(g,v),y.REDUCE?g=m(i.d,i.n):g=1,this.s=i.s,this.n=i.n/g,this.d=i.d/g}y.REDUCE=1,y.prototype={s:1,n:0,d:1,abs:function(){return new y(this.n,this.d)},neg:function(){return new y(-this.s*this.n,this.d)},add:function(g,v){return c(g,v),new y(this.s*this.n*i.d+i.s*this.d*i.n,this.d*i.d)},sub:function(g,v){return c(g,v),new y(this.s*this.n*i.d-i.s*this.d*i.n,this.d*i.d)},mul:function(g,v){return c(g,v),new y(this.s*i.s*this.n*i.n,this.d*i.d)},div:function(g,v){return c(g,v),new y(this.s*i.s*this.n*i.d,this.d*i.n)},clone:function(){return new y(this)},mod:function(g,v){return isNaN(this.n)||isNaN(this.d)?new y(NaN):g===void 0?new y(this.s*this.n%this.d,1):(c(g,v),i.n===0&&this.d===0&&y(0,0),new y(this.s*(i.d*this.n)%(i.n*this.d),i.d*this.d))},gcd:function(g,v){return c(g,v),new y(m(i.n,this.n)*m(i.d,this.d),i.d*this.d)},lcm:function(g,v){return c(g,v),i.n===0&&this.n===0?new y:new y(i.n*this.n,m(i.n,this.n)*m(i.d,this.d))},ceil:function(g){return g=Math.pow(10,g||0),isNaN(this.n)||isNaN(this.d)?new y(NaN):new y(Math.ceil(g*this.s*this.n/this.d),g)},floor:function(g){return g=Math.pow(10,g||0),isNaN(this.n)||isNaN(this.d)?new y(NaN):new y(Math.floor(g*this.s*this.n/this.d),g)},round:function(g){return g=Math.pow(10,g||0),isNaN(this.n)||isNaN(this.d)?new y(NaN):new y(Math.round(g*this.s*this.n/this.d),g)},inverse:function(){return new y(this.s*this.d,this.n)},pow:function(g,v){if(c(g,v),i.d===1)return i.s<0?new y(Math.pow(this.s*this.d,i.n),Math.pow(this.n,i.n)):new y(Math.pow(this.s*this.n,i.n),Math.pow(this.d,i.n));if(this.s<0)return null;var x=u(this.n),w=u(this.d),b=1,M=1;for(var A in x)if(A!=="1"){if(A==="0"){b=0;break}if(x[A]*=i.n,x[A]%i.d==0)x[A]/=i.d;else return null;b*=Math.pow(A,x[A])}for(var A in w)if(A!=="1"){if(w[A]*=i.n,w[A]%i.d==0)w[A]/=i.d;else return null;M*=Math.pow(A,w[A])}return i.s<0?new y(M,b):new y(b,M)},equals:function(g,v){return c(g,v),this.s*this.n*i.d==i.s*i.n*this.d},compare:function(g,v){c(g,v);var x=this.s*this.n*i.d-i.s*i.n*this.d;return(0<x)-(x<0)},simplify:function(g){if(isNaN(this.n)||isNaN(this.d))return this;var v=this.abs().toContinued();g=g||.001;function x(M){return M.length===1?new y(M[0]):x(M.slice(1)).inverse().add(M[0])}for(var w=0;w<v.length;w++){var b=x(v.slice(0,w+1));if(b.sub(this.abs()).abs().valueOf()<g)return b.mul(this.s)}return this},divisible:function(g,v){return c(g,v),!(!(i.n*this.d)||this.n*i.d%(i.n*this.d))},valueOf:function(){return this.s*this.n/this.d},toFraction:function(g){var v,x="",w=this.n,b=this.d;return this.s<0&&(x+="-"),b===1?x+=w:(g&&(v=Math.floor(w/b))>0&&(x+=v,x+=" ",w%=b),x+=w,x+="/",x+=b),x},toLatex:function(g){var v,x="",w=this.n,b=this.d;return this.s<0&&(x+="-"),b===1?x+=w:(g&&(v=Math.floor(w/b))>0&&(x+=v,w%=b),x+="\\frac{",x+=w,x+="}{",x+=b,x+="}"),x},toContinued:function(){var g,v=this.n,x=this.d,w=[];if(isNaN(v)||isNaN(x))return w;do w.push(Math.floor(v/x)),g=v%x,v=x,x=g;while(v!==1);return w},toString:function(g){var v,x=this.n,w=this.d;if(isNaN(x)||isNaN(w))return"NaN";y.REDUCE||(v=m(x,w),x/=v,w/=v),g=g||15;var b=d(x,w),M=p(x,w,b),A=this.s===-1?"-":"";if(A+=x/w|0,x%=w,x*=10,x&&(A+="."),b){for(var E=M;E--;)A+=x/w|0,x%=w,x*=10;A+="(";for(var E=b;E--;)A+=x/w|0,x%=w,x*=10;A+=")"}else for(var E=g;x&&E--;)A+=x/w|0,x%=w,x*=10;return A}},Object.defineProperty(y,"__esModule",{value:!0}),y.default=y,y.Fraction=y,r.exports=y})()})(WM);var cl=W1(WM.exports),zF="Fraction",UF=[],HF=ke(zF,UF,()=>(cl.prototype.type="Fraction",cl.prototype.isFraction=!0,cl.prototype.toJSON=function(){return{mathjs:"Fraction",n:this.s*this.n,d:this.d}},cl.fromJSON=function(r){return new cl(r)},cl),{isClass:!0}),GF="Range",kF=[],VF=ke(GF,kF,()=>{function r(e,t,n){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");var i=e!=null,s=t!=null,o=n!=null;if(i){if(Wt(e))e=e.toNumber();else if(typeof e!="number")throw new TypeError("Parameter start must be a number")}if(s){if(Wt(t))t=t.toNumber();else if(typeof t!="number")throw new TypeError("Parameter end must be a number")}if(o){if(Wt(n))n=n.toNumber();else if(typeof n!="number")throw new TypeError("Parameter step must be a number")}this.start=i?parseFloat(e):0,this.end=s?parseFloat(t):0,this.step=o?parseFloat(n):1}return r.prototype.type="Range",r.prototype.isRange=!0,r.parse=function(e){if(typeof e!="string")return null;var t=e.split(":"),n=t.map(function(s){return parseFloat(s)}),i=n.some(function(s){return isNaN(s)});if(i)return null;switch(n.length){case 2:return new r(n[0],n[1]);case 3:return new r(n[0],n[2],n[1]);default:return null}},r.prototype.clone=function(){return new r(this.start,this.end,this.step)},r.prototype.size=function(){var e=0,t=this.start,n=this.step,i=this.end,s=i-t;return vM(n)===vM(s)?e=Math.ceil(s/n):s===0&&(e=0),isNaN(e)&&(e=0),[e]},r.prototype.min=function(){var e=this.size()[0];if(e>0)return this.step>0?this.start:this.start+(e-1)*this.step},r.prototype.max=function(){var e=this.size()[0];if(e>0)return this.step>0?this.start+(e-1)*this.step:this.start},r.prototype.forEach=function(e){var t=this.start,n=this.step,i=this.end,s=0;if(n>0)for(;t<i;)e(t,[s],this),t+=n,s++;else if(n<0)for(;t>i;)e(t,[s],this),t+=n,s++},r.prototype.map=function(e){var t=[];return this.forEach(function(n,i,s){t[i[0]]=e(n,i,s)}),t},r.prototype.toArray=function(){var e=[];return this.forEach(function(t,n){e[n[0]]=t}),e},r.prototype.valueOf=function(){return this.toArray()},r.prototype.format=function(e){var t=sl(this.start,e);return this.step!==1&&(t+=":"+sl(this.step,e)),t+=":"+sl(this.end,e),t},r.prototype.toString=function(){return this.format()},r.prototype.toJSON=function(){return{mathjs:"Range",start:this.start,end:this.end,step:this.step}},r.fromJSON=function(e){return new r(e.start,e.end,e.step)},r},{isClass:!0}),WF="Matrix",qF=[],YF=ke(WF,qF,()=>{function r(){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator")}return r.prototype.type="Matrix",r.prototype.isMatrix=!0,r.prototype.storage=function(){throw new Error("Cannot invoke storage on a Matrix interface")},r.prototype.datatype=function(){throw new Error("Cannot invoke datatype on a Matrix interface")},r.prototype.create=function(e,t){throw new Error("Cannot invoke create on a Matrix interface")},r.prototype.subset=function(e,t,n){throw new Error("Cannot invoke subset on a Matrix interface")},r.prototype.get=function(e){throw new Error("Cannot invoke get on a Matrix interface")},r.prototype.set=function(e,t,n){throw new Error("Cannot invoke set on a Matrix interface")},r.prototype.resize=function(e,t){throw new Error("Cannot invoke resize on a Matrix interface")},r.prototype.reshape=function(e,t){throw new Error("Cannot invoke reshape on a Matrix interface")},r.prototype.clone=function(){throw new Error("Cannot invoke clone on a Matrix interface")},r.prototype.size=function(){throw new Error("Cannot invoke size on a Matrix interface")},r.prototype.map=function(e,t){throw new Error("Cannot invoke map on a Matrix interface")},r.prototype.forEach=function(e){throw new Error("Cannot invoke forEach on a Matrix interface")},r.prototype.toArray=function(){throw new Error("Cannot invoke toArray on a Matrix interface")},r.prototype.valueOf=function(){throw new Error("Cannot invoke valueOf on a Matrix interface")},r.prototype.format=function(e){throw new Error("Cannot invoke format on a Matrix interface")},r.prototype.toString=function(){throw new Error("Cannot invoke toString on a Matrix interface")},r},{isClass:!0}),XF="DenseMatrix",QF=["Matrix"],jF=ke(XF,QF,r=>{var{Matrix:e}=r;function t(u,c){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");if(c&&!gi(c))throw new Error("Invalid datatype: "+c);if(hn(u))u.type==="DenseMatrix"?(this._data=Et(u._data),this._size=Et(u._size),this._datatype=c||u._datatype):(this._data=u.toArray(),this._size=u.size(),this._datatype=c||u._datatype);else if(u&&nn(u.data)&&nn(u.size))this._data=u.data,this._size=u.size,AM(this._data,this._size),this._datatype=c||u.datatype;else if(nn(u))this._data=h(u),this._size=Ir(this._data),AM(this._data,this._size),this._datatype=c;else{if(u)throw new TypeError("Unsupported type of data ("+Kn(u)+")");this._data=[],this._size=[0],this._datatype=c}}t.prototype=new e,t.prototype.createDenseMatrix=function(u,c){return new t(u,c)},t.prototype.type="DenseMatrix",t.prototype.isDenseMatrix=!0,t.prototype.getDataType=function(){return Af(this._data,Kn)},t.prototype.storage=function(){return"dense"},t.prototype.datatype=function(){return this._datatype},t.prototype.create=function(u,c){return new t(u,c)},t.prototype.subset=function(u,c,f){switch(arguments.length){case 1:return n(this,u);case 2:case 3:return s(this,u,c,f);default:throw new SyntaxError("Wrong number of arguments")}},t.prototype.get=function(u){if(!nn(u))throw new TypeError("Array expected");if(u.length!==this._size.length)throw new gt(u.length,this._size.length);for(var c=0;c<u.length;c++)Kt(u[c],this._size[c]);for(var f=this._data,d=0,p=u.length;d<p;d++){var m=u[d];Kt(m,f.length),f=f[m]}return f},t.prototype.set=function(u,c,f){if(!nn(u))throw new TypeError("Array expected");if(u.length<this._size.length)throw new gt(u.length,this._size.length,"<");var d,p,m,y=u.map(function(v){return v+1});l(this,y,f);var g=this._data;for(d=0,p=u.length-1;d<p;d++)m=u[d],Kt(m,g.length),g=g[m];return m=u[u.length-1],Kt(m,g.length),g[m]=c,this};function n(u,c){if(!rl(c))throw new TypeError("Invalid index");var f=c.isScalar();if(f)return u.get(c.min());var d=c.size();if(d.length!==u._size.length)throw new gt(d.length,u._size.length);for(var p=c.min(),m=c.max(),y=0,g=u._size.length;y<g;y++)Kt(p[y],u._size[y]),Kt(m[y],u._size[y]);return new t(i(u._data,c,d.length,0),u._datatype)}function i(u,c,f,d){var p=d===f-1,m=c.dimension(d);return p?m.map(function(y){return Kt(y,u.length),u[y]}).valueOf():m.map(function(y){Kt(y,u.length);var g=u[y];return i(g,c,f,d+1)}).valueOf()}function s(u,c,f,d){if(!c||c.isIndex!==!0)throw new TypeError("Invalid index");var p=c.size(),m=c.isScalar(),y;if(hn(f)?(y=f.size(),f=f.valueOf()):y=Ir(f),m){if(y.length!==0)throw new TypeError("Scalar expected");u.set(c.min(),f,d)}else{if(p.length<u._size.length)throw new gt(p.length,u._size.length,"<");if(y.length<p.length){for(var g=0,v=0;p[g]===1&&y[g]===1;)g++;for(;p[g]===1;)v++,g++;f=SM(f,p.length,v,y)}if(!il(p,y))throw new gt(p,y,">");var x=c.max().map(function(M){return M+1});l(u,x,d);var w=p.length,b=0;o(u._data,c,f,w,b)}return u}function o(u,c,f,d,p){var m=p===d-1,y=c.dimension(p);m?y.forEach(function(g,v){Kt(g),u[g]=f[v[0]]}):y.forEach(function(g,v){Kt(g),o(u[g],c,f[v[0]],d,p+1)})}t.prototype.resize=function(u,c,f){if(!vg(u))throw new TypeError("Array or Matrix expected");var d=u.valueOf().map(m=>Array.isArray(m)&&m.length===1?m[0]:m),p=f?this.clone():this;return a(p,d,c)};function a(u,c,f){if(c.length===0){for(var d=u._data;nn(d);)d=d[0];return d}return u._size=c.slice(0),u._data=Mf(u._data,u._size,f),u}t.prototype.reshape=function(u,c){var f=c?this.clone():this;return f._data=CD(f._data,u),f._size=u.slice(0),f};function l(u,c,f){for(var d=u._size.slice(0),p=!1;d.length<c.length;)d.push(0),p=!0;for(var m=0,y=c.length;m<y;m++)c[m]>d[m]&&(d[m]=c[m],p=!0);p&&a(u,d,f)}t.prototype.clone=function(){var u=new t({data:Et(this._data),size:Et(this._size),datatype:this._datatype});return u},t.prototype.size=function(){return this._size.slice(0)},t.prototype.map=function(u){var c=this,f=function m(y,g){return nn(y)?y.map(function(v,x){return m(v,g.concat(x))}):u(y,g,c)},d=f(this._data,[]),p=this._datatype!==void 0?Af(d,Kn):void 0;return new t(d,p)},t.prototype.forEach=function(u){var c=this,f=function d(p,m){nn(p)?p.forEach(function(y,g){d(y,m.concat(g))}):u(p,m,c)};f(this._data,[])},t.prototype.toArray=function(){return Et(this._data)},t.prototype.valueOf=function(){return this._data},t.prototype.format=function(u){return rn(this._data,u)},t.prototype.toString=function(){return rn(this._data)},t.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},t.prototype.diagonal=function(u){if(u){if(Wt(u)&&(u=u.toNumber()),!tn(u)||!fn(u))throw new TypeError("The parameter k must be an integer number")}else u=0;for(var c=u>0?u:0,f=u<0?-u:0,d=this._size[0],p=this._size[1],m=Math.min(d-f,p-c),y=[],g=0;g<m;g++)y[g]=this._data[g+f][g+c];return new t({data:y,size:[m],datatype:this._datatype})},t.diagonal=function(u,c,f,d){if(!nn(u))throw new TypeError("Array expected, size parameter");if(u.length!==2)throw new Error("Only two dimensions matrix are supported");if(u=u.map(function(A){if(Wt(A)&&(A=A.toNumber()),!tn(A)||!fn(A)||A<1)throw new Error("Size values must be positive integers");return A}),f){if(Wt(f)&&(f=f.toNumber()),!tn(f)||!fn(f))throw new TypeError("The parameter k must be an integer number")}else f=0;var p=f>0?f:0,m=f<0?-f:0,y=u[0],g=u[1],v=Math.min(y-m,g-p),x;if(nn(c)){if(c.length!==v)throw new Error("Invalid value array length");x=function(E){return c[E]}}else if(hn(c)){var w=c.size();if(w.length!==1||w[0]!==v)throw new Error("Invalid matrix length");x=function(E){return c.get([E])}}else x=function(){return c};d||(d=Wt(x(0))?x(0).mul(0):0);var b=[];if(u.length>0){b=Mf(b,u,d);for(var M=0;M<v;M++)b[M+m][M+p]=x(M)}return new t({data:b,size:[y,g]})},t.fromJSON=function(u){return new t(u)},t.prototype.swapRows=function(u,c){if(!tn(u)||!fn(u)||!tn(c)||!fn(c))throw new Error("Row index must be positive integers");if(this._size.length!==2)throw new Error("Only two dimensional matrix is supported");return Kt(u,this._size[0]),Kt(c,this._size[0]),t._swapRows(u,c,this._data),this},t._swapRows=function(u,c,f){var d=f[u];f[u]=f[c],f[c]=d};function h(u){for(var c=0,f=u.length;c<f;c++){var d=u[c];nn(d)?u[c]=h(d):d&&d.isMatrix===!0&&(u[c]=h(d.valueOf()))}return u}return t},{isClass:!0});function wn(r,e,t){return r&&typeof r.map=="function"?r.map(function(n){return wn(n,e)}):e(r)}var zg="number",Oc="number, number";function qM(r){return Math.abs(r)}qM.signature=zg;function YM(r,e){return r+e}YM.signature=Oc;function XM(r,e){return r*e}XM.signature=Oc;function QM(r){return-r}QM.signature=zg;function jM(r){return Math.ceil(r)}jM.signature=zg;function ZM(r,e){if(e>0)return r-e*Math.floor(r/e);if(e===0)return r;throw new Error("Cannot calculate mod for a negative divisor")}ZM.signature=Oc;function JM(r,e){return r*r<1&&e===1/0||r*r>1&&e===-1/0?0:Math.pow(r,e)}JM.signature=Oc;function Ug(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return parseFloat(yM(r,e))}Ug.signature=Oc;var KM="isNumeric",ZF=["typed"],JF=ke(KM,ZF,r=>{var{typed:e}=r;return e(KM,{"number | BigNumber | Fraction | boolean":function(){return!0},"Complex | Unit | string | null | undefined | Node":function(){return!1},"Array | Matrix":function(n){return wn(n,this)}})});function Do(r,e,t){if(t==null)return r.eq(e);if(r.eq(e))return!0;if(r.isNaN()||e.isNaN())return!1;if(r.isFinite()&&e.isFinite()){var n=r.minus(e).abs();if(n.isZero())return!0;var i=r.constructor.max(r.abs(),e.abs());return n.lte(i.times(t))}return!1}function KF(r,e,t){return vi(r.re,e.re,t)&&vi(r.im,e.im,t)}var Pf="equalScalar",$F=["typed","config"],eO=ke(Pf,$F,r=>{var{typed:e,config:t}=r;return e(Pf,{"boolean, boolean":function(i,s){return i===s},"number, number":function(i,s){return vi(i,s,t.epsilon)},"BigNumber, BigNumber":function(i,s){return i.eq(s)||Do(i,s,t.epsilon)},"Fraction, Fraction":function(i,s){return i.equals(s)},"Complex, Complex":function(i,s){return KF(i,s,t.epsilon)},"Unit, Unit":function(i,s){if(!i.equalBase(s))throw new Error("Cannot compare units with different base");return this(i.value,s.value)}})});ke(Pf,["typed","config"],r=>{var{typed:e,config:t}=r;return e(Pf,{"number, number":function(i,s){return vi(i,s,t.epsilon)}})});var tO="SparseMatrix",nO=["typed","equalScalar","Matrix"],rO=ke(tO,nO,r=>{var{typed:e,equalScalar:t,Matrix:n}=r;function i(m,y){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if(y&&!gi(y))throw new Error("Invalid datatype: "+y);if(hn(m))s(this,m,y);else if(m&&nn(m.index)&&nn(m.ptr)&&nn(m.size))this._values=m.values,this._index=m.index,this._ptr=m.ptr,this._size=m.size,this._datatype=y||m.datatype;else if(nn(m))o(this,m,y);else{if(m)throw new TypeError("Unsupported type of data ("+Kn(m)+")");this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=y}}function s(m,y,g){y.type==="SparseMatrix"?(m._values=y._values?Et(y._values):void 0,m._index=Et(y._index),m._ptr=Et(y._ptr),m._size=Et(y._size),m._datatype=g||y._datatype):o(m,y.valueOf(),g||y._datatype)}function o(m,y,g){m._values=[],m._index=[],m._ptr=[],m._datatype=g;var v=y.length,x=0,w=t,b=0;if(gi(g)&&(w=e.find(t,[g,g])||t,b=e.convert(0,g)),v>0){var M=0;do{m._ptr.push(m._index.length);for(var A=0;A<v;A++){var E=y[A];if(nn(E)){if(M===0&&x<E.length&&(x=E.length),M<E.length){var N=E[M];w(N,b)||(m._values.push(N),m._index.push(A))}}else M===0&&x<1&&(x=1),w(E,b)||(m._values.push(E),m._index.push(A))}M++}while(M<x)}m._ptr.push(m._index.length),m._size=[v,x]}i.prototype=new n,i.prototype.createSparseMatrix=function(m,y){return new i(m,y)},i.prototype.type="SparseMatrix",i.prototype.isSparseMatrix=!0,i.prototype.getDataType=function(){return Af(this._values,Kn)},i.prototype.storage=function(){return"sparse"},i.prototype.datatype=function(){return this._datatype},i.prototype.create=function(m,y){return new i(m,y)},i.prototype.density=function(){var m=this._size[0],y=this._size[1];return m!==0&&y!==0?this._index.length/(m*y):0},i.prototype.subset=function(m,y,g){if(!this._values)throw new Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return a(this,m);case 2:case 3:return l(this,m,y,g);default:throw new SyntaxError("Wrong number of arguments")}};function a(m,y){if(!rl(y))throw new TypeError("Invalid index");var g=y.isScalar();if(g)return m.get(y.min());var v=y.size();if(v.length!==m._size.length)throw new gt(v.length,m._size.length);var x,w,b,M,A=y.min(),E=y.max();for(x=0,w=m._size.length;x<w;x++)Kt(A[x],m._size[x]),Kt(E[x],m._size[x]);var N=m._values,R=m._index,_=m._ptr,S=y.dimension(0),L=y.dimension(1),k=[],H=[];S.forEach(function(F,J){H[F]=J[0],k[F]=!0});var O=N?[]:void 0,T=[],V=[];return L.forEach(function(F){for(V.push(T.length),b=_[F],M=_[F+1];b<M;b++)x=R[b],k[x]===!0&&(T.push(H[x]),O&&O.push(N[b]))}),V.push(T.length),new i({values:O,index:T,ptr:V,size:v,datatype:m._datatype})}function l(m,y,g,v){if(!y||y.isIndex!==!0)throw new TypeError("Invalid index");var x=y.size(),w=y.isScalar(),b;if(hn(g)?(b=g.size(),g=g.toArray()):b=Ir(g),w){if(b.length!==0)throw new TypeError("Scalar expected");m.set(y.min(),g,v)}else{if(x.length!==1&&x.length!==2)throw new gt(x.length,m._size.length,"<");if(b.length<x.length){for(var M=0,A=0;x[M]===1&&b[M]===1;)M++;for(;x[M]===1;)A++,M++;g=SM(g,x.length,A,b)}if(!il(x,b))throw new gt(x,b,">");for(var E=y.min()[0],N=y.min()[1],R=b[0],_=b[1],S=0;S<R;S++)for(var L=0;L<_;L++){var k=g[S][L];m.set([S+E,L+N],k,v)}}return m}i.prototype.get=function(m){if(!nn(m))throw new TypeError("Array expected");if(m.length!==this._size.length)throw new gt(m.length,this._size.length);if(!this._values)throw new Error("Cannot invoke get on a Pattern only matrix");var y=m[0],g=m[1];Kt(y,this._size[0]),Kt(g,this._size[1]);var v=h(y,this._ptr[g],this._ptr[g+1],this._index);return v<this._ptr[g+1]&&this._index[v]===y?this._values[v]:0},i.prototype.set=function(m,y,g){if(!nn(m))throw new TypeError("Array expected");if(m.length!==this._size.length)throw new gt(m.length,this._size.length);if(!this._values)throw new Error("Cannot invoke set on a Pattern only matrix");var v=m[0],x=m[1],w=this._size[0],b=this._size[1],M=t,A=0;gi(this._datatype)&&(M=e.find(t,[this._datatype,this._datatype])||t,A=e.convert(0,this._datatype)),(v>w-1||x>b-1)&&(f(this,Math.max(v+1,w),Math.max(x+1,b),g),w=this._size[0],b=this._size[1]),Kt(v,w),Kt(x,b);var E=h(v,this._ptr[x],this._ptr[x+1],this._index);return E<this._ptr[x+1]&&this._index[E]===v?M(y,A)?u(E,x,this._values,this._index,this._ptr):this._values[E]=y:c(E,v,x,y,this._values,this._index,this._ptr),this};function h(m,y,g,v){if(g-y==0)return g;for(var x=y;x<g;x++)if(v[x]===m)return x;return y}function u(m,y,g,v,x){g.splice(m,1),v.splice(m,1);for(var w=y+1;w<x.length;w++)x[w]--}function c(m,y,g,v,x,w,b){x.splice(m,0,v),w.splice(m,0,y);for(var M=g+1;M<b.length;M++)b[M]++}i.prototype.resize=function(m,y,g){if(!vg(m))throw new TypeError("Array or Matrix expected");var v=m.valueOf().map(w=>Array.isArray(w)&&w.length===1?w[0]:w);if(v.length!==2)throw new Error("Only two dimensions matrix are supported");v.forEach(function(w){if(!tn(w)||!fn(w)||w<0)throw new TypeError("Invalid size, must contain positive integers (size: "+rn(v)+")")});var x=g?this.clone():this;return f(x,v[0],v[1],y)};function f(m,y,g,v){var x=v||0,w=t,b=0;gi(m._datatype)&&(w=e.find(t,[m._datatype,m._datatype])||t,b=e.convert(0,m._datatype),x=e.convert(x,m._datatype));var M=!w(x,b),A=m._size[0],E=m._size[1],N,R,_;if(g>E){for(R=E;R<g;R++)if(m._ptr[R]=m._values.length,M)for(N=0;N<A;N++)m._values.push(x),m._index.push(N);m._ptr[g]=m._values.length}else g<E&&(m._ptr.splice(g+1,E-g),m._values.splice(m._ptr[g],m._values.length),m._index.splice(m._ptr[g],m._index.length));if(E=g,y>A){if(M){var S=0;for(R=0;R<E;R++){m._ptr[R]=m._ptr[R]+S,_=m._ptr[R+1]+S;var L=0;for(N=A;N<y;N++,L++)m._values.splice(_+L,0,x),m._index.splice(_+L,0,N),S++}m._ptr[E]=m._values.length}}else if(y<A){var k=0;for(R=0;R<E;R++){m._ptr[R]=m._ptr[R]-k;var H=m._ptr[R],O=m._ptr[R+1]-k;for(_=H;_<O;_++)N=m._index[_],N>y-1&&(m._values.splice(_,1),m._index.splice(_,1),k++)}m._ptr[R]=m._values.length}return m._size[0]=y,m._size[1]=g,m}i.prototype.reshape=function(m,y){if(!nn(m))throw new TypeError("Array expected");if(m.length!==2)throw new Error("Sparse matrices can only be reshaped in two dimensions");if(m.forEach(function(T){if(!tn(T)||!fn(T)||T<0)throw new TypeError("Invalid size, must contain positive integers (size: "+rn(m)+")")}),this._size[0]*this._size[1]!=m[0]*m[1])throw new Error("Reshaping sparse matrix will result in the wrong number of elements");var g=y?this.clone():this;if(this._size[0]===m[0]&&this._size[1]===m[1])return g;for(var v=[],x=0;x<g._ptr.length;x++)for(var w=0;w<g._ptr[x+1]-g._ptr[x];w++)v.push(x);for(var b=g._values.slice(),M=g._index.slice(),A=0;A<g._index.length;A++){var E=M[A],N=v[A],R=E*g._size[1]+N;v[A]=R%m[1],M[A]=Math.floor(R/m[1])}g._values.length=0,g._index.length=0,g._ptr.length=m[1]+1,g._size=m.slice();for(var _=0;_<g._ptr.length;_++)g._ptr[_]=0;for(var S=0;S<b.length;S++){var L=M[S],k=v[S],H=b[S],O=h(L,g._ptr[k],g._ptr[k+1],g._index);c(O,L,k,H,g._values,g._index,g._ptr)}return g},i.prototype.clone=function(){var m=new i({values:this._values?Et(this._values):void 0,index:Et(this._index),ptr:Et(this._ptr),size:Et(this._size),datatype:this._datatype});return m},i.prototype.size=function(){return this._size.slice(0)},i.prototype.map=function(m,y){if(!this._values)throw new Error("Cannot invoke map on a Pattern only matrix");var g=this,v=this._size[0],x=this._size[1],w=function(M,A,E){return m(M,[A,E],g)};return d(this,0,v-1,0,x-1,w,y)};function d(m,y,g,v,x,w,b){var M=[],A=[],E=[],N=t,R=0;gi(m._datatype)&&(N=e.find(t,[m._datatype,m._datatype])||t,R=e.convert(0,m._datatype));for(var _=function(z,K,Z){z=w(z,K,Z),N(z,R)||(M.push(z),A.push(K))},S=v;S<=x;S++){E.push(M.length);var L=m._ptr[S],k=m._ptr[S+1];if(b)for(var H=L;H<k;H++){var O=m._index[H];O>=y&&O<=g&&_(m._values[H],O-y,S-v)}else{for(var T={},V=L;V<k;V++){var F=m._index[V];T[F]=m._values[V]}for(var J=y;J<=g;J++){var Y=J in T?T[J]:0;_(Y,J-y,S-v)}}}return E.push(M.length),new i({values:M,index:A,ptr:E,size:[g-y+1,x-v+1]})}i.prototype.forEach=function(m,y){if(!this._values)throw new Error("Cannot invoke forEach on a Pattern only matrix");for(var g=this,v=this._size[0],x=this._size[1],w=0;w<x;w++){var b=this._ptr[w],M=this._ptr[w+1];if(y)for(var A=b;A<M;A++){var E=this._index[A];m(this._values[A],[E,w],g)}else{for(var N={},R=b;R<M;R++){var _=this._index[R];N[_]=this._values[R]}for(var S=0;S<v;S++){var L=S in N?N[S]:0;m(L,[S,w],g)}}}},i.prototype.toArray=function(){return p(this._values,this._index,this._ptr,this._size,!0)},i.prototype.valueOf=function(){return p(this._values,this._index,this._ptr,this._size,!1)};function p(m,y,g,v,x){var w=v[0],b=v[1],M=[],A,E;for(A=0;A<w;A++)for(M[A]=[],E=0;E<b;E++)M[A][E]=0;for(E=0;E<b;E++)for(var N=g[E],R=g[E+1],_=N;_<R;_++)A=y[_],M[A][E]=m?x?Et(m[_]):m[_]:1;return M}return i.prototype.format=function(m){for(var y=this._size[0],g=this._size[1],v=this.density(),x="Sparse Matrix ["+rn(y,m)+" x "+rn(g,m)+"] density: "+rn(v,m)+`
`,w=0;w<g;w++)for(var b=this._ptr[w],M=this._ptr[w+1],A=b;A<M;A++){var E=this._index[A];x+=`
    (`+rn(E,m)+", "+rn(w,m)+") ==> "+(this._values?rn(this._values[A],m):"X")}return x},i.prototype.toString=function(){return rn(this.toArray())},i.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},i.prototype.diagonal=function(m){if(m){if(Wt(m)&&(m=m.toNumber()),!tn(m)||!fn(m))throw new TypeError("The parameter k must be an integer number")}else m=0;var y=m>0?m:0,g=m<0?-m:0,v=this._size[0],x=this._size[1],w=Math.min(v-g,x-y),b=[],M=[],A=[];A[0]=0;for(var E=y;E<x&&b.length<w;E++)for(var N=this._ptr[E],R=this._ptr[E+1],_=N;_<R;_++){var S=this._index[_];if(S===E-y+g){b.push(this._values[_]),M[b.length-1]=S-g;break}}return A.push(b.length),new i({values:b,index:M,ptr:A,size:[w,1]})},i.fromJSON=function(m){return new i(m)},i.diagonal=function(m,y,g,v,x){if(!nn(m))throw new TypeError("Array expected, size parameter");if(m.length!==2)throw new Error("Only two dimensions matrix are supported");if(m=m.map(function(F){if(Wt(F)&&(F=F.toNumber()),!tn(F)||!fn(F)||F<1)throw new Error("Size values must be positive integers");return F}),g){if(Wt(g)&&(g=g.toNumber()),!tn(g)||!fn(g))throw new TypeError("The parameter k must be an integer number")}else g=0;var w=t,b=0;gi(x)&&(w=e.find(t,[x,x])||t,b=e.convert(0,x));var M=g>0?g:0,A=g<0?-g:0,E=m[0],N=m[1],R=Math.min(E-A,N-M),_;if(nn(y)){if(y.length!==R)throw new Error("Invalid value array length");_=function(J){return y[J]}}else if(hn(y)){var S=y.size();if(S.length!==1||S[0]!==R)throw new Error("Invalid matrix length");_=function(J){return y.get([J])}}else _=function(){return y};for(var L=[],k=[],H=[],O=0;O<N;O++){H.push(L.length);var T=O-M;if(T>=0&&T<R){var V=_(T);w(V,b)||(k.push(T+A),L.push(V))}}return H.push(L.length),new i({values:L,index:k,ptr:H,size:[E,N]})},i.prototype.swapRows=function(m,y){if(!tn(m)||!fn(m)||!tn(y)||!fn(y))throw new Error("Row index must be positive integers");if(this._size.length!==2)throw new Error("Only two dimensional matrix is supported");return Kt(m,this._size[0]),Kt(y,this._size[0]),i._swapRows(m,y,this._size[1],this._values,this._index,this._ptr),this},i._forEachRow=function(m,y,g,v,x){for(var w=v[m],b=v[m+1],M=w;M<b;M++)x(g[M],y[M])},i._swapRows=function(m,y,g,v,x,w){for(var b=0;b<g;b++){var M=w[b],A=w[b+1],E=h(m,M,A,x),N=h(y,M,A,x);if(E<A&&N<A&&x[E]===m&&x[N]===y){if(v){var R=v[E];v[E]=v[N],v[N]=R}continue}if(E<A&&x[E]===m&&(N>=A||x[N]!==y)){var _=v?v[E]:void 0;x.splice(N,0,y),v&&v.splice(N,0,_),x.splice(N<=E?E+1:E,1),v&&v.splice(N<=E?E+1:E,1);continue}if(N<A&&x[N]===y&&(E>=A||x[E]!==m)){var S=v?v[N]:void 0;x.splice(E,0,m),v&&v.splice(E,0,S),x.splice(E<=N?N+1:N,1),v&&v.splice(E<=N?N+1:N,1)}}},i},{isClass:!0}),iO="number",sO=["typed"],oO=ke(iO,sO,r=>{var{typed:e}=r,t=e("number",{"":function(){return 0},number:function(i){return i},string:function(i){if(i==="NaN")return NaN;var s=Number(i);if(isNaN(s))throw new SyntaxError('String "'+i+'" is no valid number');if(["0b","0o","0x"].includes(i.substring(0,2))){if(s>2**32-1)throw new SyntaxError('String "'.concat(i,'" is out of range'));s&2147483648&&(s=-1*~(s-1))}return s},BigNumber:function(i){return i.toNumber()},Fraction:function(i){return i.valueOf()},Unit:function(i){throw new Error("Second argument with valueless unit expected")},null:function(i){return 0},"Unit, string | Unit":function(i,s){return i.toNumber(s)},"Array | Matrix":function(i){return wn(i,this)}});return t.fromJSON=function(n){return parseFloat(n.value)},t}),aO="bignumber",lO=["typed","BigNumber"],cO=ke(aO,lO,r=>{var{typed:e,BigNumber:t}=r;return e("bignumber",{"":function(){return new t(0)},number:function(i){return new t(i+"")},string:function(i){return new t(i)},BigNumber:function(i){return i},Fraction:function(i){return new t(i.n).div(i.d).times(i.s)},null:function(i){return new t(0)},"Array | Matrix":function(i){return wn(i,this)}})}),uO="fraction",hO=["typed","Fraction"],fO=ke(uO,hO,r=>{var{typed:e,Fraction:t}=r;return e("fraction",{number:function(i){if(!isFinite(i)||isNaN(i))throw new Error(i+" cannot be represented as a fraction");return new t(i)},string:function(i){return new t(i)},"number, number":function(i,s){return new t(i,s)},null:function(i){return new t(0)},BigNumber:function(i){return new t(i.toString())},Fraction:function(i){return i},Object:function(i){return new t(i)},"Array | Matrix":function(i){return wn(i,this)}})}),$M="matrix",dO=["typed","Matrix","DenseMatrix","SparseMatrix"],pO=ke($M,dO,r=>{var{typed:e,Matrix:t,DenseMatrix:n,SparseMatrix:i}=r;return e($M,{"":function(){return s([])},string:function(a){return s([],a)},"string, string":function(a,l){return s([],a,l)},Array:function(a){return s(a)},Matrix:function(a){return s(a,a.storage())},"Array | Matrix, string":s,"Array | Matrix, string, string":s});function s(o,a,l){if(a==="dense"||a==="default"||a===void 0)return new n(o,l);if(a==="sparse")return new i(o,l);throw new TypeError("Unknown matrix type "+JSON.stringify(a)+".")}}),eA="unaryMinus",mO=["typed"],gO=ke(eA,mO,r=>{var{typed:e}=r;return e(eA,{number:QM,Complex:function(n){return n.neg()},BigNumber:function(n){return n.neg()},Fraction:function(n){return n.neg()},Unit:function(n){var i=n.clone();return i.value=this(n.value),i},"Array | Matrix":function(n){return wn(n,this)}})}),tA="abs",vO=["typed"],yO=ke(tA,vO,r=>{var{typed:e}=r;return e(tA,{number:qM,Complex:function(n){return n.abs()},BigNumber:function(n){return n.abs()},Fraction:function(n){return n.abs()},"Array | Matrix":function(n){return wn(n,this)},Unit:function(n){return n.abs()}})}),nA="addScalar",xO=["typed"],wO=ke(nA,xO,r=>{var{typed:e}=r;return e(nA,{"number, number":YM,"Complex, Complex":function(n,i){return n.add(i)},"BigNumber, BigNumber":function(n,i){return n.plus(i)},"Fraction, Fraction":function(n,i){return n.add(i)},"Unit, Unit":function(n,i){if(n.value===null||n.value===void 0)throw new Error("Parameter x contains a unit with undefined value");if(i.value===null||i.value===void 0)throw new Error("Parameter y contains a unit with undefined value");if(!n.equalBase(i))throw new Error("Units do not match");var s=n.clone();return s.value=this(s.value,i.value),s.fixPrefix=!1,s}})}),bO="algorithm11",MO=["typed","equalScalar"],ul=ke(bO,MO,r=>{var{typed:e,equalScalar:t}=r;return function(i,s,o,a){var l=i._values,h=i._index,u=i._ptr,c=i._size,f=i._datatype;if(!l)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var d=c[0],p=c[1],m,y=t,g=0,v=o;typeof f=="string"&&(m=f,y=e.find(t,[m,m]),g=e.convert(0,m),s=e.convert(s,m),v=e.find(o,[m,m]));for(var x=[],w=[],b=[],M=0;M<p;M++){b[M]=w.length;for(var A=u[M],E=u[M+1],N=A;N<E;N++){var R=h[N],_=a?v(s,l[N]):v(l[N],s);y(_,g)||(w.push(R),x.push(_))}}return b[p]=w.length,i.createSparseMatrix({values:x,index:w,ptr:b,size:[d,p],datatype:m})}}),AO="algorithm14",SO=["typed"],Br=ke(AO,SO,r=>{var{typed:e}=r;return function(i,s,o,a){var l=i._data,h=i._size,u=i._datatype,c,f=o;typeof u=="string"&&(c=u,s=e.convert(s,c),f=e.find(o,[c,c]));var d=h.length>0?t(f,0,h,h[0],l,s,a):[];return i.createDenseMatrix({data:d,size:Et(h),datatype:c})};function t(n,i,s,o,a,l,h){var u=[];if(i===s.length-1)for(var c=0;c<o;c++)u[c]=h?n(l,a[c]):n(a[c],l);else for(var f=0;f<o;f++)u[f]=t(n,i+1,s,s[i+1],a[f],l,h);return u}}),EO="ceil",_O=["typed","config","round","matrix","equalScalar"],TO=ke(EO,_O,r=>{var{typed:e,config:t,round:n,matrix:i,equalScalar:s}=r,o=ul({typed:e,equalScalar:s}),a=Br({typed:e});return e("ceil",{number:function(h){return vi(h,n(h),t.epsilon)?n(h):jM(h)},"number, number":function(h,u){if(vi(h,n(h,u),t.epsilon))return n(h,u);var[c,f]="".concat(h,"e").split("e"),d=Math.ceil(Number("".concat(c,"e").concat(Number(f)+u)));return[c,f]="".concat(d,"e").split("e"),Number("".concat(c,"e").concat(Number(f)-u))},Complex:function(h){return h.ceil()},"Complex, number":function(h,u){return h.ceil(u)},BigNumber:function(h){return Do(h,n(h),t.epsilon)?n(h):h.ceil()},"BigNumber, BigNumber":function(h,u){return Do(h,n(h,u),t.epsilon)?n(h,u):h.toDecimalPlaces(u.toNumber(),Lo.ROUND_CEIL)},Fraction:function(h){return h.ceil()},"Fraction, number":function(h,u){return h.ceil(u)},"Array | Matrix":function(h){return wn(h,this)},"Array | Matrix, number":function(h,u){return wn(h,c=>this(c,u))},"SparseMatrix, number | BigNumber":function(h,u){return o(h,u,this,!1)},"DenseMatrix, number | BigNumber":function(h,u){return a(h,u,this,!1)},"number | Complex | BigNumber, Array":function(h,u){return a(i(u),h,this,!0).valueOf()}})}),CO="fix",RO=["typed","Complex","matrix","ceil","floor"],NO=ke(CO,RO,r=>{var{typed:e,Complex:t,matrix:n,ceil:i,floor:s}=r,o=Br({typed:e});return e("fix",{number:function(l){return l>0?s(l):i(l)},"number, number | BigNumber":function(l,h){return l>0?s(l,h):i(l,h)},Complex:function(l){return new t(l.re>0?Math.floor(l.re):Math.ceil(l.re),l.im>0?Math.floor(l.im):Math.ceil(l.im))},"Complex, number | BigNumber":function(l,h){return new t(l.re>0?s(l.re,h):i(l.re,h),l.im>0?s(l.im,h):i(l.im,h))},BigNumber:function(l){return l.isNegative()?i(l):s(l)},"BigNumber, number | BigNumber":function(l,h){return l.isNegative()?i(l,h):s(l,h)},Fraction:function(l){return l.s<0?l.ceil():l.floor()},"Fraction, number | BigNumber":function(l,h){return l.s<0?l.ceil(h):l.floor(h)},"Array | Matrix":function(l){return wn(l,this)},"Array | Matrix, number | BigNumber":function(l,h){return wn(l,u=>this(u,h))},"number | Complex | BigNumber, Array":function(l,h){return o(n(h),l,this,!0).valueOf()}})}),IO="floor",PO=["typed","config","round","matrix","equalScalar"],BO=ke(IO,PO,r=>{var{typed:e,config:t,round:n,matrix:i,equalScalar:s}=r,o=ul({typed:e,equalScalar:s}),a=Br({typed:e});return e("floor",{number:function(h){return vi(h,n(h),t.epsilon)?n(h):Math.floor(h)},"number, number":function(h,u){if(vi(h,n(h,u),t.epsilon))return n(h,u);var[c,f]="".concat(h,"e").split("e"),d=Math.floor(Number("".concat(c,"e").concat(Number(f)+u)));return[c,f]="".concat(d,"e").split("e"),Number("".concat(c,"e").concat(Number(f)-u))},Complex:function(h){return h.floor()},"Complex, number":function(h,u){return h.floor(u)},BigNumber:function(h){return Do(h,n(h),t.epsilon)?n(h):h.floor()},"BigNumber, BigNumber":function(h,u){return Do(h,n(h,u),t.epsilon)?n(h,u):h.toDecimalPlaces(u.toNumber(),Lo.ROUND_FLOOR)},Fraction:function(h){return h.floor()},"Fraction, number":function(h,u){return h.floor(u)},"Array | Matrix":function(h){return wn(h,this)},"Array | Matrix, number":function(h,u){return wn(h,c=>this(c,u))},"SparseMatrix, number | BigNumber":function(h,u){return o(h,u,this,!1)},"DenseMatrix, number | BigNumber":function(h,u){return a(h,u,this,!1)},"number | Complex | BigNumber, Array":function(h,u){return a(i(u),h,this,!0).valueOf()}})}),LO="algorithm01",DO=["typed"],rA=ke(LO,DO,r=>{var{typed:e}=r;return function(n,i,s,o){var a=n._data,l=n._size,h=n._datatype,u=i._values,c=i._index,f=i._ptr,d=i._size,p=i._datatype;if(l.length!==d.length)throw new gt(l.length,d.length);if(l[0]!==d[0]||l[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+d+")");if(!u)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var m=l[0],y=l[1],g=typeof h=="string"&&h===p?h:void 0,v=g?e.find(s,[g,g]):s,x,w,b=[];for(x=0;x<m;x++)b[x]=[];var M=[],A=[];for(w=0;w<y;w++){for(var E=w+1,N=f[w],R=f[w+1],_=N;_<R;_++)x=c[_],M[x]=o?v(u[_],a[x][w]):v(a[x][w],u[_]),A[x]=E;for(x=0;x<m;x++)A[x]===E?b[x][w]=M[x]:b[x][w]=a[x][w]}return n.createDenseMatrix({data:b,size:[m,y],datatype:g})}}),FO="algorithm04",OO=["typed","equalScalar"],zO=ke(FO,OO,r=>{var{typed:e,equalScalar:t}=r;return function(i,s,o){var a=i._values,l=i._index,h=i._ptr,u=i._size,c=i._datatype,f=s._values,d=s._index,p=s._ptr,m=s._size,y=s._datatype;if(u.length!==m.length)throw new gt(u.length,m.length);if(u[0]!==m[0]||u[1]!==m[1])throw new RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+m+")");var g=u[0],v=u[1],x,w=t,b=0,M=o;typeof c=="string"&&c===y&&(x=c,w=e.find(t,[x,x]),b=e.convert(0,x),M=e.find(o,[x,x]));var A=a&&f?[]:void 0,E=[],N=[],R=a&&f?[]:void 0,_=a&&f?[]:void 0,S=[],L=[],k,H,O,T,V;for(H=0;H<v;H++){N[H]=E.length;var F=H+1;for(T=h[H],V=h[H+1],O=T;O<V;O++)k=l[O],E.push(k),S[k]=F,R&&(R[k]=a[O]);for(T=p[H],V=p[H+1],O=T;O<V;O++)if(k=d[O],S[k]===F){if(R){var J=M(R[k],f[O]);w(J,b)?S[k]=null:R[k]=J}}else E.push(k),L[k]=F,_&&(_[k]=f[O]);if(R&&_)for(O=N[H];O<E.length;)k=E[O],S[k]===F?(A[O]=R[k],O++):L[k]===F?(A[O]=_[k],O++):E.splice(O,1)}return N[v]=E.length,i.createSparseMatrix({values:A,index:E,ptr:N,size:[g,v],datatype:x})}}),UO="algorithm10",HO=["typed","DenseMatrix"],iA=ke(UO,HO,r=>{var{typed:e,DenseMatrix:t}=r;return function(i,s,o,a){var l=i._values,h=i._index,u=i._ptr,c=i._size,f=i._datatype;if(!l)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var d=c[0],p=c[1],m,y=o;typeof f=="string"&&(m=f,s=e.convert(s,m),y=e.find(o,[m,m]));for(var g=[],v=[],x=[],w=0;w<p;w++){for(var b=w+1,M=u[w],A=u[w+1],E=M;E<A;E++){var N=h[E];v[N]=l[E],x[N]=b}for(var R=0;R<d;R++)w===0&&(g[R]=[]),x[R]===b?g[R][w]=a?y(s,v[R]):y(v[R],s):g[R][w]=s}return new t({data:g,size:[d,p],datatype:m})}}),GO="algorithm13",kO=["typed"],hl=ke(GO,kO,r=>{var{typed:e}=r;return function(i,s,o){var a=i._data,l=i._size,h=i._datatype,u=s._data,c=s._size,f=s._datatype,d=[];if(l.length!==c.length)throw new gt(l.length,c.length);for(var p=0;p<l.length;p++){if(l[p]!==c[p])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+c+")");d[p]=l[p]}var m,y=o;typeof h=="string"&&h===f&&(m=h,y=e.find(o,[m,m]));var g=d.length>0?t(y,0,d,d[0],a,u):[];return i.createDenseMatrix({data:g,size:d,datatype:m})};function t(n,i,s,o,a,l){var h=[];if(i===s.length-1)for(var u=0;u<o;u++)h[u]=n(a[u],l[u]);else for(var c=0;c<o;c++)h[c]=t(n,i+1,s,s[i+1],a[c],l[c]);return h}}),VO="algorithm02",WO=["typed","equalScalar"],qO=ke(VO,WO,r=>{var{typed:e,equalScalar:t}=r;return function(i,s,o,a){var l=i._data,h=i._size,u=i._datatype,c=s._values,f=s._index,d=s._ptr,p=s._size,m=s._datatype;if(h.length!==p.length)throw new gt(h.length,p.length);if(h[0]!==p[0]||h[1]!==p[1])throw new RangeError("Dimension mismatch. Matrix A ("+h+") must match Matrix B ("+p+")");if(!c)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var y=h[0],g=h[1],v,x=t,w=0,b=o;typeof u=="string"&&u===m&&(v=u,x=e.find(t,[v,v]),w=e.convert(0,v),b=e.find(o,[v,v]));for(var M=[],A=[],E=[],N=0;N<g;N++){E[N]=A.length;for(var R=d[N],_=d[N+1],S=R;S<_;S++){var L=f[S],k=a?b(c[S],l[L][N]):b(l[L][N],c[S]);x(k,w)||(A.push(L),M.push(k))}}return E[g]=A.length,s.createSparseMatrix({values:M,index:A,ptr:E,size:[y,g],datatype:v})}}),YO="algorithm03",XO=["typed"],zc=ke(YO,XO,r=>{var{typed:e}=r;return function(n,i,s,o){var a=n._data,l=n._size,h=n._datatype,u=i._values,c=i._index,f=i._ptr,d=i._size,p=i._datatype;if(l.length!==d.length)throw new gt(l.length,d.length);if(l[0]!==d[0]||l[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+d+")");if(!u)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var m=l[0],y=l[1],g,v=0,x=s;typeof h=="string"&&h===p&&(g=h,v=e.convert(0,g),x=e.find(s,[g,g]));for(var w=[],b=0;b<m;b++)w[b]=[];for(var M=[],A=[],E=0;E<y;E++){for(var N=E+1,R=f[E],_=f[E+1],S=R;S<_;S++){var L=c[S];M[L]=o?x(u[S],a[L][E]):x(a[L][E],u[S]),A[L]=N}for(var k=0;k<m;k++)A[k]===N?w[k][E]=M[k]:w[k][E]=o?x(v,a[k][E]):x(a[k][E],v)}return n.createDenseMatrix({data:w,size:[m,y],datatype:g})}}),QO="algorithm05",jO=["typed","equalScalar"],sA=ke(QO,jO,r=>{var{typed:e,equalScalar:t}=r;return function(i,s,o){var a=i._values,l=i._index,h=i._ptr,u=i._size,c=i._datatype,f=s._values,d=s._index,p=s._ptr,m=s._size,y=s._datatype;if(u.length!==m.length)throw new gt(u.length,m.length);if(u[0]!==m[0]||u[1]!==m[1])throw new RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+m+")");var g=u[0],v=u[1],x,w=t,b=0,M=o;typeof c=="string"&&c===y&&(x=c,w=e.find(t,[x,x]),b=e.convert(0,x),M=e.find(o,[x,x]));var A=a&&f?[]:void 0,E=[],N=[],R=A?[]:void 0,_=A?[]:void 0,S=[],L=[],k,H,O,T;for(H=0;H<v;H++){N[H]=E.length;var V=H+1;for(O=h[H],T=h[H+1];O<T;O++)k=l[O],E.push(k),S[k]=V,R&&(R[k]=a[O]);for(O=p[H],T=p[H+1];O<T;O++)k=d[O],S[k]!==V&&E.push(k),L[k]=V,_&&(_[k]=f[O]);if(A)for(O=N[H];O<E.length;){k=E[O];var F=S[k],J=L[k];if(F===V||J===V){var Y=F===V?R[k]:b,te=J===V?_[k]:b,z=M(Y,te);w(z,b)?E.splice(O,1):(A.push(z),O++)}}}return N[v]=E.length,i.createSparseMatrix({values:A,index:E,ptr:N,size:[g,v],datatype:x})}}),ZO="algorithm12",JO=["typed","DenseMatrix"],Uc=ke(ZO,JO,r=>{var{typed:e,DenseMatrix:t}=r;return function(i,s,o,a){var l=i._values,h=i._index,u=i._ptr,c=i._size,f=i._datatype;if(!l)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var d=c[0],p=c[1],m,y=o;typeof f=="string"&&(m=f,s=e.convert(s,m),y=e.find(o,[m,m]));for(var g=[],v=[],x=[],w=0;w<p;w++){for(var b=w+1,M=u[w],A=u[w+1],E=M;E<A;E++){var N=h[E];v[N]=l[E],x[N]=b}for(var R=0;R<d;R++)w===0&&(g[R]=[]),x[R]===b?g[R][w]=a?y(s,v[R]):y(v[R],s):g[R][w]=a?y(s,0):y(0,s)}return new t({data:g,size:[d,p],datatype:m})}}),oA="mod",KO=["typed","matrix","equalScalar","DenseMatrix"],$O=ke(oA,KO,r=>{var{typed:e,matrix:t,equalScalar:n,DenseMatrix:i}=r,s=qO({typed:e,equalScalar:n}),o=zc({typed:e}),a=sA({typed:e,equalScalar:n}),l=ul({typed:e,equalScalar:n}),h=Uc({typed:e,DenseMatrix:i}),u=hl({typed:e}),c=Br({typed:e});return e(oA,{"number, number":ZM,"BigNumber, BigNumber":function(d,p){if(p.isNeg())throw new Error("Cannot calculate mod for a negative divisor");return p.isZero()?d:d.mod(p)},"Fraction, Fraction":function(d,p){if(p.compare(0)<0)throw new Error("Cannot calculate mod for a negative divisor");return d.compare(0)>=0?d.mod(p):d.mod(p).add(p).mod(p)},"SparseMatrix, SparseMatrix":function(d,p){return a(d,p,this,!1)},"SparseMatrix, DenseMatrix":function(d,p){return s(p,d,this,!0)},"DenseMatrix, SparseMatrix":function(d,p){return o(d,p,this,!1)},"DenseMatrix, DenseMatrix":function(d,p){return u(d,p,this)},"Array, Array":function(d,p){return this(t(d),t(p)).valueOf()},"Array, Matrix":function(d,p){return this(t(d),p)},"Matrix, Array":function(d,p){return this(d,t(p))},"SparseMatrix, any":function(d,p){return l(d,p,this,!1)},"DenseMatrix, any":function(d,p){return c(d,p,this,!1)},"any, SparseMatrix":function(d,p){return h(p,d,this,!0)},"any, DenseMatrix":function(d,p){return c(p,d,this,!0)},"Array, any":function(d,p){return c(t(d),p,this,!1).valueOf()},"any, Array":function(d,p){return c(t(p),d,this,!0).valueOf()}})}),ez="multiplyScalar",tz=["typed"],nz=ke(ez,tz,r=>{var{typed:e}=r;return e("multiplyScalar",{"number, number":XM,"Complex, Complex":function(n,i){return n.mul(i)},"BigNumber, BigNumber":function(n,i){return n.times(i)},"Fraction, Fraction":function(n,i){return n.mul(i)},"number | Fraction | BigNumber | Complex, Unit":function(n,i){var s=i.clone();return s.value=s.value===null?s._normalize(n):this(s.value,n),s},"Unit, number | Fraction | BigNumber | Complex":function(n,i){var s=n.clone();return s.value=s.value===null?s._normalize(i):this(s.value,i),s},"Unit, Unit":function(n,i){return n.multiply(i)}})}),aA="multiply",rz=["typed","matrix","addScalar","multiplyScalar","equalScalar","dot"],iz=ke(aA,rz,r=>{var{typed:e,matrix:t,addScalar:n,multiplyScalar:i,equalScalar:s,dot:o}=r,a=ul({typed:e,equalScalar:s}),l=Br({typed:e});function h(b,M){switch(b.length){case 1:switch(M.length){case 1:if(b[0]!==M[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(b[0]!==M[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+b[0]+") must match Matrix rows ("+M[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+M.length+" dimensions)")}break;case 2:switch(M.length){case 1:if(b[1]!==M[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+b[1]+") must match Vector length ("+M[0]+")");break;case 2:if(b[1]!==M[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+b[1]+") must match Matrix B rows ("+M[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+M.length+" dimensions)")}break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+b.length+" dimensions)")}}function u(b,M,A){if(A===0)throw new Error("Cannot multiply two empty vectors");return o(b,M)}function c(b,M){if(M.storage()!=="dense")throw new Error("Support for SparseMatrix not implemented");return f(b,M)}function f(b,M){var A=b._data,E=b._size,N=b._datatype,R=M._data,_=M._size,S=M._datatype,L=E[0],k=_[1],H,O=n,T=i;N&&S&&N===S&&typeof N=="string"&&(H=N,O=e.find(n,[H,H]),T=e.find(i,[H,H]));for(var V=[],F=0;F<k;F++){for(var J=T(A[0],R[0][F]),Y=1;Y<L;Y++)J=O(J,T(A[Y],R[Y][F]));V[F]=J}return b.createDenseMatrix({data:V,size:[k],datatype:H})}var d=e("_multiplyMatrixVector",{"DenseMatrix, any":m,"SparseMatrix, any":v}),p=e("_multiplyMatrixMatrix",{"DenseMatrix, DenseMatrix":y,"DenseMatrix, SparseMatrix":g,"SparseMatrix, DenseMatrix":x,"SparseMatrix, SparseMatrix":w});function m(b,M){var A=b._data,E=b._size,N=b._datatype,R=M._data,_=M._datatype,S=E[0],L=E[1],k,H=n,O=i;N&&_&&N===_&&typeof N=="string"&&(k=N,H=e.find(n,[k,k]),O=e.find(i,[k,k]));for(var T=[],V=0;V<S;V++){for(var F=A[V],J=O(F[0],R[0]),Y=1;Y<L;Y++)J=H(J,O(F[Y],R[Y]));T[V]=J}return b.createDenseMatrix({data:T,size:[S],datatype:k})}function y(b,M){var A=b._data,E=b._size,N=b._datatype,R=M._data,_=M._size,S=M._datatype,L=E[0],k=E[1],H=_[1],O,T=n,V=i;N&&S&&N===S&&typeof N=="string"&&(O=N,T=e.find(n,[O,O]),V=e.find(i,[O,O]));for(var F=[],J=0;J<L;J++){var Y=A[J];F[J]=[];for(var te=0;te<H;te++){for(var z=V(Y[0],R[0][te]),K=1;K<k;K++)z=T(z,V(Y[K],R[K][te]));F[J][te]=z}}return b.createDenseMatrix({data:F,size:[L,H],datatype:O})}function g(b,M){var A=b._data,E=b._size,N=b._datatype,R=M._values,_=M._index,S=M._ptr,L=M._size,k=M._datatype;if(!R)throw new Error("Cannot multiply Dense Matrix times Pattern only Matrix");var H=E[0],O=L[1],T,V=n,F=i,J=s,Y=0;N&&k&&N===k&&typeof N=="string"&&(T=N,V=e.find(n,[T,T]),F=e.find(i,[T,T]),J=e.find(s,[T,T]),Y=e.convert(0,T));for(var te=[],z=[],K=[],Z=M.createSparseMatrix({values:te,index:z,ptr:K,size:[H,O],datatype:T}),Q=0;Q<O;Q++){K[Q]=z.length;var me=S[Q],ge=S[Q+1];if(ge>me)for(var se=0,he=0;he<H;he++){for(var xe=he+1,pe=void 0,G=me;G<ge;G++){var q=_[G];se!==xe?(pe=F(A[he][q],R[G]),se=xe):pe=V(pe,F(A[he][q],R[G]))}se===xe&&!J(pe,Y)&&(z.push(he),te.push(pe))}}return K[O]=z.length,Z}function v(b,M){var A=b._values,E=b._index,N=b._ptr,R=b._datatype;if(!A)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var _=M._data,S=M._datatype,L=b._size[0],k=M._size[0],H=[],O=[],T=[],V,F=n,J=i,Y=s,te=0;R&&S&&R===S&&typeof R=="string"&&(V=R,F=e.find(n,[V,V]),J=e.find(i,[V,V]),Y=e.find(s,[V,V]),te=e.convert(0,V));var z=[],K=[];T[0]=0;for(var Z=0;Z<k;Z++){var Q=_[Z];if(!Y(Q,te))for(var me=N[Z],ge=N[Z+1],se=me;se<ge;se++){var he=E[se];K[he]?z[he]=F(z[he],J(Q,A[se])):(K[he]=!0,O.push(he),z[he]=J(Q,A[se]))}}for(var xe=O.length,pe=0;pe<xe;pe++){var G=O[pe];H[pe]=z[G]}return T[1]=O.length,b.createSparseMatrix({values:H,index:O,ptr:T,size:[L,1],datatype:V})}function x(b,M){var A=b._values,E=b._index,N=b._ptr,R=b._datatype;if(!A)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var _=M._data,S=M._datatype,L=b._size[0],k=M._size[0],H=M._size[1],O,T=n,V=i,F=s,J=0;R&&S&&R===S&&typeof R=="string"&&(O=R,T=e.find(n,[O,O]),V=e.find(i,[O,O]),F=e.find(s,[O,O]),J=e.convert(0,O));for(var Y=[],te=[],z=[],K=b.createSparseMatrix({values:Y,index:te,ptr:z,size:[L,H],datatype:O}),Z=[],Q=[],me=0;me<H;me++){z[me]=te.length;for(var ge=me+1,se=0;se<k;se++){var he=_[se][me];if(!F(he,J))for(var xe=N[se],pe=N[se+1],G=xe;G<pe;G++){var q=E[G];Q[q]!==ge?(Q[q]=ge,te.push(q),Z[q]=V(he,A[G])):Z[q]=T(Z[q],V(he,A[G]))}}for(var B=z[me],D=te.length,$=B;$<D;$++){var ne=te[$];Y[$]=Z[ne]}}return z[H]=te.length,K}function w(b,M){var A=b._values,E=b._index,N=b._ptr,R=b._datatype,_=M._values,S=M._index,L=M._ptr,k=M._datatype,H=b._size[0],O=M._size[1],T=A&&_,V,F=n,J=i;R&&k&&R===k&&typeof R=="string"&&(V=R,F=e.find(n,[V,V]),J=e.find(i,[V,V]));for(var Y=T?[]:void 0,te=[],z=[],K=b.createSparseMatrix({values:Y,index:te,ptr:z,size:[H,O],datatype:V}),Z=T?[]:void 0,Q=[],me,ge,se,he,xe,pe,G,q,B=0;B<O;B++){z[B]=te.length;var D=B+1;for(xe=L[B],pe=L[B+1],he=xe;he<pe;he++)if(q=S[he],T)for(ge=N[q],se=N[q+1],me=ge;me<se;me++)G=E[me],Q[G]!==D?(Q[G]=D,te.push(G),Z[G]=J(_[he],A[me])):Z[G]=F(Z[G],J(_[he],A[me]));else for(ge=N[q],se=N[q+1],me=ge;me<se;me++)G=E[me],Q[G]!==D&&(Q[G]=D,te.push(G));if(T)for(var $=z[B],ne=te.length,U=$;U<ne;U++){var W=te[U];Y[U]=Z[W]}}return z[O]=te.length,K}return e(aA,Cg({"Array, Array":function(M,A){h(Ir(M),Ir(A));var E=this(t(M),t(A));return hn(E)?E.valueOf():E},"Matrix, Matrix":function(M,A){var E=M.size(),N=A.size();return h(E,N),E.length===1?N.length===1?u(M,A,E[0]):c(M,A):N.length===1?d(M,A):p(M,A)},"Matrix, Array":function(M,A){return this(M,t(A))},"Array, Matrix":function(M,A){return this(t(M,A.storage()),A)},"SparseMatrix, any":function(M,A){return a(M,A,i,!1)},"DenseMatrix, any":function(M,A){return l(M,A,i,!1)},"any, SparseMatrix":function(M,A){return a(A,M,i,!0)},"any, DenseMatrix":function(M,A){return l(A,M,i,!0)},"Array, any":function(M,A){return l(t(M),A,i,!1).valueOf()},"any, Array":function(M,A){return l(t(A),M,i,!0).valueOf()},"any, any":i,"any, any, ...any":function(M,A,E){for(var N=this(M,A),R=0;R<E.length;R++)N=this(N,E[R]);return N}},i.signatures))}),lA="subtract",sz=["typed","matrix","equalScalar","addScalar","unaryMinus","DenseMatrix"],oz=ke(lA,sz,r=>{var{typed:e,matrix:t,equalScalar:n,addScalar:i,unaryMinus:s,DenseMatrix:o}=r,a=rA({typed:e}),l=zc({typed:e}),h=sA({typed:e,equalScalar:n}),u=iA({typed:e,DenseMatrix:o}),c=hl({typed:e}),f=Br({typed:e});return e(lA,{"number, number":function(p,m){return p-m},"Complex, Complex":function(p,m){return p.sub(m)},"BigNumber, BigNumber":function(p,m){return p.minus(m)},"Fraction, Fraction":function(p,m){return p.sub(m)},"Unit, Unit":function(p,m){if(p.value===null)throw new Error("Parameter x contains a unit with undefined value");if(m.value===null)throw new Error("Parameter y contains a unit with undefined value");if(!p.equalBase(m))throw new Error("Units do not match");var y=p.clone();return y.value=this(y.value,m.value),y.fixPrefix=!1,y},"SparseMatrix, SparseMatrix":function(p,m){return Bf(p,m),h(p,m,this)},"SparseMatrix, DenseMatrix":function(p,m){return Bf(p,m),l(m,p,this,!0)},"DenseMatrix, SparseMatrix":function(p,m){return Bf(p,m),a(p,m,this,!1)},"DenseMatrix, DenseMatrix":function(p,m){return Bf(p,m),c(p,m,this)},"Array, Array":function(p,m){return this(t(p),t(m)).valueOf()},"Array, Matrix":function(p,m){return this(t(p),m)},"Matrix, Array":function(p,m){return this(p,t(m))},"SparseMatrix, any":function(p,m){return u(p,s(m),i)},"DenseMatrix, any":function(p,m){return f(p,m,this)},"any, SparseMatrix":function(p,m){return u(m,p,this,!0)},"any, DenseMatrix":function(p,m){return f(m,p,this,!0)},"Array, any":function(p,m){return f(t(p),m,this,!1).valueOf()},"any, Array":function(p,m){return f(t(m),p,this,!0).valueOf()}})});function Bf(r,e){var t=r.size(),n=e.size();if(t.length!==n.length)throw new gt(t.length,n.length)}var az="algorithm07",lz=["typed","DenseMatrix"],Hg=ke(az,lz,r=>{var{typed:e,DenseMatrix:t}=r;return function(s,o,a){var l=s._size,h=s._datatype,u=o._size,c=o._datatype;if(l.length!==u.length)throw new gt(l.length,u.length);if(l[0]!==u[0]||l[1]!==u[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+u+")");var f=l[0],d=l[1],p,m=0,y=a;typeof h=="string"&&h===c&&(p=h,m=e.convert(0,p),y=e.find(a,[p,p]));var g,v,x=[];for(g=0;g<f;g++)x[g]=[];var w=[],b=[],M=[],A=[];for(v=0;v<d;v++){var E=v+1;for(n(s,v,M,w,E),n(o,v,A,b,E),g=0;g<f;g++){var N=M[g]===E?w[g]:m,R=A[g]===E?b[g]:m;x[g][v]=y(N,R)}}return new t({data:x,size:[f,d],datatype:p})};function n(i,s,o,a,l){for(var h=i._values,u=i._index,c=i._ptr,f=c[s],d=c[s+1];f<d;f++){var p=u[f];o[p]=l,a[p]=h[f]}}}),cA="conj",cz=["typed"],uz=ke(cA,cz,r=>{var{typed:e}=r;return e(cA,{number:function(n){return n},BigNumber:function(n){return n},Complex:function(n){return n.conjugate()},"Array | Matrix":function(n){return wn(n,this)}})});function hz(r){var e=0,t=1,n=Object.create(null),i=Object.create(null),s=0,o=function(l){var h=i[l];if(!!h&&(delete n[h],delete i[l],--e,t===h)){if(!e){s=0,t=1;return}for(;!hasOwnProperty.call(n,++t););}};return r=Math.abs(r),{hit:function(l){var h=i[l],u=++s;if(n[u]=l,i[l]=u,!h)return++e,e<=r?void 0:(l=n[t],o(l),l);if(delete n[h],t===h)for(;!hasOwnProperty.call(n,++t););},delete:o,clear:function(){e=s=0,t=1,n=Object.create(null),i=Object.create(null)}}}function Hc(r){var{hasher:e,limit:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return t=t==null?Number.POSITIVE_INFINITY:t,e=e==null?JSON.stringify:e,function n(){typeof n.cache!="object"&&(n.cache={values:new Map,lru:hz(t||Number.POSITIVE_INFINITY)});for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];var o=e(i);if(n.cache.values.has(o))return n.cache.lru.hit(o),n.cache.values.get(o);var a=r.apply(r,i);return n.cache.values.set(o,a),n.cache.values.delete(n.cache.lru.hit(o)),a}}var uA="identity",fz=["typed","config","matrix","BigNumber","DenseMatrix","SparseMatrix"],dz=ke(uA,fz,r=>{var{typed:e,config:t,matrix:n,BigNumber:i,DenseMatrix:s,SparseMatrix:o}=r;return e(uA,{"":function(){return t.matrix==="Matrix"?n([]):[]},string:function(u){return n(u)},"number | BigNumber":function(u){return l(u,u,t.matrix==="Matrix"?"dense":void 0)},"number | BigNumber, string":function(u,c){return l(u,u,c)},"number | BigNumber, number | BigNumber":function(u,c){return l(u,c,t.matrix==="Matrix"?"dense":void 0)},"number | BigNumber, number | BigNumber, string":function(u,c,f){return l(u,c,f)},Array:function(u){return a(u)},"Array, string":function(u,c){return a(u,c)},Matrix:function(u){return a(u.valueOf(),u.storage())},"Matrix, string":function(u,c){return a(u.valueOf(),c)}});function a(h,u){switch(h.length){case 0:return u?n(u):[];case 1:return l(h[0],h[0],u);case 2:return l(h[0],h[1],u);default:throw new Error("Vector containing two values expected")}}function l(h,u,c){var f=Wt(h)||Wt(u)?i:null;if(Wt(h)&&(h=h.toNumber()),Wt(u)&&(u=u.toNumber()),!fn(h)||h<1)throw new Error("Parameters in function identity must be positive integers");if(!fn(u)||u<1)throw new Error("Parameters in function identity must be positive integers");var d=f?new i(1):1,p=f?new f(0):0,m=[h,u];if(c){if(c==="sparse")return o.diagonal(m,d,0,p);if(c==="dense")return s.diagonal(m,d,0,p);throw new TypeError('Unknown matrix type "'.concat(c,'"'))}for(var y=Mf([],m,p),g=h<u?h:u,v=0;v<g;v++)y[v][v]=d;return y}});function pz(){throw new Error('No "bignumber" implementation available')}function mz(){throw new Error('No "fraction" implementation available')}function gz(){throw new Error('No "matrix" implementation available')}function Fo(r,e,t,n){if(!(this instanceof Fo))throw new SyntaxError("Constructor must be called with the new operator");this.fn=r,this.count=e,this.min=t,this.max=n,this.message="Wrong number of arguments in function "+r+" ("+e+" provided, "+t+(n!=null?"-"+n:"")+" expected)",this.stack=new Error().stack}Fo.prototype=new Error;Fo.prototype.constructor=Error;Fo.prototype.name="ArgumentsError";Fo.prototype.isArgumentsError=!0;var hA="size",vz=["typed","config","?matrix"],yz=ke(hA,vz,r=>{var{typed:e,config:t,matrix:n}=r;return e(hA,{Matrix:function(s){return s.create(s.size())},Array:Ir,string:function(s){return t.matrix==="Array"?[s.length]:n([s.length])},"number | Complex | BigNumber | Unit | boolean | null":function(s){return t.matrix==="Array"?[]:n?n([]):gz()}})});function $n(r,e){if(fA(r)&&Gg(r,e))return r[e];throw typeof r[e]=="function"&&kg(r,e)?new Error('Cannot access method "'+e+'" as a property'):new Error('No access to property "'+e+'"')}function Oo(r,e,t){if(fA(r)&&Gg(r,e))return r[e]=t,t;throw new Error('No access to property "'+e+'"')}function Gg(r,e){return!r||typeof r!="object"?!1:Je(wz,e)?!0:!(e in Object.prototype||e in Function.prototype)}function xz(r,e){if(!kg(r,e))throw new Error('No access to method "'+e+'"')}function kg(r,e){return r==null||typeof r[e]!="function"||Je(r,e)&&Object.getPrototypeOf&&e in Object.getPrototypeOf(r)?!1:Je(bz,e)?!0:!(e in Object.prototype||e in Function.prototype)}function fA(r){return typeof r=="object"&&r&&r.constructor===Object}var wz={length:!0,name:!0},bz={toString:!0,valueOf:!0,toLocaleString:!0},dA="subset",Mz=["typed","matrix"],Az=ke(dA,Mz,r=>{var{typed:e,matrix:t}=r;return e(dA,{"Array, Index":function(i,s){var o=t(i),a=o.subset(s);return s.isScalar()?a:a.valueOf()},"Matrix, Index":function(i,s){return i.subset(s)},"Object, Index":Ez,"string, Index":Sz,"Array, Index, any":function(i,s,o){return t(Et(i)).subset(s,o,void 0).valueOf()},"Array, Index, any, any":function(i,s,o,a){return t(Et(i)).subset(s,o,a).valueOf()},"Matrix, Index, any":function(i,s,o){return i.clone().subset(s,o)},"Matrix, Index, any, any":function(i,s,o,a){return i.clone().subset(s,o,a)},"string, Index, string":pA,"string, Index, string, string":pA,"Object, Index, any":_z})});function Sz(r,e){if(!rl(e))throw new TypeError("Index expected");if(e.size().length!==1)throw new gt(e.size().length,1);var t=r.length;Kt(e.min()[0],t),Kt(e.max()[0],t);var n=e.dimension(0),i="";return n.forEach(function(s){i+=r.charAt(s)}),i}function pA(r,e,t,n){if(!e||e.isIndex!==!0)throw new TypeError("Index expected");if(e.size().length!==1)throw new gt(e.size().length,1);if(n!==void 0){if(typeof n!="string"||n.length!==1)throw new TypeError("Single character expected as defaultValue")}else n=" ";var i=e.dimension(0),s=i.size()[0];if(s!==t.length)throw new gt(i.size()[0],t.length);var o=r.length;Kt(e.min()[0]),Kt(e.max()[0]);for(var a=[],l=0;l<o;l++)a[l]=r.charAt(l);if(i.forEach(function(c,f){a[c]=t.charAt(f[0])}),a.length>o)for(var h=o-1,u=a.length;h<u;h++)a[h]||(a[h]=n);return a.join("")}function Ez(r,e){if(e.size().length!==1)throw new gt(e.size(),1);var t=e.dimension(0);if(typeof t!="string")throw new TypeError("String expected as index to retrieve an object property");return $n(r,t)}function _z(r,e,t){if(e.size().length!==1)throw new gt(e.size(),1);var n=e.dimension(0);if(typeof n!="string")throw new TypeError("String expected as index to retrieve an object property");var i=Et(r);return Oo(i,n,t),i}var mA="zeros",Tz=["typed","config","matrix","BigNumber"],Cz=ke(mA,Tz,r=>{var{typed:e,config:t,matrix:n,BigNumber:i}=r;return e(mA,{"":function(){return t.matrix==="Array"?s([]):s([],"default")},"...number | BigNumber | string":function(h){var u=h[h.length-1];if(typeof u=="string"){var c=h.pop();return s(h,c)}else return t.matrix==="Array"?s(h):s(h,"default")},Array:s,Matrix:function(h){var u=h.storage();return s(h.valueOf(),u)},"Array | Matrix, string":function(h,u){return s(h.valueOf(),u)}});function s(l,h){var u=o(l),c=u?new i(0):0;if(a(l),h){var f=n(h);return l.length>0?f.resize(l,c):f}else{var d=[];return l.length>0?Mf(d,l,c):d}}function o(l){var h=!1;return l.forEach(function(u,c,f){Wt(u)&&(h=!0,f[c]=u.toNumber())}),h}function a(l){l.forEach(function(h){if(typeof h!="number"||!fn(h)||h<0)throw new Error("Parameters in function zeros must be positive integers")})}}),gA="format",Rz=["typed"],Nz=ke(gA,Rz,r=>{var{typed:e}=r;return e(gA,{any:rn,"any, Object | function | number":rn})}),Iz="numeric",Pz=["number","?bignumber","?fraction"],Bz=ke(Iz,Pz,r=>{var{number:e,bignumber:t,fraction:n}=r,i={string:!0,number:!0,BigNumber:!0,Fraction:!0},s={number:o=>e(o),BigNumber:t?o=>t(o):pz,Fraction:n?o=>n(o):mz};return function(a,l){var h=Kn(a);if(!(h in i))throw new TypeError("Cannot convert "+a+' of type "'+h+'"; valid input types are '+Object.keys(i).join(", "));if(!(l in s))throw new TypeError("Cannot convert "+a+' to type "'+l+'"; valid output types are '+Object.keys(s).join(", "));return l===h?a:s[l](a)}}),vA="divideScalar",Lz=["typed","numeric"],Dz=ke(vA,Lz,r=>{var{typed:e,numeric:t}=r;return e(vA,{"number, number":function(i,s){return i/s},"Complex, Complex":function(i,s){return i.div(s)},"BigNumber, BigNumber":function(i,s){return i.div(s)},"Fraction, Fraction":function(i,s){return i.div(s)},"Unit, number | Fraction | BigNumber":function(i,s){var o=i.clone(),a=t(1,Kn(s));return o.value=this(o.value===null?o._normalize(a):o.value,s),o},"number | Fraction | BigNumber, Unit":function(i,s){var o=s.clone();o=o.pow(-1);var a=t(1,Kn(i));return o.value=this(i,s.value===null?s._normalize(a):s.value),o},"Unit, Unit":function(i,s){return i.divide(s)}})}),yA="pow",Fz=["typed","config","identity","multiply","matrix","fraction","number","Complex"],Oz=ke(yA,Fz,r=>{var{typed:e,config:t,identity:n,multiply:i,matrix:s,number:o,fraction:a,Complex:l}=r;return e(yA,{"number, number":h,"Complex, Complex":function(d,p){return d.pow(p)},"BigNumber, BigNumber":function(d,p){return p.isInteger()||d>=0||t.predictable?d.pow(p):new l(d.toNumber(),0).pow(p.toNumber(),0)},"Fraction, Fraction":function(d,p){if(p.d!==1){if(t.predictable)throw new Error("Function pow does not support non-integer exponents for fractions.");return h(d.valueOf(),p.valueOf())}else return d.pow(p)},"Array, number":u,"Array, BigNumber":function(d,p){return u(d,p.toNumber())},"Matrix, number":c,"Matrix, BigNumber":function(d,p){return c(d,p.toNumber())},"Unit, number | BigNumber":function(d,p){return d.pow(p)}});function h(f,d){if(t.predictable&&!fn(d)&&f<0)try{var p=a(d),m=o(p);if((d===m||Math.abs((d-m)/d)<1e-14)&&p.d%2==1)return(p.n%2==0?1:-1)*Math.pow(-f,d)}catch{}return t.predictable&&(f<-1&&d===1/0||f>-1&&f<0&&d===-1/0)?NaN:fn(d)||f>=0||t.predictable?JM(f,d):f*f<1&&d===1/0||f*f>1&&d===-1/0?0:new l(f,0).pow(d,0)}function u(f,d){if(!fn(d)||d<0)throw new TypeError("For A^b, b must be a positive integer (value is "+d+")");var p=Ir(f);if(p.length!==2)throw new Error("For A^b, A must be 2 dimensional (A has "+p.length+" dimensions)");if(p[0]!==p[1])throw new Error("For A^b, A must be square (size is "+p[0]+"x"+p[1]+")");for(var m=n(p[0]).valueOf(),y=f;d>=1;)(d&1)==1&&(m=i(y,m)),d>>=1,y=i(y,y);return m}function c(f,d){return s(u(f.valueOf(),d))}});function xA(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function wA(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?xA(Object(t),!0).forEach(function(n){zz(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):xA(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function zz(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}var fl="Number of decimals in function round must be an integer",bA="round",Uz=["typed","matrix","equalScalar","zeros","BigNumber","DenseMatrix"],Hz=ke(bA,Uz,r=>{var{typed:e,matrix:t,equalScalar:n,zeros:i,BigNumber:s,DenseMatrix:o}=r,a=ul({typed:e,equalScalar:n}),l=Uc({typed:e,DenseMatrix:o}),h=Br({typed:e});return e(bA,wA(wA({},Gz),{},{Complex:function(c){return c.round()},"Complex, number":function(c,f){if(f%1)throw new TypeError(fl);return c.round(f)},"Complex, BigNumber":function(c,f){if(!f.isInteger())throw new TypeError(fl);var d=f.toNumber();return c.round(d)},"number, BigNumber":function(c,f){if(!f.isInteger())throw new TypeError(fl);return new s(c).toDecimalPlaces(f.toNumber())},BigNumber:function(c){return c.toDecimalPlaces(0)},"BigNumber, BigNumber":function(c,f){if(!f.isInteger())throw new TypeError(fl);return c.toDecimalPlaces(f.toNumber())},Fraction:function(c){return c.round()},"Fraction, number":function(c,f){if(f%1)throw new TypeError(fl);return c.round(f)},"Array | Matrix":function(c){return wn(c,this)},"SparseMatrix, number | BigNumber":function(c,f){return a(c,f,this,!1)},"DenseMatrix, number | BigNumber":function(c,f){return h(c,f,this,!1)},"number | Complex | BigNumber, SparseMatrix":function(c,f){return n(c,0)?i(f.size(),f.storage()):l(f,c,this,!0)},"number | Complex | BigNumber, DenseMatrix":function(c,f){return n(c,0)?i(f.size(),f.storage()):h(f,c,this,!0)},"Array, number | BigNumber":function(c,f){return h(t(c),f,this,!1).valueOf()},"number | Complex | BigNumber, Array":function(c,f){return h(t(f),c,this,!0).valueOf()}}))}),Gz={number:Ug,"number, number":function(e,t){if(!fn(t))throw new TypeError(fl);if(t<0||t>15)throw new Error("Number of decimals in function round must be in te range of 0-15");return Ug(e,t)}},Lf="equal",kz=["typed","matrix","equalScalar","DenseMatrix"],Vz=ke(Lf,kz,r=>{var{typed:e,matrix:t,equalScalar:n,DenseMatrix:i}=r,s=zc({typed:e}),o=Hg({typed:e,DenseMatrix:i}),a=Uc({typed:e,DenseMatrix:i}),l=hl({typed:e}),h=Br({typed:e});return e(Lf,{"any, any":function(c,f){return c===null?f===null:f===null?c===null:c===void 0?f===void 0:f===void 0?c===void 0:n(c,f)},"SparseMatrix, SparseMatrix":function(c,f){return o(c,f,n)},"SparseMatrix, DenseMatrix":function(c,f){return s(f,c,n,!0)},"DenseMatrix, SparseMatrix":function(c,f){return s(c,f,n,!1)},"DenseMatrix, DenseMatrix":function(c,f){return l(c,f,n)},"Array, Array":function(c,f){return this(t(c),t(f)).valueOf()},"Array, Matrix":function(c,f){return this(t(c),f)},"Matrix, Array":function(c,f){return this(c,t(f))},"SparseMatrix, any":function(c,f){return a(c,f,n,!1)},"DenseMatrix, any":function(c,f){return h(c,f,n,!1)},"any, SparseMatrix":function(c,f){return a(f,c,n,!0)},"any, DenseMatrix":function(c,f){return h(f,c,n,!0)},"Array, any":function(c,f){return h(t(c),f,n,!1).valueOf()},"any, Array":function(c,f){return h(t(f),c,n,!0).valueOf()}})});ke(Lf,["typed","equalScalar"],r=>{var{typed:e,equalScalar:t}=r;return e(Lf,{"any, any":function(i,s){return i===null?s===null:s===null?i===null:i===void 0?s===void 0:s===void 0?i===void 0:t(i,s)}})});var MA="smaller",Wz=["typed","config","matrix","DenseMatrix"],qz=ke(MA,Wz,r=>{var{typed:e,config:t,matrix:n,DenseMatrix:i}=r,s=zc({typed:e}),o=Hg({typed:e,DenseMatrix:i}),a=Uc({typed:e,DenseMatrix:i}),l=hl({typed:e}),h=Br({typed:e});return e(MA,{"boolean, boolean":function(c,f){return c<f},"number, number":function(c,f){return c<f&&!vi(c,f,t.epsilon)},"BigNumber, BigNumber":function(c,f){return c.lt(f)&&!Do(c,f,t.epsilon)},"Fraction, Fraction":function(c,f){return c.compare(f)===-1},"Complex, Complex":function(c,f){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(c,f){if(!c.equalBase(f))throw new Error("Cannot compare units with different base");return this(c.value,f.value)},"SparseMatrix, SparseMatrix":function(c,f){return o(c,f,this)},"SparseMatrix, DenseMatrix":function(c,f){return s(f,c,this,!0)},"DenseMatrix, SparseMatrix":function(c,f){return s(c,f,this,!1)},"DenseMatrix, DenseMatrix":function(c,f){return l(c,f,this)},"Array, Array":function(c,f){return this(n(c),n(f)).valueOf()},"Array, Matrix":function(c,f){return this(n(c),f)},"Matrix, Array":function(c,f){return this(c,n(f))},"SparseMatrix, any":function(c,f){return a(c,f,this,!1)},"DenseMatrix, any":function(c,f){return h(c,f,this,!1)},"any, SparseMatrix":function(c,f){return a(f,c,this,!0)},"any, DenseMatrix":function(c,f){return h(f,c,this,!0)},"Array, any":function(c,f){return h(n(c),f,this,!1).valueOf()},"any, Array":function(c,f){return h(n(f),c,this,!0).valueOf()}})}),AA="larger",Yz=["typed","config","matrix","DenseMatrix"],Xz=ke(AA,Yz,r=>{var{typed:e,config:t,matrix:n,DenseMatrix:i}=r,s=zc({typed:e}),o=Hg({typed:e,DenseMatrix:i}),a=Uc({typed:e,DenseMatrix:i}),l=hl({typed:e}),h=Br({typed:e});return e(AA,{"boolean, boolean":function(c,f){return c>f},"number, number":function(c,f){return c>f&&!vi(c,f,t.epsilon)},"BigNumber, BigNumber":function(c,f){return c.gt(f)&&!Do(c,f,t.epsilon)},"Fraction, Fraction":function(c,f){return c.compare(f)===1},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(c,f){if(!c.equalBase(f))throw new Error("Cannot compare units with different base");return this(c.value,f.value)},"SparseMatrix, SparseMatrix":function(c,f){return o(c,f,this)},"SparseMatrix, DenseMatrix":function(c,f){return s(f,c,this,!0)},"DenseMatrix, SparseMatrix":function(c,f){return s(c,f,this,!1)},"DenseMatrix, DenseMatrix":function(c,f){return l(c,f,this)},"Array, Array":function(c,f){return this(n(c),n(f)).valueOf()},"Array, Matrix":function(c,f){return this(n(c),f)},"Matrix, Array":function(c,f){return this(c,n(f))},"SparseMatrix, any":function(c,f){return a(c,f,this,!1)},"DenseMatrix, any":function(c,f){return h(c,f,this,!1)},"any, SparseMatrix":function(c,f){return a(f,c,this,!0)},"any, DenseMatrix":function(c,f){return h(f,c,this,!0)},"Array, any":function(c,f){return h(n(c),f,this,!1).valueOf()},"any, Array":function(c,f){return h(n(f),c,this,!0).valueOf()}})}),Qz="FibonacciHeap",jz=["smaller","larger"],Zz=ke(Qz,jz,r=>{var{smaller:e,larger:t}=r,n=1/Math.log((1+Math.sqrt(5))/2);function i(){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");this._minimum=null,this._size=0}i.prototype.type="FibonacciHeap",i.prototype.isFibonacciHeap=!0,i.prototype.insert=function(u,c){var f={key:u,value:c,degree:0};if(this._minimum){var d=this._minimum;f.left=d,f.right=d.right,d.right=f,f.right.left=f,e(u,d.key)&&(this._minimum=f)}else f.left=f,f.right=f,this._minimum=f;return this._size++,f},i.prototype.size=function(){return this._size},i.prototype.clear=function(){this._minimum=null,this._size=0},i.prototype.isEmpty=function(){return this._size===0},i.prototype.extractMinimum=function(){var u=this._minimum;if(u===null)return u;for(var c=this._minimum,f=u.degree,d=u.child;f>0;){var p=d.right;d.left.right=d.right,d.right.left=d.left,d.left=c,d.right=c.right,c.right=d,d.right.left=d,d.parent=null,d=p,f--}return u.left.right=u.right,u.right.left=u.left,u===u.right?c=null:(c=u.right,c=h(c,this._size)),this._size--,this._minimum=c,u},i.prototype.remove=function(u){this._minimum=s(this._minimum,u,-1),this.extractMinimum()};function s(u,c,f){c.key=f;var d=c.parent;return d&&e(c.key,d.key)&&(o(u,c,d),a(u,d)),e(c.key,u.key)&&(u=c),u}function o(u,c,f){c.left.right=c.right,c.right.left=c.left,f.degree--,f.child===c&&(f.child=c.right),f.degree===0&&(f.child=null),c.left=u,c.right=u.right,u.right=c,c.right.left=c,c.parent=null,c.mark=!1}function a(u,c){var f=c.parent;!f||(c.mark?(o(u,c,f),a(f)):c.mark=!0)}var l=function(c,f){c.left.right=c.right,c.right.left=c.left,c.parent=f,f.child?(c.left=f.child,c.right=f.child.right,f.child.right=c,c.right.left=c):(f.child=c,c.right=c,c.left=c),f.degree++,c.mark=!1};function h(u,c){var f=Math.floor(Math.log(c)*n)+1,d=new Array(f),p=0,m=u;if(m)for(p++,m=m.right;m!==u;)p++,m=m.right;for(var y;p>0;){for(var g=m.degree,v=m.right;y=d[g],!!y;){if(t(m.key,y.key)){var x=y;y=m,m=x}l(y,m),d[g]=null,g++}d[g]=m,m=v,p--}u=null;for(var w=0;w<f;w++)y=d[w],!!y&&(u?(y.left.right=y.right,y.right.left=y.left,y.left=u,y.right=u.right,u.right=y,y.right.left=y,e(y.key,u.key)&&(u=y)):u=y);return u}return i},{isClass:!0}),Jz="Spa",Kz=["addScalar","equalScalar","FibonacciHeap"],$z=ke(Jz,Kz,r=>{var{addScalar:e,equalScalar:t,FibonacciHeap:n}=r;function i(){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");this._values=[],this._heap=new n}return i.prototype.type="Spa",i.prototype.isSpa=!0,i.prototype.set=function(s,o){if(this._values[s])this._values[s].value=o;else{var a=this._heap.insert(s,o);this._values[s]=a}},i.prototype.get=function(s){var o=this._values[s];return o?o.value:0},i.prototype.accumulate=function(s,o){var a=this._values[s];a?a.value=e(a.value,o):(a=this._heap.insert(s,o),this._values[s]=a)},i.prototype.forEach=function(s,o,a){var l=this._heap,h=this._values,u=[],c=l.extractMinimum();for(c&&u.push(c);c&&c.key<=o;)c.key>=s&&(t(c.value,0)||a(c.key,c.value,this)),c=l.extractMinimum(),c&&u.push(c);for(var f=0;f<u.length;f++){var d=u[f];c=l.insert(d.key,d.value),h[c.key]=c}},i.prototype.swap=function(s,o){var a=this._values[s],l=this._values[o];if(!a&&l)a=this._heap.insert(s,l.value),this._heap.remove(l),this._values[s]=a,this._values[o]=void 0;else if(a&&!l)l=this._heap.insert(o,a.value),this._heap.remove(a),this._values[o]=l,this._values[s]=void 0;else if(a&&l){var h=a.value;a.value=l.value,l.value=h}},i},{isClass:!0});Hc(function(r){return new r(1).exp()},{hasher:Df});Hc(function(r){return new r(1).plus(new r(5).sqrt()).div(2)},{hasher:Df});var SA=Hc(function(r){return r.acos(-1)},{hasher:Df});Hc(function(r){return SA(r).times(2)},{hasher:Df});function Df(r){return r[0].precision}function Gc(){return Gc=Object.assign||function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Gc.apply(this,arguments)}function EA(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function Vg(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?EA(Object(t),!0).forEach(function(n){e4(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):EA(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function e4(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}var t4="Unit",n4=["?on","config","addScalar","subtract","multiplyScalar","divideScalar","pow","abs","fix","round","equal","isNumeric","format","number","Complex","BigNumber","Fraction"],r4=ke(t4,n4,r=>{var{on:e,config:t,addScalar:n,subtract:i,multiplyScalar:s,divideScalar:o,pow:a,abs:l,fix:h,round:u,equal:c,isNumeric:f,format:d,number:p,Complex:m,BigNumber:y,Fraction:g}=r,v=p;function x(B,D){if(!(this instanceof x))throw new Error("Constructor must be called with the new operator");if(!(B==null||f(B)||Qi(B)))throw new TypeError("First parameter in Unit constructor must be number, BigNumber, Fraction, Complex, or undefined");if(D!==void 0&&(typeof D!="string"||D===""))throw new TypeError("Second parameter in Unit constructor must be a string");if(D!==void 0){var $=x.parse(D);this.units=$.units,this.dimensions=$.dimensions}else{this.units=[{unit:te,prefix:T.NONE,power:0}],this.dimensions=[];for(var ne=0;ne<V.length;ne++)this.dimensions[ne]=0}this.value=B!=null?this._normalize(B):null,this.fixPrefix=!1,this.skipAutomaticSimplification=!0}x.prototype.type="Unit",x.prototype.isUnit=!0;var w,b,M;function A(){for(;M===" "||M==="	";)R()}function E(B){return B>="0"&&B<="9"||B==="."}function N(B){return B>="0"&&B<="9"}function R(){b++,M=w.charAt(b)}function _(B){b=B,M=w.charAt(b)}function S(){var B="",D=b;if(M==="+"?R():M==="-"&&(B+=M,R()),!E(M))return _(D),null;if(M==="."){if(B+=M,R(),!N(M))return _(D),null}else{for(;N(M);)B+=M,R();M==="."&&(B+=M,R())}for(;N(M);)B+=M,R();if(M==="E"||M==="e"){var $="",ne=b;if($+=M,R(),(M==="+"||M==="-")&&($+=M,R()),!N(M))return _(ne),B;for(B=B+$;N(M);)B+=M,R()}return B}function L(){for(var B="";N(M)||x.isValidAlpha(M);)B+=M,R();var D=B.charAt(0);return x.isValidAlpha(D)?B:null}function k(B){return M===B?(R(),B):null}x.parse=function(B,D){if(D=D||{},w=B,b=-1,M="",typeof w!="string")throw new TypeError("Invalid argument in Unit.parse, string expected");var $=new x;$.units=[];var ne=1,U=!1;R(),A();var W=S(),P=null;if(W){if(t.number==="BigNumber")P=new y(W);else if(t.number==="Fraction")try{P=new g(W)}catch{P=parseFloat(W)}else P=parseFloat(W);A(),k("*")?(ne=1,U=!0):k("/")&&(ne=-1,U=!0)}for(var C=[],ee=1;;){for(A();M==="(";)C.push(ne),ee*=ne,ne=1,R(),A();var ae=void 0;if(M){var le=M;if(ae=L(),ae===null)throw new SyntaxError('Unexpected "'+le+'" in "'+w+'" at index '+b.toString())}else break;var ce=H(ae);if(ce===null)throw new SyntaxError('Unit "'+ae+'" not found.');var ye=ne*ee;if(A(),k("^")){A();var we=S();if(we===null)throw new SyntaxError('In "'+B+'", "^" must be followed by a floating-point number');ye*=we}$.units.push({unit:ce.unit,prefix:ce.prefix,power:ye});for(var be=0;be<V.length;be++)$.dimensions[be]+=(ce.unit.dimensions[be]||0)*ye;for(A();M===")";){if(C.length===0)throw new SyntaxError('Unmatched ")" in "'+w+'" at index '+b.toString());ee/=C.pop(),R(),A()}if(U=!1,k("*")?(ne=1,U=!0):k("/")?(ne=-1,U=!0):ne=1,ce.unit.base){var oe=ce.unit.base.key;Q.auto[oe]={unit:ce.unit,prefix:ce.prefix}}}if(A(),M)throw new SyntaxError('Could not parse: "'+B+'"');if(U)throw new SyntaxError('Trailing characters: "'+B+'"');if(C.length!==0)throw new SyntaxError('Unmatched "(" in "'+w+'"');if($.units.length===0&&!D.allowNoUnits)throw new SyntaxError('"'+B+'" contains no units');return $.value=P!==void 0?$._normalize(P):null,$},x.prototype.clone=function(){var B=new x;B.fixPrefix=this.fixPrefix,B.skipAutomaticSimplification=this.skipAutomaticSimplification,B.value=Et(this.value),B.dimensions=this.dimensions.slice(0),B.units=[];for(var D=0;D<this.units.length;D++){B.units[D]={};for(var $ in this.units[D])Je(this.units[D],$)&&(B.units[D][$]=this.units[D][$])}return B},x.prototype._isDerived=function(){return this.units.length===0?!1:this.units.length>1||Math.abs(this.units[0].power-1)>1e-15},x.prototype._normalize=function(B){var D,$,ne,U,W;if(B==null||this.units.length===0)return B;if(this._isDerived()){var P=B;W=x._getNumberConverter(Kn(B));for(var C=0;C<this.units.length;C++)D=W(this.units[C].unit.value),U=W(this.units[C].prefix.value),ne=W(this.units[C].power),P=s(P,a(s(D,U),ne));return P}else return W=x._getNumberConverter(Kn(B)),D=W(this.units[0].unit.value),$=W(this.units[0].unit.offset),U=W(this.units[0].prefix.value),s(n(B,$),s(D,U))},x.prototype._denormalize=function(B,D){var $,ne,U,W,P;if(B==null||this.units.length===0)return B;if(this._isDerived()){var C=B;P=x._getNumberConverter(Kn(B));for(var ee=0;ee<this.units.length;ee++)$=P(this.units[ee].unit.value),W=P(this.units[ee].prefix.value),U=P(this.units[ee].power),C=o(C,a(s($,W),U));return C}else return P=x._getNumberConverter(Kn(B)),$=P(this.units[0].unit.value),W=P(this.units[0].prefix.value),ne=P(this.units[0].unit.offset),D==null?i(o(o(B,$),W),ne):i(o(o(B,$),D),ne)};var H=Hc(B=>{if(Je(z,B)){var D=z[B],$=D.prefixes[""];return{unit:D,prefix:$}}for(var ne in z)if(Je(z,ne)&&_D(B,ne)){var U=z[ne],W=B.length-ne.length,P=B.substring(0,W),C=Je(U.prefixes,P)?U.prefixes[P]:void 0;if(C!==void 0)return{unit:U,prefix:C}}return null},{hasher:B=>B[0],limit:100});x.isValuelessUnit=function(B){return H(B)!==null},x.prototype.hasBase=function(B){if(typeof B=="string"&&(B=F[B]),!B)return!1;for(var D=0;D<V.length;D++)if(Math.abs((this.dimensions[D]||0)-(B.dimensions[D]||0))>1e-12)return!1;return!0},x.prototype.equalBase=function(B){for(var D=0;D<V.length;D++)if(Math.abs((this.dimensions[D]||0)-(B.dimensions[D]||0))>1e-12)return!1;return!0},x.prototype.equals=function(B){return this.equalBase(B)&&c(this.value,B.value)},x.prototype.multiply=function(B){for(var D=this.clone(),$=0;$<V.length;$++)D.dimensions[$]=(this.dimensions[$]||0)+(B.dimensions[$]||0);for(var ne=0;ne<B.units.length;ne++){var U=Vg({},B.units[ne]);D.units.push(U)}if(this.value!==null||B.value!==null){var W=this.value===null?this._normalize(1):this.value,P=B.value===null?B._normalize(1):B.value;D.value=s(W,P)}else D.value=null;return D.skipAutomaticSimplification=!1,O(D)},x.prototype.divide=function(B){for(var D=this.clone(),$=0;$<V.length;$++)D.dimensions[$]=(this.dimensions[$]||0)-(B.dimensions[$]||0);for(var ne=0;ne<B.units.length;ne++){var U=Vg(Vg({},B.units[ne]),{},{power:-B.units[ne].power});D.units.push(U)}if(this.value!==null||B.value!==null){var W=this.value===null?this._normalize(1):this.value,P=B.value===null?B._normalize(1):B.value;D.value=o(W,P)}else D.value=null;return D.skipAutomaticSimplification=!1,O(D)},x.prototype.pow=function(B){for(var D=this.clone(),$=0;$<V.length;$++)D.dimensions[$]=(this.dimensions[$]||0)*B;for(var ne=0;ne<D.units.length;ne++)D.units[ne].power*=B;return D.value!==null?D.value=a(D.value,B):D.value=null,D.skipAutomaticSimplification=!1,O(D)};function O(B){return B.equalBase(F.NONE)&&B.value!==null&&!t.predictable?B.value:B}x.prototype.abs=function(){var B=this.clone();B.value=B.value!==null?l(B.value):null;for(var D in B.units)(B.units[D].unit.name==="VA"||B.units[D].unit.name==="VAR")&&(B.units[D].unit=z.W);return B},x.prototype.to=function(B){var D,$=this.value===null?this._normalize(1):this.value;if(typeof B=="string"){if(D=x.parse(B),!this.equalBase(D))throw new Error("Units do not match ('".concat(D.toString(),"' != '").concat(this.toString(),"')"));if(D.value!==null)throw new Error("Cannot convert to a unit with a value");return D.value=Et($),D.fixPrefix=!0,D.skipAutomaticSimplification=!0,D}else if(No(B)){if(!this.equalBase(B))throw new Error("Units do not match ('".concat(B.toString(),"' != '").concat(this.toString(),"')"));if(B.value!==null)throw new Error("Cannot convert to a unit with a value");return D=B.clone(),D.value=Et($),D.fixPrefix=!0,D.skipAutomaticSimplification=!0,D}else throw new Error("String or Unit expected as parameter")},x.prototype.toNumber=function(B){return v(this.toNumeric(B))},x.prototype.toNumeric=function(B){var D;return B?D=this.to(B):D=this.clone(),D._isDerived()||D.units.length===0?D._denormalize(D.value):D._denormalize(D.value,D.units[0].prefix.value)},x.prototype.toString=function(){return this.format()},x.prototype.toJSON=function(){return{mathjs:"Unit",value:this._denormalize(this.value),unit:this.formatUnits(),fixPrefix:this.fixPrefix}},x.fromJSON=function(B){var D=new x(B.value,B.unit);return D.fixPrefix=B.fixPrefix||!1,D},x.prototype.valueOf=x.prototype.toString,x.prototype.simplify=function(){var B=this.clone(),D=[],$;for(var ne in me)if(Je(me,ne)&&B.hasBase(F[ne])){$=ne;break}if($==="NONE")B.units=[];else{var U;if($&&Je(me,$)&&(U=me[$]),U)B.units=[{unit:U.unit,prefix:U.prefix,power:1}];else{for(var W=!1,P=0;P<V.length;P++){var C=V[P];Math.abs(B.dimensions[P]||0)>1e-12&&(Je(me,C)?D.push({unit:me[C].unit,prefix:me[C].prefix,power:B.dimensions[P]||0}):W=!0)}D.length<B.units.length&&!W&&(B.units=D)}}return B},x.prototype.toSI=function(){for(var B=this.clone(),D=[],$=0;$<V.length;$++){var ne=V[$];if(Math.abs(B.dimensions[$]||0)>1e-12)if(Je(Q.si,ne))D.push({unit:Q.si[ne].unit,prefix:Q.si[ne].prefix,power:B.dimensions[$]||0});else throw new Error("Cannot express custom unit "+ne+" in SI units")}return B.units=D,B.fixPrefix=!0,B.skipAutomaticSimplification=!0,B},x.prototype.formatUnits=function(){for(var B="",D="",$=0,ne=0,U=0;U<this.units.length;U++)this.units[U].power>0?($++,B+=" "+this.units[U].prefix.name+this.units[U].unit.name,Math.abs(this.units[U].power-1)>1e-15&&(B+="^"+this.units[U].power)):this.units[U].power<0&&ne++;if(ne>0)for(var W=0;W<this.units.length;W++)this.units[W].power<0&&($>0?(D+=" "+this.units[W].prefix.name+this.units[W].unit.name,Math.abs(this.units[W].power+1)>1e-15&&(D+="^"+-this.units[W].power)):(D+=" "+this.units[W].prefix.name+this.units[W].unit.name,D+="^"+this.units[W].power));B=B.substr(1),D=D.substr(1),$>1&&ne>0&&(B="("+B+")"),ne>1&&$>0&&(D="("+D+")");var P=B;return $>0&&ne>0&&(P+=" / "),P+=D,P},x.prototype.format=function(B){var D=this.skipAutomaticSimplification||this.value===null?this.clone():this.simplify(),$=!1;typeof D.value!="undefined"&&D.value!==null&&Qi(D.value)&&($=Math.abs(D.value.re)<1e-14);for(var ne in D.units)Je(D.units,ne)&&D.units[ne].unit&&(D.units[ne].unit.name==="VA"&&$?D.units[ne].unit=z.VAR:D.units[ne].unit.name==="VAR"&&!$&&(D.units[ne].unit=z.VA));D.units.length===1&&!D.fixPrefix&&Math.abs(D.units[0].power-Math.round(D.units[0].power))<1e-14&&(D.units[0].prefix=D._bestPrefix());var U=D._denormalize(D.value),W=D.value!==null?d(U,B||{}):"",P=D.formatUnits();return D.value&&Qi(D.value)&&(W="("+W+")"),P.length>0&&W.length>0&&(W+=" "),W+=P,W},x.prototype._bestPrefix=function(){if(this.units.length!==1)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");if(Math.abs(this.units[0].power-Math.round(this.units[0].power))>=1e-14)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");var B=this.value!==null?l(this.value):0,D=l(this.units[0].unit.value),$=this.units[0].prefix;if(B===0)return $;var ne=this.units[0].power,U=Math.log(B/Math.pow($.value*D,ne))/Math.LN10-1.2;if(U>-2.200001&&U<1.800001)return $;U=Math.abs(U);var W=this.units[0].unit.prefixes;for(var P in W)if(Je(W,P)){var C=W[P];if(C.scientific){var ee=Math.abs(Math.log(B/Math.pow(C.value*D,ne))/Math.LN10-1.2);(ee<U||ee===U&&C.name.length<$.name.length)&&($=C,U=ee)}}return $},x.prototype.splitUnit=function(B){for(var D=this.clone(),$=[],ne=0;ne<B.length&&(D=D.to(B[ne]),ne!==B.length-1);ne++){var U=D.toNumeric(),W=u(U),P=void 0,C=c(W,U);C?P=W:P=h(D.toNumeric());var ee=new x(P,B[ne].toString());$.push(ee),D=i(D,ee)}for(var ae=0,le=0;le<$.length;le++)ae=n(ae,$[le].value);return c(ae,this.value)&&(D.value=0),$.push(D),$};var T={NONE:{"":{name:"",value:1,scientific:!0}},SHORT:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:10,scientific:!1},h:{name:"h",value:100,scientific:!1},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0},d:{name:"d",value:.1,scientific:!1},c:{name:"c",value:.01,scientific:!1},m:{name:"m",value:.001,scientific:!0},u:{name:"u",value:1e-6,scientific:!0},n:{name:"n",value:1e-9,scientific:!0},p:{name:"p",value:1e-12,scientific:!0},f:{name:"f",value:1e-15,scientific:!0},a:{name:"a",value:1e-18,scientific:!0},z:{name:"z",value:1e-21,scientific:!0},y:{name:"y",value:1e-24,scientific:!0}},LONG:{"":{name:"",value:1,scientific:!0},deca:{name:"deca",value:10,scientific:!1},hecto:{name:"hecto",value:100,scientific:!1},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0},deci:{name:"deci",value:.1,scientific:!1},centi:{name:"centi",value:.01,scientific:!1},milli:{name:"milli",value:.001,scientific:!0},micro:{name:"micro",value:1e-6,scientific:!0},nano:{name:"nano",value:1e-9,scientific:!0},pico:{name:"pico",value:1e-12,scientific:!0},femto:{name:"femto",value:1e-15,scientific:!0},atto:{name:"atto",value:1e-18,scientific:!0},zepto:{name:"zepto",value:1e-21,scientific:!0},yocto:{name:"yocto",value:1e-24,scientific:!0}},SQUARED:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:100,scientific:!1},h:{name:"h",value:1e4,scientific:!1},k:{name:"k",value:1e6,scientific:!0},M:{name:"M",value:1e12,scientific:!0},G:{name:"G",value:1e18,scientific:!0},T:{name:"T",value:1e24,scientific:!0},P:{name:"P",value:1e30,scientific:!0},E:{name:"E",value:1e36,scientific:!0},Z:{name:"Z",value:1e42,scientific:!0},Y:{name:"Y",value:1e48,scientific:!0},d:{name:"d",value:.01,scientific:!1},c:{name:"c",value:1e-4,scientific:!1},m:{name:"m",value:1e-6,scientific:!0},u:{name:"u",value:1e-12,scientific:!0},n:{name:"n",value:1e-18,scientific:!0},p:{name:"p",value:1e-24,scientific:!0},f:{name:"f",value:1e-30,scientific:!0},a:{name:"a",value:1e-36,scientific:!0},z:{name:"z",value:1e-42,scientific:!0},y:{name:"y",value:1e-48,scientific:!0}},CUBIC:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:1e3,scientific:!1},h:{name:"h",value:1e6,scientific:!1},k:{name:"k",value:1e9,scientific:!0},M:{name:"M",value:1e18,scientific:!0},G:{name:"G",value:1e27,scientific:!0},T:{name:"T",value:1e36,scientific:!0},P:{name:"P",value:1e45,scientific:!0},E:{name:"E",value:1e54,scientific:!0},Z:{name:"Z",value:1e63,scientific:!0},Y:{name:"Y",value:1e72,scientific:!0},d:{name:"d",value:.001,scientific:!1},c:{name:"c",value:1e-6,scientific:!1},m:{name:"m",value:1e-9,scientific:!0},u:{name:"u",value:1e-18,scientific:!0},n:{name:"n",value:1e-27,scientific:!0},p:{name:"p",value:1e-36,scientific:!0},f:{name:"f",value:1e-45,scientific:!0},a:{name:"a",value:1e-54,scientific:!0},z:{name:"z",value:1e-63,scientific:!0},y:{name:"y",value:1e-72,scientific:!0}},BINARY_SHORT_SI:{"":{name:"",value:1,scientific:!0},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0}},BINARY_SHORT_IEC:{"":{name:"",value:1,scientific:!0},Ki:{name:"Ki",value:1024,scientific:!0},Mi:{name:"Mi",value:Math.pow(1024,2),scientific:!0},Gi:{name:"Gi",value:Math.pow(1024,3),scientific:!0},Ti:{name:"Ti",value:Math.pow(1024,4),scientific:!0},Pi:{name:"Pi",value:Math.pow(1024,5),scientific:!0},Ei:{name:"Ei",value:Math.pow(1024,6),scientific:!0},Zi:{name:"Zi",value:Math.pow(1024,7),scientific:!0},Yi:{name:"Yi",value:Math.pow(1024,8),scientific:!0}},BINARY_LONG_SI:{"":{name:"",value:1,scientific:!0},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0}},BINARY_LONG_IEC:{"":{name:"",value:1,scientific:!0},kibi:{name:"kibi",value:1024,scientific:!0},mebi:{name:"mebi",value:Math.pow(1024,2),scientific:!0},gibi:{name:"gibi",value:Math.pow(1024,3),scientific:!0},tebi:{name:"tebi",value:Math.pow(1024,4),scientific:!0},pebi:{name:"pebi",value:Math.pow(1024,5),scientific:!0},exi:{name:"exi",value:Math.pow(1024,6),scientific:!0},zebi:{name:"zebi",value:Math.pow(1024,7),scientific:!0},yobi:{name:"yobi",value:Math.pow(1024,8),scientific:!0}},BTU:{"":{name:"",value:1,scientific:!0},MM:{name:"MM",value:1e6,scientific:!0}}};T.SHORTLONG=Gc({},T.SHORT,T.LONG),T.BINARY_SHORT=Gc({},T.BINARY_SHORT_SI,T.BINARY_SHORT_IEC),T.BINARY_LONG=Gc({},T.BINARY_LONG_SI,T.BINARY_LONG_IEC);var V=["MASS","LENGTH","TIME","CURRENT","TEMPERATURE","LUMINOUS_INTENSITY","AMOUNT_OF_SUBSTANCE","ANGLE","BIT"],F={NONE:{dimensions:[0,0,0,0,0,0,0,0,0]},MASS:{dimensions:[1,0,0,0,0,0,0,0,0]},LENGTH:{dimensions:[0,1,0,0,0,0,0,0,0]},TIME:{dimensions:[0,0,1,0,0,0,0,0,0]},CURRENT:{dimensions:[0,0,0,1,0,0,0,0,0]},TEMPERATURE:{dimensions:[0,0,0,0,1,0,0,0,0]},LUMINOUS_INTENSITY:{dimensions:[0,0,0,0,0,1,0,0,0]},AMOUNT_OF_SUBSTANCE:{dimensions:[0,0,0,0,0,0,1,0,0]},FORCE:{dimensions:[1,1,-2,0,0,0,0,0,0]},SURFACE:{dimensions:[0,2,0,0,0,0,0,0,0]},VOLUME:{dimensions:[0,3,0,0,0,0,0,0,0]},ENERGY:{dimensions:[1,2,-2,0,0,0,0,0,0]},POWER:{dimensions:[1,2,-3,0,0,0,0,0,0]},PRESSURE:{dimensions:[1,-1,-2,0,0,0,0,0,0]},ELECTRIC_CHARGE:{dimensions:[0,0,1,1,0,0,0,0,0]},ELECTRIC_CAPACITANCE:{dimensions:[-1,-2,4,2,0,0,0,0,0]},ELECTRIC_POTENTIAL:{dimensions:[1,2,-3,-1,0,0,0,0,0]},ELECTRIC_RESISTANCE:{dimensions:[1,2,-3,-2,0,0,0,0,0]},ELECTRIC_INDUCTANCE:{dimensions:[1,2,-2,-2,0,0,0,0,0]},ELECTRIC_CONDUCTANCE:{dimensions:[-1,-2,3,2,0,0,0,0,0]},MAGNETIC_FLUX:{dimensions:[1,2,-2,-1,0,0,0,0,0]},MAGNETIC_FLUX_DENSITY:{dimensions:[1,0,-2,-1,0,0,0,0,0]},FREQUENCY:{dimensions:[0,0,-1,0,0,0,0,0,0]},ANGLE:{dimensions:[0,0,0,0,0,0,0,1,0]},BIT:{dimensions:[0,0,0,0,0,0,0,0,1]}};for(var J in F)Je(F,J)&&(F[J].key=J);var Y={},te={name:"",base:Y,value:1,offset:0,dimensions:V.map(B=>0)},z={meter:{name:"meter",base:F.LENGTH,prefixes:T.LONG,value:1,offset:0},inch:{name:"inch",base:F.LENGTH,prefixes:T.NONE,value:.0254,offset:0},foot:{name:"foot",base:F.LENGTH,prefixes:T.NONE,value:.3048,offset:0},yard:{name:"yard",base:F.LENGTH,prefixes:T.NONE,value:.9144,offset:0},mile:{name:"mile",base:F.LENGTH,prefixes:T.NONE,value:1609.344,offset:0},link:{name:"link",base:F.LENGTH,prefixes:T.NONE,value:.201168,offset:0},rod:{name:"rod",base:F.LENGTH,prefixes:T.NONE,value:5.0292,offset:0},chain:{name:"chain",base:F.LENGTH,prefixes:T.NONE,value:20.1168,offset:0},angstrom:{name:"angstrom",base:F.LENGTH,prefixes:T.NONE,value:1e-10,offset:0},m:{name:"m",base:F.LENGTH,prefixes:T.SHORT,value:1,offset:0},in:{name:"in",base:F.LENGTH,prefixes:T.NONE,value:.0254,offset:0},ft:{name:"ft",base:F.LENGTH,prefixes:T.NONE,value:.3048,offset:0},yd:{name:"yd",base:F.LENGTH,prefixes:T.NONE,value:.9144,offset:0},mi:{name:"mi",base:F.LENGTH,prefixes:T.NONE,value:1609.344,offset:0},li:{name:"li",base:F.LENGTH,prefixes:T.NONE,value:.201168,offset:0},rd:{name:"rd",base:F.LENGTH,prefixes:T.NONE,value:5.02921,offset:0},ch:{name:"ch",base:F.LENGTH,prefixes:T.NONE,value:20.1168,offset:0},mil:{name:"mil",base:F.LENGTH,prefixes:T.NONE,value:254e-7,offset:0},m2:{name:"m2",base:F.SURFACE,prefixes:T.SQUARED,value:1,offset:0},sqin:{name:"sqin",base:F.SURFACE,prefixes:T.NONE,value:64516e-8,offset:0},sqft:{name:"sqft",base:F.SURFACE,prefixes:T.NONE,value:.09290304,offset:0},sqyd:{name:"sqyd",base:F.SURFACE,prefixes:T.NONE,value:.83612736,offset:0},sqmi:{name:"sqmi",base:F.SURFACE,prefixes:T.NONE,value:2589988110336e-6,offset:0},sqrd:{name:"sqrd",base:F.SURFACE,prefixes:T.NONE,value:25.29295,offset:0},sqch:{name:"sqch",base:F.SURFACE,prefixes:T.NONE,value:404.6873,offset:0},sqmil:{name:"sqmil",base:F.SURFACE,prefixes:T.NONE,value:64516e-14,offset:0},acre:{name:"acre",base:F.SURFACE,prefixes:T.NONE,value:4046.86,offset:0},hectare:{name:"hectare",base:F.SURFACE,prefixes:T.NONE,value:1e4,offset:0},m3:{name:"m3",base:F.VOLUME,prefixes:T.CUBIC,value:1,offset:0},L:{name:"L",base:F.VOLUME,prefixes:T.SHORT,value:.001,offset:0},l:{name:"l",base:F.VOLUME,prefixes:T.SHORT,value:.001,offset:0},litre:{name:"litre",base:F.VOLUME,prefixes:T.LONG,value:.001,offset:0},cuin:{name:"cuin",base:F.VOLUME,prefixes:T.NONE,value:16387064e-12,offset:0},cuft:{name:"cuft",base:F.VOLUME,prefixes:T.NONE,value:.028316846592,offset:0},cuyd:{name:"cuyd",base:F.VOLUME,prefixes:T.NONE,value:.764554857984,offset:0},teaspoon:{name:"teaspoon",base:F.VOLUME,prefixes:T.NONE,value:5e-6,offset:0},tablespoon:{name:"tablespoon",base:F.VOLUME,prefixes:T.NONE,value:15e-6,offset:0},drop:{name:"drop",base:F.VOLUME,prefixes:T.NONE,value:5e-8,offset:0},gtt:{name:"gtt",base:F.VOLUME,prefixes:T.NONE,value:5e-8,offset:0},minim:{name:"minim",base:F.VOLUME,prefixes:T.NONE,value:6161152e-14,offset:0},fluiddram:{name:"fluiddram",base:F.VOLUME,prefixes:T.NONE,value:36966911e-13,offset:0},fluidounce:{name:"fluidounce",base:F.VOLUME,prefixes:T.NONE,value:2957353e-11,offset:0},gill:{name:"gill",base:F.VOLUME,prefixes:T.NONE,value:.0001182941,offset:0},cc:{name:"cc",base:F.VOLUME,prefixes:T.NONE,value:1e-6,offset:0},cup:{name:"cup",base:F.VOLUME,prefixes:T.NONE,value:.0002365882,offset:0},pint:{name:"pint",base:F.VOLUME,prefixes:T.NONE,value:.0004731765,offset:0},quart:{name:"quart",base:F.VOLUME,prefixes:T.NONE,value:.0009463529,offset:0},gallon:{name:"gallon",base:F.VOLUME,prefixes:T.NONE,value:.003785412,offset:0},beerbarrel:{name:"beerbarrel",base:F.VOLUME,prefixes:T.NONE,value:.1173478,offset:0},oilbarrel:{name:"oilbarrel",base:F.VOLUME,prefixes:T.NONE,value:.1589873,offset:0},hogshead:{name:"hogshead",base:F.VOLUME,prefixes:T.NONE,value:.238481,offset:0},fldr:{name:"fldr",base:F.VOLUME,prefixes:T.NONE,value:36966911e-13,offset:0},floz:{name:"floz",base:F.VOLUME,prefixes:T.NONE,value:2957353e-11,offset:0},gi:{name:"gi",base:F.VOLUME,prefixes:T.NONE,value:.0001182941,offset:0},cp:{name:"cp",base:F.VOLUME,prefixes:T.NONE,value:.0002365882,offset:0},pt:{name:"pt",base:F.VOLUME,prefixes:T.NONE,value:.0004731765,offset:0},qt:{name:"qt",base:F.VOLUME,prefixes:T.NONE,value:.0009463529,offset:0},gal:{name:"gal",base:F.VOLUME,prefixes:T.NONE,value:.003785412,offset:0},bbl:{name:"bbl",base:F.VOLUME,prefixes:T.NONE,value:.1173478,offset:0},obl:{name:"obl",base:F.VOLUME,prefixes:T.NONE,value:.1589873,offset:0},g:{name:"g",base:F.MASS,prefixes:T.SHORT,value:.001,offset:0},gram:{name:"gram",base:F.MASS,prefixes:T.LONG,value:.001,offset:0},ton:{name:"ton",base:F.MASS,prefixes:T.SHORT,value:907.18474,offset:0},t:{name:"t",base:F.MASS,prefixes:T.SHORT,value:1e3,offset:0},tonne:{name:"tonne",base:F.MASS,prefixes:T.LONG,value:1e3,offset:0},grain:{name:"grain",base:F.MASS,prefixes:T.NONE,value:6479891e-11,offset:0},dram:{name:"dram",base:F.MASS,prefixes:T.NONE,value:.0017718451953125,offset:0},ounce:{name:"ounce",base:F.MASS,prefixes:T.NONE,value:.028349523125,offset:0},poundmass:{name:"poundmass",base:F.MASS,prefixes:T.NONE,value:.45359237,offset:0},hundredweight:{name:"hundredweight",base:F.MASS,prefixes:T.NONE,value:45.359237,offset:0},stick:{name:"stick",base:F.MASS,prefixes:T.NONE,value:.115,offset:0},stone:{name:"stone",base:F.MASS,prefixes:T.NONE,value:6.35029318,offset:0},gr:{name:"gr",base:F.MASS,prefixes:T.NONE,value:6479891e-11,offset:0},dr:{name:"dr",base:F.MASS,prefixes:T.NONE,value:.0017718451953125,offset:0},oz:{name:"oz",base:F.MASS,prefixes:T.NONE,value:.028349523125,offset:0},lbm:{name:"lbm",base:F.MASS,prefixes:T.NONE,value:.45359237,offset:0},cwt:{name:"cwt",base:F.MASS,prefixes:T.NONE,value:45.359237,offset:0},s:{name:"s",base:F.TIME,prefixes:T.SHORT,value:1,offset:0},min:{name:"min",base:F.TIME,prefixes:T.NONE,value:60,offset:0},h:{name:"h",base:F.TIME,prefixes:T.NONE,value:3600,offset:0},second:{name:"second",base:F.TIME,prefixes:T.LONG,value:1,offset:0},sec:{name:"sec",base:F.TIME,prefixes:T.LONG,value:1,offset:0},minute:{name:"minute",base:F.TIME,prefixes:T.NONE,value:60,offset:0},hour:{name:"hour",base:F.TIME,prefixes:T.NONE,value:3600,offset:0},day:{name:"day",base:F.TIME,prefixes:T.NONE,value:86400,offset:0},week:{name:"week",base:F.TIME,prefixes:T.NONE,value:7*86400,offset:0},month:{name:"month",base:F.TIME,prefixes:T.NONE,value:2629800,offset:0},year:{name:"year",base:F.TIME,prefixes:T.NONE,value:31557600,offset:0},decade:{name:"decade",base:F.TIME,prefixes:T.NONE,value:315576e3,offset:0},century:{name:"century",base:F.TIME,prefixes:T.NONE,value:315576e4,offset:0},millennium:{name:"millennium",base:F.TIME,prefixes:T.NONE,value:315576e5,offset:0},hertz:{name:"Hertz",base:F.FREQUENCY,prefixes:T.LONG,value:1,offset:0,reciprocal:!0},Hz:{name:"Hz",base:F.FREQUENCY,prefixes:T.SHORT,value:1,offset:0,reciprocal:!0},rad:{name:"rad",base:F.ANGLE,prefixes:T.SHORT,value:1,offset:0},radian:{name:"radian",base:F.ANGLE,prefixes:T.LONG,value:1,offset:0},deg:{name:"deg",base:F.ANGLE,prefixes:T.SHORT,value:null,offset:0},degree:{name:"degree",base:F.ANGLE,prefixes:T.LONG,value:null,offset:0},grad:{name:"grad",base:F.ANGLE,prefixes:T.SHORT,value:null,offset:0},gradian:{name:"gradian",base:F.ANGLE,prefixes:T.LONG,value:null,offset:0},cycle:{name:"cycle",base:F.ANGLE,prefixes:T.NONE,value:null,offset:0},arcsec:{name:"arcsec",base:F.ANGLE,prefixes:T.NONE,value:null,offset:0},arcmin:{name:"arcmin",base:F.ANGLE,prefixes:T.NONE,value:null,offset:0},A:{name:"A",base:F.CURRENT,prefixes:T.SHORT,value:1,offset:0},ampere:{name:"ampere",base:F.CURRENT,prefixes:T.LONG,value:1,offset:0},K:{name:"K",base:F.TEMPERATURE,prefixes:T.NONE,value:1,offset:0},degC:{name:"degC",base:F.TEMPERATURE,prefixes:T.NONE,value:1,offset:273.15},degF:{name:"degF",base:F.TEMPERATURE,prefixes:T.NONE,value:1/1.8,offset:459.67},degR:{name:"degR",base:F.TEMPERATURE,prefixes:T.NONE,value:1/1.8,offset:0},kelvin:{name:"kelvin",base:F.TEMPERATURE,prefixes:T.NONE,value:1,offset:0},celsius:{name:"celsius",base:F.TEMPERATURE,prefixes:T.NONE,value:1,offset:273.15},fahrenheit:{name:"fahrenheit",base:F.TEMPERATURE,prefixes:T.NONE,value:1/1.8,offset:459.67},rankine:{name:"rankine",base:F.TEMPERATURE,prefixes:T.NONE,value:1/1.8,offset:0},mol:{name:"mol",base:F.AMOUNT_OF_SUBSTANCE,prefixes:T.SHORT,value:1,offset:0},mole:{name:"mole",base:F.AMOUNT_OF_SUBSTANCE,prefixes:T.LONG,value:1,offset:0},cd:{name:"cd",base:F.LUMINOUS_INTENSITY,prefixes:T.SHORT,value:1,offset:0},candela:{name:"candela",base:F.LUMINOUS_INTENSITY,prefixes:T.LONG,value:1,offset:0},N:{name:"N",base:F.FORCE,prefixes:T.SHORT,value:1,offset:0},newton:{name:"newton",base:F.FORCE,prefixes:T.LONG,value:1,offset:0},dyn:{name:"dyn",base:F.FORCE,prefixes:T.SHORT,value:1e-5,offset:0},dyne:{name:"dyne",base:F.FORCE,prefixes:T.LONG,value:1e-5,offset:0},lbf:{name:"lbf",base:F.FORCE,prefixes:T.NONE,value:4.4482216152605,offset:0},poundforce:{name:"poundforce",base:F.FORCE,prefixes:T.NONE,value:4.4482216152605,offset:0},kip:{name:"kip",base:F.FORCE,prefixes:T.LONG,value:4448.2216,offset:0},kilogramforce:{name:"kilogramforce",base:F.FORCE,prefixes:T.NONE,value:9.80665,offset:0},J:{name:"J",base:F.ENERGY,prefixes:T.SHORT,value:1,offset:0},joule:{name:"joule",base:F.ENERGY,prefixes:T.SHORT,value:1,offset:0},erg:{name:"erg",base:F.ENERGY,prefixes:T.NONE,value:1e-7,offset:0},Wh:{name:"Wh",base:F.ENERGY,prefixes:T.SHORT,value:3600,offset:0},BTU:{name:"BTU",base:F.ENERGY,prefixes:T.BTU,value:1055.05585262,offset:0},eV:{name:"eV",base:F.ENERGY,prefixes:T.SHORT,value:1602176565e-28,offset:0},electronvolt:{name:"electronvolt",base:F.ENERGY,prefixes:T.LONG,value:1602176565e-28,offset:0},W:{name:"W",base:F.POWER,prefixes:T.SHORT,value:1,offset:0},watt:{name:"watt",base:F.POWER,prefixes:T.LONG,value:1,offset:0},hp:{name:"hp",base:F.POWER,prefixes:T.NONE,value:745.6998715386,offset:0},VAR:{name:"VAR",base:F.POWER,prefixes:T.SHORT,value:m.I,offset:0},VA:{name:"VA",base:F.POWER,prefixes:T.SHORT,value:1,offset:0},Pa:{name:"Pa",base:F.PRESSURE,prefixes:T.SHORT,value:1,offset:0},psi:{name:"psi",base:F.PRESSURE,prefixes:T.NONE,value:6894.75729276459,offset:0},atm:{name:"atm",base:F.PRESSURE,prefixes:T.NONE,value:101325,offset:0},bar:{name:"bar",base:F.PRESSURE,prefixes:T.SHORTLONG,value:1e5,offset:0},torr:{name:"torr",base:F.PRESSURE,prefixes:T.NONE,value:133.322,offset:0},mmHg:{name:"mmHg",base:F.PRESSURE,prefixes:T.NONE,value:133.322,offset:0},mmH2O:{name:"mmH2O",base:F.PRESSURE,prefixes:T.NONE,value:9.80665,offset:0},cmH2O:{name:"cmH2O",base:F.PRESSURE,prefixes:T.NONE,value:98.0665,offset:0},coulomb:{name:"coulomb",base:F.ELECTRIC_CHARGE,prefixes:T.LONG,value:1,offset:0},C:{name:"C",base:F.ELECTRIC_CHARGE,prefixes:T.SHORT,value:1,offset:0},farad:{name:"farad",base:F.ELECTRIC_CAPACITANCE,prefixes:T.LONG,value:1,offset:0},F:{name:"F",base:F.ELECTRIC_CAPACITANCE,prefixes:T.SHORT,value:1,offset:0},volt:{name:"volt",base:F.ELECTRIC_POTENTIAL,prefixes:T.LONG,value:1,offset:0},V:{name:"V",base:F.ELECTRIC_POTENTIAL,prefixes:T.SHORT,value:1,offset:0},ohm:{name:"ohm",base:F.ELECTRIC_RESISTANCE,prefixes:T.SHORTLONG,value:1,offset:0},henry:{name:"henry",base:F.ELECTRIC_INDUCTANCE,prefixes:T.LONG,value:1,offset:0},H:{name:"H",base:F.ELECTRIC_INDUCTANCE,prefixes:T.SHORT,value:1,offset:0},siemens:{name:"siemens",base:F.ELECTRIC_CONDUCTANCE,prefixes:T.LONG,value:1,offset:0},S:{name:"S",base:F.ELECTRIC_CONDUCTANCE,prefixes:T.SHORT,value:1,offset:0},weber:{name:"weber",base:F.MAGNETIC_FLUX,prefixes:T.LONG,value:1,offset:0},Wb:{name:"Wb",base:F.MAGNETIC_FLUX,prefixes:T.SHORT,value:1,offset:0},tesla:{name:"tesla",base:F.MAGNETIC_FLUX_DENSITY,prefixes:T.LONG,value:1,offset:0},T:{name:"T",base:F.MAGNETIC_FLUX_DENSITY,prefixes:T.SHORT,value:1,offset:0},b:{name:"b",base:F.BIT,prefixes:T.BINARY_SHORT,value:1,offset:0},bits:{name:"bits",base:F.BIT,prefixes:T.BINARY_LONG,value:1,offset:0},B:{name:"B",base:F.BIT,prefixes:T.BINARY_SHORT,value:8,offset:0},bytes:{name:"bytes",base:F.BIT,prefixes:T.BINARY_LONG,value:8,offset:0}},K={meters:"meter",inches:"inch",feet:"foot",yards:"yard",miles:"mile",links:"link",rods:"rod",chains:"chain",angstroms:"angstrom",lt:"l",litres:"litre",liter:"litre",liters:"litre",teaspoons:"teaspoon",tablespoons:"tablespoon",minims:"minim",fluiddrams:"fluiddram",fluidounces:"fluidounce",gills:"gill",cups:"cup",pints:"pint",quarts:"quart",gallons:"gallon",beerbarrels:"beerbarrel",oilbarrels:"oilbarrel",hogsheads:"hogshead",gtts:"gtt",grams:"gram",tons:"ton",tonnes:"tonne",grains:"grain",drams:"dram",ounces:"ounce",poundmasses:"poundmass",hundredweights:"hundredweight",sticks:"stick",lb:"lbm",lbs:"lbm",kips:"kip",kgf:"kilogramforce",acres:"acre",hectares:"hectare",sqfeet:"sqft",sqyard:"sqyd",sqmile:"sqmi",sqmiles:"sqmi",mmhg:"mmHg",mmh2o:"mmH2O",cmh2o:"cmH2O",seconds:"second",secs:"second",minutes:"minute",mins:"minute",hours:"hour",hr:"hour",hrs:"hour",days:"day",weeks:"week",months:"month",years:"year",decades:"decade",centuries:"century",millennia:"millennium",hertz:"hertz",radians:"radian",degrees:"degree",gradians:"gradian",cycles:"cycle",arcsecond:"arcsec",arcseconds:"arcsec",arcminute:"arcmin",arcminutes:"arcmin",BTUs:"BTU",watts:"watt",joules:"joule",amperes:"ampere",coulombs:"coulomb",volts:"volt",ohms:"ohm",farads:"farad",webers:"weber",teslas:"tesla",electronvolts:"electronvolt",moles:"mole",bit:"bits",byte:"bytes"};function Z(B){if(B.number==="BigNumber"){var D=SA(y);z.rad.value=new y(1),z.deg.value=D.div(180),z.grad.value=D.div(200),z.cycle.value=D.times(2),z.arcsec.value=D.div(648e3),z.arcmin.value=D.div(10800)}else z.rad.value=1,z.deg.value=Math.PI/180,z.grad.value=Math.PI/200,z.cycle.value=Math.PI*2,z.arcsec.value=Math.PI/648e3,z.arcmin.value=Math.PI/10800;z.radian.value=z.rad.value,z.degree.value=z.deg.value,z.gradian.value=z.grad.value}Z(t),e&&e("config",function(B,D){B.number!==D.number&&Z(B)});var Q={si:{NONE:{unit:te,prefix:T.NONE[""]},LENGTH:{unit:z.m,prefix:T.SHORT[""]},MASS:{unit:z.g,prefix:T.SHORT.k},TIME:{unit:z.s,prefix:T.SHORT[""]},CURRENT:{unit:z.A,prefix:T.SHORT[""]},TEMPERATURE:{unit:z.K,prefix:T.SHORT[""]},LUMINOUS_INTENSITY:{unit:z.cd,prefix:T.SHORT[""]},AMOUNT_OF_SUBSTANCE:{unit:z.mol,prefix:T.SHORT[""]},ANGLE:{unit:z.rad,prefix:T.SHORT[""]},BIT:{unit:z.bits,prefix:T.SHORT[""]},FORCE:{unit:z.N,prefix:T.SHORT[""]},ENERGY:{unit:z.J,prefix:T.SHORT[""]},POWER:{unit:z.W,prefix:T.SHORT[""]},PRESSURE:{unit:z.Pa,prefix:T.SHORT[""]},ELECTRIC_CHARGE:{unit:z.C,prefix:T.SHORT[""]},ELECTRIC_CAPACITANCE:{unit:z.F,prefix:T.SHORT[""]},ELECTRIC_POTENTIAL:{unit:z.V,prefix:T.SHORT[""]},ELECTRIC_RESISTANCE:{unit:z.ohm,prefix:T.SHORT[""]},ELECTRIC_INDUCTANCE:{unit:z.H,prefix:T.SHORT[""]},ELECTRIC_CONDUCTANCE:{unit:z.S,prefix:T.SHORT[""]},MAGNETIC_FLUX:{unit:z.Wb,prefix:T.SHORT[""]},MAGNETIC_FLUX_DENSITY:{unit:z.T,prefix:T.SHORT[""]},FREQUENCY:{unit:z.Hz,prefix:T.SHORT[""]}}};Q.cgs=JSON.parse(JSON.stringify(Q.si)),Q.cgs.LENGTH={unit:z.m,prefix:T.SHORT.c},Q.cgs.MASS={unit:z.g,prefix:T.SHORT[""]},Q.cgs.FORCE={unit:z.dyn,prefix:T.SHORT[""]},Q.cgs.ENERGY={unit:z.erg,prefix:T.NONE[""]},Q.us=JSON.parse(JSON.stringify(Q.si)),Q.us.LENGTH={unit:z.ft,prefix:T.NONE[""]},Q.us.MASS={unit:z.lbm,prefix:T.NONE[""]},Q.us.TEMPERATURE={unit:z.degF,prefix:T.NONE[""]},Q.us.FORCE={unit:z.lbf,prefix:T.NONE[""]},Q.us.ENERGY={unit:z.BTU,prefix:T.BTU[""]},Q.us.POWER={unit:z.hp,prefix:T.NONE[""]},Q.us.PRESSURE={unit:z.psi,prefix:T.NONE[""]},Q.auto=JSON.parse(JSON.stringify(Q.si));var me=Q.auto;x.setUnitSystem=function(B){if(Je(Q,B))me=Q[B];else throw new Error("Unit system "+B+" does not exist. Choices are: "+Object.keys(Q).join(", "))},x.getUnitSystem=function(){for(var B in Q)if(Je(Q,B)&&Q[B]===me)return B},x.typeConverters={BigNumber:function(D){return new y(D+"")},Fraction:function(D){return new g(D)},Complex:function(D){return D},number:function(D){return D}},x._getNumberConverter=function(B){if(!x.typeConverters[B])throw new TypeError('Unsupported type "'+B+'"');return x.typeConverters[B]};for(var ge in z)if(Je(z,ge)){var se=z[ge];se.dimensions=se.base.dimensions}for(var he in K)if(Je(K,he)){var xe=z[K[he]],pe={};for(var G in xe)Je(xe,G)&&(pe[G]=xe[G]);pe.name=he,z[he]=pe}x.isValidAlpha=function(D){return/^[a-zA-Z]$/.test(D)};function q(B){for(var D=0;D<B.length;D++){if(M=B.charAt(D),D===0&&!x.isValidAlpha(M))throw new Error('Invalid unit name (must begin with alpha character): "'+B+'"');if(D>0&&!(x.isValidAlpha(M)||N(M)))throw new Error('Invalid unit name (only alphanumeric characters are allowed): "'+B+'"')}}return x.createUnit=function(B,D){if(typeof B!="object")throw new TypeError("createUnit expects first parameter to be of type 'Object'");if(D&&D.override){for(var $ in B)if(Je(B,$)&&x.deleteUnit($),B[$].aliases)for(var ne=0;ne<B[$].aliases.length;ne++)x.deleteUnit(B[$].aliases[ne])}var U;for(var W in B)Je(B,W)&&(U=x.createUnitSingle(W,B[W]));return U},x.createUnitSingle=function(B,D,$){if((typeof D=="undefined"||D===null)&&(D={}),typeof B!="string")throw new TypeError("createUnitSingle expects first parameter to be of type 'string'");if(Je(z,B))throw new Error('Cannot create unit "'+B+'": a unit with that name already exists');q(B);var ne=null,U=[],W=0,P,C,ee;if(D&&D.type==="Unit")ne=D.clone();else if(typeof D=="string")D!==""&&(P=D);else if(typeof D=="object")P=D.definition,C=D.prefixes,W=D.offset,ee=D.baseName,D.aliases&&(U=D.aliases.valueOf());else throw new TypeError('Cannot create unit "'+B+'" from "'+D.toString()+'": expecting "string" or "Unit" or "Object"');if(U){for(var ae=0;ae<U.length;ae++)if(Je(z,U[ae]))throw new Error('Cannot create alias "'+U[ae]+'": a unit with that name already exists')}if(P&&typeof P=="string"&&!ne)try{ne=x.parse(P,{allowNoUnits:!0})}catch(re){throw re.message='Could not create unit "'+B+'" from "'+P+'": '+re.message,re}else P&&P.type==="Unit"&&(ne=P.clone());U=U||[],W=W||0,C&&C.toUpperCase?C=T[C.toUpperCase()]||T.NONE:C=T.NONE;var le={};if(ne){le={name:B,value:ne.value,dimensions:ne.dimensions.slice(0),prefixes:C,offset:W};var be=!1;for(var oe in F)if(Je(F,oe)){for(var Ie=!0,Pe=0;Pe<V.length;Pe++)if(Math.abs((le.dimensions[Pe]||0)-(F[oe].dimensions[Pe]||0))>1e-12){Ie=!1;break}if(Ie){be=!0,le.base=F[oe];break}}if(!be){ee=ee||B+"_STUFF";var Qe={dimensions:ne.dimensions.slice(0)};Qe.key=ee,F[ee]=Qe,me[ee]={unit:le,prefix:T.NONE[""]},le.base=F[ee]}}else{if(ee=ee||B+"_STUFF",V.indexOf(ee)>=0)throw new Error('Cannot create new base unit "'+B+'": a base unit with that name already exists (and cannot be overridden)');V.push(ee);for(var ce in F)Je(F,ce)&&(F[ce].dimensions[V.length-1]=0);for(var ye={dimensions:[]},we=0;we<V.length;we++)ye.dimensions[we]=0;ye.dimensions[V.length-1]=1,ye.key=ee,F[ee]=ye,le={name:B,value:1,dimensions:F[ee].dimensions.slice(0),prefixes:C,offset:W,base:F[ee]},me[ee]={unit:le,prefix:T.NONE[""]}}x.UNITS[B]=le;for(var Ge=0;Ge<U.length;Ge++){var We=U[Ge],Fe={};for(var I in le)Je(le,I)&&(Fe[I]=le[I]);Fe.name=We,x.UNITS[We]=Fe}return delete H.cache,new x(null,B)},x.deleteUnit=function(B){delete x.UNITS[B]},x.PREFIXES=T,x.BASE_DIMENSIONS=V,x.BASE_UNITS=F,x.UNIT_SYSTEMS=Q,x.UNITS=z,x},{isClass:!0}),_A="unit",i4=["typed","Unit"],s4=ke(_A,i4,r=>{var{typed:e,Unit:t}=r;return e(_A,{Unit:function(i){return i.clone()},string:function(i){return t.isValuelessUnit(i)?new t(null,i):t.parse(i,{allowNoUnits:!0})},"number | BigNumber | Fraction | Complex, string":function(i,s){return new t(i,s)},"Array | Matrix":function(i){return wn(i,this)}})}),TA="createUnit",o4=["typed","Unit"],a4=ke(TA,o4,r=>{var{typed:e,Unit:t}=r;return e(TA,{"Object, Object":function(i,s){return t.createUnit(i,s)},Object:function(i){return t.createUnit(i,{})},"string, Unit | string | Object, Object":function(i,s,o){var a={};return a[i]=s,t.createUnit(a,o)},"string, Unit | string | Object":function(i,s){var o={};return o[i]=s,t.createUnit(o,{})},string:function(i){var s={};return s[i]={},t.createUnit(s,{})}})}),CA="add",l4=["typed","matrix","addScalar","equalScalar","DenseMatrix","SparseMatrix"],c4=ke(CA,l4,r=>{var{typed:e,matrix:t,addScalar:n,equalScalar:i,DenseMatrix:s,SparseMatrix:o}=r,a=rA({typed:e}),l=zO({typed:e,equalScalar:i}),h=iA({typed:e,DenseMatrix:s}),u=hl({typed:e}),c=Br({typed:e});return e(CA,Cg({"DenseMatrix, DenseMatrix":function(d,p){return u(d,p,n)},"DenseMatrix, SparseMatrix":function(d,p){return a(d,p,n,!1)},"SparseMatrix, DenseMatrix":function(d,p){return a(p,d,n,!0)},"SparseMatrix, SparseMatrix":function(d,p){return l(d,p,n)},"Array, Array":function(d,p){return this(t(d),t(p)).valueOf()},"Array, Matrix":function(d,p){return this(t(d),p)},"Matrix, Array":function(d,p){return this(d,t(p))},"DenseMatrix, any":function(d,p){return c(d,p,n,!1)},"SparseMatrix, any":function(d,p){return h(d,p,n,!1)},"any, DenseMatrix":function(d,p){return c(p,d,n,!0)},"any, SparseMatrix":function(d,p){return h(p,d,n,!0)},"Array, any":function(d,p){return c(t(d),p,n,!1).valueOf()},"any, Array":function(d,p){return c(t(p),d,n,!0).valueOf()},"any, any":n,"any, any, ...any":function(d,p,m){for(var y=this(d,p),g=0;g<m.length;g++)y=this(y,m[g]);return y}},n.signatures))}),RA="dot",u4=["typed","addScalar","multiplyScalar","conj","size"],h4=ke(RA,u4,r=>{var{typed:e,addScalar:t,multiplyScalar:n,conj:i,size:s}=r;return e(RA,{"Array | DenseMatrix, Array | DenseMatrix":a,"SparseMatrix, SparseMatrix":l});function o(u,c){var f=h(u),d=h(c),p,m;if(f.length===1)p=f[0];else if(f.length===2&&f[1]===1)p=f[0];else throw new RangeError("Expected a column vector, instead got a matrix of size ("+f.join(", ")+")");if(d.length===1)m=d[0];else if(d.length===2&&d[1]===1)m=d[0];else throw new RangeError("Expected a column vector, instead got a matrix of size ("+d.join(", ")+")");if(p!==m)throw new RangeError("Vectors must have equal length ("+p+" != "+m+")");if(p===0)throw new RangeError("Cannot calculate the dot product of empty vectors");return p}function a(u,c){var f=o(u,c),d=hn(u)?u._data:u,p=hn(u)?u._datatype:void 0,m=hn(c)?c._data:c,y=hn(c)?c._datatype:void 0,g=h(u).length===2,v=h(c).length===2,x=t,w=n;if(p&&y&&p===y&&typeof p=="string"){var b=p;x=e.find(t,[b,b]),w=e.find(n,[b,b])}if(!g&&!v){for(var M=w(i(d[0]),m[0]),A=1;A<f;A++)M=x(M,w(i(d[A]),m[A]));return M}if(!g&&v){for(var E=w(i(d[0]),m[0][0]),N=1;N<f;N++)E=x(E,w(i(d[N]),m[N][0]));return E}if(g&&!v){for(var R=w(i(d[0][0]),m[0]),_=1;_<f;_++)R=x(R,w(i(d[_][0]),m[_]));return R}if(g&&v){for(var S=w(i(d[0][0]),m[0][0]),L=1;L<f;L++)S=x(S,w(i(d[L][0]),m[L][0]));return S}}function l(u,c){o(u,c);for(var f=u._index,d=u._values,p=c._index,m=c._values,y=0,g=t,v=n,x=0,w=0;x<f.length&&w<p.length;){var b=f[x],M=p[w];if(b<M){x++;continue}if(b>M){w++;continue}b===M&&(y=g(y,v(d[x],m[w])),x++,w++)}return y}function h(u){return hn(u)?u.size():s(u)}}),NA={end:!0},f4="Node",d4=["mathWithTransform"],p4=ke(f4,d4,r=>{var{mathWithTransform:e}=r;function t(){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator")}t.prototype.evaluate=function(i){return this.compile().evaluate(i)},t.prototype.type="Node",t.prototype.isNode=!0,t.prototype.comment="",t.prototype.compile=function(){var i=this._compile(e,{}),s={},o=null;function a(l){var h=l||{};return n(h),i(h,s,o)}return{evaluate:a}},t.prototype._compile=function(i,s){throw new Error("Method _compile should be implemented by type "+this.type)},t.prototype.forEach=function(i){throw new Error("Cannot run forEach on a Node interface")},t.prototype.map=function(i){throw new Error("Cannot run map on a Node interface")},t.prototype._ifNode=function(i){if(!Jt(i))throw new TypeError("Callback function must return a Node");return i},t.prototype.traverse=function(i){i(this,null,null);function s(o,a){o.forEach(function(l,h,u){a(l,h,u),s(l,a)})}s(this,i)},t.prototype.transform=function(i){function s(o,a,l){var h=i(o,a,l);return h!==o?h:o.map(s)}return s(this,null,null)},t.prototype.filter=function(i){var s=[];return this.traverse(function(o,a,l){i(o,a,l)&&s.push(o)}),s},t.prototype.clone=function(){throw new Error("Cannot clone a Node interface")},t.prototype.cloneDeep=function(){return this.map(function(i){return i.cloneDeep()})},t.prototype.equals=function(i){return i?il(this,i):!1},t.prototype.toString=function(i){var s;if(i&&typeof i=="object")switch(typeof i.handler){case"object":case"undefined":break;case"function":s=i.handler(this,i);break;default:throw new TypeError("Object or function expected as callback")}return typeof s!="undefined"?s:this._toString(i)},t.prototype.toJSON=function(){throw new Error("Cannot serialize object: toJSON not implemented by "+this.type)},t.prototype.toHTML=function(i){var s;if(i&&typeof i=="object")switch(typeof i.handler){case"object":case"undefined":break;case"function":s=i.handler(this,i);break;default:throw new TypeError("Object or function expected as callback")}return typeof s!="undefined"?s:this.toHTML(i)},t.prototype._toString=function(){throw new Error("_toString not implemented for "+this.type)},t.prototype.toTex=function(i){var s;if(i&&typeof i=="object")switch(typeof i.handler){case"object":case"undefined":break;case"function":s=i.handler(this,i);break;default:throw new TypeError("Object or function expected as callback")}return typeof s!="undefined"?s:this._toTex(i)},t.prototype._toTex=function(i){throw new Error("_toTex not implemented for "+this.type)},t.prototype.getIdentifier=function(){return this.type},t.prototype.getContent=function(){return this};function n(i){for(var s in i)if(Je(i,s)&&s in NA)throw new Error('Scope contains an illegal symbol, "'+s+'" is a reserved keyword')}return t},{isClass:!0,isNode:!0});function IA(r){return r&&r.isIndexError?new Bs(r.index+1,r.min+1,r.max!==void 0?r.max+1:void 0):r}function PA(r){var{subset:e}=r;return function(n,i){try{if(Array.isArray(n))return e(n,i);if(n&&typeof n.subset=="function")return n.subset(i);if(typeof n=="string")return e(n,i);if(typeof n=="object"){if(!i.isObjectProperty())throw new TypeError("Cannot apply a numeric index as object property");return $n(n,i.getObjectProperty())}else throw new TypeError("Cannot apply index: unsupported type of object")}catch(s){throw IA(s)}}}var m4="AccessorNode",g4=["subset","Node"],v4=ke(m4,g4,r=>{var{subset:e,Node:t}=r,n=PA({subset:e});function i(o,a){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if(!Jt(o))throw new TypeError('Node expected for parameter "object"');if(!Bc(a))throw new TypeError('IndexNode expected for parameter "index"');this.object=o||null,this.index=a,Object.defineProperty(this,"name",{get:function(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}.bind(this),set:function(){throw new Error("Cannot assign a new name, name is read-only")}})}i.prototype=new t,i.prototype.type="AccessorNode",i.prototype.isAccessorNode=!0,i.prototype._compile=function(o,a){var l=this.object._compile(o,a),h=this.index._compile(o,a);if(this.index.isObjectProperty()){var u=this.index.getObjectProperty();return function(f,d,p){return $n(l(f,d,p),u)}}else return function(f,d,p){var m=l(f,d,p),y=h(f,d,m);return n(m,y)}},i.prototype.forEach=function(o){o(this.object,"object",this),o(this.index,"index",this)},i.prototype.map=function(o){return new i(this._ifNode(o(this.object,"object",this)),this._ifNode(o(this.index,"index",this)))},i.prototype.clone=function(){return new i(this.object,this.index)},i.prototype._toString=function(o){var a=this.object.toString(o);return s(this.object)&&(a="("+a+")"),a+this.index.toString(o)},i.prototype.toHTML=function(o){var a=this.object.toHTML(o);return s(this.object)&&(a='<span class="math-parenthesis math-round-parenthesis">(</span>'+a+'<span class="math-parenthesis math-round-parenthesis">)</span>'),a+this.index.toHTML(o)},i.prototype._toTex=function(o){var a=this.object.toTex(o);return s(this.object)&&(a="\\left(' + object + '\\right)"),a+this.index.toTex(o)},i.prototype.toJSON=function(){return{mathjs:"AccessorNode",object:this.object,index:this.index}},i.fromJSON=function(o){return new i(o.object,o.index)};function s(o){return!(Io(o)||bg(o)||Po(o)||yf(o)||Ag(o)||Eg(o)||or(o))}return i},{isClass:!0,isNode:!0}),y4="ArrayNode",x4=["Node"],w4=ke(y4,x4,r=>{var{Node:e}=r;function t(n){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");if(this.items=n||[],!Array.isArray(this.items)||!this.items.every(Jt))throw new TypeError("Array containing Nodes expected")}return t.prototype=new e,t.prototype.type="ArrayNode",t.prototype.isArrayNode=!0,t.prototype._compile=function(n,i){var s=Pr(this.items,function(l){return l._compile(n,i)}),o=n.config.matrix!=="Array";if(o){var a=n.matrix;return function(h,u,c){return a(Pr(s,function(f){return f(h,u,c)}))}}else return function(h,u,c){return Pr(s,function(f){return f(h,u,c)})}},t.prototype.forEach=function(n){for(var i=0;i<this.items.length;i++){var s=this.items[i];n(s,"items["+i+"]",this)}},t.prototype.map=function(n){for(var i=[],s=0;s<this.items.length;s++)i[s]=this._ifNode(n(this.items[s],"items["+s+"]",this));return new t(i)},t.prototype.clone=function(){return new t(this.items.slice(0))},t.prototype._toString=function(n){var i=this.items.map(function(s){return s.toString(n)});return"["+i.join(", ")+"]"},t.prototype.toJSON=function(){return{mathjs:"ArrayNode",items:this.items}},t.fromJSON=function(n){return new t(n.items)},t.prototype.toHTML=function(n){var i=this.items.map(function(s){return s.toHTML(n)});return'<span class="math-parenthesis math-square-parenthesis">[</span>'+i.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-square-parenthesis">]</span>'},t.prototype._toTex=function(n){var i="\\begin{bmatrix}";return this.items.forEach(function(s){s.items?i+=s.items.map(function(o){return o.toTex(n)}).join("&"):i+=s.toTex(n),i+="\\\\"}),i+="\\end{bmatrix}",i},t},{isClass:!0,isNode:!0});function b4(r){var{subset:e,matrix:t}=r;return function(i,s,o){try{if(Array.isArray(i))return t(i).subset(s,o).valueOf();if(i&&typeof i.subset=="function")return i.subset(s,o);if(typeof i=="string")return e(i,s,o);if(typeof i=="object"){if(!s.isObjectProperty())throw TypeError("Cannot apply a numeric index as object property");return Oo(i,s.getObjectProperty(),o),i}else throw new TypeError("Cannot apply index: unsupported type of object")}catch(a){throw IA(a)}}}var xi=[{AssignmentNode:{},FunctionAssignmentNode:{}},{ConditionalNode:{latexLeftParens:!1,latexRightParens:!1,latexParens:!1}},{"OperatorNode:or":{associativity:"left",associativeWith:[]}},{"OperatorNode:xor":{associativity:"left",associativeWith:[]}},{"OperatorNode:and":{associativity:"left",associativeWith:[]}},{"OperatorNode:bitOr":{associativity:"left",associativeWith:[]}},{"OperatorNode:bitXor":{associativity:"left",associativeWith:[]}},{"OperatorNode:bitAnd":{associativity:"left",associativeWith:[]}},{"OperatorNode:equal":{associativity:"left",associativeWith:[]},"OperatorNode:unequal":{associativity:"left",associativeWith:[]},"OperatorNode:smaller":{associativity:"left",associativeWith:[]},"OperatorNode:larger":{associativity:"left",associativeWith:[]},"OperatorNode:smallerEq":{associativity:"left",associativeWith:[]},"OperatorNode:largerEq":{associativity:"left",associativeWith:[]},RelationalNode:{associativity:"left",associativeWith:[]}},{"OperatorNode:leftShift":{associativity:"left",associativeWith:[]},"OperatorNode:rightArithShift":{associativity:"left",associativeWith:[]},"OperatorNode:rightLogShift":{associativity:"left",associativeWith:[]}},{"OperatorNode:to":{associativity:"left",associativeWith:[]}},{RangeNode:{}},{"OperatorNode:add":{associativity:"left",associativeWith:["OperatorNode:add","OperatorNode:subtract"]},"OperatorNode:subtract":{associativity:"left",associativeWith:[]}},{"OperatorNode:multiply":{associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","Operator:dotMultiply","Operator:dotDivide"]},"OperatorNode:divide":{associativity:"left",associativeWith:[],latexLeftParens:!1,latexRightParens:!1,latexParens:!1},"OperatorNode:dotMultiply":{associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","OperatorNode:dotMultiply","OperatorNode:doDivide"]},"OperatorNode:dotDivide":{associativity:"left",associativeWith:[]},"OperatorNode:mod":{associativity:"left",associativeWith:[]}},{"OperatorNode:unaryPlus":{associativity:"right"},"OperatorNode:unaryMinus":{associativity:"right"},"OperatorNode:bitNot":{associativity:"right"},"OperatorNode:not":{associativity:"right"}},{"OperatorNode:pow":{associativity:"right",associativeWith:[],latexRightParens:!1},"OperatorNode:dotPow":{associativity:"right",associativeWith:[]}},{"OperatorNode:factorial":{associativity:"left"}},{"OperatorNode:transpose":{associativity:"left"}}];function Pt(r,e){var t=r;e!=="keep"&&(t=r.getContent());for(var n=t.getIdentifier(),i=0;i<xi.length;i++)if(n in xi[i])return i;return null}function kc(r,e){var t=r;e!=="keep"&&(t=r.getContent());var n=t.getIdentifier(),i=Pt(t,e);if(i===null)return null;var s=xi[i][n];if(Je(s,"associativity")){if(s.associativity==="left")return"left";if(s.associativity==="right")return"right";throw Error("'"+n+"' has the invalid associativity '"+s.associativity+"'.")}return null}function Wg(r,e,t){var n=t!=="keep"?r.getContent():r,i=t!=="keep"?r.getContent():e,s=n.getIdentifier(),o=i.getIdentifier(),a=Pt(n,t);if(a===null)return null;var l=xi[a][s];if(Je(l,"associativeWith")&&l.associativeWith instanceof Array){for(var h=0;h<l.associativeWith.length;h++)if(l.associativeWith[h]===o)return!0;return!1}return null}var M4="AssignmentNode",A4=["subset","?matrix","Node"],S4=ke(M4,A4,r=>{var{subset:e,matrix:t,Node:n}=r,i=PA({subset:e}),s=b4({subset:e,matrix:t});function o(l,h,u){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");if(this.object=l,this.index=u?h:null,this.value=u||h,!or(l)&&!Io(l))throw new TypeError('SymbolNode or AccessorNode expected as "object"');if(or(l)&&l.name==="end")throw new Error('Cannot assign to symbol "end"');if(this.index&&!Bc(this.index))throw new TypeError('IndexNode expected as "index"');if(!Jt(this.value))throw new TypeError('Node expected as "value"');Object.defineProperty(this,"name",{get:function(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}.bind(this),set:function(){throw new Error("Cannot assign a new name, name is read-only")}})}o.prototype=new n,o.prototype.type="AssignmentNode",o.prototype.isAssignmentNode=!0,o.prototype._compile=function(l,h){var u=this.object._compile(l,h),c=this.index?this.index._compile(l,h):null,f=this.value._compile(l,h),d=this.object.name;if(this.index)if(this.index.isObjectProperty()){var p=this.index.getObjectProperty();return function(x,w,b){var M=u(x,w,b),A=f(x,w,b);return Oo(M,p,A)}}else{if(or(this.object))return function(x,w,b){var M=u(x,w,b),A=f(x,w,b),E=c(x,w,M);return Oo(x,d,s(M,E,A)),A};var m=this.object.object._compile(l,h);if(this.object.index.isObjectProperty()){var y=this.object.index.getObjectProperty();return function(x,w,b){var M=m(x,w,b),A=$n(M,y),E=c(x,w,A),N=f(x,w,b);return Oo(M,y,s(A,E,N)),N}}else{var g=this.object.index._compile(l,h);return function(x,w,b){var M=m(x,w,b),A=g(x,w,M),E=i(M,A),N=c(x,w,E),R=f(x,w,b);return s(M,A,s(E,N,R)),R}}}else{if(!or(this.object))throw new TypeError("SymbolNode expected as object");return function(x,w,b){return Oo(x,d,f(x,w,b))}}},o.prototype.forEach=function(l){l(this.object,"object",this),this.index&&l(this.index,"index",this),l(this.value,"value",this)},o.prototype.map=function(l){var h=this._ifNode(l(this.object,"object",this)),u=this.index?this._ifNode(l(this.index,"index",this)):null,c=this._ifNode(l(this.value,"value",this));return new o(h,u,c)},o.prototype.clone=function(){return new o(this.object,this.index,this.value)};function a(l,h){h||(h="keep");var u=Pt(l,h),c=Pt(l.value,h);return h==="all"||c!==null&&c<=u}return o.prototype._toString=function(l){var h=this.object.toString(l),u=this.index?this.index.toString(l):"",c=this.value.toString(l);return a(this,l&&l.parenthesis)&&(c="("+c+")"),h+u+" = "+c},o.prototype.toJSON=function(){return{mathjs:"AssignmentNode",object:this.object,index:this.index,value:this.value}},o.fromJSON=function(l){return new o(l.object,l.index,l.value)},o.prototype.toHTML=function(l){var h=this.object.toHTML(l),u=this.index?this.index.toHTML(l):"",c=this.value.toHTML(l);return a(this,l&&l.parenthesis)&&(c='<span class="math-paranthesis math-round-parenthesis">(</span>'+c+'<span class="math-paranthesis math-round-parenthesis">)</span>'),h+u+'<span class="math-operator math-assignment-operator math-variable-assignment-operator math-binary-operator">=</span>'+c},o.prototype._toTex=function(l){var h=this.object.toTex(l),u=this.index?this.index.toTex(l):"",c=this.value.toTex(l);return a(this,l&&l.parenthesis)&&(c="\\left(".concat(c,"\\right)")),h+u+":="+c},o},{isClass:!0,isNode:!0}),E4="BlockNode",_4=["ResultSet","Node"],T4=ke(E4,_4,r=>{var{ResultSet:e,Node:t}=r;function n(i){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(!Array.isArray(i))throw new Error("Array expected");this.blocks=i.map(function(s){var o=s&&s.node,a=s&&s.visible!==void 0?s.visible:!0;if(!Jt(o))throw new TypeError('Property "node" must be a Node');if(typeof a!="boolean")throw new TypeError('Property "visible" must be a boolean');return{node:o,visible:a}})}return n.prototype=new t,n.prototype.type="BlockNode",n.prototype.isBlockNode=!0,n.prototype._compile=function(i,s){var o=Pr(this.blocks,function(a){return{evaluate:a.node._compile(i,s),visible:a.visible}});return function(l,h,u){var c=[];return _M(o,function(d){var p=d.evaluate(l,h,u);d.visible&&c.push(p)}),new e(c)}},n.prototype.forEach=function(i){for(var s=0;s<this.blocks.length;s++)i(this.blocks[s].node,"blocks["+s+"].node",this)},n.prototype.map=function(i){for(var s=[],o=0;o<this.blocks.length;o++){var a=this.blocks[o],l=this._ifNode(i(a.node,"blocks["+o+"].node",this));s[o]={node:l,visible:a.visible}}return new n(s)},n.prototype.clone=function(){var i=this.blocks.map(function(s){return{node:s.node,visible:s.visible}});return new n(i)},n.prototype._toString=function(i){return this.blocks.map(function(s){return s.node.toString(i)+(s.visible?"":";")}).join(`
`)},n.prototype.toJSON=function(){return{mathjs:"BlockNode",blocks:this.blocks}},n.fromJSON=function(i){return new n(i.blocks)},n.prototype.toHTML=function(i){return this.blocks.map(function(s){return s.node.toHTML(i)+(s.visible?"":'<span class="math-separator">;</span>')}).join('<span class="math-separator"><br /></span>')},n.prototype._toTex=function(i){return this.blocks.map(function(s){return s.node.toTex(i)+(s.visible?"":";")}).join(`\\;\\;
`)},n},{isClass:!0,isNode:!0}),C4="ConditionalNode",R4=["Node"],N4=ke(C4,R4,r=>{var{Node:e}=r;function t(i,s,o){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");if(!Jt(i))throw new TypeError("Parameter condition must be a Node");if(!Jt(s))throw new TypeError("Parameter trueExpr must be a Node");if(!Jt(o))throw new TypeError("Parameter falseExpr must be a Node");this.condition=i,this.trueExpr=s,this.falseExpr=o}t.prototype=new e,t.prototype.type="ConditionalNode",t.prototype.isConditionalNode=!0,t.prototype._compile=function(i,s){var o=this.condition._compile(i,s),a=this.trueExpr._compile(i,s),l=this.falseExpr._compile(i,s);return function(u,c,f){return n(o(u,c,f))?a(u,c,f):l(u,c,f)}},t.prototype.forEach=function(i){i(this.condition,"condition",this),i(this.trueExpr,"trueExpr",this),i(this.falseExpr,"falseExpr",this)},t.prototype.map=function(i){return new t(this._ifNode(i(this.condition,"condition",this)),this._ifNode(i(this.trueExpr,"trueExpr",this)),this._ifNode(i(this.falseExpr,"falseExpr",this)))},t.prototype.clone=function(){return new t(this.condition,this.trueExpr,this.falseExpr)},t.prototype._toString=function(i){var s=i&&i.parenthesis?i.parenthesis:"keep",o=Pt(this,s),a=this.condition.toString(i),l=Pt(this.condition,s);(s==="all"||this.condition.type==="OperatorNode"||l!==null&&l<=o)&&(a="("+a+")");var h=this.trueExpr.toString(i),u=Pt(this.trueExpr,s);(s==="all"||this.trueExpr.type==="OperatorNode"||u!==null&&u<=o)&&(h="("+h+")");var c=this.falseExpr.toString(i),f=Pt(this.falseExpr,s);return(s==="all"||this.falseExpr.type==="OperatorNode"||f!==null&&f<=o)&&(c="("+c+")"),a+" ? "+h+" : "+c},t.prototype.toJSON=function(){return{mathjs:"ConditionalNode",condition:this.condition,trueExpr:this.trueExpr,falseExpr:this.falseExpr}},t.fromJSON=function(i){return new t(i.condition,i.trueExpr,i.falseExpr)},t.prototype.toHTML=function(i){var s=i&&i.parenthesis?i.parenthesis:"keep",o=Pt(this,s),a=this.condition.toHTML(i),l=Pt(this.condition,s);(s==="all"||this.condition.type==="OperatorNode"||l!==null&&l<=o)&&(a='<span class="math-parenthesis math-round-parenthesis">(</span>'+a+'<span class="math-parenthesis math-round-parenthesis">)</span>');var h=this.trueExpr.toHTML(i),u=Pt(this.trueExpr,s);(s==="all"||this.trueExpr.type==="OperatorNode"||u!==null&&u<=o)&&(h='<span class="math-parenthesis math-round-parenthesis">(</span>'+h+'<span class="math-parenthesis math-round-parenthesis">)</span>');var c=this.falseExpr.toHTML(i),f=Pt(this.falseExpr,s);return(s==="all"||this.falseExpr.type==="OperatorNode"||f!==null&&f<=o)&&(c='<span class="math-parenthesis math-round-parenthesis">(</span>'+c+'<span class="math-parenthesis math-round-parenthesis">)</span>'),a+'<span class="math-operator math-conditional-operator">?</span>'+h+'<span class="math-operator math-conditional-operator">:</span>'+c},t.prototype._toTex=function(i){return"\\begin{cases} {"+this.trueExpr.toTex(i)+"}, &\\quad{\\text{if }\\;"+this.condition.toTex(i)+"}\\\\{"+this.falseExpr.toTex(i)+"}, &\\quad{\\text{otherwise}}\\end{cases}"};function n(i){if(typeof i=="number"||typeof i=="boolean"||typeof i=="string")return!!i;if(i){if(Wt(i))return!i.isZero();if(Qi(i))return!!(i.re||i.im);if(No(i))return!!i.value}if(i==null)return!1;throw new TypeError('Unsupported type of condition "'+Kn(i)+'"')}return t},{isClass:!0,isNode:!0}),qg=Object.assign||function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},I4={"{":"\\{","}":"\\}","\\":"\\textbackslash{}","#":"\\#",$:"\\$","%":"\\%","&":"\\&","^":"\\textasciicircum{}",_:"\\_","~":"\\textasciitilde{}"},P4={"\u2013":"\\--","\u2014":"\\---"," ":"~","	":"\\qquad{}","\r\n":"\\newline{}","\n":"\\newline{}"},B4=function(e,t){return qg({},e,t)},L4=function(r){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.preserveFormatting,n=t===void 0?!1:t,i=e.escapeMapFn,s=i===void 0?B4:i,o=String(r),a="",l=s(qg({},I4),n?qg({},P4):{}),h=Object.keys(l),u=function(){var f=!1;h.forEach(function(d,p){f||o.length>=d.length&&o.slice(0,d.length)===d&&(a+=l[h[p]],o=o.slice(d.length,o.length),f=!0)}),f||(a+=o.slice(0,1),o=o.slice(1,o.length))};o;)u();return a},D4=L4,Yg={Alpha:"A",alpha:"\\alpha",Beta:"B",beta:"\\beta",Gamma:"\\Gamma",gamma:"\\gamma",Delta:"\\Delta",delta:"\\delta",Epsilon:"E",epsilon:"\\epsilon",varepsilon:"\\varepsilon",Zeta:"Z",zeta:"\\zeta",Eta:"H",eta:"\\eta",Theta:"\\Theta",theta:"\\theta",vartheta:"\\vartheta",Iota:"I",iota:"\\iota",Kappa:"K",kappa:"\\kappa",varkappa:"\\varkappa",Lambda:"\\Lambda",lambda:"\\lambda",Mu:"M",mu:"\\mu",Nu:"N",nu:"\\nu",Xi:"\\Xi",xi:"\\xi",Omicron:"O",omicron:"o",Pi:"\\Pi",pi:"\\pi",varpi:"\\varpi",Rho:"P",rho:"\\rho",varrho:"\\varrho",Sigma:"\\Sigma",sigma:"\\sigma",varsigma:"\\varsigma",Tau:"T",tau:"\\tau",Upsilon:"\\Upsilon",upsilon:"\\upsilon",Phi:"\\Phi",phi:"\\phi",varphi:"\\varphi",Chi:"X",chi:"\\chi",Psi:"\\Psi",psi:"\\psi",Omega:"\\Omega",omega:"\\omega",true:"\\mathrm{True}",false:"\\mathrm{False}",i:"i",inf:"\\infty",Inf:"\\infty",infinity:"\\infty",Infinity:"\\infty",oo:"\\infty",lim:"\\lim",undefined:"\\mathbf{?}"},yt={transpose:"^\\top",ctranspose:"^H",factorial:"!",pow:"^",dotPow:".^\\wedge",unaryPlus:"+",unaryMinus:"-",bitNot:"\\~",not:"\\neg",multiply:"\\cdot",divide:"\\frac",dotMultiply:".\\cdot",dotDivide:".:",mod:"\\mod",add:"+",subtract:"-",to:"\\rightarrow",leftShift:"<<",rightArithShift:">>",rightLogShift:">>>",equal:"=",unequal:"\\neq",smaller:"<",larger:">",smallerEq:"\\leq",largerEq:"\\geq",bitAnd:"\\&",bitXor:"\\underline{|}",bitOr:"|",and:"\\wedge",xor:"\\veebar",or:"\\vee"},BA={abs:{1:"\\left|${args[0]}\\right|"},add:{2:"\\left(${args[0]}".concat(yt.add,"${args[1]}\\right)")},cbrt:{1:"\\sqrt[3]{${args[0]}}"},ceil:{1:"\\left\\lceil${args[0]}\\right\\rceil"},cube:{1:"\\left(${args[0]}\\right)^3"},divide:{2:"\\frac{${args[0]}}{${args[1]}}"},dotDivide:{2:"\\left(${args[0]}".concat(yt.dotDivide,"${args[1]}\\right)")},dotMultiply:{2:"\\left(${args[0]}".concat(yt.dotMultiply,"${args[1]}\\right)")},dotPow:{2:"\\left(${args[0]}".concat(yt.dotPow,"${args[1]}\\right)")},exp:{1:"\\exp\\left(${args[0]}\\right)"},expm1:"\\left(e".concat(yt.pow,"{${args[0]}}-1\\right)"),fix:{1:"\\mathrm{${name}}\\left(${args[0]}\\right)"},floor:{1:"\\left\\lfloor${args[0]}\\right\\rfloor"},gcd:"\\gcd\\left(${args}\\right)",hypot:"\\hypot\\left(${args}\\right)",log:{1:"\\ln\\left(${args[0]}\\right)",2:"\\log_{${args[1]}}\\left(${args[0]}\\right)"},log10:{1:"\\log_{10}\\left(${args[0]}\\right)"},log1p:{1:"\\ln\\left(${args[0]}+1\\right)",2:"\\log_{${args[1]}}\\left(${args[0]}+1\\right)"},log2:"\\log_{2}\\left(${args[0]}\\right)",mod:{2:"\\left(${args[0]}".concat(yt.mod,"${args[1]}\\right)")},multiply:{2:"\\left(${args[0]}".concat(yt.multiply,"${args[1]}\\right)")},norm:{1:"\\left\\|${args[0]}\\right\\|",2:void 0},nthRoot:{2:"\\sqrt[${args[1]}]{${args[0]}}"},nthRoots:{2:"\\{y : $y^{args[1]} = {${args[0]}}\\}"},pow:{2:"\\left(${args[0]}\\right)".concat(yt.pow,"{${args[1]}}")},round:{1:"\\left\\lfloor${args[0]}\\right\\rceil",2:void 0},sign:{1:"\\mathrm{${name}}\\left(${args[0]}\\right)"},sqrt:{1:"\\sqrt{${args[0]}}"},square:{1:"\\left(${args[0]}\\right)^2"},subtract:{2:"\\left(${args[0]}".concat(yt.subtract,"${args[1]}\\right)")},unaryMinus:{1:"".concat(yt.unaryMinus,"\\left(${args[0]}\\right)")},unaryPlus:{1:"".concat(yt.unaryPlus,"\\left(${args[0]}\\right)")},bitAnd:{2:"\\left(${args[0]}".concat(yt.bitAnd,"${args[1]}\\right)")},bitNot:{1:yt.bitNot+"\\left(${args[0]}\\right)"},bitOr:{2:"\\left(${args[0]}".concat(yt.bitOr,"${args[1]}\\right)")},bitXor:{2:"\\left(${args[0]}".concat(yt.bitXor,"${args[1]}\\right)")},leftShift:{2:"\\left(${args[0]}".concat(yt.leftShift,"${args[1]}\\right)")},rightArithShift:{2:"\\left(${args[0]}".concat(yt.rightArithShift,"${args[1]}\\right)")},rightLogShift:{2:"\\left(${args[0]}".concat(yt.rightLogShift,"${args[1]}\\right)")},bellNumbers:{1:"\\mathrm{B}_{${args[0]}}"},catalan:{1:"\\mathrm{C}_{${args[0]}}"},stirlingS2:{2:"\\mathrm{S}\\left(${args}\\right)"},arg:{1:"\\arg\\left(${args[0]}\\right)"},conj:{1:"\\left(${args[0]}\\right)^*"},im:{1:"\\Im\\left\\lbrace${args[0]}\\right\\rbrace"},re:{1:"\\Re\\left\\lbrace${args[0]}\\right\\rbrace"},and:{2:"\\left(${args[0]}".concat(yt.and,"${args[1]}\\right)")},not:{1:yt.not+"\\left(${args[0]}\\right)"},or:{2:"\\left(${args[0]}".concat(yt.or,"${args[1]}\\right)")},xor:{2:"\\left(${args[0]}".concat(yt.xor,"${args[1]}\\right)")},cross:{2:"\\left(${args[0]}\\right)\\times\\left(${args[1]}\\right)"},ctranspose:{1:"\\left(${args[0]}\\right)".concat(yt.ctranspose)},det:{1:"\\det\\left(${args[0]}\\right)"},dot:{2:"\\left(${args[0]}\\cdot${args[1]}\\right)"},expm:{1:"\\exp\\left(${args[0]}\\right)"},inv:{1:"\\left(${args[0]}\\right)^{-1}"},sqrtm:{1:"{${args[0]}}".concat(yt.pow,"{\\frac{1}{2}}")},trace:{1:"\\mathrm{tr}\\left(${args[0]}\\right)"},transpose:{1:"\\left(${args[0]}\\right)".concat(yt.transpose)},combinations:{2:"\\binom{${args[0]}}{${args[1]}}"},combinationsWithRep:{2:"\\left(\\!\\!{\\binom{${args[0]}}{${args[1]}}}\\!\\!\\right)"},factorial:{1:"\\left(${args[0]}\\right)".concat(yt.factorial)},gamma:{1:"\\Gamma\\left(${args[0]}\\right)"},equal:{2:"\\left(${args[0]}".concat(yt.equal,"${args[1]}\\right)")},larger:{2:"\\left(${args[0]}".concat(yt.larger,"${args[1]}\\right)")},largerEq:{2:"\\left(${args[0]}".concat(yt.largerEq,"${args[1]}\\right)")},smaller:{2:"\\left(${args[0]}".concat(yt.smaller,"${args[1]}\\right)")},smallerEq:{2:"\\left(${args[0]}".concat(yt.smallerEq,"${args[1]}\\right)")},unequal:{2:"\\left(${args[0]}".concat(yt.unequal,"${args[1]}\\right)")},erf:{1:"erf\\left(${args[0]}\\right)"},max:"\\max\\left(${args}\\right)",min:"\\min\\left(${args}\\right)",variance:"\\mathrm{Var}\\left(${args}\\right)",acos:{1:"\\cos^{-1}\\left(${args[0]}\\right)"},acosh:{1:"\\cosh^{-1}\\left(${args[0]}\\right)"},acot:{1:"\\cot^{-1}\\left(${args[0]}\\right)"},acoth:{1:"\\coth^{-1}\\left(${args[0]}\\right)"},acsc:{1:"\\csc^{-1}\\left(${args[0]}\\right)"},acsch:{1:"\\mathrm{csch}^{-1}\\left(${args[0]}\\right)"},asec:{1:"\\sec^{-1}\\left(${args[0]}\\right)"},asech:{1:"\\mathrm{sech}^{-1}\\left(${args[0]}\\right)"},asin:{1:"\\sin^{-1}\\left(${args[0]}\\right)"},asinh:{1:"\\sinh^{-1}\\left(${args[0]}\\right)"},atan:{1:"\\tan^{-1}\\left(${args[0]}\\right)"},atan2:{2:"\\mathrm{atan2}\\left(${args}\\right)"},atanh:{1:"\\tanh^{-1}\\left(${args[0]}\\right)"},cos:{1:"\\cos\\left(${args[0]}\\right)"},cosh:{1:"\\cosh\\left(${args[0]}\\right)"},cot:{1:"\\cot\\left(${args[0]}\\right)"},coth:{1:"\\coth\\left(${args[0]}\\right)"},csc:{1:"\\csc\\left(${args[0]}\\right)"},csch:{1:"\\mathrm{csch}\\left(${args[0]}\\right)"},sec:{1:"\\sec\\left(${args[0]}\\right)"},sech:{1:"\\mathrm{sech}\\left(${args[0]}\\right)"},sin:{1:"\\sin\\left(${args[0]}\\right)"},sinh:{1:"\\sinh\\left(${args[0]}\\right)"},tan:{1:"\\tan\\left(${args[0]}\\right)"},tanh:{1:"\\tanh\\left(${args[0]}\\right)"},to:{2:"\\left(${args[0]}".concat(yt.to,"${args[1]}\\right)")},numeric:function(e,t){return e.args[0].toTex()},number:{0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"},string:{0:'\\mathtt{""}',1:"\\mathrm{string}\\left(${args[0]}\\right)"},bignumber:{0:"0",1:"\\left(${args[0]}\\right)"},complex:{0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)+".concat(Yg.i,"\\cdot\\left(${args[1]}\\right)\\right)")},matrix:{0:"\\begin{bmatrix}\\end{bmatrix}",1:"\\left(${args[0]}\\right)",2:"\\left(${args[0]}\\right)"},sparse:{0:"\\begin{bsparse}\\end{bsparse}",1:"\\left(${args[0]}\\right)"},unit:{1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"}},F4="\\mathrm{${name}}\\left(${args}\\right)",LA={deg:"^\\circ"};function Xg(r){return D4(r,{preserveFormatting:!0})}function DA(r,e){return e=typeof e=="undefined"?!1:e,e?Je(LA,r)?LA[r]:"\\mathrm{"+Xg(r)+"}":Je(Yg,r)?Yg[r]:Xg(r)}var O4="ConstantNode",z4=["Node"],U4=ke(O4,z4,r=>{var{Node:e}=r;function t(n){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");this.value=n}return t.prototype=new e,t.prototype.type="ConstantNode",t.prototype.isConstantNode=!0,t.prototype._compile=function(n,i){var s=this.value;return function(){return s}},t.prototype.forEach=function(n){},t.prototype.map=function(n){return this.clone()},t.prototype.clone=function(){return new t(this.value)},t.prototype._toString=function(n){return rn(this.value,n)},t.prototype.toHTML=function(n){var i=this._toString(n);switch(Kn(this.value)){case"number":case"BigNumber":case"Fraction":return'<span class="math-number">'+i+"</span>";case"string":return'<span class="math-string">'+i+"</span>";case"boolean":return'<span class="math-boolean">'+i+"</span>";case"null":return'<span class="math-null-symbol">'+i+"</span>";case"undefined":return'<span class="math-undefined">'+i+"</span>";default:return'<span class="math-symbol">'+i+"</span>"}},t.prototype.toJSON=function(){return{mathjs:"ConstantNode",value:this.value}},t.fromJSON=function(n){return new t(n.value)},t.prototype._toTex=function(n){var i=this._toString(n);switch(Kn(this.value)){case"string":return"\\mathtt{"+Xg(i)+"}";case"number":case"BigNumber":{if(!isFinite(this.value))return this.value.valueOf()<0?"-\\infty":"\\infty";var s=i.toLowerCase().indexOf("e");if(s!==-1)return i.substring(0,s)+"\\cdot10^{"+i.substring(s+1)+"}"}return i;case"Fraction":return this.value.toLatex();default:return i}},t},{isClass:!0,isNode:!0}),H4="FunctionAssignmentNode",G4=["typed","Node"],k4=ke(H4,G4,r=>{var{typed:e,Node:t}=r;function n(s,o,a){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(typeof s!="string")throw new TypeError('String expected for parameter "name"');if(!Array.isArray(o))throw new TypeError('Array containing strings or objects expected for parameter "params"');if(!Jt(a))throw new TypeError('Node expected for parameter "expr"');if(s in NA)throw new Error('Illegal function name, "'+s+'" is a reserved keyword');this.name=s,this.params=o.map(function(l){return l&&l.name||l}),this.types=o.map(function(l){return l&&l.type||"any"}),this.expr=a}n.prototype=new t,n.prototype.type="FunctionAssignmentNode",n.prototype.isFunctionAssignmentNode=!0,n.prototype._compile=function(s,o){var a=Object.create(o);_M(this.params,function(d){a[d]=!0});var l=this.expr._compile(s,a),h=this.name,u=this.params,c=TM(this.types,","),f=h+"("+TM(this.params,", ")+")";return function(p,m,y){var g={};g[c]=function(){for(var x=Object.create(m),w=0;w<u.length;w++)x[u[w]]=arguments[w];return l(p,x,y)};var v=e(h,g);return v.syntax=f,Oo(p,h,v),v}},n.prototype.forEach=function(s){s(this.expr,"expr",this)},n.prototype.map=function(s){var o=this._ifNode(s(this.expr,"expr",this));return new n(this.name,this.params.slice(0),o)},n.prototype.clone=function(){return new n(this.name,this.params.slice(0),this.expr)};function i(s,o){var a=Pt(s,o),l=Pt(s.expr,o);return o==="all"||l!==null&&l<=a}return n.prototype._toString=function(s){var o=s&&s.parenthesis?s.parenthesis:"keep",a=this.expr.toString(s);return i(this,o)&&(a="("+a+")"),this.name+"("+this.params.join(", ")+") = "+a},n.prototype.toJSON=function(){var s=this.types;return{mathjs:"FunctionAssignmentNode",name:this.name,params:this.params.map(function(o,a){return{name:o,type:s[a]}}),expr:this.expr}},n.fromJSON=function(s){return new n(s.name,s.params,s.expr)},n.prototype.toHTML=function(s){for(var o=s&&s.parenthesis?s.parenthesis:"keep",a=[],l=0;l<this.params.length;l++)a.push('<span class="math-symbol math-parameter">'+Nr(this.params[l])+"</span>");var h=this.expr.toHTML(s);return i(this,o)&&(h='<span class="math-parenthesis math-round-parenthesis">(</span>'+h+'<span class="math-parenthesis math-round-parenthesis">)</span>'),'<span class="math-function">'+Nr(this.name)+'</span><span class="math-parenthesis math-round-parenthesis">(</span>'+a.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-round-parenthesis">)</span><span class="math-operator math-assignment-operator math-variable-assignment-operator math-binary-operator">=</span>'+h},n.prototype._toTex=function(s){var o=s&&s.parenthesis?s.parenthesis:"keep",a=this.expr.toTex(s);return i(this,o)&&(a="\\left(".concat(a,"\\right)")),"\\mathrm{"+this.name+"}\\left("+this.params.map(DA).join(",")+"\\right):="+a},n},{isClass:!0,isNode:!0}),V4="IndexNode",W4=["Range","Node","size"],q4=ke(V4,W4,r=>{var{Range:e,Node:t,size:n}=r;function i(o,a){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if(this.dimensions=o,this.dotNotation=a||!1,!Array.isArray(o)||!o.every(Jt))throw new TypeError('Array containing Nodes expected for parameter "dimensions"');if(this.dotNotation&&!this.isObjectProperty())throw new Error("dotNotation only applicable for object properties")}i.prototype=new t,i.prototype.type="IndexNode",i.prototype.isIndexNode=!0,i.prototype._compile=function(o,a){var l=Pr(this.dimensions,function(u,c){if(_g(u))if(u.needsEnd()){var f=Object.create(a);f.end=!0;var d=u.start._compile(o,f),p=u.end._compile(o,f),m=u.step?u.step._compile(o,f):function(){return 1};return function(A,E,N){var R=n(N).valueOf(),_=Object.create(E);return _.end=R[c],s(d(A,_,N),p(A,_,N),m(A,_,N))}}else{var y=u.start._compile(o,a),g=u.end._compile(o,a),v=u.step?u.step._compile(o,a):function(){return 1};return function(A,E,N){return s(y(A,E,N),g(A,E,N),v(A,E,N))}}else if(or(u)&&u.name==="end"){var x=Object.create(a);x.end=!0;var w=u._compile(o,x);return function(A,E,N){var R=n(N).valueOf(),_=Object.create(E);return _.end=R[c],w(A,_,N)}}else{var b=u._compile(o,a);return function(A,E,N){return b(A,E,N)}}}),h=$n(o,"index");return function(c,f,d){var p=Pr(l,function(m){return m(c,f,d)});return h(...p)}},i.prototype.forEach=function(o){for(var a=0;a<this.dimensions.length;a++)o(this.dimensions[a],"dimensions["+a+"]",this)},i.prototype.map=function(o){for(var a=[],l=0;l<this.dimensions.length;l++)a[l]=this._ifNode(o(this.dimensions[l],"dimensions["+l+"]",this));return new i(a,this.dotNotation)},i.prototype.clone=function(){return new i(this.dimensions.slice(0),this.dotNotation)},i.prototype.isObjectProperty=function(){return this.dimensions.length===1&&Po(this.dimensions[0])&&typeof this.dimensions[0].value=="string"},i.prototype.getObjectProperty=function(){return this.isObjectProperty()?this.dimensions[0].value:null},i.prototype._toString=function(o){return this.dotNotation?"."+this.getObjectProperty():"["+this.dimensions.join(", ")+"]"},i.prototype.toJSON=function(){return{mathjs:"IndexNode",dimensions:this.dimensions,dotNotation:this.dotNotation}},i.fromJSON=function(o){return new i(o.dimensions,o.dotNotation)},i.prototype.toHTML=function(o){for(var a=[],l=0;l<this.dimensions.length;l++)a[l]=this.dimensions[l].toHTML();return this.dotNotation?'<span class="math-operator math-accessor-operator">.</span><span class="math-symbol math-property">'+Nr(this.getObjectProperty())+"</span>":'<span class="math-parenthesis math-square-parenthesis">[</span>'+a.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-square-parenthesis">]</span>'},i.prototype._toTex=function(o){var a=this.dimensions.map(function(l){return l.toTex(o)});return this.dotNotation?"."+this.getObjectProperty()+"":"_{"+a.join(",")+"}"};function s(o,a,l){return new e(Wt(o)?o.toNumber():o,Wt(a)?a.toNumber():a,Wt(l)?l.toNumber():l)}return i},{isClass:!0,isNode:!0}),Y4="ObjectNode",X4=["Node"],Q4=ke(Y4,X4,r=>{var{Node:e}=r;function t(n){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");if(this.properties=n||{},n&&(typeof n!="object"||!Object.keys(n).every(function(i){return Jt(n[i])})))throw new TypeError("Object containing Nodes expected")}return t.prototype=new e,t.prototype.type="ObjectNode",t.prototype.isObjectNode=!0,t.prototype._compile=function(n,i){var s={};for(var o in this.properties)if(Je(this.properties,o)){var a=bf(o),l=JSON.parse(a);if(!Gg(this.properties,l))throw new Error('No access to property "'+l+'"');s[l]=this.properties[o]._compile(n,i)}return function(u,c,f){var d={};for(var p in s)Je(s,p)&&(d[p]=s[p](u,c,f));return d}},t.prototype.forEach=function(n){for(var i in this.properties)Je(this.properties,i)&&n(this.properties[i],"properties["+bf(i)+"]",this)},t.prototype.map=function(n){var i={};for(var s in this.properties)Je(this.properties,s)&&(i[s]=this._ifNode(n(this.properties[s],"properties["+bf(s)+"]",this)));return new t(i)},t.prototype.clone=function(){var n={};for(var i in this.properties)Je(this.properties,i)&&(n[i]=this.properties[i]);return new t(n)},t.prototype._toString=function(n){var i=[];for(var s in this.properties)Je(this.properties,s)&&i.push(bf(s)+": "+this.properties[s].toString(n));return"{"+i.join(", ")+"}"},t.prototype.toJSON=function(){return{mathjs:"ObjectNode",properties:this.properties}},t.fromJSON=function(n){return new t(n.properties)},t.prototype.toHTML=function(n){var i=[];for(var s in this.properties)Je(this.properties,s)&&i.push('<span class="math-symbol math-property">'+Nr(s)+'</span><span class="math-operator math-assignment-operator math-property-assignment-operator math-binary-operator">:</span>'+this.properties[s].toHTML(n));return'<span class="math-parenthesis math-curly-parenthesis">{</span>'+i.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-curly-parenthesis">}</span>'},t.prototype._toTex=function(n){var i=[];for(var s in this.properties)Je(this.properties,s)&&i.push("\\mathbf{"+s+":} & "+this.properties[s].toTex(n)+"\\\\");return"\\left\\{\\begin{array}{ll}".concat(i.join(`
`),"\\end{array}\\right\\}")},t},{isClass:!0,isNode:!0}),j4="OperatorNode",Z4=["Node"],J4=ke(j4,Z4,r=>{var{Node:e}=r;function t(i,s,o,a){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");if(typeof i!="string")throw new TypeError('string expected for parameter "op"');if(typeof s!="string")throw new TypeError('string expected for parameter "fn"');if(!Array.isArray(o)||!o.every(Jt))throw new TypeError('Array containing Nodes expected for parameter "args"');this.implicit=a===!0,this.op=i,this.fn=s,this.args=o||[]}t.prototype=new e,t.prototype.type="OperatorNode",t.prototype.isOperatorNode=!0,t.prototype._compile=function(i,s){if(typeof this.fn!="string"||!kg(i,this.fn))throw i[this.fn]?new Error('No access to function "'+this.fn+'"'):new Error("Function "+this.fn+' missing in provided namespace "math"');var o=$n(i,this.fn),a=Pr(this.args,function(c){return c._compile(i,s)});if(a.length===1){var l=a[0];return function(f,d,p){return o(l(f,d,p))}}else if(a.length===2){var h=a[0],u=a[1];return function(f,d,p){return o(h(f,d,p),u(f,d,p))}}else return function(f,d,p){return o.apply(null,Pr(a,function(m){return m(f,d,p)}))}},t.prototype.forEach=function(i){for(var s=0;s<this.args.length;s++)i(this.args[s],"args["+s+"]",this)},t.prototype.map=function(i){for(var s=[],o=0;o<this.args.length;o++)s[o]=this._ifNode(i(this.args[o],"args["+o+"]",this));return new t(this.op,this.fn,s,this.implicit)},t.prototype.clone=function(){return new t(this.op,this.fn,this.args.slice(0),this.implicit)},t.prototype.isUnary=function(){return this.args.length===1},t.prototype.isBinary=function(){return this.args.length===2};function n(i,s,o,a,l){var h=Pt(i,s),u=kc(i,s);if(s==="all"||a.length>2&&i.getIdentifier()!=="OperatorNode:add"&&i.getIdentifier()!=="OperatorNode:multiply")return a.map(function(E){switch(E.getContent().type){case"ArrayNode":case"ConstantNode":case"SymbolNode":case"ParenthesisNode":return!1;default:return!0}});var c;switch(a.length){case 0:c=[];break;case 1:{var f=Pt(a[0],s);if(l&&f!==null){var d,p;if(s==="keep"?(d=a[0].getIdentifier(),p=i.getIdentifier()):(d=a[0].getContent().getIdentifier(),p=i.getContent().getIdentifier()),xi[h][p].latexLeftParens===!1){c=[!1];break}if(xi[f][d].latexParens===!1){c=[!1];break}}if(f===null){c=[!1];break}if(f<=h){c=[!0];break}c=[!1]}break;case 2:{var m,y=Pt(a[0],s),g=Wg(i,a[0],s);y===null?m=!1:y===h&&u==="right"&&!g||y<h?m=!0:m=!1;var v,x=Pt(a[1],s),w=Wg(i,a[1],s);if(x===null?v=!1:x===h&&u==="left"&&!w||x<h?v=!0:v=!1,l){var b,M,A;s==="keep"?(b=i.getIdentifier(),M=i.args[0].getIdentifier(),A=i.args[1].getIdentifier()):(b=i.getContent().getIdentifier(),M=i.args[0].getContent().getIdentifier(),A=i.args[1].getContent().getIdentifier()),y!==null&&(xi[h][b].latexLeftParens===!1&&(m=!1),xi[y][M].latexParens===!1&&(m=!1)),x!==null&&(xi[h][b].latexRightParens===!1&&(v=!1),xi[x][A].latexParens===!1&&(v=!1))}c=[m,v]}break;default:(i.getIdentifier()==="OperatorNode:add"||i.getIdentifier()==="OperatorNode:multiply")&&(c=a.map(function(E){var N=Pt(E,s),R=Wg(i,E,s),_=kc(E,s);return N===null?!1:h===N&&u===_&&!R?!0:N<h}));break}return a.length>=2&&i.getIdentifier()==="OperatorNode:multiply"&&i.implicit&&s==="auto"&&o==="hide"&&(c=a.map(function(E,N){var R=E.getIdentifier()==="ParenthesisNode";return!!(c[N]||R)})),c}return t.prototype._toString=function(i){var s=i&&i.parenthesis?i.parenthesis:"keep",o=i&&i.implicit?i.implicit:"hide",a=this.args,l=n(this,s,o,a,!1);if(a.length===1){var h=kc(this,s),u=a[0].toString(i);l[0]&&(u="("+u+")");var c=/[a-zA-Z]+/.test(this.op);return h==="right"?this.op+(c?" ":"")+u:h==="left"?u+(c?" ":"")+this.op:u+this.op}else if(a.length===2){var f=a[0].toString(i),d=a[1].toString(i);return l[0]&&(f="("+f+")"),l[1]&&(d="("+d+")"),this.implicit&&this.getIdentifier()==="OperatorNode:multiply"&&o==="hide"?f+" "+d:f+" "+this.op+" "+d}else if(a.length>2&&(this.getIdentifier()==="OperatorNode:add"||this.getIdentifier()==="OperatorNode:multiply")){var p=a.map(function(m,y){return m=m.toString(i),l[y]&&(m="("+m+")"),m});return this.implicit&&this.getIdentifier()==="OperatorNode:multiply"&&o==="hide"?p.join(" "):p.join(" "+this.op+" ")}else return this.fn+"("+this.args.join(", ")+")"},t.prototype.toJSON=function(){return{mathjs:"OperatorNode",op:this.op,fn:this.fn,args:this.args,implicit:this.implicit}},t.fromJSON=function(i){return new t(i.op,i.fn,i.args,i.implicit)},t.prototype.toHTML=function(i){var s=i&&i.parenthesis?i.parenthesis:"keep",o=i&&i.implicit?i.implicit:"hide",a=this.args,l=n(this,s,o,a,!1);if(a.length===1){var h=kc(this,s),u=a[0].toHTML(i);return l[0]&&(u='<span class="math-parenthesis math-round-parenthesis">(</span>'+u+'<span class="math-parenthesis math-round-parenthesis">)</span>'),h==="right"?'<span class="math-operator math-unary-operator math-lefthand-unary-operator">'+Nr(this.op)+"</span>"+u:u+'<span class="math-operator math-unary-operator math-righthand-unary-operator">'+Nr(this.op)+"</span>"}else if(a.length===2){var c=a[0].toHTML(i),f=a[1].toHTML(i);return l[0]&&(c='<span class="math-parenthesis math-round-parenthesis">(</span>'+c+'<span class="math-parenthesis math-round-parenthesis">)</span>'),l[1]&&(f='<span class="math-parenthesis math-round-parenthesis">(</span>'+f+'<span class="math-parenthesis math-round-parenthesis">)</span>'),this.implicit&&this.getIdentifier()==="OperatorNode:multiply"&&o==="hide"?c+'<span class="math-operator math-binary-operator math-implicit-binary-operator"></span>'+f:c+'<span class="math-operator math-binary-operator math-explicit-binary-operator">'+Nr(this.op)+"</span>"+f}else{var d=a.map(function(p,m){return p=p.toHTML(i),l[m]&&(p='<span class="math-parenthesis math-round-parenthesis">(</span>'+p+'<span class="math-parenthesis math-round-parenthesis">)</span>'),p});return a.length>2&&(this.getIdentifier()==="OperatorNode:add"||this.getIdentifier()==="OperatorNode:multiply")?this.implicit&&this.getIdentifier()==="OperatorNode:multiply"&&o==="hide"?d.join('<span class="math-operator math-binary-operator math-implicit-binary-operator"></span>'):d.join('<span class="math-operator math-binary-operator math-explicit-binary-operator">'+Nr(this.op)+"</span>"):'<span class="math-function">'+Nr(this.fn)+'</span><span class="math-paranthesis math-round-parenthesis">(</span>'+d.join('<span class="math-separator">,</span>')+'<span class="math-paranthesis math-round-parenthesis">)</span>'}},t.prototype._toTex=function(i){var s=i&&i.parenthesis?i.parenthesis:"keep",o=i&&i.implicit?i.implicit:"hide",a=this.args,l=n(this,s,o,a,!0),h=yt[this.fn];if(h=typeof h=="undefined"?this.op:h,a.length===1){var u=kc(this,s),c=a[0].toTex(i);return l[0]&&(c="\\left(".concat(c,"\\right)")),u==="right"?h+c:c+h}else if(a.length===2){var f=a[0],d=f.toTex(i);l[0]&&(d="\\left(".concat(d,"\\right)"));var p=a[1],m=p.toTex(i);l[1]&&(m="\\left(".concat(m,"\\right)"));var y;switch(s==="keep"?y=f.getIdentifier():y=f.getContent().getIdentifier(),this.getIdentifier()){case"OperatorNode:divide":return h+"{"+d+"}{"+m+"}";case"OperatorNode:pow":switch(d="{"+d+"}",m="{"+m+"}",y){case"ConditionalNode":case"OperatorNode:divide":d="\\left(".concat(d,"\\right)")}break;case"OperatorNode:multiply":if(this.implicit&&o==="hide")return d+"~"+m}return d+h+m}else if(a.length>2&&(this.getIdentifier()==="OperatorNode:add"||this.getIdentifier()==="OperatorNode:multiply")){var g=a.map(function(v,x){return v=v.toTex(i),l[x]&&(v="\\left(".concat(v,"\\right)")),v});return this.getIdentifier()==="OperatorNode:multiply"&&this.implicit?g.join("~"):g.join(h)}else return"\\mathrm{"+this.fn+"}\\left("+a.map(function(v){return v.toTex(i)}).join(",")+"\\right)"},t.prototype.getIdentifier=function(){return this.type+":"+this.fn},t},{isClass:!0,isNode:!0}),K4="ParenthesisNode",$4=["Node"],eU=ke(K4,$4,r=>{var{Node:e}=r;function t(n){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");if(!Jt(n))throw new TypeError('Node expected for parameter "content"');this.content=n}return t.prototype=new e,t.prototype.type="ParenthesisNode",t.prototype.isParenthesisNode=!0,t.prototype._compile=function(n,i){return this.content._compile(n,i)},t.prototype.getContent=function(){return this.content.getContent()},t.prototype.forEach=function(n){n(this.content,"content",this)},t.prototype.map=function(n){var i=n(this.content,"content",this);return new t(i)},t.prototype.clone=function(){return new t(this.content)},t.prototype._toString=function(n){return!n||n&&!n.parenthesis||n&&n.parenthesis==="keep"?"("+this.content.toString(n)+")":this.content.toString(n)},t.prototype.toJSON=function(){return{mathjs:"ParenthesisNode",content:this.content}},t.fromJSON=function(n){return new t(n.content)},t.prototype.toHTML=function(n){return!n||n&&!n.parenthesis||n&&n.parenthesis==="keep"?'<span class="math-parenthesis math-round-parenthesis">(</span>'+this.content.toHTML(n)+'<span class="math-parenthesis math-round-parenthesis">)</span>':this.content.toHTML(n)},t.prototype._toTex=function(n){return!n||n&&!n.parenthesis||n&&n.parenthesis==="keep"?"\\left(".concat(this.content.toTex(n),"\\right)"):this.content.toTex(n)},t},{isClass:!0,isNode:!0}),tU="RangeNode",nU=["Node"],rU=ke(tU,nU,r=>{var{Node:e}=r;function t(i,s,o){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");if(!Jt(i))throw new TypeError("Node expected");if(!Jt(s))throw new TypeError("Node expected");if(o&&!Jt(o))throw new TypeError("Node expected");if(arguments.length>3)throw new Error("Too many arguments");this.start=i,this.end=s,this.step=o||null}t.prototype=new e,t.prototype.type="RangeNode",t.prototype.isRangeNode=!0,t.prototype.needsEnd=function(){var i=this.filter(function(s){return or(s)&&s.name==="end"});return i.length>0},t.prototype._compile=function(i,s){var o=i.range,a=this.start._compile(i,s),l=this.end._compile(i,s);if(this.step){var h=this.step._compile(i,s);return function(c,f,d){return o(a(c,f,d),l(c,f,d),h(c,f,d))}}else return function(c,f,d){return o(a(c,f,d),l(c,f,d))}},t.prototype.forEach=function(i){i(this.start,"start",this),i(this.end,"end",this),this.step&&i(this.step,"step",this)},t.prototype.map=function(i){return new t(this._ifNode(i(this.start,"start",this)),this._ifNode(i(this.end,"end",this)),this.step&&this._ifNode(i(this.step,"step",this)))},t.prototype.clone=function(){return new t(this.start,this.end,this.step&&this.step)};function n(i,s){var o=Pt(i,s),a={},l=Pt(i.start,s);if(a.start=l!==null&&l<=o||s==="all",i.step){var h=Pt(i.step,s);a.step=h!==null&&h<=o||s==="all"}var u=Pt(i.end,s);return a.end=u!==null&&u<=o||s==="all",a}return t.prototype._toString=function(i){var s=i&&i.parenthesis?i.parenthesis:"keep",o=n(this,s),a,l=this.start.toString(i);if(o.start&&(l="("+l+")"),a=l,this.step){var h=this.step.toString(i);o.step&&(h="("+h+")"),a+=":"+h}var u=this.end.toString(i);return o.end&&(u="("+u+")"),a+=":"+u,a},t.prototype.toJSON=function(){return{mathjs:"RangeNode",start:this.start,end:this.end,step:this.step}},t.fromJSON=function(i){return new t(i.start,i.end,i.step)},t.prototype.toHTML=function(i){var s=i&&i.parenthesis?i.parenthesis:"keep",o=n(this,s),a,l=this.start.toHTML(i);if(o.start&&(l='<span class="math-parenthesis math-round-parenthesis">(</span>'+l+'<span class="math-parenthesis math-round-parenthesis">)</span>'),a=l,this.step){var h=this.step.toHTML(i);o.step&&(h='<span class="math-parenthesis math-round-parenthesis">(</span>'+h+'<span class="math-parenthesis math-round-parenthesis">)</span>'),a+='<span class="math-operator math-range-operator">:</span>'+h}var u=this.end.toHTML(i);return o.end&&(u='<span class="math-parenthesis math-round-parenthesis">(</span>'+u+'<span class="math-parenthesis math-round-parenthesis">)</span>'),a+='<span class="math-operator math-range-operator">:</span>'+u,a},t.prototype._toTex=function(i){var s=i&&i.parenthesis?i.parenthesis:"keep",o=n(this,s),a=this.start.toTex(i);if(o.start&&(a="\\left(".concat(a,"\\right)")),this.step){var l=this.step.toTex(i);o.step&&(l="\\left(".concat(l,"\\right)")),a+=":"+l}var h=this.end.toTex(i);return o.end&&(h="\\left(".concat(h,"\\right)")),a+=":"+h,a},t},{isClass:!0,isNode:!0}),iU="RelationalNode",sU=["Node"],oU=ke(iU,sU,r=>{var{Node:e}=r;function t(n,i){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");if(!Array.isArray(n))throw new TypeError("Parameter conditionals must be an array");if(!Array.isArray(i))throw new TypeError("Parameter params must be an array");if(n.length!==i.length-1)throw new TypeError("Parameter params must contain exactly one more element than parameter conditionals");this.conditionals=n,this.params=i}return t.prototype=new e,t.prototype.type="RelationalNode",t.prototype.isRelationalNode=!0,t.prototype._compile=function(n,i){var s=this,o=this.params.map(a=>a._compile(n,i));return function(l,h,u){for(var c,f=o[0](l,h,u),d=0;d<s.conditionals.length;d++){c=f,f=o[d+1](l,h,u);var p=$n(n,s.conditionals[d]);if(!p(c,f))return!1}return!0}},t.prototype.forEach=function(n){this.params.forEach((i,s)=>n(i,"params["+s+"]",this),this)},t.prototype.map=function(n){return new t(this.conditionals.slice(),this.params.map((i,s)=>this._ifNode(n(i,"params["+s+"]",this)),this))},t.prototype.clone=function(){return new t(this.conditionals,this.params)},t.prototype._toString=function(n){for(var i=n&&n.parenthesis?n.parenthesis:"keep",s=Pt(this,i),o=this.params.map(function(u,c){var f=Pt(u,i);return i==="all"||f!==null&&f<=s?"("+u.toString(n)+")":u.toString(n)}),a={equal:"==",unequal:"!=",smaller:"<",larger:">",smallerEq:"<=",largerEq:">="},l=o[0],h=0;h<this.conditionals.length;h++)l+=" "+a[this.conditionals[h]]+" "+o[h+1];return l},t.prototype.toJSON=function(){return{mathjs:"RelationalNode",conditionals:this.conditionals,params:this.params}},t.fromJSON=function(n){return new t(n.conditionals,n.params)},t.prototype.toHTML=function(n){for(var i=n&&n.parenthesis?n.parenthesis:"keep",s=Pt(this,i),o=this.params.map(function(u,c){var f=Pt(u,i);return i==="all"||f!==null&&f<=s?'<span class="math-parenthesis math-round-parenthesis">(</span>'+u.toHTML(n)+'<span class="math-parenthesis math-round-parenthesis">)</span>':u.toHTML(n)}),a={equal:"==",unequal:"!=",smaller:"<",larger:">",smallerEq:"<=",largerEq:">="},l=o[0],h=0;h<this.conditionals.length;h++)l+='<span class="math-operator math-binary-operator math-explicit-binary-operator">'+Nr(a[this.conditionals[h]])+"</span>"+o[h+1];return l},t.prototype._toTex=function(n){for(var i=n&&n.parenthesis?n.parenthesis:"keep",s=Pt(this,i),o=this.params.map(function(h,u){var c=Pt(h,i);return i==="all"||c!==null&&c<=s?"\\left("+h.toTex(n)+"\right)":h.toTex(n)}),a=o[0],l=0;l<this.conditionals.length;l++)a+=yt[this.conditionals[l]]+o[l+1];return a},t},{isClass:!0,isNode:!0}),aU="SymbolNode",lU=["math","?Unit","Node"],cU=ke(aU,lU,r=>{var{math:e,Unit:t,Node:n}=r;function i(a){return t?t.isValuelessUnit(a):!1}function s(a){if(!(this instanceof s))throw new SyntaxError("Constructor must be called with the new operator");if(typeof a!="string")throw new TypeError('String expected for parameter "name"');this.name=a}s.prototype=new n,s.prototype.type="SymbolNode",s.prototype.isSymbolNode=!0,s.prototype._compile=function(a,l){var h=this.name;if(l[h]===!0)return function(c,f,d){return f[h]};if(h in a)return function(c,f,d){return h in c?$n(c,h):$n(a,h)};var u=i(h);return function(c,f,d){return h in c?$n(c,h):u?new t(null,h):o(h)}},s.prototype.forEach=function(a){},s.prototype.map=function(a){return this.clone()};function o(a){throw new Error("Undefined symbol "+a)}return s.prototype.clone=function(){return new s(this.name)},s.prototype._toString=function(a){return this.name},s.prototype.toHTML=function(a){var l=Nr(this.name);return l==="true"||l==="false"?'<span class="math-symbol math-boolean">'+l+"</span>":l==="i"?'<span class="math-symbol math-imaginary-symbol">'+l+"</span>":l==="Infinity"?'<span class="math-symbol math-infinity-symbol">'+l+"</span>":l==="NaN"?'<span class="math-symbol math-nan-symbol">'+l+"</span>":l==="null"?'<span class="math-symbol math-null-symbol">'+l+"</span>":l==="undefined"?'<span class="math-symbol math-undefined-symbol">'+l+"</span>":'<span class="math-symbol">'+l+"</span>"},s.prototype.toJSON=function(){return{mathjs:"SymbolNode",name:this.name}},s.fromJSON=function(a){return new s(a.name)},s.prototype._toTex=function(a){var l=!1;typeof e[this.name]=="undefined"&&i(this.name)&&(l=!0);var h=DA(this.name,l);return h[0]==="\\"?h:" "+h},s},{isClass:!0,isNode:!0});function Vc(){return Vc=Object.assign||function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Vc.apply(this,arguments)}var uU="FunctionNode",hU=["math","Node","SymbolNode"],fU=ke(uU,hU,r=>{var{math:e,Node:t,SymbolNode:n}=r;function i(l,h){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if(typeof l=="string"&&(l=new n(l)),!Jt(l))throw new TypeError('Node expected as parameter "fn"');if(!Array.isArray(h)||!h.every(Jt))throw new TypeError('Array containing Nodes expected for parameter "args"');this.fn=l,this.args=h||[],Object.defineProperty(this,"name",{get:function(){return this.fn.name||""}.bind(this),set:function(){throw new Error("Cannot assign a new name, name is read-only")}})}i.prototype=new t,i.prototype.type="FunctionNode",i.prototype.isFunctionNode=!0,i.prototype._compile=function(l,h){if(!(this instanceof i))throw new TypeError("No valid FunctionNode");var u=Pr(this.args,function(A){return A._compile(l,h)});if(or(this.fn)){var c=this.fn.name,f=c in l?$n(l,c):void 0,d=typeof f=="function"&&f.rawArgs===!0;if(d){var p=this.args;return function(E,N,R){return(c in E?$n(E,c):f)(p,l,Vc({},E,N))}}else if(u.length===1){var m=u[0];return function(E,N,R){return(c in E?$n(E,c):f)(m(E,N,R))}}else if(u.length===2){var y=u[0],g=u[1];return function(E,N,R){return(c in E?$n(E,c):f)(y(E,N,R),g(E,N,R))}}else return function(E,N,R){return(c in E?$n(E,c):f).apply(null,Pr(u,function(_){return _(E,N,R)}))}}else if(Io(this.fn)&&Bc(this.fn.index)&&this.fn.index.isObjectProperty()){var v=this.fn.object._compile(l,h),x=this.fn.index.getObjectProperty(),w=this.args;return function(E,N,R){var _=v(E,N,R);xz(_,x);var S=_[x]&&_[x].rawArgs;return S?_[x](w,l,Vc({},E,N)):_[x].apply(_,Pr(u,function(L){return L(E,N,R)}))}}else{var b=this.fn._compile(l,h),M=this.args;return function(E,N,R){var _=b(E,N,R),S=_&&_.rawArgs;return S?_(M,l,Vc({},E,N)):_.apply(_,Pr(u,function(L){return L(E,N,R)}))}}},i.prototype.forEach=function(l){l(this.fn,"fn",this);for(var h=0;h<this.args.length;h++)l(this.args[h],"args["+h+"]",this)},i.prototype.map=function(l){for(var h=this._ifNode(l(this.fn,"fn",this)),u=[],c=0;c<this.args.length;c++)u[c]=this._ifNode(l(this.args[c],"args["+c+"]",this));return new i(h,u)},i.prototype.clone=function(){return new i(this.fn,this.args.slice(0))};var s=i.prototype.toString;i.prototype.toString=function(l){var h,u=this.fn.toString(l);return l&&typeof l.handler=="object"&&Je(l.handler,u)&&(h=l.handler[u](this,l)),typeof h!="undefined"?h:s.call(this,l)},i.prototype._toString=function(l){var h=this.args.map(function(c){return c.toString(l)}),u=Mg(this.fn)?"("+this.fn.toString(l)+")":this.fn.toString(l);return u+"("+h.join(", ")+")"},i.prototype.toJSON=function(){return{mathjs:"FunctionNode",fn:this.fn,args:this.args}},i.fromJSON=function(l){return new i(l.fn,l.args)},i.prototype.toHTML=function(l){var h=this.args.map(function(u){return u.toHTML(l)});return'<span class="math-function">'+Nr(this.fn)+'</span><span class="math-paranthesis math-round-parenthesis">(</span>'+h.join('<span class="math-separator">,</span>')+'<span class="math-paranthesis math-round-parenthesis">)</span>'};function o(l,h,u){for(var c="",f=/\$(?:\{([a-z_][a-z_0-9]*)(?:\[([0-9]+)\])?\}|\$)/gi,d=0,p;(p=f.exec(l))!==null;)if(c+=l.substring(d,p.index),d=p.index,p[0]==="$$")c+="$",d++;else{d+=p[0].length;var m=h[p[1]];if(!m)throw new ReferenceError("Template: Property "+p[1]+" does not exist.");if(p[2]===void 0)switch(typeof m){case"string":c+=m;break;case"object":if(Jt(m))c+=m.toTex(u);else if(Array.isArray(m))c+=m.map(function(y,g){if(Jt(y))return y.toTex(u);throw new TypeError("Template: "+p[1]+"["+g+"] is not a Node.")}).join(",");else throw new TypeError("Template: "+p[1]+" has to be a Node, String or array of Nodes");break;default:throw new TypeError("Template: "+p[1]+" has to be a Node, String or array of Nodes")}else if(Jt(m[p[2]]&&m[p[2]]))c+=m[p[2]].toTex(u);else throw new TypeError("Template: "+p[1]+"["+p[2]+"] is not a Node.")}return c+=l.slice(d),c}var a=i.prototype.toTex;return i.prototype.toTex=function(l){var h;return l&&typeof l.handler=="object"&&Je(l.handler,this.name)&&(h=l.handler[this.name](this,l)),typeof h!="undefined"?h:a.call(this,l)},i.prototype._toTex=function(l){var h=this.args.map(function(f){return f.toTex(l)}),u;BA[this.name]&&(u=BA[this.name]),e[this.name]&&(typeof e[this.name].toTex=="function"||typeof e[this.name].toTex=="object"||typeof e[this.name].toTex=="string")&&(u=e[this.name].toTex);var c;switch(typeof u){case"function":c=u(this,l);break;case"string":c=o(u,this,l);break;case"object":switch(typeof u[h.length]){case"function":c=u[h.length](this,l);break;case"string":c=o(u[h.length],this,l);break}}return typeof c!="undefined"?c:o(F4,this,l)},i.prototype.getIdentifier=function(){return this.type+":"+this.name},i},{isClass:!0,isNode:!0});function Os(){return Os=Object.assign||function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Os.apply(this,arguments)}var FA="parse",dU=["typed","numeric","config","AccessorNode","ArrayNode","AssignmentNode","BlockNode","ConditionalNode","ConstantNode","FunctionAssignmentNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","ParenthesisNode","RangeNode","RelationalNode","SymbolNode"],pU=ke(FA,dU,r=>{var{typed:e,numeric:t,config:n,AccessorNode:i,ArrayNode:s,AssignmentNode:o,BlockNode:a,ConditionalNode:l,ConstantNode:h,FunctionAssignmentNode:u,FunctionNode:c,IndexNode:f,ObjectNode:d,OperatorNode:p,ParenthesisNode:m,RangeNode:y,RelationalNode:g,SymbolNode:v}=r,x=e(FA,{string:function(re){return J(re,{})},"Array | Matrix":function(re){return w(re,{})},"string, Object":function(re,ve){var Be=ve.nodes!==void 0?ve.nodes:{};return J(re,Be)},"Array | Matrix, Object":w});function w(I){var re=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ve=re.nodes!==void 0?re.nodes:{};return wn(I,function(Be){if(typeof Be!="string")throw new TypeError("String expected");return J(Be,ve)})}var b={NULL:0,DELIMITER:1,NUMBER:2,SYMBOL:3,UNKNOWN:4},M={",":!0,"(":!0,")":!0,"[":!0,"]":!0,"{":!0,"}":!0,'"':!0,"'":!0,";":!0,"+":!0,"-":!0,"*":!0,".*":!0,"/":!0,"./":!0,"%":!0,"^":!0,".^":!0,"~":!0,"!":!0,"&":!0,"|":!0,"^|":!0,"=":!0,":":!0,"?":!0,"==":!0,"!=":!0,"<":!0,">":!0,"<=":!0,">=":!0,"<<":!0,">>":!0,">>>":!0},A={mod:!0,to:!0,in:!0,and:!0,xor:!0,or:!0,not:!0},E={true:!0,false:!1,null:null,undefined:void 0},N=["NaN","Infinity"];function R(){return{extraNodes:{},expression:"",comment:"",index:0,token:"",tokenType:b.NULL,nestingLevel:0,conditionalLevel:null}}function _(I,re){return I.expression.substr(I.index,re)}function S(I){return _(I,1)}function L(I){I.index++}function k(I){return I.expression.charAt(I.index-1)}function H(I){return I.expression.charAt(I.index+1)}function O(I){for(I.tokenType=b.NULL,I.token="",I.comment="";x.isWhitespace(S(I),I.nestingLevel);)L(I);if(S(I)==="#")for(;S(I)!==`
`&&S(I)!=="";)I.comment+=S(I),L(I);if(S(I)===""){I.tokenType=b.DELIMITER;return}if(S(I)===`
`&&!I.nestingLevel){I.tokenType=b.DELIMITER,I.token=S(I),L(I);return}var re=S(I),ve=_(I,2),Be=_(I,3);if(Be.length===3&&M[Be]){I.tokenType=b.DELIMITER,I.token=Be,L(I),L(I),L(I);return}if(ve.length===2&&M[ve]){I.tokenType=b.DELIMITER,I.token=ve,L(I),L(I);return}if(M[re]){I.tokenType=b.DELIMITER,I.token=re,L(I);return}if(x.isDigitDot(re)){I.tokenType=b.NUMBER;var Ze=_(I,2);if(Ze==="0b"||Ze==="0o"||Ze==="0x"){for(I.token+=S(I),L(I),I.token+=S(I),L(I);x.isHexDigit(S(I));)I.token+=S(I),L(I);return}if(S(I)===".")I.token+=S(I),L(I),x.isDigit(S(I))||(I.tokenType=b.DELIMITER);else{for(;x.isDigit(S(I));)I.token+=S(I),L(I);x.isDecimalMark(S(I),H(I))&&(I.token+=S(I),L(I))}for(;x.isDigit(S(I));)I.token+=S(I),L(I);if(S(I)==="E"||S(I)==="e"){if(x.isDigit(H(I))||H(I)==="-"||H(I)==="+"){if(I.token+=S(I),L(I),(S(I)==="+"||S(I)==="-")&&(I.token+=S(I),L(I)),!x.isDigit(S(I)))throw We(I,'Digit expected, got "'+S(I)+'"');for(;x.isDigit(S(I));)I.token+=S(I),L(I);if(x.isDecimalMark(S(I),H(I)))throw We(I,'Digit expected, got "'+S(I)+'"')}else if(H(I)===".")throw L(I),We(I,'Digit expected, got "'+S(I)+'"')}return}if(x.isAlpha(S(I),k(I),H(I))){for(;x.isAlpha(S(I),k(I),H(I))||x.isDigit(S(I));)I.token+=S(I),L(I);Je(A,I.token)?I.tokenType=b.DELIMITER:I.tokenType=b.SYMBOL;return}for(I.tokenType=b.UNKNOWN;S(I)!=="";)I.token+=S(I),L(I);throw We(I,'Syntax error in part "'+I.token+'"')}function T(I){do O(I);while(I.token===`
`)}function V(I){I.nestingLevel++}function F(I){I.nestingLevel--}x.isAlpha=function(re,ve,Be){return x.isValidLatinOrGreek(re)||x.isValidMathSymbol(re,Be)||x.isValidMathSymbol(ve,re)},x.isValidLatinOrGreek=function(re){return/^[a-zA-Z_$\u00C0-\u02AF\u0370-\u03FF\u2100-\u214F]$/.test(re)},x.isValidMathSymbol=function(re,ve){return/^[\uD835]$/.test(re)&&/^[\uDC00-\uDFFF]$/.test(ve)&&/^[^\uDC55\uDC9D\uDCA0\uDCA1\uDCA3\uDCA4\uDCA7\uDCA8\uDCAD\uDCBA\uDCBC\uDCC4\uDD06\uDD0B\uDD0C\uDD15\uDD1D\uDD3A\uDD3F\uDD45\uDD47-\uDD49\uDD51\uDEA6\uDEA7\uDFCC\uDFCD]$/.test(ve)},x.isWhitespace=function(re,ve){return re===" "||re==="	"||re===`
`&&ve>0},x.isDecimalMark=function(re,ve){return re==="."&&ve!=="/"&&ve!=="*"&&ve!=="^"},x.isDigitDot=function(re){return re>="0"&&re<="9"||re==="."},x.isDigit=function(re){return re>="0"&&re<="9"},x.isHexDigit=function(re){return re>="0"&&re<="9"||re>="a"&&re<="f"||re>="A"&&re<="F"};function J(I,re){var ve=R();Os(ve,{expression:I,extraNodes:re}),O(ve);var Be=Y(ve);if(ve.token!=="")throw ve.tokenType===b.DELIMITER?Fe(ve,"Unexpected operator "+ve.token):We(ve,'Unexpected part "'+ve.token+'"');return Be}function Y(I){var re,ve=[],Be;for(I.token!==""&&I.token!==`
`&&I.token!==";"&&(re=te(I),re.comment=I.comment);I.token===`
`||I.token===";";)ve.length===0&&re&&(Be=I.token!==";",ve.push({node:re,visible:Be})),O(I),I.token!==`
`&&I.token!==";"&&I.token!==""&&(re=te(I),re.comment=I.comment,Be=I.token!==";",ve.push({node:re,visible:Be}));return ve.length>0?new a(ve):(re||(re=new h(void 0),re.comment=I.comment),re)}function te(I){var re,ve,Be,Ze,Ke=z(I);if(I.token==="="){if(or(Ke))return re=Ke.name,T(I),Be=te(I),new o(new v(re),Be);if(Io(Ke))return T(I),Be=te(I),new o(Ke.object,Ke.index,Be);if(yf(Ke)&&or(Ke.fn)&&(Ze=!0,ve=[],re=Ke.name,Ke.args.forEach(function(Ft,tr){or(Ft)?ve[tr]=Ft.name:Ze=!1}),Ze))return T(I),Be=te(I),new u(re,ve,Be);throw We(I,"Invalid left hand side of assignment operator =")}return Ke}function z(I){for(var re=K(I);I.token==="?";){var ve=I.conditionalLevel;I.conditionalLevel=I.nestingLevel,T(I);var Be=re,Ze=te(I);if(I.token!==":")throw We(I,"False part of conditional expression expected");I.conditionalLevel=null,T(I);var Ke=te(I);re=new l(Be,Ze,Ke),I.conditionalLevel=ve}return re}function K(I){for(var re=Z(I);I.token==="or";)T(I),re=new p("or","or",[re,Z(I)]);return re}function Z(I){for(var re=Q(I);I.token==="xor";)T(I),re=new p("xor","xor",[re,Q(I)]);return re}function Q(I){for(var re=me(I);I.token==="and";)T(I),re=new p("and","and",[re,me(I)]);return re}function me(I){for(var re=ge(I);I.token==="|";)T(I),re=new p("|","bitOr",[re,ge(I)]);return re}function ge(I){for(var re=se(I);I.token==="^|";)T(I),re=new p("^|","bitXor",[re,se(I)]);return re}function se(I){for(var re=he(I);I.token==="&";)T(I),re=new p("&","bitAnd",[re,he(I)]);return re}function he(I){for(var re=[xe(I)],ve=[],Be={"==":"equal","!=":"unequal","<":"smaller",">":"larger","<=":"smallerEq",">=":"largerEq"};Je(Be,I.token);){var Ze={name:I.token,fn:Be[I.token]};ve.push(Ze),T(I),re.push(xe(I))}return re.length===1?re[0]:re.length===2?new p(ve[0].name,ve[0].fn,re):new g(ve.map(Ke=>Ke.fn),re)}function xe(I){var re,ve,Be,Ze;re=pe(I);for(var Ke={"<<":"leftShift",">>":"rightArithShift",">>>":"rightLogShift"};Je(Ke,I.token);)ve=I.token,Be=Ke[ve],T(I),Ze=[re,pe(I)],re=new p(ve,Be,Ze);return re}function pe(I){var re,ve,Be,Ze;re=G(I);for(var Ke={to:"to",in:"to"};Je(Ke,I.token);)ve=I.token,Be=Ke[ve],T(I),ve==="in"&&I.token===""?re=new p("*","multiply",[re,new v("in")],!0):(Ze=[re,G(I)],re=new p(ve,Be,Ze));return re}function G(I){var re,ve=[];if(I.token===":"?re=new h(1):re=q(I),I.token===":"&&I.conditionalLevel!==I.nestingLevel){for(ve.push(re);I.token===":"&&ve.length<3;)T(I),I.token===")"||I.token==="]"||I.token===","||I.token===""?ve.push(new v("end")):ve.push(q(I));ve.length===3?re=new y(ve[0],ve[2],ve[1]):re=new y(ve[0],ve[1])}return re}function q(I){var re,ve,Be,Ze;re=B(I);for(var Ke={"+":"add","-":"subtract"};Je(Ke,I.token);)ve=I.token,Be=Ke[ve],T(I),Ze=[re,B(I)],re=new p(ve,Be,Ze);return re}function B(I){var re,ve,Be,Ze;re=D(I),ve=re;for(var Ke={"*":"multiply",".*":"dotMultiply","/":"divide","./":"dotDivide","%":"mod",mod:"mod"};Je(Ke,I.token);)Be=I.token,Ze=Ke[Be],T(I),ve=D(I),re=new p(Be,Ze,[re,ve]);return re}function D(I){var re,ve;for(re=$(I),ve=re;I.tokenType===b.SYMBOL||I.token==="in"&&Po(re)||I.tokenType===b.NUMBER&&!Po(ve)&&(!Sg(ve)||ve.op==="!")||I.token==="(";)ve=$(I),re=new p("*","multiply",[re,ve],!0);return re}function $(I){for(var re=ne(I),ve=re,Be=[];I.token==="/"&&Po(ve);)if(Be.push(Os({},I)),T(I),I.tokenType===b.NUMBER)if(Be.push(Os({},I)),T(I),I.tokenType===b.SYMBOL||I.token==="(")Os(I,Be.pop()),Be.pop(),ve=ne(I),re=new p("/","divide",[re,ve]);else{Be.pop(),Os(I,Be.pop());break}else{Os(I,Be.pop());break}return re}function ne(I){var re,ve,Be,Ze={"-":"unaryMinus","+":"unaryPlus","~":"bitNot",not:"not"};return Je(Ze,I.token)?(Be=Ze[I.token],re=I.token,T(I),ve=[ne(I)],new p(re,Be,ve)):U(I)}function U(I){var re,ve,Be,Ze;return re=W(I),(I.token==="^"||I.token===".^")&&(ve=I.token,Be=ve==="^"?"pow":"dotPow",T(I),Ze=[re,ne(I)],re=new p(ve,Be,Ze)),re}function W(I){var re,ve,Be,Ze;re=P(I);for(var Ke={"!":"factorial","'":"ctranspose"};Je(Ke,I.token);)ve=I.token,Be=Ke[ve],O(I),Ze=[re],re=new p(ve,Be,Ze),re=ee(I,re);return re}function P(I){var re=[];if(I.tokenType===b.SYMBOL&&Je(I.extraNodes,I.token)){var ve=I.extraNodes[I.token];if(O(I),I.token==="("){if(re=[],V(I),O(I),I.token!==")")for(re.push(te(I));I.token===",";)O(I),re.push(te(I));if(I.token!==")")throw We(I,"Parenthesis ) expected");F(I),O(I)}return new ve(re)}return C(I)}function C(I){var re,ve;return I.tokenType===b.SYMBOL||I.tokenType===b.DELIMITER&&I.token in A?(ve=I.token,O(I),Je(E,ve)?re=new h(E[ve]):N.indexOf(ve)!==-1?re=new h(t(ve,"number")):re=new v(ve),re=ee(I,re),re):ae(I)}function ee(I,re,ve){for(var Be;(I.token==="("||I.token==="["||I.token===".")&&(!ve||ve.indexOf(I.token)!==-1);)if(Be=[],I.token==="(")if(or(re)||Io(re)){if(V(I),O(I),I.token!==")")for(Be.push(te(I));I.token===",";)O(I),Be.push(te(I));if(I.token!==")")throw We(I,"Parenthesis ) expected");F(I),O(I),re=new c(re,Be)}else return re;else if(I.token==="["){if(V(I),O(I),I.token!=="]")for(Be.push(te(I));I.token===",";)O(I),Be.push(te(I));if(I.token!=="]")throw We(I,"Parenthesis ] expected");F(I),O(I),re=new i(re,new f(Be))}else{if(O(I),I.tokenType!==b.SYMBOL)throw We(I,"Property name expected after dot");Be.push(new h(I.token)),O(I);var Ze=!0;re=new i(re,new f(Be,Ze))}return re}function ae(I){var re,ve;return I.token==='"'?(ve=le(I),re=new h(ve),re=ee(I,re),re):ce(I)}function le(I){for(var re="";S(I)!==""&&S(I)!=='"';)S(I)==="\\"&&(re+=S(I),L(I)),re+=S(I),L(I);if(O(I),I.token!=='"')throw We(I,'End of string " expected');return O(I),JSON.parse('"'+re+'"')}function ce(I){var re,ve;return I.token==="'"?(ve=ye(I),re=new h(ve),re=ee(I,re),re):we(I)}function ye(I){for(var re="";S(I)!==""&&S(I)!=="'";)S(I)==="\\"&&(re+=S(I),L(I)),re+=S(I),L(I);if(O(I),I.token!=="'")throw We(I,"End of string ' expected");return O(I),JSON.parse('"'+re+'"')}function we(I){var re,ve,Be,Ze;if(I.token==="["){if(V(I),O(I),I.token!=="]"){var Ke=be(I);if(I.token===";"){for(Be=1,ve=[Ke];I.token===";";)O(I),ve[Be]=be(I),Be++;if(I.token!=="]")throw We(I,"End of matrix ] expected");F(I),O(I),Ze=ve[0].items.length;for(var Ft=1;Ft<Be;Ft++)if(ve[Ft].items.length!==Ze)throw Fe(I,"Column dimensions mismatch ("+ve[Ft].items.length+" !== "+Ze+")");re=new s(ve)}else{if(I.token!=="]")throw We(I,"End of matrix ] expected");F(I),O(I),re=Ke}}else F(I),O(I),re=new s([]);return ee(I,re)}return oe(I)}function be(I){for(var re=[te(I)],ve=1;I.token===",";)O(I),re[ve]=te(I),ve++;return new s(re)}function oe(I){if(I.token==="{"){V(I);var re,ve={};do if(O(I),I.token!=="}"){if(I.token==='"')re=le(I);else if(I.token==="'")re=ye(I);else if(I.tokenType===b.SYMBOL||I.tokenType===b.DELIMITER&&I.token in A)re=I.token,O(I);else throw We(I,"Symbol or string expected as object key");if(I.token!==":")throw We(I,"Colon : expected after object key");O(I),ve[re]=te(I)}while(I.token===",");if(I.token!=="}")throw We(I,"Comma , or bracket } expected after object value");F(I),O(I);var Be=new d(ve);return Be=ee(I,Be),Be}return Ie(I)}function Ie(I){var re;return I.tokenType===b.NUMBER?(re=I.token,O(I),new h(t(re,n.number))):Pe(I)}function Pe(I){var re;if(I.token==="("){if(V(I),O(I),re=te(I),I.token!==")")throw We(I,"Parenthesis ) expected");return F(I),O(I),re=new m(re),re=ee(I,re),re}return Qe(I)}function Qe(I){throw I.token===""?We(I,"Unexpected end of expression"):We(I,"Value expected")}function Ge(I){return I.index-I.token.length+1}function We(I,re){var ve=Ge(I),Be=new SyntaxError(re+" (char "+ve+")");return Be.char=ve,Be}function Fe(I,re){var ve=Ge(I),Be=new SyntaxError(re+" (char "+ve+")");return Be.char=ve,Be}return x}),OA="evaluate",mU=["typed","parse"],gU=ke(OA,mU,r=>{var{typed:e,parse:t}=r;return e(OA,{string:function(i){var s={};return t(i).compile().evaluate(s)},"string, Object":function(i,s){return t(i).compile().evaluate(s)},"Array | Matrix":function(i){var s={};return wn(i,function(o){return t(o).compile().evaluate(s)})},"Array | Matrix, Object":function(i,s){return wn(i,function(o){return t(o).compile().evaluate(s)})}})}),zA="lup",vU=["typed","matrix","abs","addScalar","divideScalar","multiplyScalar","subtract","larger","equalScalar","unaryMinus","DenseMatrix","SparseMatrix","Spa"],yU=ke(zA,vU,r=>{var{typed:e,matrix:t,abs:n,addScalar:i,divideScalar:s,multiplyScalar:o,subtract:a,larger:l,equalScalar:h,unaryMinus:u,DenseMatrix:c,SparseMatrix:f,Spa:d}=r;return e(zA,{DenseMatrix:function(g){return p(g)},SparseMatrix:function(g){return m(g)},Array:function(g){var v=t(g),x=p(v);return{L:x.L.valueOf(),U:x.U.valueOf(),p:x.p}}});function p(y){var g=y._size[0],v=y._size[1],x=Math.min(g,v),w=Et(y._data),b=[],M=[g,x],A=[],E=[x,v],N,R,_,S=[];for(N=0;N<g;N++)S[N]=N;for(R=0;R<v;R++){if(R>0)for(N=0;N<g;N++){var L=Math.min(N,R),k=0;for(_=0;_<L;_++)k=i(k,o(w[N][_],w[_][R]));w[N][R]=a(w[N][R],k)}var H=R,O=0,T=0;for(N=R;N<g;N++){var V=w[N][R],F=n(V);l(F,O)&&(H=N,O=F,T=V)}if(R!==H&&(S[R]=[S[H],S[H]=S[R]][0],c._swapRows(R,H,w)),R<g)for(N=R+1;N<g;N++){var J=w[N][R];h(J,0)||(w[N][R]=s(w[N][R],T))}}for(R=0;R<v;R++)for(N=0;N<g;N++){if(R===0&&(N<v&&(A[N]=[]),b[N]=[]),N<R){N<v&&(A[N][R]=w[N][R]),R<g&&(b[N][R]=0);continue}if(N===R){N<v&&(A[N][R]=w[N][R]),R<g&&(b[N][R]=1);continue}N<v&&(A[N][R]=0),R<g&&(b[N][R]=w[N][R])}var Y=new c({data:b,size:M}),te=new c({data:A,size:E}),z=[];for(N=0,x=S.length;N<x;N++)z[S[N]]=N;return{L:Y,U:te,p:z,toString:function(){return"L: "+this.L.toString()+`
U: `+this.U.toString()+`
P: `+this.p}}}function m(y){var g=y._size[0],v=y._size[1],x=Math.min(g,v),w=y._values,b=y._index,M=y._ptr,A=[],E=[],N=[],R=[g,x],_=[],S=[],L=[],k=[x,v],H,O,T,V=[],F=[];for(H=0;H<g;H++)V[H]=H,F[H]=H;var J=function(z,K){var Z=F[z],Q=F[K];V[Z]=K,V[Q]=z,F[z]=Q,F[K]=Z},Y=function(){var z=new d;O<g&&(N.push(A.length),A.push(1),E.push(O)),L.push(_.length);var K=M[O],Z=M[O+1];for(T=K;T<Z;T++)H=b[T],z.set(V[H],w[T]);O>0&&z.forEach(0,O-1,function(se,he){f._forEachRow(se,A,E,N,function(xe,pe){xe>se&&z.accumulate(xe,u(o(pe,he)))})});var Q=O,me=z.get(O),ge=n(me);z.forEach(O+1,g-1,function(se,he){var xe=n(he);l(xe,ge)&&(Q=se,ge=xe,me=he)}),O!==Q&&(f._swapRows(O,Q,R[1],A,E,N),f._swapRows(O,Q,k[1],_,S,L),z.swap(O,Q),J(O,Q)),z.forEach(0,g-1,function(se,he){se<=O?(_.push(he),S.push(se)):(he=s(he,me),h(he,0)||(A.push(he),E.push(se)))})};for(O=0;O<v;O++)Y();return L.push(_.length),N.push(A.length),{L:new f({values:A,index:E,ptr:N,size:R}),U:new f({values:_,index:S,ptr:L,size:k}),p:V,toString:function(){return"L: "+this.L.toString()+`
U: `+this.U.toString()+`
P: `+this.p}}}}),UA="det",xU=["typed","matrix","subtract","multiply","unaryMinus","lup"],wU=ke(UA,xU,r=>{var{typed:e,matrix:t,subtract:n,multiply:i,unaryMinus:s,lup:o}=r;return e(UA,{any:function(h){return Et(h)},"Array | Matrix":function(h){var u;switch(hn(h)?u=h.size():Array.isArray(h)?(h=t(h),u=h.size()):u=[],u.length){case 0:return Et(h);case 1:if(u[0]===1)return Et(h.valueOf()[0]);throw new RangeError("Matrix must be square (size: "+rn(u)+")");case 2:{var c=u[0],f=u[1];if(c===f)return a(h.clone().valueOf(),c);throw new RangeError("Matrix must be square (size: "+rn(u)+")")}default:throw new RangeError("Matrix must be two dimensional (size: "+rn(u)+")")}}});function a(l,h,u){if(h===1)return Et(l[0][0]);if(h===2)return n(i(l[0][0],l[1][1]),i(l[1][0],l[0][1]));for(var c=o(l),f=c.U[0][0],d=1;d<h;d++)f=i(f,c.U[d][d]);for(var p=0,m=0,y=[];;){for(;y[m];)m++;if(m>=h)break;for(var g=m,v=0;!y[c.p[g]];)y[c.p[g]]=!0,g=c.p[g],v++;v%2==0&&p++}return p%2==0?f:s(f)}}),HA="inv",bU=["typed","matrix","divideScalar","addScalar","multiply","unaryMinus","det","identity","abs"],MU=ke(HA,bU,r=>{var{typed:e,matrix:t,divideScalar:n,addScalar:i,multiply:s,unaryMinus:o,det:a,identity:l,abs:h}=r;return e(HA,{"Array | Matrix":function(f){var d=hn(f)?f.size():Ir(f);switch(d.length){case 1:if(d[0]===1)return hn(f)?t([n(1,f.valueOf()[0])]):[n(1,f[0])];throw new RangeError("Matrix must be square (size: "+rn(d)+")");case 2:{var p=d[0],m=d[1];if(p===m)return hn(f)?t(u(f.valueOf(),p,m),f.storage()):u(f,p,m);throw new RangeError("Matrix must be square (size: "+rn(d)+")")}default:throw new RangeError("Matrix must be two dimensional (size: "+rn(d)+")")}},any:function(f){return n(1,f)}});function u(c,f,d){var p,m,y,g,v;if(f===1){if(g=c[0][0],g===0)throw Error("Cannot calculate inverse, determinant is zero");return[[n(1,g)]]}else if(f===2){var x=a(c);if(x===0)throw Error("Cannot calculate inverse, determinant is zero");return[[n(c[1][1],x),n(o(c[0][1]),x)],[n(o(c[1][0]),x),n(c[0][0],x)]]}else{var w=c.concat();for(p=0;p<f;p++)w[p]=w[p].concat();for(var b=l(f).valueOf(),M=0;M<d;M++){var A=h(w[M][M]),E=M;for(p=M+1;p<f;)h(w[p][M])>A&&(A=h(w[p][M]),E=p),p++;if(A===0)throw Error("Cannot calculate inverse, determinant is zero");p=E,p!==M&&(v=w[M],w[M]=w[p],w[p]=v,v=b[M],b[M]=b[p],b[p]=v);var N=w[M],R=b[M];for(p=0;p<f;p++){var _=w[p],S=b[p];if(p!==M){if(_[M]!==0){for(y=n(o(_[M]),N[M]),m=M;m<d;m++)_[m]=i(_[m],s(y,N[m]));for(m=0;m<d;m++)S[m]=i(S[m],s(y,R[m]))}}else{for(y=N[M],m=M;m<d;m++)_[m]=n(_[m],y);for(m=0;m<d;m++)S[m]=n(S[m],y)}}}return b}}}),AU="divide",SU=["typed","matrix","multiply","equalScalar","divideScalar","inv"],EU=ke(AU,SU,r=>{var{typed:e,matrix:t,multiply:n,equalScalar:i,divideScalar:s,inv:o}=r,a=ul({typed:e,equalScalar:i}),l=Br({typed:e});return e("divide",Cg({"Array | Matrix, Array | Matrix":function(u,c){return n(u,o(c))},"DenseMatrix, any":function(u,c){return l(u,c,s,!1)},"SparseMatrix, any":function(u,c){return a(u,c,s,!1)},"Array, any":function(u,c){return l(t(u),c,s,!1).valueOf()},"any, Array | Matrix":function(u,c){return n(u,o(c))}},s.signatures))}),dl={createBigNumberClass:LF},Ff={createComplexClass:OF},Qg={createMatrixClass:YF},Qr={MatrixDependencies:Qg,createDenseMatrixClass:jF},jg={createFractionClass:HF},ht={BigNumberDependencies:dl,ComplexDependencies:Ff,DenseMatrixDependencies:Qr,FractionDependencies:jg,createTyped:LD},_U={createResultSet:zD},TU={createRangeClass:VF},CU={typedDependencies:ht,createIsNumeric:JF},Lr={typedDependencies:ht,createEqualScalar:eO},Of={MatrixDependencies:Qg,equalScalarDependencies:Lr,typedDependencies:ht,createSparseMatrixClass:rO},Zg={typedDependencies:ht,createNumber:oO},RU={BigNumberDependencies:dl,typedDependencies:ht,createBignumber:cO},GA={FractionDependencies:jg,typedDependencies:ht,createFraction:fO},dn={DenseMatrixDependencies:Qr,MatrixDependencies:Qg,SparseMatrixDependencies:Of,typedDependencies:ht,createMatrix:pO},zf={typedDependencies:ht,createUnaryMinus:gO},Jg={typedDependencies:ht,createAbs:yO},zs={typedDependencies:ht,createAddScalar:wO},NU={BigNumberDependencies:dl,matrixDependencies:dn,typedDependencies:ht,createZeros:Cz},Kg={BigNumberDependencies:dl,DenseMatrixDependencies:Qr,equalScalarDependencies:Lr,matrixDependencies:dn,typedDependencies:ht,zerosDependencies:NU,createRound:Hz},IU={equalScalarDependencies:Lr,matrixDependencies:dn,roundDependencies:Kg,typedDependencies:ht,createCeil:TO},PU={equalScalarDependencies:Lr,matrixDependencies:dn,roundDependencies:Kg,typedDependencies:ht,createFloor:BO},BU={ComplexDependencies:Ff,ceilDependencies:IU,floorDependencies:PU,matrixDependencies:dn,typedDependencies:ht,createFix:NO},N5={DenseMatrixDependencies:Qr,equalScalarDependencies:Lr,matrixDependencies:dn,typedDependencies:ht,createMod:$O},Uf={typedDependencies:ht,createMultiplyScalar:nz},LU={typedDependencies:ht,createConj:uz},kA={matrixDependencies:dn,typedDependencies:ht,createSize:yz},DU={addScalarDependencies:zs,conjDependencies:LU,multiplyScalarDependencies:Uf,sizeDependencies:kA,typedDependencies:ht,createDot:h4},Hf={addScalarDependencies:zs,dotDependencies:DU,equalScalarDependencies:Lr,matrixDependencies:dn,multiplyScalarDependencies:Uf,typedDependencies:ht,createMultiply:iz},$g={DenseMatrixDependencies:Qr,addScalarDependencies:zs,equalScalarDependencies:Lr,matrixDependencies:dn,typedDependencies:ht,unaryMinusDependencies:zf,createSubtract:oz},FU={DenseMatrixDependencies:Qr,matrixDependencies:dn,typedDependencies:ht,createSmaller:qz},VA={DenseMatrixDependencies:Qr,matrixDependencies:dn,typedDependencies:ht,createLarger:Xz},WA={BigNumberDependencies:dl,DenseMatrixDependencies:Qr,SparseMatrixDependencies:Of,matrixDependencies:dn,typedDependencies:ht,createIdentity:dz},I5={DenseMatrixDependencies:Qr,SparseMatrixDependencies:Of,addScalarDependencies:zs,equalScalarDependencies:Lr,matrixDependencies:dn,typedDependencies:ht,createAdd:c4},OU={DenseMatrixDependencies:Qr,equalScalarDependencies:Lr,matrixDependencies:dn,typedDependencies:ht,createEqual:Vz},zU={largerDependencies:VA,smallerDependencies:FU,createFibonacciHeapClass:Zz},UU={FibonacciHeapDependencies:zU,addScalarDependencies:zs,equalScalarDependencies:Lr,createSpaClass:$z},qA={bignumberDependencies:RU,fractionDependencies:GA,numberDependencies:Zg,createNumeric:Bz},Gf={numericDependencies:qA,typedDependencies:ht,createDivideScalar:Dz},HU={DenseMatrixDependencies:Qr,SpaDependencies:UU,SparseMatrixDependencies:Of,absDependencies:Jg,addScalarDependencies:zs,divideScalarDependencies:Gf,equalScalarDependencies:Lr,largerDependencies:VA,matrixDependencies:dn,multiplyScalarDependencies:Uf,subtractDependencies:$g,typedDependencies:ht,unaryMinusDependencies:zf,createLup:yU},GU={lupDependencies:HU,matrixDependencies:dn,multiplyDependencies:Hf,subtractDependencies:$g,typedDependencies:ht,unaryMinusDependencies:zf,createDet:wU},kU={absDependencies:Jg,addScalarDependencies:zs,detDependencies:GU,divideScalarDependencies:Gf,identityDependencies:WA,matrixDependencies:dn,multiplyDependencies:Hf,typedDependencies:ht,unaryMinusDependencies:zf,createInv:MU},VU={ComplexDependencies:Ff,fractionDependencies:GA,identityDependencies:WA,matrixDependencies:dn,multiplyDependencies:Hf,numberDependencies:Zg,typedDependencies:ht,createPow:Oz},YA={matrixDependencies:dn,typedDependencies:ht,createSubset:Az},WU={typedDependencies:ht,createFormat:Nz},ev={BigNumberDependencies:dl,ComplexDependencies:Ff,FractionDependencies:jg,absDependencies:Jg,addScalarDependencies:zs,divideScalarDependencies:Gf,equalDependencies:OU,fixDependencies:BU,formatDependencies:WU,isNumericDependencies:CU,multiplyScalarDependencies:Uf,numberDependencies:Zg,powDependencies:VU,roundDependencies:Kg,subtractDependencies:$g,createUnitClass:r4},P5={UnitDependencies:ev,typedDependencies:ht,createUnitFunction:s4},B5={UnitDependencies:ev,typedDependencies:ht,createCreateUnit:a4},er={createNode:p4},qU={NodeDependencies:er,subsetDependencies:YA,createAccessorNode:v4},YU={NodeDependencies:er,createArrayNode:w4},XU={matrixDependencies:dn,NodeDependencies:er,subsetDependencies:YA,createAssignmentNode:S4},QU={NodeDependencies:er,ResultSetDependencies:_U,createBlockNode:T4},jU={NodeDependencies:er,createConditionalNode:N4},ZU={NodeDependencies:er,createConstantNode:U4},JU={NodeDependencies:er,typedDependencies:ht,createFunctionAssignmentNode:k4},KU={NodeDependencies:er,RangeDependencies:TU,sizeDependencies:kA,createIndexNode:q4},$U={NodeDependencies:er,createObjectNode:Q4},eH={NodeDependencies:er,createOperatorNode:J4},tH={NodeDependencies:er,createParenthesisNode:eU},nH={NodeDependencies:er,createRangeNode:rU},rH={NodeDependencies:er,createRelationalNode:oU},XA={UnitDependencies:ev,NodeDependencies:er,createSymbolNode:cU},iH={NodeDependencies:er,SymbolNodeDependencies:XA,createFunctionNode:fU},sH={AccessorNodeDependencies:qU,ArrayNodeDependencies:YU,AssignmentNodeDependencies:XU,BlockNodeDependencies:QU,ConditionalNodeDependencies:jU,ConstantNodeDependencies:ZU,FunctionAssignmentNodeDependencies:JU,FunctionNodeDependencies:iH,IndexNodeDependencies:KU,ObjectNodeDependencies:$U,OperatorNodeDependencies:eH,ParenthesisNodeDependencies:tH,RangeNodeDependencies:nH,RelationalNodeDependencies:rH,SymbolNodeDependencies:XA,numericDependencies:qA,typedDependencies:ht,createParse:pU},L5={parseDependencies:sH,typedDependencies:ht,createEvaluate:gU},D5={divideScalarDependencies:Gf,equalScalarDependencies:Lr,invDependencies:kU,matrixDependencies:dn,multiplyDependencies:Hf,typedDependencies:ht,createDivide:EU},tv={exports:{}};function nv(){}nv.prototype={on:function(r,e,t){var n=this.e||(this.e={});return(n[r]||(n[r]=[])).push({fn:e,ctx:t}),this},once:function(r,e,t){var n=this;function i(){n.off(r,i),e.apply(t,arguments)}return i._=e,this.on(r,i,t)},emit:function(r){var e=[].slice.call(arguments,1),t=((this.e||(this.e={}))[r]||[]).slice(),n=0,i=t.length;for(n;n<i;n++)t[n].fn.apply(t[n].ctx,e);return this},off:function(r,e){var t=this.e||(this.e={}),n=t[r],i=[];if(n&&e)for(var s=0,o=n.length;s<o;s++)n[s].fn!==e&&n[s].fn._!==e&&i.push(n[s]);return i.length?t[r]=i:delete t[r],this}};tv.exports=nv;tv.exports.TinyEmitter=nv;var oH=tv.exports;function aH(r){var e=new oH;return r.on=e.on.bind(e),r.off=e.off.bind(e),r.once=e.once.bind(e),r.emit=e.emit.bind(e),r}function lH(r,e,t,n){function i(g,v){var x=arguments.length;if(x!==1&&x!==2)throw new Fo("import",x,1,2);v||(v={});function w(E,N,R){if(Array.isArray(N))N.forEach(L=>w(E,L));else if(typeof N=="object")for(var _ in N)Je(N,_)&&w(E,N[_],_);else if(Dc(N)||R!==void 0){var S=Dc(N)?m(N)?N.fn+".transform":N.fn:R;if(Je(E,S)&&E[S]!==N&&!v.silent)throw new Error('Cannot import "'+S+'" twice');E[S]=N}else if(!v.silent)throw new TypeError("Factory, Object, or Array expected")}var b={};w(b,g);for(var M in b)if(Je(b,M)){var A=b[M];if(Dc(A))h(A,v);else if(u(A))s(M,A,v);else if(!v.silent)throw new TypeError("Factory, Object, or Array expected")}}function s(g,v,x){if(x.wrap&&typeof v=="function"&&(v=l(v)),f(v)&&(v=r(g,{[v.signature]:v})),c(t[g])&&c(v)){x.override?v=r(g,v.signatures):v=r(t[g],v),t[g]=v,delete n[g],o(g,v),t.emit("import",g,function(){return v});return}if(t[g]===void 0||x.override){t[g]=v,delete n[g],o(g,v),t.emit("import",g,function(){return v});return}if(!x.silent)throw new Error('Cannot import "'+g+'": already exists')}function o(g,v){v&&typeof v.transform=="function"?(t.expression.transform[g]=v.transform,d(g)&&(t.expression.mathWithTransform[g]=v.transform)):(delete t.expression.transform[g],d(g)&&(t.expression.mathWithTransform[g]=v))}function a(g){delete t.expression.transform[g],d(g)?t.expression.mathWithTransform[g]=t[g]:delete t.expression.mathWithTransform[g]}function l(g){var v=function(){for(var w=[],b=0,M=arguments.length;b<M;b++){var A=arguments[b];w[b]=A&&A.valueOf()}return g.apply(t,w)};return g.transform&&(v.transform=g.transform),v}function h(g,v){var x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:g.fn;if(CM(x,"."))throw new Error("Factory name should not contain a nested path. Name: "+JSON.stringify(x));var w=m(g)?t.expression.transform:t,b=x in t.expression.transform,M=Je(w,x)?w[x]:void 0,A=function(){var N={};g.dependencies.map(RM).forEach(_=>{if(CM(_,"."))throw new Error("Factory dependency should not contain a nested path. Name: "+JSON.stringify(_));_==="math"?N.math=t:_==="mathWithTransform"?N.mathWithTransform=t.expression.mathWithTransform:_==="classes"?N.classes=t:N[_]=t[_]});var R=g(N);if(R&&typeof R.transform=="function")throw new Error('Transforms cannot be attached to factory functions. Please create a separate function for it with exports.path="expression.transform"');if(M===void 0||v.override)return R;if(c(M)&&c(R))return r(M,R);if(v.silent)return M;throw new Error('Cannot import "'+x+'": already exists')};!g.meta||g.meta.lazy!==!1?(Rg(w,x,A),M&&b?a(x):(m(g)||p(g))&&Rg(t.expression.mathWithTransform,x,()=>w[x])):(w[x]=A(),M&&b?a(x):(m(g)||p(g))&&Rg(t.expression.mathWithTransform,x,()=>w[x])),n[x]=g,t.emit("import",x,A)}function u(g){return typeof g=="function"||typeof g=="number"||typeof g=="string"||typeof g=="boolean"||g===null||No(g)||Qi(g)||Wt(g)||Pc(g)||hn(g)||Array.isArray(g)}function c(g){return typeof g=="function"&&typeof g.signatures=="object"}function f(g){return typeof g=="function"&&typeof g.signature=="string"}function d(g){return!Je(y,g)}function p(g){return g.fn.indexOf(".")===-1&&!Je(y,g.fn)&&(!g.meta||!g.meta.isClass)}function m(g){return g!==void 0&&g.meta!==void 0&&g.meta.isTransformFunction===!0||!1}var y={expression:!0,type:!0,docs:!0,error:!0,json:!0,chain:!0};return i}function rv(){return rv=Object.assign||function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},rv.apply(this,arguments)}function cH(r,e){var t=rv({},Zb,e);if(typeof Object.create!="function")throw new Error("ES5 not supported by this JavaScript engine. Please load the es5-shim and es5-sham library for compatibility.");var n=aH({isNumber:tn,isComplex:Qi,isBigNumber:Wt,isFraction:Pc,isUnit:No,isString:gi,isArray:nn,isMatrix:hn,isCollection:vg,isDenseMatrix:Jb,isSparseMatrix:Kb,isRange:yg,isIndex:rl,isBoolean:$b,isResultSet:xg,isHelp:wg,isFunction:eM,isDate:tM,isRegExp:nM,isObject:rM,isNull:iM,isUndefined:sM,isAccessorNode:Io,isArrayNode:bg,isAssignmentNode:oM,isBlockNode:aM,isConditionalNode:lM,isConstantNode:Po,isFunctionAssignmentNode:Mg,isFunctionNode:yf,isIndexNode:Bc,isNode:Jt,isObjectNode:Ag,isOperatorNode:Sg,isParenthesisNode:Eg,isRangeNode:_g,isSymbolNode:or,isChain:Tg});n.config=vD(t,n.emit),n.expression={transform:{},mathWithTransform:{config:n.config}};var i=[],s=[];function o(u){if(Dc(u))return u(n);var c=u[Object.keys(u)[0]];if(Dc(c))return c(n);if(!mD(u))throw console.warn("Factory object with properties `type`, `name`, and `factory` expected",u),new Error("Factory object with properties `type`, `name`, and `factory` expected");var f=i.indexOf(u),d;return f===-1?(u.math===!0?d=u.factory(n.type,t,o,n.typed,n):d=u.factory(n.type,t,o,n.typed),i.push(u),s.push(d)):d=s[f],d}var a={};function l(){for(var u=arguments.length,c=new Array(u),f=0;f<u;f++)c[f]=arguments[f];return n.typed.apply(n.typed,c)}var h=lH(l,o,n,a);return n.import=h,n.on("config",()=>{hM(a).forEach(u=>{u&&u.meta&&u.meta.recreateOnConfigChange&&h(u,{override:!0})})}),n.create=cH.bind(null,r),n.factory=ke,n.import(hM(pD(r))),n.ArgumentsError=Fo,n.DimensionError=gt,n.IndexError=Bs,n}var zo=[],uH=function(){return zo.some(function(r){return r.activeTargets.length>0})},hH=function(){return zo.some(function(r){return r.skippedTargets.length>0})},QA="ResizeObserver loop completed with undelivered notifications.",fH=function(){var r;typeof ErrorEvent=="function"?r=new ErrorEvent("error",{message:QA}):(r=document.createEvent("Event"),r.initEvent("error",!1,!1),r.message=QA),window.dispatchEvent(r)},Wc;(function(r){r.BORDER_BOX="border-box",r.CONTENT_BOX="content-box",r.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"})(Wc||(Wc={}));var Uo=function(r){return Object.freeze(r)},dH=function(){function r(e,t){this.inlineSize=e,this.blockSize=t,Uo(this)}return r}(),jA=function(){function r(e,t,n,i){return this.x=e,this.y=t,this.width=n,this.height=i,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,Uo(this)}return r.prototype.toJSON=function(){var e=this,t=e.x,n=e.y,i=e.top,s=e.right,o=e.bottom,a=e.left,l=e.width,h=e.height;return{x:t,y:n,top:i,right:s,bottom:o,left:a,width:l,height:h}},r.fromRect=function(e){return new r(e.x,e.y,e.width,e.height)},r}(),iv=function(r){return r instanceof SVGElement&&"getBBox"in r},ZA=function(r){if(iv(r)){var e=r.getBBox(),t=e.width,n=e.height;return!t&&!n}var i=r,s=i.offsetWidth,o=i.offsetHeight;return!(s||o||r.getClientRects().length)},JA=function(r){var e,t;if(r instanceof Element)return!0;var n=(t=(e=r)===null||e===void 0?void 0:e.ownerDocument)===null||t===void 0?void 0:t.defaultView;return!!(n&&r instanceof n.Element)},pH=function(r){switch(r.tagName){case"INPUT":if(r.type!=="image")break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1},qc=typeof window!="undefined"?window:{},kf=new WeakMap,KA=/auto|scroll/,mH=/^tb|vertical/,gH=/msie|trident/i.test(qc.navigator&&qc.navigator.userAgent),wi=function(r){return parseFloat(r||"0")},pl=function(r,e,t){return r===void 0&&(r=0),e===void 0&&(e=0),t===void 0&&(t=!1),new dH((t?e:r)||0,(t?r:e)||0)},$A=Uo({devicePixelContentBoxSize:pl(),borderBoxSize:pl(),contentBoxSize:pl(),contentRect:new jA(0,0,0,0)}),eS=function(r,e){if(e===void 0&&(e=!1),kf.has(r)&&!e)return kf.get(r);if(ZA(r))return kf.set(r,$A),$A;var t=getComputedStyle(r),n=iv(r)&&r.ownerSVGElement&&r.getBBox(),i=!gH&&t.boxSizing==="border-box",s=mH.test(t.writingMode||""),o=!n&&KA.test(t.overflowY||""),a=!n&&KA.test(t.overflowX||""),l=n?0:wi(t.paddingTop),h=n?0:wi(t.paddingRight),u=n?0:wi(t.paddingBottom),c=n?0:wi(t.paddingLeft),f=n?0:wi(t.borderTopWidth),d=n?0:wi(t.borderRightWidth),p=n?0:wi(t.borderBottomWidth),m=n?0:wi(t.borderLeftWidth),y=c+h,g=l+u,v=m+d,x=f+p,w=a?r.offsetHeight-x-r.clientHeight:0,b=o?r.offsetWidth-v-r.clientWidth:0,M=i?y+v:0,A=i?g+x:0,E=n?n.width:wi(t.width)-M-b,N=n?n.height:wi(t.height)-A-w,R=E+y+b+v,_=N+g+w+x,S=Uo({devicePixelContentBoxSize:pl(Math.round(E*devicePixelRatio),Math.round(N*devicePixelRatio),s),borderBoxSize:pl(R,_,s),contentBoxSize:pl(E,N,s),contentRect:new jA(c,l,E,N)});return kf.set(r,S),S},tS=function(r,e,t){var n=eS(r,t),i=n.borderBoxSize,s=n.contentBoxSize,o=n.devicePixelContentBoxSize;switch(e){case Wc.DEVICE_PIXEL_CONTENT_BOX:return o;case Wc.BORDER_BOX:return i;default:return s}},vH=function(){function r(e){var t=eS(e);this.target=e,this.contentRect=t.contentRect,this.borderBoxSize=Uo([t.borderBoxSize]),this.contentBoxSize=Uo([t.contentBoxSize]),this.devicePixelContentBoxSize=Uo([t.devicePixelContentBoxSize])}return r}(),nS=function(r){if(ZA(r))return 1/0;for(var e=0,t=r.parentNode;t;)e+=1,t=t.parentNode;return e},yH=function(){var r=1/0,e=[];zo.forEach(function(o){if(o.activeTargets.length!==0){var a=[];o.activeTargets.forEach(function(h){var u=new vH(h.target),c=nS(h.target);a.push(u),h.lastReportedSize=tS(h.target,h.observedBox),c<r&&(r=c)}),e.push(function(){o.callback.call(o.observer,a,o.observer)}),o.activeTargets.splice(0,o.activeTargets.length)}});for(var t=0,n=e;t<n.length;t++){var i=n[t];i()}return r},rS=function(r){zo.forEach(function(t){t.activeTargets.splice(0,t.activeTargets.length),t.skippedTargets.splice(0,t.skippedTargets.length),t.observationTargets.forEach(function(i){i.isActive()&&(nS(i.target)>r?t.activeTargets.push(i):t.skippedTargets.push(i))})})},xH=function(){var r=0;for(rS(r);uH();)r=yH(),rS(r);return hH()&&fH(),r>0},sv,iS=[],wH=function(){return iS.splice(0).forEach(function(r){return r()})},bH=function(r){if(!sv){var e=0,t=document.createTextNode(""),n={characterData:!0};new MutationObserver(function(){return wH()}).observe(t,n),sv=function(){t.textContent=""+(e?e--:e++)}}iS.push(r),sv()},MH=function(r){bH(function(){requestAnimationFrame(r)})},Vf=0,AH=function(){return!!Vf},SH=250,EH={attributes:!0,characterData:!0,childList:!0,subtree:!0},sS=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],oS=function(r){return r===void 0&&(r=0),Date.now()+r},ov=!1,_H=function(){function r(){var e=this;this.stopped=!0,this.listener=function(){return e.schedule()}}return r.prototype.run=function(e){var t=this;if(e===void 0&&(e=SH),!ov){ov=!0;var n=oS(e);MH(function(){var i=!1;try{i=xH()}finally{if(ov=!1,e=n-oS(),!AH())return;i?t.run(1e3):e>0?t.run(e):t.start()}})}},r.prototype.schedule=function(){this.stop(),this.run()},r.prototype.observe=function(){var e=this,t=function(){return e.observer&&e.observer.observe(document.body,EH)};document.body?t():qc.addEventListener("DOMContentLoaded",t)},r.prototype.start=function(){var e=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),sS.forEach(function(t){return qc.addEventListener(t,e.listener,!0)}))},r.prototype.stop=function(){var e=this;this.stopped||(this.observer&&this.observer.disconnect(),sS.forEach(function(t){return qc.removeEventListener(t,e.listener,!0)}),this.stopped=!0)},r}(),av=new _H,aS=function(r){!Vf&&r>0&&av.start(),Vf+=r,!Vf&&av.stop()},TH=function(r){return!iv(r)&&!pH(r)&&getComputedStyle(r).display==="inline"},CH=function(){function r(e,t){this.target=e,this.observedBox=t||Wc.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return r.prototype.isActive=function(){var e=tS(this.target,this.observedBox,!0);return TH(this.target)&&(this.lastReportedSize=e),this.lastReportedSize.inlineSize!==e.inlineSize||this.lastReportedSize.blockSize!==e.blockSize},r}(),RH=function(){function r(e,t){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=e,this.callback=t}return r}(),Wf=new WeakMap,lS=function(r,e){for(var t=0;t<r.length;t+=1)if(r[t].target===e)return t;return-1},qf=function(){function r(){}return r.connect=function(e,t){var n=new RH(e,t);Wf.set(e,n)},r.observe=function(e,t,n){var i=Wf.get(e),s=i.observationTargets.length===0;lS(i.observationTargets,t)<0&&(s&&zo.push(i),i.observationTargets.push(new CH(t,n&&n.box)),aS(1),av.schedule())},r.unobserve=function(e,t){var n=Wf.get(e),i=lS(n.observationTargets,t),s=n.observationTargets.length===1;i>=0&&(s&&zo.splice(zo.indexOf(n),1),n.observationTargets.splice(i,1),aS(-1))},r.disconnect=function(e){var t=this,n=Wf.get(e);n.observationTargets.slice().forEach(function(i){return t.unobserve(e,i.target)}),n.activeTargets.splice(0,n.activeTargets.length)},r}(),F5=function(){function r(e){if(arguments.length===0)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if(typeof e!="function")throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");qf.connect(this,e)}return r.prototype.observe=function(e,t){if(arguments.length===0)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!JA(e))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");qf.observe(this,e,t)},r.prototype.unobserve=function(e){if(arguments.length===0)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!JA(e))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");qf.unobserve(this,e)},r.prototype.disconnect=function(){qf.disconnect(this)},r.toString=function(){return"function ResizeObserver () { [polyfill code] }"},r}();class NH{constructor(e=4){this.pool=e,this.queue=[],this.workers=[],this.workersResolve=[],this.workerStatus=0}_initWorker(e){if(!this.workers[e]){const t=this.workerCreator();t.addEventListener("message",this._onMessage.bind(this,e)),this.workers[e]=t}}_getIdleWorker(){for(let e=0;e<this.pool;e++)if(!(this.workerStatus&1<<e))return e;return-1}_onMessage(e,t){const n=this.workersResolve[e];if(n&&n(t),this.queue.length){const{resolve:i,msg:s,transfer:o}=this.queue.shift();this.workersResolve[e]=i,this.workers[e].postMessage(s,o)}else this.workerStatus^=1<<e}setWorkerCreator(e){this.workerCreator=e}setWorkerLimit(e){this.pool=e}postMessage(e,t){return new Promise(n=>{const i=this._getIdleWorker();i!==-1?(this._initWorker(i),this.workerStatus|=1<<i,this.workersResolve[i]=n,this.workers[i].postMessage(e,t)):this.queue.push({resolve:n,msg:e,transfer:t})})}dispose(){this.workers.forEach(e=>e.terminate()),this.workersResolve.length=0,this.workers.length=0,this.queue.length=0,this.workerStatus=0}}const IH=2,PH=1,lv=new WeakMap;let cv=0;class Zi extends Bn{constructor(e){super(e);this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerPool=new NH,this.workerSourceURL="",this.workerConfig=null,typeof MSC_TRANSCODER!="undefined"&&console.warn('THREE.KTX2Loader: Please update to latest "basis_transcoder". "msc_basis_transcoder" is no longer supported in three.js r125+.')}setTranscoderPath(e){return this.transcoderPath=e,this}setWorkerLimit(e){return this.workerPool.setWorkerLimit(e),this}detectSupport(e){return this.workerConfig={astcSupported:e.extensions.has("WEBGL_compressed_texture_astc"),etc1Supported:e.extensions.has("WEBGL_compressed_texture_etc1"),etc2Supported:e.extensions.has("WEBGL_compressed_texture_etc"),dxtSupported:e.extensions.has("WEBGL_compressed_texture_s3tc"),bptcSupported:e.extensions.has("EXT_texture_compression_bptc"),pvrtcSupported:e.extensions.has("WEBGL_compressed_texture_pvrtc")||e.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc")},e.capabilities.isWebGL2&&(this.workerConfig.etc1Supported=!1),this}dispose(){return this.workerPool.dispose(),this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),this}init(){if(!this.transcoderPending){const e=new Zn(this.manager);e.setPath(this.transcoderPath),e.setWithCredentials(this.withCredentials);const t=e.loadAsync("basis_transcoder.js"),n=new Zn(this.manager);n.setPath(this.transcoderPath),n.setResponseType("arraybuffer"),n.setWithCredentials(this.withCredentials);const i=n.loadAsync("basis_transcoder.wasm");this.transcoderPending=Promise.all([t,i]).then(([s,o])=>{const a=Zi.BasisWorker.toString(),l=["/* constants */","let _EngineFormat = "+JSON.stringify(Zi.EngineFormat),"let _TranscoderFormat = "+JSON.stringify(Zi.TranscoderFormat),"let _BasisFormat = "+JSON.stringify(Zi.BasisFormat),"/* basis_transcoder.js */",s,"/* worker */",a.substring(a.indexOf("{")+1,a.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([l])),this.transcoderBinary=o,this.workerPool.setWorkerCreator(()=>{const h=new Worker(this.workerSourceURL),u=this.transcoderBinary.slice(0);return h.postMessage({type:"init",config:this.workerConfig,transcoderBinary:u},[u]),h})}),cv>0&&console.warn("THREE.KTX2Loader: Multiple active KTX2 loaders may cause performance issues. Use a single KTX2Loader instance, or call .dispose() on old instances."),cv++}return this.transcoderPending}load(e,t,n,i){if(this.workerConfig===null)throw new Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");const s=new Zn(this.manager);s.setResponseType("arraybuffer"),s.setWithCredentials(this.withCredentials);const o=new nc;return s.load(e,a=>{if(lv.has(a))return lv.get(a).promise.then(t).catch(i);this._createTexture([a]).then(function(l){o.copy(l),o.needsUpdate=!0,t&&t(o)}).catch(i)},n,i),o}_createTextureFrom(e){const{mipmaps:t,width:n,height:i,format:s,type:o,error:a,dfdTransferFn:l,dfdFlags:h}=e;if(o==="error")return Promise.reject(a);const u=new nc(t,n,i,s,pn);return u.minFilter=t.length===1?ft:ti,u.magFilter=ft,u.generateMipmaps=!1,u.needsUpdate=!0,u.encoding=l===IH?Fr:gr,u.premultiplyAlpha=!!(h&PH),u}_createTexture(e,t={}){const n=t,i=this.init().then(()=>this.workerPool.postMessage({type:"transcode",buffers:e,taskConfig:n},e)).then(s=>this._createTextureFrom(s.data));return lv.set(e[0],{promise:i}),i}dispose(){return URL.revokeObjectURL(this.workerSourceURL),this.workerPool.dispose(),cv--,this}}Zi.BasisFormat={ETC1S:0,UASTC_4x4:1};Zi.TranscoderFormat={ETC1:0,ETC2:1,BC1:2,BC3:3,BC4:4,BC5:5,BC7_M6_OPAQUE_ONLY:6,BC7_M5:7,PVRTC1_4_RGB:8,PVRTC1_4_RGBA:9,ASTC_4x4:10,ATC_RGB:11,ATC_RGBA_INTERPOLATED_ALPHA:12,RGBA32:13,RGB565:14,BGR565:15,RGBA4444:16};Zi.EngineFormat={RGBAFormat:Lt,RGBA_ASTC_4x4_Format:fp,RGBA_BPTC_Format:dp,RGBA_ETC2_EAC_Format:Tu,RGBA_PVRTC_4BPPV1_Format:Eu,RGBA_S3TC_DXT5_Format:Au,RGB_ETC1_Format:hp,RGB_ETC2_Format:_u,RGB_PVRTC_4BPPV1_Format:Su,RGB_S3TC_DXT1_Format:Mu};Zi.BasisWorker=function(){let r,e,t;const n=_EngineFormat,i=_TranscoderFormat,s=_BasisFormat;self.addEventListener("message",function(d){const p=d.data;switch(p.type){case"init":r=p.config,o(p.transcoderBinary);break;case"transcode":e.then(()=>{try{const{width:m,height:y,hasAlpha:g,mipmaps:v,format:x,dfdTransferFn:w,dfdFlags:b}=a(p.buffers[0]),M=[];for(let A=0;A<v.length;++A)M.push(v[A].data.buffer);self.postMessage({type:"transcode",id:p.id,width:m,height:y,hasAlpha:g,mipmaps:v,format:x,dfdTransferFn:w,dfdFlags:b},M)}catch(m){console.error(m),self.postMessage({type:"error",id:p.id,error:m.message})}});break}});function o(d){e=new Promise(p=>{t={wasmBinary:d,onRuntimeInitialized:p},BASIS(t)}).then(()=>{t.initializeBasis(),t.KTX2File===void 0&&console.warn("THREE.KTX2Loader: Please update Basis Universal transcoder.")})}function a(d){const p=new t.KTX2File(new Uint8Array(d));function m(){p.close(),p.delete()}if(!p.isValid())throw m(),new Error("THREE.KTX2Loader:	Invalid or unsupported .ktx2 file");const y=p.isUASTC()?s.UASTC_4x4:s.ETC1S,g=p.getWidth(),v=p.getHeight(),x=p.getLevels(),w=p.getHasAlpha(),b=p.getDFDTransferFunc(),M=p.getDFDFlags(),{transcoderFormat:A,engineFormat:E}=c(y,g,v,w);if(!g||!v||!x)throw m(),new Error("THREE.KTX2Loader:	Invalid texture");if(!p.startTranscoding())throw m(),new Error("THREE.KTX2Loader: .startTranscoding failed");const N=[];for(let R=0;R<x;R++){const _=p.getImageLevelInfo(R,0,0),S=_.origWidth,L=_.origHeight,k=new Uint8Array(p.getImageTranscodedSizeInBytes(R,0,0,A));if(!p.transcodeImage(k,R,0,0,A,0,-1,-1))throw m(),new Error("THREE.KTX2Loader: .transcodeImage failed.");N.push({data:k,width:S,height:L})}return m(),{width:g,height:v,hasAlpha:w,mipmaps:N,format:E,dfdTransferFn:b,dfdFlags:M}}const l=[{if:"astcSupported",basisFormat:[s.UASTC_4x4],transcoderFormat:[i.ASTC_4x4,i.ASTC_4x4],engineFormat:[n.RGBA_ASTC_4x4_Format,n.RGBA_ASTC_4x4_Format],priorityETC1S:1/0,priorityUASTC:1,needsPowerOfTwo:!1},{if:"bptcSupported",basisFormat:[s.ETC1S,s.UASTC_4x4],transcoderFormat:[i.BC7_M5,i.BC7_M5],engineFormat:[n.RGBA_BPTC_Format,n.RGBA_BPTC_Format],priorityETC1S:3,priorityUASTC:2,needsPowerOfTwo:!1},{if:"dxtSupported",basisFormat:[s.ETC1S,s.UASTC_4x4],transcoderFormat:[i.BC1,i.BC3],engineFormat:[n.RGB_S3TC_DXT1_Format,n.RGBA_S3TC_DXT5_Format],priorityETC1S:4,priorityUASTC:5,needsPowerOfTwo:!1},{if:"etc2Supported",basisFormat:[s.ETC1S,s.UASTC_4x4],transcoderFormat:[i.ETC1,i.ETC2],engineFormat:[n.RGB_ETC2_Format,n.RGBA_ETC2_EAC_Format],priorityETC1S:1,priorityUASTC:3,needsPowerOfTwo:!1},{if:"etc1Supported",basisFormat:[s.ETC1S,s.UASTC_4x4],transcoderFormat:[i.ETC1],engineFormat:[n.RGB_ETC1_Format],priorityETC1S:2,priorityUASTC:4,needsPowerOfTwo:!1},{if:"pvrtcSupported",basisFormat:[s.ETC1S,s.UASTC_4x4],transcoderFormat:[i.PVRTC1_4_RGB,i.PVRTC1_4_RGBA],engineFormat:[n.RGB_PVRTC_4BPPV1_Format,n.RGBA_PVRTC_4BPPV1_Format],priorityETC1S:5,priorityUASTC:6,needsPowerOfTwo:!0}],h=l.sort(function(d,p){return d.priorityETC1S-p.priorityETC1S}),u=l.sort(function(d,p){return d.priorityUASTC-p.priorityUASTC});function c(d,p,m,y){let g,v;const x=d===s.ETC1S?h:u;for(let w=0;w<x.length;w++){const b=x[w];if(!!r[b.if]&&!!b.basisFormat.includes(d)&&!(y&&b.transcoderFormat.length<2)&&!(b.needsPowerOfTwo&&!(f(p)&&f(m))))return g=b.transcoderFormat[y?1:0],v=b.engineFormat[y?1:0],{transcoderFormat:g,engineFormat:v}}return console.warn("THREE.KTX2Loader: No suitable compressed texture format found. Decoding to RGBA32."),g=i.RGBA32,v=n.RGBAFormat,{transcoderFormat:g,engineFormat:v}}function f(d){return d<=2?!0:(d&d-1)==0&&d!==0}};var uv={};Object.defineProperty(uv,"__esModule",{value:!0});var BH=uv.VERSION=void 0;BH=uv.VERSION=typeof __VERSION__!="undefined"?__VERSION__:"latest";var O5=function(r){var e=function(t){this.manager=t!==void 0?t:r.DefaultLoadingManager};return e.prototype={constructor:r.STLLoader,load:function(t,n,i,s){var o=this,a=new r.FileLoader(o.manager);a.setResponseType("arraybuffer"),a.load(t,function(l){n(o.parse(l))},i,s)},parse:function(t){var n=function(){var s,o,a,l;if(l=new DataView(i),o=32/8*3+32/8*3*3+16/8,a=l.getUint32(80,!0),s=80+32/8+a*o,s===l.byteLength)return!0;for(var h=[115,111,108,105,100],u=0;u<5;u++)if(h[u]!=l.getUint8(u,!1))return!0;return!1},i=this.ensureBinary(t);return n()?this.parseBinary(i):this.parseASCII(this.ensureString(t))},parseBinary:function(t){for(var n=new DataView(t),i=n.getUint32(80,!0),s,o,a,l=!1,h,u,c,f,d,p=0;p<80-10;p++)n.getUint32(p,!1)==1129270351&&n.getUint8(p+4)==82&&n.getUint8(p+5)==61&&(l=!0,h=[],u=n.getUint8(p+6)/255,c=n.getUint8(p+7)/255,f=n.getUint8(p+8)/255,d=n.getUint8(p+9)/255);for(var m=84,y=12*4+2,g=new r.BufferGeometry,v=[],x=[],w=0;w<i;w++){var b=m+w*y,M=n.getFloat32(b,!0),A=n.getFloat32(b+4,!0),E=n.getFloat32(b+8,!0);if(l){var N=n.getUint16(b+48,!0);(N&32768)==0?(s=(N&31)/31,o=(N>>5&31)/31,a=(N>>10&31)/31):(s=u,o=c,a=f)}for(var R=1;R<=3;R++){var _=b+R*12;v.push(n.getFloat32(_,!0)),v.push(n.getFloat32(_+4,!0)),v.push(n.getFloat32(_+8,!0)),x.push(M,A,E),l&&h.push(s,o,a)}}return g.addAttribute("position",new r.BufferAttribute(new Float32Array(v),3)),g.addAttribute("normal",new r.BufferAttribute(new Float32Array(x),3)),l&&(g.addAttribute("color",new r.BufferAttribute(new Float32Array(h),3)),g.hasColors=!0,g.alpha=d),g},parseASCII:function(t){var n,i,s,o,a,l;n=new r.BufferGeometry,i=/facet([\s\S]*?)endfacet/g;for(var h=[],u=[],c=new r.Vector3;(a=i.exec(t))!==null;){for(l=a[0],s=/normal[\s]+([\-+]?[0-9]+\.?[0-9]*([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+/g;(a=s.exec(l))!==null;)c.x=parseFloat(a[1]),c.y=parseFloat(a[3]),c.z=parseFloat(a[5]);for(o=/vertex[\s]+([\-+]?[0-9]+\.?[0-9]*([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+/g;(a=o.exec(l))!==null;)h.push(parseFloat(a[1]),parseFloat(a[3]),parseFloat(a[5])),u.push(c.x,c.y,c.z)}return n.addAttribute("position",new r.BufferAttribute(new Float32Array(h),3)),n.addAttribute("normal",new r.BufferAttribute(new Float32Array(u),3)),n},ensureString:function(t){if(typeof t!="string"){for(var n=new Uint8Array(t),i=[],s=0;s<t.byteLength;s++)i.push(String.fromCharCode(n[s]));return i.join("")}else return t},ensureBinary:function(t){if(typeof t=="string"){for(var n=new Uint8Array(t.length),i=0;i<t.length;i++)n[i]=t.charCodeAt(i)&255;return n.buffer||n}else return t}},e},LH={exports:{}};(function(r,e){(function(t){r.exports=t()})(function(){return function t(n,i,s){function o(h,u){if(!i[h]){if(!n[h]){var c=typeof Yh=="function"&&Yh;if(!u&&c)return c(h,!0);if(a)return a(h,!0);throw new Error("Cannot find module '"+h+"'")}var f=i[h]={exports:{}};n[h][0].call(f.exports,function(d){var p=n[h][1][d];return o(p||d)},f,f.exports,t,n,i,s)}return i[h].exports}for(var a=typeof Yh=="function"&&Yh,l=0;l<s.length;l++)o(s[l]);return o}({1:[function(t,n,i){n.exports={name:"cannon",version:"0.6.2",description:"A lightweight 3D physics engine written in JavaScript.",homepage:"https://github.com/schteppe/cannon.js",author:"Stefan Hedman <schteppe@gmail.com> (http://steffe.se)",keywords:["cannon.js","cannon","physics","engine","3d"],main:"./build/cannon.js",engines:{node:"*"},repository:{type:"git",url:"https://github.com/schteppe/cannon.js.git"},bugs:{url:"https://github.com/schteppe/cannon.js/issues"},licenses:[{type:"MIT"}],devDependencies:{jshint:"latest","uglify-js":"latest",nodeunit:"^0.9.0",grunt:"~0.4.0","grunt-contrib-jshint":"~0.1.1","grunt-contrib-nodeunit":"^0.4.1","grunt-contrib-concat":"~0.1.3","grunt-contrib-uglify":"^0.5.1","grunt-browserify":"^2.1.4","grunt-contrib-yuidoc":"^0.5.2",browserify:"*"},dependencies:{}}},{}],2:[function(t,n,i){n.exports={version:t("../package.json").version,AABB:t("./collision/AABB"),ArrayCollisionMatrix:t("./collision/ArrayCollisionMatrix"),Body:t("./objects/Body"),Box:t("./shapes/Box"),Broadphase:t("./collision/Broadphase"),Constraint:t("./constraints/Constraint"),ContactEquation:t("./equations/ContactEquation"),Narrowphase:t("./world/Narrowphase"),ConeTwistConstraint:t("./constraints/ConeTwistConstraint"),ContactMaterial:t("./material/ContactMaterial"),ConvexPolyhedron:t("./shapes/ConvexPolyhedron"),Cylinder:t("./shapes/Cylinder"),DistanceConstraint:t("./constraints/DistanceConstraint"),Equation:t("./equations/Equation"),EventTarget:t("./utils/EventTarget"),FrictionEquation:t("./equations/FrictionEquation"),GSSolver:t("./solver/GSSolver"),GridBroadphase:t("./collision/GridBroadphase"),Heightfield:t("./shapes/Heightfield"),HingeConstraint:t("./constraints/HingeConstraint"),LockConstraint:t("./constraints/LockConstraint"),Mat3:t("./math/Mat3"),Material:t("./material/Material"),NaiveBroadphase:t("./collision/NaiveBroadphase"),ObjectCollisionMatrix:t("./collision/ObjectCollisionMatrix"),Pool:t("./utils/Pool"),Particle:t("./shapes/Particle"),Plane:t("./shapes/Plane"),PointToPointConstraint:t("./constraints/PointToPointConstraint"),Quaternion:t("./math/Quaternion"),Ray:t("./collision/Ray"),RaycastVehicle:t("./objects/RaycastVehicle"),RaycastResult:t("./collision/RaycastResult"),RigidVehicle:t("./objects/RigidVehicle"),RotationalEquation:t("./equations/RotationalEquation"),RotationalMotorEquation:t("./equations/RotationalMotorEquation"),SAPBroadphase:t("./collision/SAPBroadphase"),SPHSystem:t("./objects/SPHSystem"),Shape:t("./shapes/Shape"),Solver:t("./solver/Solver"),Sphere:t("./shapes/Sphere"),SplitSolver:t("./solver/SplitSolver"),Spring:t("./objects/Spring"),Trimesh:t("./shapes/Trimesh"),Vec3:t("./math/Vec3"),Vec3Pool:t("./utils/Vec3Pool"),World:t("./world/World")}},{"../package.json":1,"./collision/AABB":3,"./collision/ArrayCollisionMatrix":4,"./collision/Broadphase":5,"./collision/GridBroadphase":6,"./collision/NaiveBroadphase":7,"./collision/ObjectCollisionMatrix":8,"./collision/Ray":9,"./collision/RaycastResult":10,"./collision/SAPBroadphase":11,"./constraints/ConeTwistConstraint":12,"./constraints/Constraint":13,"./constraints/DistanceConstraint":14,"./constraints/HingeConstraint":15,"./constraints/LockConstraint":16,"./constraints/PointToPointConstraint":17,"./equations/ContactEquation":19,"./equations/Equation":20,"./equations/FrictionEquation":21,"./equations/RotationalEquation":22,"./equations/RotationalMotorEquation":23,"./material/ContactMaterial":24,"./material/Material":25,"./math/Mat3":27,"./math/Quaternion":28,"./math/Vec3":30,"./objects/Body":31,"./objects/RaycastVehicle":32,"./objects/RigidVehicle":33,"./objects/SPHSystem":34,"./objects/Spring":35,"./shapes/Box":37,"./shapes/ConvexPolyhedron":38,"./shapes/Cylinder":39,"./shapes/Heightfield":40,"./shapes/Particle":41,"./shapes/Plane":42,"./shapes/Shape":43,"./shapes/Sphere":44,"./shapes/Trimesh":45,"./solver/GSSolver":46,"./solver/Solver":47,"./solver/SplitSolver":48,"./utils/EventTarget":49,"./utils/Pool":51,"./utils/Vec3Pool":54,"./world/Narrowphase":55,"./world/World":56}],3:[function(t,n,i){var s=t("../math/Vec3");t("../utils/Utils"),n.exports=o;function o(h){h=h||{},this.lowerBound=new s,h.lowerBound&&this.lowerBound.copy(h.lowerBound),this.upperBound=new s,h.upperBound&&this.upperBound.copy(h.upperBound)}var a=new s;o.prototype.setFromPoints=function(h,u,c,f){var d=this.lowerBound,p=this.upperBound,m=c;d.copy(h[0]),m&&m.vmult(d,d),p.copy(d);for(var y=1;y<h.length;y++){var g=h[y];m&&(m.vmult(g,a),g=a),g.x>p.x&&(p.x=g.x),g.x<d.x&&(d.x=g.x),g.y>p.y&&(p.y=g.y),g.y<d.y&&(d.y=g.y),g.z>p.z&&(p.z=g.z),g.z<d.z&&(d.z=g.z)}return u&&(u.vadd(d,d),u.vadd(p,p)),f&&(d.x-=f,d.y-=f,d.z-=f,p.x+=f,p.y+=f,p.z+=f),this},o.prototype.copy=function(h){return this.lowerBound.copy(h.lowerBound),this.upperBound.copy(h.upperBound),this},o.prototype.clone=function(){return new o().copy(this)},o.prototype.extend=function(h){var u=h.lowerBound.x;this.lowerBound.x>u&&(this.lowerBound.x=u);var c=h.upperBound.x;this.upperBound.x<c&&(this.upperBound.x=c);var u=h.lowerBound.y;this.lowerBound.y>u&&(this.lowerBound.y=u);var c=h.upperBound.y;this.upperBound.y<c&&(this.upperBound.y=c);var u=h.lowerBound.z;this.lowerBound.z>u&&(this.lowerBound.z=u);var c=h.upperBound.z;this.upperBound.z<c&&(this.upperBound.z=c)},o.prototype.overlaps=function(h){var u=this.lowerBound,c=this.upperBound,f=h.lowerBound,d=h.upperBound;return(f.x<=c.x&&c.x<=d.x||u.x<=d.x&&d.x<=c.x)&&(f.y<=c.y&&c.y<=d.y||u.y<=d.y&&d.y<=c.y)&&(f.z<=c.z&&c.z<=d.z||u.z<=d.z&&d.z<=c.z)},o.prototype.contains=function(h){var u=this.lowerBound,c=this.upperBound,f=h.lowerBound,d=h.upperBound;return u.x<=f.x&&c.x>=d.x&&u.y<=f.y&&c.y>=d.y&&u.z<=f.z&&c.z>=d.z},o.prototype.getCorners=function(h,u,c,f,d,p,m,y){var g=this.lowerBound,v=this.upperBound;h.copy(g),u.set(v.x,g.y,g.z),c.set(v.x,v.y,g.z),f.set(g.x,v.y,v.z),d.set(v.x,g.y,g.z),p.set(g.x,v.y,g.z),m.set(g.x,g.y,v.z),y.copy(v)};var l=[new s,new s,new s,new s,new s,new s,new s,new s];o.prototype.toLocalFrame=function(h,u){var c=l,f=c[0],d=c[1],p=c[2],m=c[3],y=c[4],g=c[5],v=c[6],x=c[7];this.getCorners(f,d,p,m,y,g,v,x);for(var w=0;w!==8;w++){var b=c[w];h.pointToLocal(b,b)}return u.setFromPoints(c)},o.prototype.toWorldFrame=function(h,u){var c=l,f=c[0],d=c[1],p=c[2],m=c[3],y=c[4],g=c[5],v=c[6],x=c[7];this.getCorners(f,d,p,m,y,g,v,x);for(var w=0;w!==8;w++){var b=c[w];h.pointToWorld(b,b)}return u.setFromPoints(c)}},{"../math/Vec3":30,"../utils/Utils":53}],4:[function(t,n,i){n.exports=s;function s(){this.matrix=[]}s.prototype.get=function(o,a){if(o=o.index,a=a.index,a>o){var l=a;a=o,o=l}return this.matrix[(o*(o+1)>>1)+a-1]},s.prototype.set=function(o,a,l){if(o=o.index,a=a.index,a>o){var h=a;a=o,o=h}this.matrix[(o*(o+1)>>1)+a-1]=l?1:0},s.prototype.reset=function(){for(var o=0,a=this.matrix.length;o!==a;o++)this.matrix[o]=0},s.prototype.setNumObjects=function(o){this.matrix.length=o*(o-1)>>1}},{}],5:[function(t,n,i){var s=t("../objects/Body"),o=t("../math/Vec3"),a=t("../math/Quaternion");t("../shapes/Shape"),t("../shapes/Plane"),n.exports=l;function l(){this.world=null,this.useBoundingBoxes=!1,this.dirty=!0}l.prototype.collisionPairs=function(m,y,g){throw new Error("collisionPairs not implemented for this BroadPhase class!")};var h=s.STATIC|s.KINEMATIC;l.prototype.needBroadphaseCollision=function(m,y){return!((m.collisionFilterGroup&y.collisionFilterMask)==0||(y.collisionFilterGroup&m.collisionFilterMask)==0||((m.type&h)!=0||m.sleepState===s.SLEEPING)&&((y.type&h)!=0||y.sleepState===s.SLEEPING))},l.prototype.intersectionTest=function(m,y,g,v){this.useBoundingBoxes?this.doBoundingBoxBroadphase(m,y,g,v):this.doBoundingSphereBroadphase(m,y,g,v)};var u=new o;new o,new a,new o,l.prototype.doBoundingSphereBroadphase=function(m,y,g,v){var x=u;y.position.vsub(m.position,x);var w=Math.pow(m.boundingRadius+y.boundingRadius,2),b=x.norm2();b<w&&(g.push(m),v.push(y))},l.prototype.doBoundingBoxBroadphase=function(m,y,g,v){m.aabbNeedsUpdate&&m.computeAABB(),y.aabbNeedsUpdate&&y.computeAABB(),m.aabb.overlaps(y.aabb)&&(g.push(m),v.push(y))};var c={keys:[]},f=[],d=[];l.prototype.makePairsUnique=function(m,y){for(var g=c,v=f,x=d,w=m.length,b=0;b!==w;b++)v[b]=m[b],x[b]=y[b];m.length=0,y.length=0;for(var b=0;b!==w;b++){var M=v[b].id,A=x[b].id,E=M<A?M+","+A:A+","+M;g[E]=b,g.keys.push(E)}for(var b=0;b!==g.keys.length;b++){var E=g.keys.pop(),N=g[E];m.push(v[N]),y.push(x[N]),delete g[E]}},l.prototype.setWorld=function(m){};var p=new o;l.boundingSphereCheck=function(m,y){var g=p;return m.position.vsub(y.position,g),Math.pow(m.shape.boundingSphereRadius+y.shape.boundingSphereRadius,2)>g.norm2()},l.prototype.aabbQuery=function(m,y,g){return console.warn(".aabbQuery is not implemented in this Broadphase subclass."),[]}},{"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Plane":42,"../shapes/Shape":43}],6:[function(t,n,i){n.exports=l;var s=t("./Broadphase"),o=t("../math/Vec3"),a=t("../shapes/Shape");function l(u,c,f,d,p){s.apply(this),this.nx=f||10,this.ny=d||10,this.nz=p||10,this.aabbMin=u||new o(100,100,100),this.aabbMax=c||new o(-100,-100,-100);var m=this.nx*this.ny*this.nz;if(m<=0)throw"GridBroadphase: Each dimension's n must be >0";this.bins=[],this.binLengths=[],this.bins.length=m,this.binLengths.length=m;for(var y=0;y<m;y++)this.bins[y]=[],this.binLengths[y]=0}l.prototype=new s,l.prototype.constructor=l;var h=new o;new o,l.prototype.collisionPairs=function(u,c,f){var d=u.numObjects(),p=u.bodies,m=this.aabbMax,y=this.aabbMin,g=this.nx,v=this.ny,x=this.nz,w=v*x,b=x,M=1,A=m.x,E=m.y,N=m.z,R=y.x,_=y.y,S=y.z,L=g/(A-R),k=v/(E-_),H=x/(N-S),O=(A-R)/g,T=(E-_)/v,V=(N-S)/x,F=Math.sqrt(O*O+T*T+V*V)*.5,J=a.types,Y=J.SPHERE,te=J.PLANE;J.BOX,J.COMPOUND,J.CONVEXPOLYHEDRON;for(var z=this.bins,K=this.binLengths,Z=this.bins.length,Q=0;Q!==Z;Q++)K[Q]=0;var me=Math.ceil,y=Math.min,m=Math.max;function ge(oe,Ie,Pe,Qe,Ge,We,Fe){var I=(oe-R)*L|0,re=(Ie-_)*k|0,ve=(Pe-S)*H|0,Be=me((Qe-R)*L),Ze=me((Ge-_)*k),Ke=me((We-S)*H);I<0?I=0:I>=g&&(I=g-1),re<0?re=0:re>=v&&(re=v-1),ve<0?ve=0:ve>=x&&(ve=x-1),Be<0?Be=0:Be>=g&&(Be=g-1),Ze<0?Ze=0:Ze>=v&&(Ze=v-1),Ke<0?Ke=0:Ke>=x&&(Ke=x-1),I*=w,re*=b,ve*=M,Be*=w,Ze*=b,Ke*=M;for(var Ft=I;Ft<=Be;Ft+=w)for(var tr=re;tr<=Ze;tr+=b)for(var Dr=ve;Dr<=Ke;Dr+=M){var ur=Ft+tr+Dr;z[ur][K[ur]++]=Fe}}for(var Q=0;Q!==d;Q++){var se=p[Q],he=se.shape;switch(he.type){case Y:var xe=se.position.x,pe=se.position.y,G=se.position.z,q=he.radius;ge(xe-q,pe-q,G-q,xe+q,pe+q,G+q,se);break;case te:he.worldNormalNeedsUpdate&&he.computeWorldNormal(se.quaternion);var B=he.worldNormal,D=R+O*.5-se.position.x,$=_+T*.5-se.position.y,ne=S+V*.5-se.position.z,U=h;U.set(D,$,ne);for(var W=0,P=0;W!==g;W++,P+=w,U.y=$,U.x+=O)for(var C=0,ee=0;C!==v;C++,ee+=b,U.z=ne,U.y+=T)for(var ae=0,le=0;ae!==x;ae++,le+=M,U.z+=V)if(U.dot(B)<F){var ce=P+ee+le;z[ce][K[ce]++]=se}break;default:se.aabbNeedsUpdate&&se.computeAABB(),ge(se.aabb.lowerBound.x,se.aabb.lowerBound.y,se.aabb.lowerBound.z,se.aabb.upperBound.x,se.aabb.upperBound.y,se.aabb.upperBound.z,se);break}}for(var Q=0;Q!==Z;Q++){var ye=K[Q];if(ye>1)for(var we=z[Q],W=0;W!==ye;W++)for(var se=we[W],C=0;C!==W;C++){var be=we[C];this.needBroadphaseCollision(se,be)&&this.intersectionTest(se,be,c,f)}}this.makePairsUnique(c,f)}},{"../math/Vec3":30,"../shapes/Shape":43,"./Broadphase":5}],7:[function(t,n,i){n.exports=a;var s=t("./Broadphase"),o=t("./AABB");function a(){s.apply(this)}a.prototype=new s,a.prototype.constructor=a,a.prototype.collisionPairs=function(l,h,u){var c=l.bodies,f=c.length,d,p,m,y;for(d=0;d!==f;d++)for(p=0;p!==d;p++)m=c[d],y=c[p],!!this.needBroadphaseCollision(m,y)&&this.intersectionTest(m,y,h,u)},new o,a.prototype.aabbQuery=function(l,h,u){u=u||[];for(var c=0;c<l.bodies.length;c++){var f=l.bodies[c];f.aabbNeedsUpdate&&f.computeAABB(),f.aabb.overlaps(h)&&u.push(f)}return u}},{"./AABB":3,"./Broadphase":5}],8:[function(t,n,i){n.exports=s;function s(){this.matrix={}}s.prototype.get=function(o,a){if(o=o.id,a=a.id,a>o){var l=a;a=o,o=l}return o+"-"+a in this.matrix},s.prototype.set=function(o,a,l){if(o=o.id,a=a.id,a>o){var h=a;a=o,o=h}l?this.matrix[o+"-"+a]=!0:delete this.matrix[o+"-"+a]},s.prototype.reset=function(){this.matrix={}},s.prototype.setNumObjects=function(o){}},{}],9:[function(t,n,i){n.exports=c;var s=t("../math/Vec3"),o=t("../math/Quaternion"),a=t("../math/Transform");t("../shapes/ConvexPolyhedron"),t("../shapes/Box");var l=t("../collision/RaycastResult"),h=t("../shapes/Shape"),u=t("../collision/AABB");function c(z,K){this.from=z?z.clone():new s,this.to=K?K.clone():new s,this._direction=new s,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=c.ANY,this.result=new l,this.hasHit=!1,this.callback=function(Z){}}c.prototype.constructor=c,c.CLOSEST=1,c.ANY=2,c.ALL=4;var f=new u,d=[];c.prototype.intersectWorld=function(z,K){return this.mode=K.mode||c.ANY,this.result=K.result||new l,this.skipBackfaces=!!K.skipBackfaces,this.collisionFilterMask=typeof K.collisionFilterMask!="undefined"?K.collisionFilterMask:-1,this.collisionFilterGroup=typeof K.collisionFilterGroup!="undefined"?K.collisionFilterGroup:-1,K.from&&this.from.copy(K.from),K.to&&this.to.copy(K.to),this.callback=K.callback||function(){},this.hasHit=!1,this.result.reset(),this._updateDirection(),this.getAABB(f),d.length=0,z.broadphase.aabbQuery(z,f,d),this.intersectBodies(d),this.hasHit};var p=new s,m=new s;c.pointInTriangle=y;function y(z,K,Z,Q){Q.vsub(K,J),Z.vsub(K,p),z.vsub(K,m);var me=J.dot(J),ge=J.dot(p),se=J.dot(m),he=p.dot(p),xe=p.dot(m),pe,G;return(pe=he*se-ge*xe)>=0&&(G=me*xe-ge*se)>=0&&pe+G<me*he-ge*ge}var g=new s,v=new o;c.prototype.intersectBody=function(z,K){K&&(this.result=K,this._updateDirection());var Z=this.checkCollisionResponse;if(!(Z&&!z.collisionResponse)&&!((this.collisionFilterGroup&z.collisionFilterMask)==0||(z.collisionFilterGroup&this.collisionFilterMask)==0))for(var Q=g,me=v,ge=0,se=z.shapes.length;ge<se;ge++){var he=z.shapes[ge];if(!(Z&&!he.collisionResponse)&&(z.quaternion.mult(z.shapeOrientations[ge],me),z.quaternion.vmult(z.shapeOffsets[ge],Q),Q.vadd(z.position,Q),this.intersectShape(he,me,Q,z),this.result._shouldStop))break}},c.prototype.intersectBodies=function(z,K){K&&(this.result=K,this._updateDirection());for(var Z=0,Q=z.length;!this.result._shouldStop&&Z<Q;Z++)this.intersectBody(z[Z])},c.prototype._updateDirection=function(){this.to.vsub(this.from,this._direction),this._direction.normalize()},c.prototype.intersectShape=function(z,K,Z,Q){var me=this.from,ge=te(me,this._direction,Z);if(!(ge>z.boundingSphereRadius)){var se=this[z.type];se&&se.call(this,z,K,Z,Q)}},new s,new s;var x=new s,w=new s,b=new s,M=new s;new s,new l,c.prototype.intersectBox=function(z,K,Z,Q){return this.intersectConvex(z.convexPolyhedronRepresentation,K,Z,Q)},c.prototype[h.types.BOX]=c.prototype.intersectBox,c.prototype.intersectPlane=function(z,K,Z,Q){var me=this.from,ge=this.to,se=this._direction,he=new s(0,0,1);K.vmult(he,he);var xe=new s;me.vsub(Z,xe);var pe=xe.dot(he);ge.vsub(Z,xe);var G=xe.dot(he);if(!(pe*G>0)&&!(me.distanceTo(ge)<pe)){var q=he.dot(se);if(!(Math.abs(q)<this.precision)){var B=new s,D=new s,$=new s;me.vsub(Z,B);var ne=-he.dot(B)/q;se.scale(ne,D),me.vadd(D,$),this.reportIntersection(he,$,z,Q,-1)}}},c.prototype[h.types.PLANE]=c.prototype.intersectPlane,c.prototype.getAABB=function(z){var K=this.to,Z=this.from;z.lowerBound.x=Math.min(K.x,Z.x),z.lowerBound.y=Math.min(K.y,Z.y),z.lowerBound.z=Math.min(K.z,Z.z),z.upperBound.x=Math.max(K.x,Z.x),z.upperBound.y=Math.max(K.y,Z.y),z.upperBound.z=Math.max(K.z,Z.z)};var A={faceList:[0]};c.prototype.intersectHeightfield=function(z,K,Z,Q){z.data,z.elementSize;var me=new s,ge=new c(this.from,this.to);a.pointToLocalFrame(Z,K,ge.from,ge.from),a.pointToLocalFrame(Z,K,ge.to,ge.to);var se=[],he=null,xe=null,pe=null,G=null,q=z.getIndexOfPosition(ge.from.x,ge.from.y,se,!1);if(q&&(he=se[0],xe=se[1],pe=se[0],G=se[1]),q=z.getIndexOfPosition(ge.to.x,ge.to.y,se,!1),q&&((he===null||se[0]<he)&&(he=se[0]),(pe===null||se[0]>pe)&&(pe=se[0]),(xe===null||se[1]<xe)&&(xe=se[1]),(G===null||se[1]>G)&&(G=se[1])),he!==null){var B=[];z.getRectMinMax(he,xe,pe,G,B),B[0],B[1];for(var D=he;D<=pe;D++)for(var $=xe;$<=G;$++){if(this.result._shouldStop||(z.getConvexTrianglePillar(D,$,!1),a.pointToWorldFrame(Z,K,z.pillarOffset,me),this.intersectConvex(z.pillarConvex,K,me,Q,A),this.result._shouldStop))return;z.getConvexTrianglePillar(D,$,!0),a.pointToWorldFrame(Z,K,z.pillarOffset,me),this.intersectConvex(z.pillarConvex,K,me,Q,A)}}},c.prototype[h.types.HEIGHTFIELD]=c.prototype.intersectHeightfield;var E=new s,N=new s;c.prototype.intersectSphere=function(z,K,Z,Q){var me=this.from,ge=this.to,se=z.radius,he=Math.pow(ge.x-me.x,2)+Math.pow(ge.y-me.y,2)+Math.pow(ge.z-me.z,2),xe=2*((ge.x-me.x)*(me.x-Z.x)+(ge.y-me.y)*(me.y-Z.y)+(ge.z-me.z)*(me.z-Z.z)),pe=Math.pow(me.x-Z.x,2)+Math.pow(me.y-Z.y,2)+Math.pow(me.z-Z.z,2)-Math.pow(se,2),G=Math.pow(xe,2)-4*he*pe,q=E,B=N;if(!(G<0))if(G===0)me.lerp(ge,G,q),q.vsub(Z,B),B.normalize(),this.reportIntersection(B,q,z,Q,-1);else{var D=(-xe-Math.sqrt(G))/(2*he),$=(-xe+Math.sqrt(G))/(2*he);if(D>=0&&D<=1&&(me.lerp(ge,D,q),q.vsub(Z,B),B.normalize(),this.reportIntersection(B,q,z,Q,-1)),this.result._shouldStop)return;$>=0&&$<=1&&(me.lerp(ge,$,q),q.vsub(Z,B),B.normalize(),this.reportIntersection(B,q,z,Q,-1))}},c.prototype[h.types.SPHERE]=c.prototype.intersectSphere;var R=new s;new s,new s;var _=new s;c.prototype.intersectConvex=function(K,Z,Q,me,ge){for(var se=R,he=_,xe=ge&&ge.faceList||null,pe=K.faces,G=K.vertices,q=K.faceNormals,B=this._direction,D=this.from,$=this.to,ne=D.distanceTo($),U=xe?xe.length:pe.length,W=this.result,P=0;!W._shouldStop&&P<U;P++){var C=xe?xe[P]:P,ee=pe[C],ae=q[C],le=Z,ce=Q;he.copy(G[ee[0]]),le.vmult(he,he),he.vadd(ce,he),he.vsub(D,he),le.vmult(ae,se);var ye=B.dot(se);if(!(Math.abs(ye)<this.precision)){var we=se.dot(he)/ye;if(!(we<0)){B.mult(we,x),x.vadd(D,x),w.copy(G[ee[0]]),le.vmult(w,w),ce.vadd(w,w);for(var be=1;!W._shouldStop&&be<ee.length-1;be++){b.copy(G[ee[be]]),M.copy(G[ee[be+1]]),le.vmult(b,b),le.vmult(M,M),ce.vadd(b,b),ce.vadd(M,M);var oe=x.distanceTo(D);!(y(x,w,b,M)||y(x,b,w,M))||oe>ne||this.reportIntersection(se,x,K,me,C)}}}}},c.prototype[h.types.CONVEXPOLYHEDRON]=c.prototype.intersectConvex;var S=new s,L=new s,k=new s,H=new s,O=new s,T=new s;new u;var V=[],F=new a;c.prototype.intersectTrimesh=function(K,Z,Q,me,ge){var se=S,he=V,xe=F,pe=_,G=L,q=k,B=H,D=T,$=O;ge&&ge.faceList;var ne=K.indices;K.vertices,K.faceNormals;var U=this.from,W=this.to,P=this._direction;xe.position.copy(Q),xe.quaternion.copy(Z),a.vectorToLocalFrame(Q,Z,P,G),a.pointToLocalFrame(Q,Z,U,q),a.pointToLocalFrame(Q,Z,W,B);var C=q.distanceSquared(B);K.tree.rayQuery(this,xe,he);for(var ee=0,ae=he.length;!this.result._shouldStop&&ee!==ae;ee++){var le=he[ee];K.getNormal(le,se),K.getVertex(ne[le*3],w),w.vsub(q,pe);var ce=G.dot(se),ye=se.dot(pe)/ce;if(!(ye<0)){G.scale(ye,x),x.vadd(q,x),K.getVertex(ne[le*3+1],b),K.getVertex(ne[le*3+2],M);var we=x.distanceSquared(q);!(y(x,b,w,M)||y(x,w,b,M))||we>C||(a.vectorToWorldFrame(Z,se,$),a.pointToWorldFrame(Q,Z,x,D),this.reportIntersection($,D,K,me,le))}}he.length=0},c.prototype[h.types.TRIMESH]=c.prototype.intersectTrimesh,c.prototype.reportIntersection=function(z,K,Z,Q,me){var ge=this.from,se=this.to,he=ge.distanceTo(K),xe=this.result;if(!(this.skipBackfaces&&z.dot(this._direction)>0))switch(xe.hitFaceIndex=typeof me!="undefined"?me:-1,this.mode){case c.ALL:this.hasHit=!0,xe.set(ge,se,z,K,Z,Q,he),xe.hasHit=!0,this.callback(xe);break;case c.CLOSEST:(he<xe.distance||!xe.hasHit)&&(this.hasHit=!0,xe.hasHit=!0,xe.set(ge,se,z,K,Z,Q,he));break;case c.ANY:this.hasHit=!0,xe.hasHit=!0,xe.set(ge,se,z,K,Z,Q,he),xe._shouldStop=!0;break}};var J=new s,Y=new s;function te(z,K,Z){Z.vsub(z,J);var Q=J.dot(K);K.mult(Q,Y),Y.vadd(z,Y);var me=Z.distanceTo(Y);return me}},{"../collision/AABB":3,"../collision/RaycastResult":10,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../shapes/Box":37,"../shapes/ConvexPolyhedron":38,"../shapes/Shape":43}],10:[function(t,n,i){var s=t("../math/Vec3");n.exports=o;function o(){this.rayFromWorld=new s,this.rayToWorld=new s,this.hitNormalWorld=new s,this.hitPointWorld=new s,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this._shouldStop=!1}o.prototype.reset=function(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this._shouldStop=!1},o.prototype.abort=function(){this._shouldStop=!0},o.prototype.set=function(a,l,h,u,c,f,d){this.rayFromWorld.copy(a),this.rayToWorld.copy(l),this.hitNormalWorld.copy(h),this.hitPointWorld.copy(u),this.shape=c,this.body=f,this.distance=d}},{"../math/Vec3":30}],11:[function(t,n,i){t("../shapes/Shape");var s=t("../collision/Broadphase");n.exports=o;function o(a){s.apply(this),this.axisList=[],this.world=null,this.axisIndex=0;var l=this.axisList;this._addBodyHandler=function(h){l.push(h.body)},this._removeBodyHandler=function(h){var u=l.indexOf(h.body);u!==-1&&l.splice(u,1)},a&&this.setWorld(a)}o.prototype=new s,o.prototype.setWorld=function(a){this.axisList.length=0;for(var l=0;l<a.bodies.length;l++)this.axisList.push(a.bodies[l]);a.removeEventListener("addBody",this._addBodyHandler),a.removeEventListener("removeBody",this._removeBodyHandler),a.addEventListener("addBody",this._addBodyHandler),a.addEventListener("removeBody",this._removeBodyHandler),this.world=a,this.dirty=!0},o.insertionSortX=function(a){for(var l=1,h=a.length;l<h;l++){for(var u=a[l],c=l-1;c>=0&&!(a[c].aabb.lowerBound.x<=u.aabb.lowerBound.x);c--)a[c+1]=a[c];a[c+1]=u}return a},o.insertionSortY=function(a){for(var l=1,h=a.length;l<h;l++){for(var u=a[l],c=l-1;c>=0&&!(a[c].aabb.lowerBound.y<=u.aabb.lowerBound.y);c--)a[c+1]=a[c];a[c+1]=u}return a},o.insertionSortZ=function(a){for(var l=1,h=a.length;l<h;l++){for(var u=a[l],c=l-1;c>=0&&!(a[c].aabb.lowerBound.z<=u.aabb.lowerBound.z);c--)a[c+1]=a[c];a[c+1]=u}return a},o.prototype.collisionPairs=function(a,l,h){var u=this.axisList,c=u.length,f=this.axisIndex,d,p;for(this.dirty&&(this.sortList(),this.dirty=!1),d=0;d!==c;d++){var m=u[d];for(p=d+1;p<c;p++){var y=u[p];if(!!this.needBroadphaseCollision(m,y)){if(!o.checkBounds(m,y,f))break;this.intersectionTest(m,y,l,h)}}}},o.prototype.sortList=function(){for(var a=this.axisList,l=this.axisIndex,h=a.length,u=0;u!==h;u++){var c=a[u];c.aabbNeedsUpdate&&c.computeAABB()}l===0?o.insertionSortX(a):l===1?o.insertionSortY(a):l===2&&o.insertionSortZ(a)},o.checkBounds=function(a,l,h){var u,c;h===0?(u=a.position.x,c=l.position.x):h===1?(u=a.position.y,c=l.position.y):h===2&&(u=a.position.z,c=l.position.z);var f=a.boundingRadius,d=l.boundingRadius,p=u+f,m=c-d;return m<p},o.prototype.autoDetectAxis=function(){for(var a=0,l=0,h=0,u=0,c=0,f=0,d=this.axisList,p=d.length,m=1/p,y=0;y!==p;y++){var g=d[y],v=g.position.x;a+=v,l+=v*v;var x=g.position.y;h+=x,u+=x*x;var w=g.position.z;c+=w,f+=w*w}var b=l-a*a*m,M=u-h*h*m,A=f-c*c*m;b>M?b>A?this.axisIndex=0:this.axisIndex=2:M>A?this.axisIndex=1:this.axisIndex=2},o.prototype.aabbQuery=function(a,l,h){h=h||[],this.dirty&&(this.sortList(),this.dirty=!1);var u=this.axisIndex,c="x";u===1&&(c="y"),u===2&&(c="z");var f=this.axisList;l.lowerBound[c],l.upperBound[c];for(var d=0;d<f.length;d++){var p=f[d];p.aabbNeedsUpdate&&p.computeAABB(),p.aabb.overlaps(l)&&h.push(p)}return h}},{"../collision/Broadphase":5,"../shapes/Shape":43}],12:[function(t,n,i){n.exports=h,t("./Constraint");var s=t("./PointToPointConstraint"),o=t("../equations/ConeEquation"),a=t("../equations/RotationalEquation");t("../equations/ContactEquation");var l=t("../math/Vec3");function h(u,c,f){f=f||{};var d=typeof f.maxForce!="undefined"?f.maxForce:1e6,p=f.pivotA?f.pivotA.clone():new l,m=f.pivotB?f.pivotB.clone():new l;this.axisA=f.axisA?f.axisA.clone():new l,this.axisB=f.axisB?f.axisB.clone():new l,s.call(this,u,p,c,m,d),this.collideConnected=!!f.collideConnected,this.angle=typeof f.angle!="undefined"?f.angle:0;var y=this.coneEquation=new o(u,c,f),g=this.twistEquation=new a(u,c,f);this.twistAngle=typeof f.twistAngle!="undefined"?f.twistAngle:0,y.maxForce=0,y.minForce=-d,g.maxForce=0,g.minForce=-d,this.equations.push(y,g)}h.prototype=new s,h.constructor=h,new l,new l,h.prototype.update=function(){var u=this.bodyA,c=this.bodyB,f=this.coneEquation,d=this.twistEquation;s.prototype.update.call(this),u.vectorToWorldFrame(this.axisA,f.axisA),c.vectorToWorldFrame(this.axisB,f.axisB),this.axisA.tangents(d.axisA,d.axisA),u.vectorToWorldFrame(d.axisA,d.axisA),this.axisB.tangents(d.axisB,d.axisB),c.vectorToWorldFrame(d.axisB,d.axisB),f.angle=this.angle,d.maxAngle=this.twistAngle}},{"../equations/ConeEquation":18,"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],13:[function(t,n,i){n.exports=o;var s=t("../utils/Utils");function o(a,l,h){h=s.defaults(h,{collideConnected:!0,wakeUpBodies:!0}),this.equations=[],this.bodyA=a,this.bodyB=l,this.id=o.idCounter++,this.collideConnected=h.collideConnected,h.wakeUpBodies&&(a&&a.wakeUp(),l&&l.wakeUp())}o.prototype.update=function(){throw new Error("method update() not implmemented in this Constraint subclass!")},o.prototype.enable=function(){for(var a=this.equations,l=0;l<a.length;l++)a[l].enabled=!0},o.prototype.disable=function(){for(var a=this.equations,l=0;l<a.length;l++)a[l].enabled=!1},o.idCounter=0},{"../utils/Utils":53}],14:[function(t,n,i){n.exports=a;var s=t("./Constraint"),o=t("../equations/ContactEquation");function a(l,h,u,c){s.call(this,l,h),typeof u=="undefined"&&(u=l.position.distanceTo(h.position)),typeof c=="undefined"&&(c=1e6),this.distance=u;var f=this.distanceEquation=new o(l,h);this.equations.push(f),f.minForce=-c,f.maxForce=c}a.prototype=new s,a.prototype.update=function(){var l=this.bodyA,h=this.bodyB,u=this.distanceEquation,c=this.distance*.5,f=u.ni;h.position.vsub(l.position,f),f.normalize(),f.mult(c,u.ri),f.mult(-c,u.rj)}},{"../equations/ContactEquation":19,"./Constraint":13}],15:[function(t,n,i){n.exports=h,t("./Constraint");var s=t("./PointToPointConstraint"),o=t("../equations/RotationalEquation"),a=t("../equations/RotationalMotorEquation");t("../equations/ContactEquation");var l=t("../math/Vec3");function h(f,d,p){p=p||{};var m=typeof p.maxForce!="undefined"?p.maxForce:1e6,y=p.pivotA?p.pivotA.clone():new l,g=p.pivotB?p.pivotB.clone():new l;s.call(this,f,y,d,g,m);var v=this.axisA=p.axisA?p.axisA.clone():new l(1,0,0);v.normalize();var x=this.axisB=p.axisB?p.axisB.clone():new l(1,0,0);x.normalize();var w=this.rotationalEquation1=new o(f,d,p),b=this.rotationalEquation2=new o(f,d,p),M=this.motorEquation=new a(f,d,m);M.enabled=!1,this.equations.push(w,b,M)}h.prototype=new s,h.constructor=h,h.prototype.enableMotor=function(){this.motorEquation.enabled=!0},h.prototype.disableMotor=function(){this.motorEquation.enabled=!1},h.prototype.setMotorSpeed=function(f){this.motorEquation.targetVelocity=f},h.prototype.setMotorMaxForce=function(f){this.motorEquation.maxForce=f,this.motorEquation.minForce=-f};var u=new l,c=new l;h.prototype.update=function(){var f=this.bodyA,d=this.bodyB,p=this.motorEquation,m=this.rotationalEquation1,y=this.rotationalEquation2,g=u,v=c,x=this.axisA,w=this.axisB;s.prototype.update.call(this),f.quaternion.vmult(x,g),d.quaternion.vmult(w,v),g.tangents(m.axisA,y.axisA),m.axisB.copy(v),y.axisB.copy(v),this.motorEquation.enabled&&(f.quaternion.vmult(this.axisA,p.axisA),d.quaternion.vmult(this.axisB,p.axisB))}},{"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../equations/RotationalMotorEquation":23,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],16:[function(t,n,i){n.exports=l,t("./Constraint");var s=t("./PointToPointConstraint"),o=t("../equations/RotationalEquation");t("../equations/RotationalMotorEquation"),t("../equations/ContactEquation");var a=t("../math/Vec3");function l(h,u,c){c=c||{};var f=typeof c.maxForce!="undefined"?c.maxForce:1e6,d=new a,p=new a,m=new a;h.position.vadd(u.position,m),m.scale(.5,m),u.pointToLocalFrame(m,p),h.pointToLocalFrame(m,d),s.call(this,h,d,u,p,f);var y=this.rotationalEquation1=new o(h,u,c),g=this.rotationalEquation2=new o(h,u,c),v=this.rotationalEquation3=new o(h,u,c);this.equations.push(y,g,v)}l.prototype=new s,l.constructor=l,new a,new a,l.prototype.update=function(){var h=this.bodyA,u=this.bodyB;this.motorEquation;var c=this.rotationalEquation1,f=this.rotationalEquation2,d=this.rotationalEquation3;s.prototype.update.call(this),h.vectorToWorldFrame(a.UNIT_X,c.axisA),u.vectorToWorldFrame(a.UNIT_Y,c.axisB),h.vectorToWorldFrame(a.UNIT_Y,f.axisA),u.vectorToWorldFrame(a.UNIT_Z,f.axisB),h.vectorToWorldFrame(a.UNIT_Z,d.axisA),u.vectorToWorldFrame(a.UNIT_X,d.axisB)}},{"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../equations/RotationalMotorEquation":23,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],17:[function(t,n,i){n.exports=l;var s=t("./Constraint"),o=t("../equations/ContactEquation"),a=t("../math/Vec3");function l(h,u,c,f,d){s.call(this,h,c),d=typeof d!="undefined"?d:1e6,this.pivotA=u?u.clone():new a,this.pivotB=f?f.clone():new a;var p=this.equationX=new o(h,c),m=this.equationY=new o(h,c),y=this.equationZ=new o(h,c);this.equations.push(p,m,y),p.minForce=m.minForce=y.minForce=-d,p.maxForce=m.maxForce=y.maxForce=d,p.ni.set(1,0,0),m.ni.set(0,1,0),y.ni.set(0,0,1)}l.prototype=new s,l.prototype.update=function(){var h=this.bodyA,u=this.bodyB,c=this.equationX,f=this.equationY,d=this.equationZ;h.quaternion.vmult(this.pivotA,c.ri),u.quaternion.vmult(this.pivotB,c.rj),f.ri.copy(c.ri),f.rj.copy(c.rj),d.ri.copy(c.ri),d.rj.copy(c.rj)}},{"../equations/ContactEquation":19,"../math/Vec3":30,"./Constraint":13}],18:[function(t,n,i){n.exports=a;var s=t("../math/Vec3");t("../math/Mat3");var o=t("./Equation");function a(u,c,f){f=f||{};var d=typeof f.maxForce!="undefined"?f.maxForce:1e6;o.call(this,u,c,-d,d),this.axisA=f.axisA?f.axisA.clone():new s(1,0,0),this.axisB=f.axisB?f.axisB.clone():new s(0,1,0),this.angle=typeof f.angle!="undefined"?f.angle:0}a.prototype=new o,a.prototype.constructor=a;var l=new s,h=new s;a.prototype.computeB=function(u){var c=this.a,f=this.b,d=this.axisA,p=this.axisB,m=l,y=h,g=this.jacobianElementA,v=this.jacobianElementB;d.cross(p,m),p.cross(d,y),g.rotational.copy(y),v.rotational.copy(m);var x=Math.cos(this.angle)-d.dot(p),w=this.computeGW(),b=this.computeGiMf(),M=-x*c-w*f-u*b;return M}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],19:[function(t,n,i){n.exports=a;var s=t("./Equation"),o=t("../math/Vec3");t("../math/Mat3");function a(y,g,v){v=typeof v!="undefined"?v:1e6,s.call(this,y,g,0,v),this.restitution=0,this.ri=new o,this.rj=new o,this.ni=new o}a.prototype=new s,a.prototype.constructor=a;var l=new o,h=new o,u=new o;a.prototype.computeB=function(y){var g=this.a,v=this.b,x=this.bi,w=this.bj,b=this.ri,M=this.rj,A=l,E=h,N=x.velocity,R=x.angularVelocity;x.force,x.torque;var _=w.velocity,S=w.angularVelocity;w.force,w.torque;var L=u,k=this.jacobianElementA,H=this.jacobianElementB,O=this.ni;b.cross(O,A),M.cross(O,E),O.negate(k.spatial),A.negate(k.rotational),H.spatial.copy(O),H.rotational.copy(E),L.copy(w.position),L.vadd(M,L),L.vsub(x.position,L),L.vsub(b,L);var T=O.dot(L),V=this.restitution+1,F=V*_.dot(O)-V*N.dot(O)+S.dot(E)-R.dot(A),J=this.computeGiMf(),Y=-T*g-F*v-y*J;return Y};var c=new o,f=new o,d=new o,p=new o,m=new o;a.prototype.getImpactVelocityAlongNormal=function(){var y=c,g=f,v=d,x=p,w=m;return this.bi.position.vadd(this.ri,v),this.bj.position.vadd(this.rj,x),this.bi.getVelocityAtWorldPoint(v,y),this.bj.getVelocityAtWorldPoint(x,g),y.vsub(g,w),this.ni.dot(w)}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],20:[function(t,n,i){n.exports=a;var s=t("../math/JacobianElement"),o=t("../math/Vec3");function a(m,y,g,v){this.id=a.id++,this.minForce=typeof g=="undefined"?-1e6:g,this.maxForce=typeof v=="undefined"?1e6:v,this.bi=m,this.bj=y,this.a=0,this.b=0,this.eps=0,this.jacobianElementA=new s,this.jacobianElementB=new s,this.enabled=!0,this.setSpookParams(1e7,4,1/60)}a.prototype.constructor=a,a.id=0,a.prototype.setSpookParams=function(m,y,g){var v=y,x=m,w=g;this.a=4/(w*(1+4*v)),this.b=4*v/(1+4*v),this.eps=4/(w*w*x*(1+4*v))},a.prototype.computeB=function(m,y,g){var v=this.computeGW(),x=this.computeGq(),w=this.computeGiMf();return-x*m-v*y-w*g},a.prototype.computeGq=function(){var m=this.jacobianElementA,y=this.jacobianElementB,g=this.bi,v=this.bj,x=g.position,w=v.position;return m.spatial.dot(x)+y.spatial.dot(w)};var l=new o;a.prototype.computeGW=function(){var m=this.jacobianElementA,y=this.jacobianElementB,g=this.bi,v=this.bj,x=g.velocity,w=v.velocity,b=g.angularVelocity||l,M=v.angularVelocity||l;return m.multiplyVectors(x,b)+y.multiplyVectors(w,M)},a.prototype.computeGWlambda=function(){var m=this.jacobianElementA,y=this.jacobianElementB,g=this.bi,v=this.bj,x=g.vlambda,w=v.vlambda,b=g.wlambda||l,M=v.wlambda||l;return m.multiplyVectors(x,b)+y.multiplyVectors(w,M)};var h=new o,u=new o,c=new o,f=new o;a.prototype.computeGiMf=function(){var m=this.jacobianElementA,y=this.jacobianElementB,g=this.bi,v=this.bj,x=g.force,w=g.torque,b=v.force,M=v.torque,A=g.invMassSolve,E=v.invMassSolve;return g.invInertiaWorldSolve?g.invInertiaWorldSolve.vmult(w,c):c.set(0,0,0),v.invInertiaWorldSolve?v.invInertiaWorldSolve.vmult(M,f):f.set(0,0,0),x.mult(A,h),b.mult(E,u),m.multiplyVectors(h,c)+y.multiplyVectors(u,f)};var d=new o;a.prototype.computeGiMGt=function(){var m=this.jacobianElementA,y=this.jacobianElementB,g=this.bi,v=this.bj,x=g.invMassSolve,w=v.invMassSolve,b=g.invInertiaWorldSolve,M=v.invInertiaWorldSolve,A=x+w;return b&&(b.vmult(m.rotational,d),A+=d.dot(m.rotational)),M&&(M.vmult(y.rotational,d),A+=d.dot(y.rotational)),A};var p=new o;new o,new o,new o,new o,new o,a.prototype.addToWlambda=function(m){var y=this.jacobianElementA,g=this.jacobianElementB,v=this.bi,x=this.bj,w=p;y.spatial.mult(v.invMassSolve*m,w),v.vlambda.vadd(w,v.vlambda),g.spatial.mult(x.invMassSolve*m,w),x.vlambda.vadd(w,x.vlambda),v.invInertiaWorldSolve&&(v.invInertiaWorldSolve.vmult(y.rotational,w),w.mult(m,w),v.wlambda.vadd(w,v.wlambda)),x.invInertiaWorldSolve&&(x.invInertiaWorldSolve.vmult(g.rotational,w),w.mult(m,w),x.wlambda.vadd(w,x.wlambda))},a.prototype.computeC=function(){return this.computeGiMGt()+this.eps}},{"../math/JacobianElement":26,"../math/Vec3":30}],21:[function(t,n,i){n.exports=a;var s=t("./Equation"),o=t("../math/Vec3");t("../math/Mat3");function a(u,c,f){s.call(this,u,c,-f,f),this.ri=new o,this.rj=new o,this.t=new o}a.prototype=new s,a.prototype.constructor=a;var l=new o,h=new o;a.prototype.computeB=function(u){this.a;var c=this.b;this.bi,this.bj;var f=this.ri,d=this.rj,p=l,m=h,y=this.t;f.cross(y,p),d.cross(y,m);var g=this.jacobianElementA,v=this.jacobianElementB;y.negate(g.spatial),p.negate(g.rotational),v.spatial.copy(y),v.rotational.copy(m);var x=this.computeGW(),w=this.computeGiMf(),b=-x*c-u*w;return b}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],22:[function(t,n,i){n.exports=a;var s=t("../math/Vec3");t("../math/Mat3");var o=t("./Equation");function a(u,c,f){f=f||{};var d=typeof f.maxForce!="undefined"?f.maxForce:1e6;o.call(this,u,c,-d,d),this.axisA=f.axisA?f.axisA.clone():new s(1,0,0),this.axisB=f.axisB?f.axisB.clone():new s(0,1,0),this.maxAngle=Math.PI/2}a.prototype=new o,a.prototype.constructor=a;var l=new s,h=new s;a.prototype.computeB=function(u){var c=this.a,f=this.b,d=this.axisA,p=this.axisB,m=l,y=h,g=this.jacobianElementA,v=this.jacobianElementB;d.cross(p,m),p.cross(d,y),g.rotational.copy(y),v.rotational.copy(m);var x=Math.cos(this.maxAngle)-d.dot(p),w=this.computeGW(),b=this.computeGiMf(),M=-x*c-w*f-u*b;return M}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],23:[function(t,n,i){n.exports=a;var s=t("../math/Vec3");t("../math/Mat3");var o=t("./Equation");function a(l,h,u){u=typeof u!="undefined"?u:1e6,o.call(this,l,h,-u,u),this.axisA=new s,this.axisB=new s,this.targetVelocity=0}a.prototype=new o,a.prototype.constructor=a,a.prototype.computeB=function(l){this.a;var h=this.b;this.bi,this.bj;var u=this.axisA,c=this.axisB,f=this.jacobianElementA,d=this.jacobianElementB;f.rotational.copy(u),c.negate(d.rotational);var p=this.computeGW()-this.targetVelocity,m=this.computeGiMf(),y=-p*h-l*m;return y}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],24:[function(t,n,i){var s=t("../utils/Utils");n.exports=o;function o(a,l,h){h=s.defaults(h,{friction:.3,restitution:.3,contactEquationStiffness:1e7,contactEquationRelaxation:3,frictionEquationStiffness:1e7,frictionEquationRelaxation:3}),this.id=o.idCounter++,this.materials=[a,l],this.friction=h.friction,this.restitution=h.restitution,this.contactEquationStiffness=h.contactEquationStiffness,this.contactEquationRelaxation=h.contactEquationRelaxation,this.frictionEquationStiffness=h.frictionEquationStiffness,this.frictionEquationRelaxation=h.frictionEquationRelaxation}o.idCounter=0},{"../utils/Utils":53}],25:[function(t,n,i){n.exports=s;function s(o){var a="";o=o||{},typeof o=="string"?(a=o,o={}):typeof o=="object"&&(a=""),this.name=a,this.id=s.idCounter++,this.friction=typeof o.friction!="undefined"?o.friction:-1,this.restitution=typeof o.restitution!="undefined"?o.restitution:-1}s.idCounter=0},{}],26:[function(t,n,i){n.exports=o;var s=t("./Vec3");function o(){this.spatial=new s,this.rotational=new s}o.prototype.multiplyElement=function(a){return a.spatial.dot(this.spatial)+a.rotational.dot(this.rotational)},o.prototype.multiplyVectors=function(a,l){return a.dot(this.spatial)+l.dot(this.rotational)}},{"./Vec3":30}],27:[function(t,n,i){n.exports=o;var s=t("./Vec3");function o(a){a?this.elements=a:this.elements=[0,0,0,0,0,0,0,0,0]}o.prototype.identity=function(){var a=this.elements;a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1},o.prototype.setZero=function(){var a=this.elements;a[0]=0,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=0,a[6]=0,a[7]=0,a[8]=0},o.prototype.setTrace=function(a){var l=this.elements;l[0]=a.x,l[4]=a.y,l[8]=a.z},o.prototype.getTrace=function(a){var a=a||new s,l=this.elements;a.x=l[0],a.y=l[4],a.z=l[8]},o.prototype.vmult=function(a,l){l=l||new s;var h=this.elements,u=a.x,c=a.y,f=a.z;return l.x=h[0]*u+h[1]*c+h[2]*f,l.y=h[3]*u+h[4]*c+h[5]*f,l.z=h[6]*u+h[7]*c+h[8]*f,l},o.prototype.smult=function(a){for(var l=0;l<this.elements.length;l++)this.elements[l]*=a},o.prototype.mmult=function(a,l){for(var h=l||new o,u=0;u<3;u++)for(var c=0;c<3;c++){for(var f=0,d=0;d<3;d++)f+=a.elements[u+d*3]*this.elements[d+c*3];h.elements[u+c*3]=f}return h},o.prototype.scale=function(a,l){l=l||new o;for(var h=this.elements,u=l.elements,c=0;c!==3;c++)u[3*c+0]=a.x*h[3*c+0],u[3*c+1]=a.y*h[3*c+1],u[3*c+2]=a.z*h[3*c+2];return l},o.prototype.solve=function(a,l){l=l||new s;for(var h=3,u=4,c=[],f=0;f<h*u;f++)c.push(0);var f,d;for(f=0;f<3;f++)for(d=0;d<3;d++)c[f+u*d]=this.elements[f+3*d];c[3+4*0]=a.x,c[3+4*1]=a.y,c[3+4*2]=a.z;var p=3,m=p,y,g=4,v;do{if(f=m-p,c[f+u*f]===0){for(d=f+1;d<m;d++)if(c[f+u*d]!==0){y=g;do v=g-y,c[v+u*f]+=c[v+u*d];while(--y);break}}if(c[f+u*f]!==0)for(d=f+1;d<m;d++){var x=c[f+u*d]/c[f+u*f];y=g;do v=g-y,c[v+u*d]=v<=f?0:c[v+u*d]-c[v+u*f]*x;while(--y)}}while(--p);if(l.z=c[2*u+3]/c[2*u+2],l.y=(c[1*u+3]-c[1*u+2]*l.z)/c[1*u+1],l.x=(c[0*u+3]-c[0*u+2]*l.z-c[0*u+1]*l.y)/c[0*u+0],isNaN(l.x)||isNaN(l.y)||isNaN(l.z)||l.x===1/0||l.y===1/0||l.z===1/0)throw"Could not solve equation! Got x=["+l.toString()+"], b=["+a.toString()+"], A=["+this.toString()+"]";return l},o.prototype.e=function(a,l,h){if(h===void 0)return this.elements[l+3*a];this.elements[l+3*a]=h},o.prototype.copy=function(a){for(var l=0;l<a.elements.length;l++)this.elements[l]=a.elements[l];return this},o.prototype.toString=function(){for(var a="",l=",",h=0;h<9;h++)a+=this.elements[h]+l;return a},o.prototype.reverse=function(a){a=a||new o;for(var l=3,h=6,u=[],c=0;c<l*h;c++)u.push(0);var c,f;for(c=0;c<3;c++)for(f=0;f<3;f++)u[c+h*f]=this.elements[c+3*f];u[3+6*0]=1,u[3+6*1]=0,u[3+6*2]=0,u[4+6*0]=0,u[4+6*1]=1,u[4+6*2]=0,u[5+6*0]=0,u[5+6*1]=0,u[5+6*2]=1;var d=3,p=d,m,y=h,g;do{if(c=p-d,u[c+h*c]===0){for(f=c+1;f<p;f++)if(u[c+h*f]!==0){m=y;do g=y-m,u[g+h*c]+=u[g+h*f];while(--m);break}}if(u[c+h*c]!==0)for(f=c+1;f<p;f++){var v=u[c+h*f]/u[c+h*c];m=y;do g=y-m,u[g+h*f]=g<=c?0:u[g+h*f]-u[g+h*c]*v;while(--m)}}while(--d);c=2;do{f=c-1;do{var v=u[c+h*f]/u[c+h*c];m=h;do g=h-m,u[g+h*f]=u[g+h*f]-u[g+h*c]*v;while(--m)}while(f--)}while(--c);c=2;do{var v=1/u[c+h*c];m=h;do g=h-m,u[g+h*c]=u[g+h*c]*v;while(--m)}while(c--);c=2;do{f=2;do{if(g=u[l+f+h*c],isNaN(g)||g===1/0)throw"Could not reverse! A=["+this.toString()+"]";a.e(c,f,g)}while(f--)}while(c--);return a},o.prototype.setRotationFromQuaternion=function(a){var l=a.x,h=a.y,u=a.z,c=a.w,f=l+l,d=h+h,p=u+u,m=l*f,y=l*d,g=l*p,v=h*d,x=h*p,w=u*p,b=c*f,M=c*d,A=c*p,E=this.elements;return E[3*0+0]=1-(v+w),E[3*0+1]=y-A,E[3*0+2]=g+M,E[3*1+0]=y+A,E[3*1+1]=1-(m+w),E[3*1+2]=x-b,E[3*2+0]=g-M,E[3*2+1]=x+b,E[3*2+2]=1-(m+v),this},o.prototype.transpose=function(a){a=a||new o;for(var l=a.elements,h=this.elements,u=0;u!==3;u++)for(var c=0;c!==3;c++)l[3*u+c]=h[3*c+u];return a}},{"./Vec3":30}],28:[function(t,n,i){n.exports=o;var s=t("./Vec3");function o(f,d,p,m){this.x=f!==void 0?f:0,this.y=d!==void 0?d:0,this.z=p!==void 0?p:0,this.w=m!==void 0?m:1}o.prototype.set=function(f,d,p,m){this.x=f,this.y=d,this.z=p,this.w=m},o.prototype.toString=function(){return this.x+","+this.y+","+this.z+","+this.w},o.prototype.toArray=function(){return[this.x,this.y,this.z,this.w]},o.prototype.setFromAxisAngle=function(f,d){var p=Math.sin(d*.5);this.x=f.x*p,this.y=f.y*p,this.z=f.z*p,this.w=Math.cos(d*.5)},o.prototype.toAxisAngle=function(f){f=f||new s,this.normalize();var d=2*Math.acos(this.w),p=Math.sqrt(1-this.w*this.w);return p<.001?(f.x=this.x,f.y=this.y,f.z=this.z):(f.x=this.x/p,f.y=this.y/p,f.z=this.z/p),[f,d]};var a=new s,l=new s;o.prototype.setFromVectors=function(f,d){if(f.isAntiparallelTo(d)){var p=a,m=l;f.tangents(p,m),this.setFromAxisAngle(p,Math.PI)}else{var y=f.cross(d);this.x=y.x,this.y=y.y,this.z=y.z,this.w=Math.sqrt(Math.pow(f.norm(),2)*Math.pow(d.norm(),2))+f.dot(d),this.normalize()}};var h=new s,u=new s,c=new s;o.prototype.mult=function(f,d){d=d||new o;var p=this.w,m=h,y=u,g=c;return m.set(this.x,this.y,this.z),y.set(f.x,f.y,f.z),d.w=p*f.w-m.dot(y),m.cross(y,g),d.x=p*y.x+f.w*m.x+g.x,d.y=p*y.y+f.w*m.y+g.y,d.z=p*y.z+f.w*m.z+g.z,d},o.prototype.inverse=function(f){var d=this.x,p=this.y,m=this.z,y=this.w;f=f||new o,this.conjugate(f);var g=1/(d*d+p*p+m*m+y*y);return f.x*=g,f.y*=g,f.z*=g,f.w*=g,f},o.prototype.conjugate=function(f){return f=f||new o,f.x=-this.x,f.y=-this.y,f.z=-this.z,f.w=this.w,f},o.prototype.normalize=function(){var f=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);f===0?(this.x=0,this.y=0,this.z=0,this.w=0):(f=1/f,this.x*=f,this.y*=f,this.z*=f,this.w*=f)},o.prototype.normalizeFast=function(){var f=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;f===0?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=f,this.y*=f,this.z*=f,this.w*=f)},o.prototype.vmult=function(f,d){d=d||new s;var p=f.x,m=f.y,y=f.z,g=this.x,v=this.y,x=this.z,w=this.w,b=w*p+v*y-x*m,M=w*m+x*p-g*y,A=w*y+g*m-v*p,E=-g*p-v*m-x*y;return d.x=b*w+E*-g+M*-x-A*-v,d.y=M*w+E*-v+A*-g-b*-x,d.z=A*w+E*-x+b*-v-M*-g,d},o.prototype.copy=function(f){return this.x=f.x,this.y=f.y,this.z=f.z,this.w=f.w,this},o.prototype.toEuler=function(f,d){d=d||"YZX";var p,m,y,g=this.x,v=this.y,x=this.z,w=this.w;switch(d){case"YZX":var b=g*v+x*w;if(b>.499&&(p=2*Math.atan2(g,w),m=Math.PI/2,y=0),b<-.499&&(p=-2*Math.atan2(g,w),m=-Math.PI/2,y=0),isNaN(p)){var M=g*g,A=v*v,E=x*x;p=Math.atan2(2*v*w-2*g*x,1-2*A-2*E),m=Math.asin(2*b),y=Math.atan2(2*g*w-2*v*x,1-2*M-2*E)}break;default:throw new Error("Euler order "+d+" not supported yet.")}f.y=p,f.z=m,f.x=y},o.prototype.setFromEuler=function(f,d,p,m){m=m||"XYZ";var y=Math.cos(f/2),g=Math.cos(d/2),v=Math.cos(p/2),x=Math.sin(f/2),w=Math.sin(d/2),b=Math.sin(p/2);return m==="XYZ"?(this.x=x*g*v+y*w*b,this.y=y*w*v-x*g*b,this.z=y*g*b+x*w*v,this.w=y*g*v-x*w*b):m==="YXZ"?(this.x=x*g*v+y*w*b,this.y=y*w*v-x*g*b,this.z=y*g*b-x*w*v,this.w=y*g*v+x*w*b):m==="ZXY"?(this.x=x*g*v-y*w*b,this.y=y*w*v+x*g*b,this.z=y*g*b+x*w*v,this.w=y*g*v-x*w*b):m==="ZYX"?(this.x=x*g*v-y*w*b,this.y=y*w*v+x*g*b,this.z=y*g*b-x*w*v,this.w=y*g*v+x*w*b):m==="YZX"?(this.x=x*g*v+y*w*b,this.y=y*w*v+x*g*b,this.z=y*g*b-x*w*v,this.w=y*g*v-x*w*b):m==="XZY"&&(this.x=x*g*v-y*w*b,this.y=y*w*v-x*g*b,this.z=y*g*b+x*w*v,this.w=y*g*v+x*w*b),this},o.prototype.clone=function(){return new o(this.x,this.y,this.z,this.w)}},{"./Vec3":30}],29:[function(t,n,i){var s=t("./Vec3"),o=t("./Quaternion");n.exports=a;function a(h){h=h||{},this.position=new s,h.position&&this.position.copy(h.position),this.quaternion=new o,h.quaternion&&this.quaternion.copy(h.quaternion)}var l=new o;a.pointToLocalFrame=function(h,u,c,f){var f=f||new s;return c.vsub(h,f),u.conjugate(l),l.vmult(f,f),f},a.prototype.pointToLocal=function(h,u){return a.pointToLocalFrame(this.position,this.quaternion,h,u)},a.pointToWorldFrame=function(h,u,c,f){var f=f||new s;return u.vmult(c,f),f.vadd(h,f),f},a.prototype.pointToWorld=function(h,u){return a.pointToWorldFrame(this.position,this.quaternion,h,u)},a.prototype.vectorToWorldFrame=function(h,u){var u=u||new s;return this.quaternion.vmult(h,u),u},a.vectorToWorldFrame=function(h,u,c){return h.vmult(u,c),c},a.vectorToLocalFrame=function(h,u,c,f){var f=f||new s;return u.w*=-1,u.vmult(c,f),u.w*=-1,f}},{"./Quaternion":28,"./Vec3":30}],30:[function(t,n,i){n.exports=o;var s=t("./Mat3");function o(u,c,f){this.x=u||0,this.y=c||0,this.z=f||0}o.ZERO=new o(0,0,0),o.UNIT_X=new o(1,0,0),o.UNIT_Y=new o(0,1,0),o.UNIT_Z=new o(0,0,1),o.prototype.cross=function(u,c){var f=u.x,d=u.y,p=u.z,m=this.x,y=this.y,g=this.z;return c=c||new o,c.x=y*p-g*d,c.y=g*f-m*p,c.z=m*d-y*f,c},o.prototype.set=function(u,c,f){return this.x=u,this.y=c,this.z=f,this},o.prototype.setZero=function(){this.x=this.y=this.z=0},o.prototype.vadd=function(u,c){if(c)c.x=u.x+this.x,c.y=u.y+this.y,c.z=u.z+this.z;else return new o(this.x+u.x,this.y+u.y,this.z+u.z)},o.prototype.vsub=function(u,c){if(c)c.x=this.x-u.x,c.y=this.y-u.y,c.z=this.z-u.z;else return new o(this.x-u.x,this.y-u.y,this.z-u.z)},o.prototype.crossmat=function(){return new s([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])},o.prototype.normalize=function(){var u=this.x,c=this.y,f=this.z,d=Math.sqrt(u*u+c*c+f*f);if(d>0){var p=1/d;this.x*=p,this.y*=p,this.z*=p}else this.x=0,this.y=0,this.z=0;return d},o.prototype.unit=function(u){u=u||new o;var c=this.x,f=this.y,d=this.z,p=Math.sqrt(c*c+f*f+d*d);return p>0?(p=1/p,u.x=c*p,u.y=f*p,u.z=d*p):(u.x=1,u.y=0,u.z=0),u},o.prototype.norm=function(){var u=this.x,c=this.y,f=this.z;return Math.sqrt(u*u+c*c+f*f)},o.prototype.length=o.prototype.norm,o.prototype.norm2=function(){return this.dot(this)},o.prototype.lengthSquared=o.prototype.norm2,o.prototype.distanceTo=function(u){var c=this.x,f=this.y,d=this.z,p=u.x,m=u.y,y=u.z;return Math.sqrt((p-c)*(p-c)+(m-f)*(m-f)+(y-d)*(y-d))},o.prototype.distanceSquared=function(u){var c=this.x,f=this.y,d=this.z,p=u.x,m=u.y,y=u.z;return(p-c)*(p-c)+(m-f)*(m-f)+(y-d)*(y-d)},o.prototype.mult=function(u,c){c=c||new o;var f=this.x,d=this.y,p=this.z;return c.x=u*f,c.y=u*d,c.z=u*p,c},o.prototype.scale=o.prototype.mult,o.prototype.dot=function(u){return this.x*u.x+this.y*u.y+this.z*u.z},o.prototype.isZero=function(){return this.x===0&&this.y===0&&this.z===0},o.prototype.negate=function(u){return u=u||new o,u.x=-this.x,u.y=-this.y,u.z=-this.z,u};var a=new o,l=new o;o.prototype.tangents=function(u,c){var f=this.norm();if(f>0){var d=a,p=1/f;d.set(this.x*p,this.y*p,this.z*p);var m=l;Math.abs(d.x)<.9?(m.set(1,0,0),d.cross(m,u)):(m.set(0,1,0),d.cross(m,u)),d.cross(u,c)}else u.set(1,0,0),c.set(0,1,0)},o.prototype.toString=function(){return this.x+","+this.y+","+this.z},o.prototype.toArray=function(){return[this.x,this.y,this.z]},o.prototype.copy=function(u){return this.x=u.x,this.y=u.y,this.z=u.z,this},o.prototype.lerp=function(u,c,f){var d=this.x,p=this.y,m=this.z;f.x=d+(u.x-d)*c,f.y=p+(u.y-p)*c,f.z=m+(u.z-m)*c},o.prototype.almostEquals=function(u,c){return c===void 0&&(c=1e-6),!(Math.abs(this.x-u.x)>c||Math.abs(this.y-u.y)>c||Math.abs(this.z-u.z)>c)},o.prototype.almostZero=function(u){return u===void 0&&(u=1e-6),!(Math.abs(this.x)>u||Math.abs(this.y)>u||Math.abs(this.z)>u)};var h=new o;o.prototype.isAntiparallelTo=function(u,c){return this.negate(h),h.almostEquals(u,c)},o.prototype.clone=function(){return new o(this.x,this.y,this.z)}},{"./Mat3":27}],31:[function(t,n,i){n.exports=c;var s=t("../utils/EventTarget");t("../shapes/Shape");var o=t("../math/Vec3"),a=t("../math/Mat3"),l=t("../math/Quaternion");t("../material/Material");var h=t("../collision/AABB"),u=t("../shapes/Box");function c(_){_=_||{},s.apply(this),this.id=c.idCounter++,this.world=null,this.preStep=null,this.postStep=null,this.vlambda=new o,this.collisionFilterGroup=typeof _.collisionFilterGroup=="number"?_.collisionFilterGroup:1,this.collisionFilterMask=typeof _.collisionFilterMask=="number"?_.collisionFilterMask:1,this.collisionResponse=!0,this.position=new o,_.position&&this.position.copy(_.position),this.previousPosition=new o,this.initPosition=new o,this.velocity=new o,_.velocity&&this.velocity.copy(_.velocity),this.initVelocity=new o,this.force=new o;var S=typeof _.mass=="number"?_.mass:0;this.mass=S,this.invMass=S>0?1/S:0,this.material=_.material||null,this.linearDamping=typeof _.linearDamping=="number"?_.linearDamping:.01,this.type=S<=0?c.STATIC:c.DYNAMIC,typeof _.type==typeof c.STATIC&&(this.type=_.type),this.allowSleep=typeof _.allowSleep!="undefined"?_.allowSleep:!0,this.sleepState=0,this.sleepSpeedLimit=typeof _.sleepSpeedLimit!="undefined"?_.sleepSpeedLimit:.1,this.sleepTimeLimit=typeof _.sleepTimeLimit!="undefined"?_.sleepTimeLimit:1,this.timeLastSleepy=0,this._wakeUpAfterNarrowphase=!1,this.torque=new o,this.quaternion=new l,_.quaternion&&this.quaternion.copy(_.quaternion),this.initQuaternion=new l,this.angularVelocity=new o,_.angularVelocity&&this.angularVelocity.copy(_.angularVelocity),this.initAngularVelocity=new o,this.interpolatedPosition=new o,this.interpolatedQuaternion=new l,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new o,this.invInertia=new o,this.invInertiaWorld=new a,this.invMassSolve=0,this.invInertiaSolve=new o,this.invInertiaWorldSolve=new a,this.fixedRotation=typeof _.fixedRotation!="undefined"?_.fixedRotation:!1,this.angularDamping=typeof _.angularDamping!="undefined"?_.angularDamping:.01,this.aabb=new h,this.aabbNeedsUpdate=!0,this.wlambda=new o,_.shape&&this.addShape(_.shape),this.updateMassProperties()}c.prototype=new s,c.prototype.constructor=c,c.DYNAMIC=1,c.STATIC=2,c.KINEMATIC=4,c.AWAKE=0,c.SLEEPY=1,c.SLEEPING=2,c.idCounter=0,c.prototype.wakeUp=function(){var _=this.sleepState;this.sleepState=0,_===c.SLEEPING&&this.dispatchEvent({type:"wakeup"})},c.prototype.sleep=function(){this.sleepState=c.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0)},c.sleepyEvent={type:"sleepy"},c.sleepEvent={type:"sleep"},c.prototype.sleepTick=function(_){if(this.allowSleep){var S=this.sleepState,L=this.velocity.norm2()+this.angularVelocity.norm2(),k=Math.pow(this.sleepSpeedLimit,2);S===c.AWAKE&&L<k?(this.sleepState=c.SLEEPY,this.timeLastSleepy=_,this.dispatchEvent(c.sleepyEvent)):S===c.SLEEPY&&L>k?this.wakeUp():S===c.SLEEPY&&_-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(c.sleepEvent))}},c.prototype.updateSolveMassProperties=function(){this.sleepState===c.SLEEPING||this.type===c.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))},c.prototype.pointToLocalFrame=function(_,S){var S=S||new o;return _.vsub(this.position,S),this.quaternion.conjugate().vmult(S,S),S},c.prototype.vectorToLocalFrame=function(_,S){var S=S||new o;return this.quaternion.conjugate().vmult(_,S),S},c.prototype.pointToWorldFrame=function(_,S){var S=S||new o;return this.quaternion.vmult(_,S),S.vadd(this.position,S),S},c.prototype.vectorToWorldFrame=function(_,S){var S=S||new o;return this.quaternion.vmult(_,S),S};var f=new o,d=new l;c.prototype.addShape=function(_,S,L){var k=new o,H=new l;return S&&k.copy(S),L&&H.copy(L),this.shapes.push(_),this.shapeOffsets.push(k),this.shapeOrientations.push(H),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,this},c.prototype.updateBoundingRadius=function(){for(var _=this.shapes,S=this.shapeOffsets,L=_.length,k=0,H=0;H!==L;H++){var O=_[H];O.updateBoundingSphereRadius();var T=S[H].norm(),V=O.boundingSphereRadius;T+V>k&&(k=T+V)}this.boundingRadius=k};var p=new h;c.prototype.computeAABB=function(){for(var _=this.shapes,S=this.shapeOffsets,L=this.shapeOrientations,k=_.length,H=f,O=d,T=this.quaternion,V=this.aabb,F=p,J=0;J!==k;J++){var Y=_[J];L[J].mult(T,O),O.vmult(S[J],H),H.vadd(this.position,H),Y.calculateWorldAABB(H,O,F.lowerBound,F.upperBound),J===0?V.copy(F):V.extend(F)}this.aabbNeedsUpdate=!1};var m=new a,y=new a;new a,c.prototype.updateInertiaWorld=function(_){var S=this.invInertia;if(!(S.x===S.y&&S.y===S.z&&!_)){var L=m,k=y;L.setRotationFromQuaternion(this.quaternion),L.transpose(k),L.scale(S,L),L.mmult(k,this.invInertiaWorld)}};var g=new o,v=new o;c.prototype.applyForce=function(_,S){if(this.type===c.DYNAMIC){var L=g;S.vsub(this.position,L);var k=v;L.cross(_,k),this.force.vadd(_,this.force),this.torque.vadd(k,this.torque)}};var x=new o,w=new o;c.prototype.applyLocalForce=function(_,S){if(this.type===c.DYNAMIC){var L=x,k=w;this.vectorToWorldFrame(_,L),this.pointToWorldFrame(S,k),this.applyForce(L,k)}};var b=new o,M=new o,A=new o;c.prototype.applyImpulse=function(_,S){if(this.type===c.DYNAMIC){var L=b;S.vsub(this.position,L);var k=M;k.copy(_),k.mult(this.invMass,k),this.velocity.vadd(k,this.velocity);var H=A;L.cross(_,H),this.invInertiaWorld.vmult(H,H),this.angularVelocity.vadd(H,this.angularVelocity)}};var E=new o,N=new o;c.prototype.applyLocalImpulse=function(_,S){if(this.type===c.DYNAMIC){var L=E,k=N;this.vectorToWorldFrame(_,L),this.pointToWorldFrame(S,k),this.applyImpulse(L,k)}};var R=new o;c.prototype.updateMassProperties=function(){var _=R;this.invMass=this.mass>0?1/this.mass:0;var S=this.inertia,L=this.fixedRotation;this.computeAABB(),_.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),u.calculateInertia(_,this.mass,S),this.invInertia.set(S.x>0&&!L?1/S.x:0,S.y>0&&!L?1/S.y:0,S.z>0&&!L?1/S.z:0),this.updateInertiaWorld(!0)},c.prototype.getVelocityAtWorldPoint=function(_,S){var L=new o;return _.vsub(this.position,L),this.angularVelocity.cross(L,S),this.velocity.vadd(S,S),S}},{"../collision/AABB":3,"../material/Material":25,"../math/Mat3":27,"../math/Quaternion":28,"../math/Vec3":30,"../shapes/Box":37,"../shapes/Shape":43,"../utils/EventTarget":49}],32:[function(t,n,i){t("./Body");var s=t("../math/Vec3"),o=t("../math/Quaternion");t("../collision/RaycastResult");var a=t("../collision/Ray"),l=t("../objects/WheelInfo");n.exports=h;function h(T){this.chassisBody=T.chassisBody,this.wheelInfos=[],this.sliding=!1,this.world=null,this.indexRightAxis=typeof T.indexRightAxis!="undefined"?T.indexRightAxis:1,this.indexForwardAxis=typeof T.indexForwardAxis!="undefined"?T.indexForwardAxis:0,this.indexUpAxis=typeof T.indexUpAxis!="undefined"?T.indexUpAxis:2}new s,new s,new s;var u=new s,c=new s,f=new s;new a,h.prototype.addWheel=function(T){T=T||{};var V=new l(T),F=this.wheelInfos.length;return this.wheelInfos.push(V),F},h.prototype.setSteeringValue=function(T,V){var F=this.wheelInfos[V];F.steering=T},new s,h.prototype.applyEngineForce=function(T,V){this.wheelInfos[V].engineForce=T},h.prototype.setBrake=function(T,V){this.wheelInfos[V].brake=T},h.prototype.addToWorld=function(T){this.constraints,T.add(this.chassisBody);var V=this;this.preStepCallback=function(){V.updateVehicle(T.dt)},T.addEventListener("preStep",this.preStepCallback),this.world=T},h.prototype.getVehicleAxisWorld=function(T,V){V.set(T===0?1:0,T===1?1:0,T===2?1:0),this.chassisBody.vectorToWorldFrame(V,V)},h.prototype.updateVehicle=function(T){for(var V=this.wheelInfos,F=V.length,J=this.chassisBody,Y=0;Y<F;Y++)this.updateWheelTransform(Y);this.currentVehicleSpeedKmHour=3.6*J.velocity.norm();var te=new s;this.getVehicleAxisWorld(this.indexForwardAxis,te),te.dot(J.velocity)<0&&(this.currentVehicleSpeedKmHour*=-1);for(var Y=0;Y<F;Y++)this.castRay(V[Y]);this.updateSuspension(T);for(var z=new s,K=new s,Y=0;Y<F;Y++){var Z=V[Y],Q=Z.suspensionForce;Q>Z.maxSuspensionForce&&(Q=Z.maxSuspensionForce),Z.raycastResult.hitNormalWorld.scale(Q*T,z),Z.raycastResult.hitPointWorld.vsub(J.position,K),J.applyImpulse(z,Z.raycastResult.hitPointWorld)}this.updateFriction(T);var me=new s,ge=new s,se=new s;for(Y=0;Y<F;Y++){var Z=V[Y];J.getVelocityAtWorldPoint(Z.chassisConnectionPointWorld,se);var he=1;switch(this.indexUpAxis){case 1:he=-1;break}if(Z.isInContact){this.getVehicleAxisWorld(this.indexForwardAxis,ge);var xe=ge.dot(Z.raycastResult.hitNormalWorld);Z.raycastResult.hitNormalWorld.scale(xe,me),ge.vsub(me,ge);var pe=ge.dot(se);Z.deltaRotation=he*pe*T/Z.radius}(Z.sliding||!Z.isInContact)&&Z.engineForce!==0&&Z.useCustomSlidingRotationalSpeed&&(Z.deltaRotation=(Z.engineForce>0?1:-1)*Z.customSlidingRotationalSpeed*T),Math.abs(Z.brake)>Math.abs(Z.engineForce)&&(Z.deltaRotation=0),Z.rotation+=Z.deltaRotation,Z.deltaRotation*=.99}},h.prototype.updateSuspension=function(T){for(var V=this.chassisBody,F=V.mass,J=this.wheelInfos,Y=J.length,te=0;te<Y;te++){var z=J[te];if(z.isInContact){var K,Z=z.suspensionRestLength,Q=z.suspensionLength,me=Z-Q;K=z.suspensionStiffness*me*z.clippedInvContactDotSuspension;var ge=z.suspensionRelativeVelocity,se;ge<0?se=z.dampingCompression:se=z.dampingRelaxation,K-=se*ge,z.suspensionForce=K*F,z.suspensionForce<0&&(z.suspensionForce=0)}else z.suspensionForce=0}},h.prototype.removeFromWorld=function(T){this.constraints,T.remove(this.chassisBody),T.removeEventListener("preStep",this.preStepCallback),this.world=null};var d=new s,p=new s;h.prototype.castRay=function(T){var V=d,F=p;this.updateWheelTransformWorld(T);var J=this.chassisBody,Y=-1,te=T.suspensionRestLength+T.radius;T.directionWorld.scale(te,V);var z=T.chassisConnectionPointWorld;z.vadd(V,F);var K=T.raycastResult;K.reset();var Z=J.collisionResponse;J.collisionResponse=!1,this.world.rayTest(z,F,K),J.collisionResponse=Z;var Q=K.body;if(T.raycastResult.groundObject=0,Q){Y=K.distance,T.raycastResult.hitNormalWorld=K.hitNormalWorld,T.isInContact=!0;var me=K.distance;T.suspensionLength=me-T.radius;var ge=T.suspensionRestLength-T.maxSuspensionTravel,se=T.suspensionRestLength+T.maxSuspensionTravel;T.suspensionLength<ge&&(T.suspensionLength=ge),T.suspensionLength>se&&(T.suspensionLength=se,T.raycastResult.reset());var he=T.raycastResult.hitNormalWorld.dot(T.directionWorld),xe=new s;J.getVelocityAtWorldPoint(T.raycastResult.hitPointWorld,xe);var pe=T.raycastResult.hitNormalWorld.dot(xe);if(he>=-.1)T.suspensionRelativeVelocity=0,T.clippedInvContactDotSuspension=1/.1;else{var G=-1/he;T.suspensionRelativeVelocity=pe*G,T.clippedInvContactDotSuspension=G}}else T.suspensionLength=T.suspensionRestLength+0*T.maxSuspensionTravel,T.suspensionRelativeVelocity=0,T.directionWorld.scale(-1,T.raycastResult.hitNormalWorld),T.clippedInvContactDotSuspension=1;return Y},h.prototype.updateWheelTransformWorld=function(T){T.isInContact=!1;var V=this.chassisBody;V.pointToWorldFrame(T.chassisConnectionPointLocal,T.chassisConnectionPointWorld),V.vectorToWorldFrame(T.directionLocal,T.directionWorld),V.vectorToWorldFrame(T.axleLocal,T.axleWorld)},h.prototype.updateWheelTransform=function(T){var V=u,F=c,J=f,Y=this.wheelInfos[T];this.updateWheelTransformWorld(Y),Y.directionLocal.scale(-1,V),F.copy(Y.axleLocal),V.cross(F,J),J.normalize(),F.normalize();var te=Y.steering,z=new o;z.setFromAxisAngle(V,te);var K=new o;K.setFromAxisAngle(F,Y.rotation);var Z=Y.worldTransform.quaternion;this.chassisBody.quaternion.mult(z,Z),Z.mult(K,Z),Z.normalize();var Q=Y.worldTransform.position;Q.copy(Y.directionWorld),Q.scale(Y.suspensionLength,Q),Q.vadd(Y.chassisConnectionPointWorld,Q)};var m=[new s(1,0,0),new s(0,1,0),new s(0,0,1)];h.prototype.getWheelTransformWorld=function(T){return this.wheelInfos[T].worldTransform};var y=new s,g=[],v=[],x=1;h.prototype.updateFriction=function(T){for(var V=y,F=this.wheelInfos,J=F.length,Y=this.chassisBody,te=v,z=g,K=0;K<J;K++){var Z=F[K],Q=Z.raycastResult.body;Z.sideImpulse=0,Z.forwardImpulse=0,te[K]||(te[K]=new s),z[K]||(z[K]=new s)}for(var K=0;K<J;K++){var Z=F[K],Q=Z.raycastResult.body;if(Q){var me=z[K],ge=this.getWheelTransformWorld(K);ge.vectorToWorldFrame(m[this.indexRightAxis],me);var se=Z.raycastResult.hitNormalWorld,he=me.dot(se);se.scale(he,V),me.vsub(V,me),me.normalize(),se.cross(me,te[K]),te[K].normalize(),Z.sideImpulse=O(Y,Z.raycastResult.hitPointWorld,Q,Z.raycastResult.hitPointWorld,me),Z.sideImpulse*=x}}var xe=1,pe=.5;this.sliding=!1;for(var K=0;K<J;K++){var Z=F[K],Q=Z.raycastResult.body,G=0;if(Z.slipInfo=1,Q){var q=0,B=Z.brake?Z.brake:q;G=A(Y,Q,Z.raycastResult.hitPointWorld,te[K],B),G+=Z.engineForce*T;var D=B/G;Z.slipInfo*=D}if(Z.forwardImpulse=0,Z.skidInfo=1,Q){Z.skidInfo=1;var $=Z.suspensionForce*T*Z.frictionSlip,ne=$,U=$*ne;Z.forwardImpulse=G;var W=Z.forwardImpulse*pe,P=Z.sideImpulse*xe,C=W*W+P*P;if(Z.sliding=!1,C>U){this.sliding=!0,Z.sliding=!0;var D=$/Math.sqrt(C);Z.skidInfo*=D}}}if(this.sliding)for(var K=0;K<J;K++){var Z=F[K];Z.sideImpulse!==0&&Z.skidInfo<1&&(Z.forwardImpulse*=Z.skidInfo,Z.sideImpulse*=Z.skidInfo)}for(var K=0;K<J;K++){var Z=F[K],ee=new s;if(ee.copy(Z.raycastResult.hitPointWorld),Z.forwardImpulse!==0){var ae=new s;te[K].scale(Z.forwardImpulse,ae),Y.applyImpulse(ae,ee)}if(Z.sideImpulse!==0){var Q=Z.raycastResult.body,le=new s;le.copy(Z.raycastResult.hitPointWorld);var ce=new s;z[K].scale(Z.sideImpulse,ce),Y.pointToLocalFrame(ee,ee),ee["xyz"[this.indexUpAxis]]*=Z.rollInfluence,Y.pointToWorldFrame(ee,ee),Y.applyImpulse(ce,ee),ce.scale(-1,ce),Q.applyImpulse(ce,le)}}};var w=new s,b=new s,M=new s;function A(T,V,F,J,Y){var te=0,z=F,K=w,Z=b,Q=M;T.getVelocityAtWorldPoint(z,K),V.getVelocityAtWorldPoint(z,Z),K.vsub(Z,Q);var me=J.dot(Q),ge=S(T,F,J),se=S(V,F,J),he=1,xe=he/(ge+se);return te=-me*xe,Y<te&&(te=Y),te<-Y&&(te=-Y),te}var E=new s,N=new s,R=new s,_=new s;function S(T,V,F){var J=E,Y=N,te=R,z=_;return V.vsub(T.position,J),J.cross(F,Y),T.invInertiaWorld.vmult(Y,z),z.cross(J,te),T.invMass+F.dot(te)}var L=new s,k=new s,H=new s;function O(T,V,F,J,Y,te){var z=Y.norm2();if(z>1.1)return 0;var K=L,Z=k,Q=H;T.getVelocityAtWorldPoint(V,K),F.getVelocityAtWorldPoint(J,Z),K.vsub(Z,Q);var me=Y.dot(Q),ge=.2,se=1/(T.invMass+F.invMass),te=-ge*me*se;return te}},{"../collision/Ray":9,"../collision/RaycastResult":10,"../math/Quaternion":28,"../math/Vec3":30,"../objects/WheelInfo":36,"./Body":31}],33:[function(t,n,i){var s=t("./Body"),o=t("../shapes/Sphere"),a=t("../shapes/Box"),l=t("../math/Vec3"),h=t("../constraints/HingeConstraint");n.exports=u;function u(d){if(this.wheelBodies=[],this.coordinateSystem=typeof d.coordinateSystem=="undefined"?new l(1,2,3):d.coordinateSystem.clone(),this.chassisBody=d.chassisBody,!this.chassisBody){var p=new a(new l(5,2,.5));this.chassisBody=new s(1,p)}this.constraints=[],this.wheelAxes=[],this.wheelForces=[]}u.prototype.addWheel=function(d){d=d||{};var p=d.body;p||(p=new s(1,new o(1.2))),this.wheelBodies.push(p),this.wheelForces.push(0),new l;var m=typeof d.position!="undefined"?d.position.clone():new l,y=new l;this.chassisBody.pointToWorldFrame(m,y),p.position.set(y.x,y.y,y.z);var g=typeof d.axis!="undefined"?d.axis.clone():new l(0,1,0);this.wheelAxes.push(g);var v=new h(this.chassisBody,p,{pivotA:m,axisA:g,pivotB:l.ZERO,axisB:g,collideConnected:!1});return this.constraints.push(v),this.wheelBodies.length-1},u.prototype.setSteeringValue=function(d,p){var m=this.wheelAxes[p],y=Math.cos(d),g=Math.sin(d),v=m.x,x=m.y;this.constraints[p].axisA.set(y*v-g*x,g*v+y*x,0)},u.prototype.setMotorSpeed=function(d,p){var m=this.constraints[p];m.enableMotor(),m.motorTargetVelocity=d},u.prototype.disableMotor=function(d){var p=this.constraints[d];p.disableMotor()};var c=new l;u.prototype.setWheelForce=function(d,p){this.wheelForces[p]=d},u.prototype.applyWheelForce=function(d,p){var m=this.wheelAxes[p],y=this.wheelBodies[p],g=y.torque;m.scale(d,c),y.vectorToWorldFrame(c,c),g.vadd(c,g)},u.prototype.addToWorld=function(d){for(var p=this.constraints,m=this.wheelBodies.concat([this.chassisBody]),y=0;y<m.length;y++)d.add(m[y]);for(var y=0;y<p.length;y++)d.addConstraint(p[y]);d.addEventListener("preStep",this._update.bind(this))},u.prototype._update=function(){for(var d=this.wheelForces,p=0;p<d.length;p++)this.applyWheelForce(d[p],p)},u.prototype.removeFromWorld=function(d){for(var p=this.constraints,m=this.wheelBodies.concat([this.chassisBody]),y=0;y<m.length;y++)d.remove(m[y]);for(var y=0;y<p.length;y++)d.removeConstraint(p[y])};var f=new l;u.prototype.getWheelSpeed=function(d){var p=this.wheelAxes[d],m=this.wheelBodies[d],y=m.angularVelocity;return this.chassisBody.vectorToWorldFrame(p,f),y.dot(f)}},{"../constraints/HingeConstraint":15,"../math/Vec3":30,"../shapes/Box":37,"../shapes/Sphere":44,"./Body":31}],34:[function(t,n,i){n.exports=o,t("../shapes/Shape");var s=t("../math/Vec3");t("../math/Quaternion"),t("../shapes/Particle"),t("../objects/Body"),t("../material/Material");function o(){this.particles=[],this.density=1,this.smoothingRadius=1,this.speedOfSound=1,this.viscosity=.01,this.eps=1e-6,this.pressures=[],this.densities=[],this.neighbors=[]}o.prototype.add=function(p){this.particles.push(p),this.neighbors.length<this.particles.length&&this.neighbors.push([])},o.prototype.remove=function(p){var m=this.particles.indexOf(p);m!==-1&&(this.particles.splice(m,1),this.neighbors.length>this.particles.length&&this.neighbors.pop())};var a=new s;o.prototype.getNeighbors=function(p,m){for(var y=this.particles.length,g=p.id,v=this.smoothingRadius*this.smoothingRadius,x=a,w=0;w!==y;w++){var b=this.particles[w];b.position.vsub(p.position,x),g!==b.id&&x.norm2()<v&&m.push(b)}};var l=new s,h=new s,u=new s,c=new s,f=new s,d=new s;o.prototype.update=function(){for(var p=this.particles.length,m=l,y=this.speedOfSound,g=this.eps,v=0;v!==p;v++){var x=this.particles[v],w=this.neighbors[v];w.length=0,this.getNeighbors(x,w),w.push(this.particles[v]);for(var b=w.length,M=0,A=0;A!==b;A++){x.position.vsub(w[A].position,m);var E=m.norm(),N=this.w(E);M+=w[A].mass*N}this.densities[v]=M,this.pressures[v]=y*y*(this.densities[v]-this.density)}for(var R=h,_=u,S=c,L=f,k=d,v=0;v!==p;v++){var H=this.particles[v];R.set(0,0,0),_.set(0,0,0);for(var O,T,w=this.neighbors[v],b=w.length,A=0;A!==b;A++){var V=w[A];H.position.vsub(V.position,L);var F=L.norm();O=-V.mass*(this.pressures[v]/(this.densities[v]*this.densities[v]+g)+this.pressures[A]/(this.densities[A]*this.densities[A]+g)),this.gradw(L,S),S.mult(O,S),R.vadd(S,R),V.velocity.vsub(H.velocity,k),k.mult(1/(1e-4+this.densities[v]*this.densities[A])*this.viscosity*V.mass,k),T=this.nablaw(F),k.mult(T,k),_.vadd(k,_)}_.mult(H.mass,_),R.mult(H.mass,R),H.force.vadd(_,H.force),H.force.vadd(R,H.force)}},o.prototype.w=function(p){var m=this.smoothingRadius;return 315/(64*Math.PI*Math.pow(m,9))*Math.pow(m*m-p*p,3)},o.prototype.gradw=function(p,m){var y=p.norm(),g=this.smoothingRadius;p.mult(945/(32*Math.PI*Math.pow(g,9))*Math.pow(g*g-y*y,2),m)},o.prototype.nablaw=function(p){var m=this.smoothingRadius,y=945/(32*Math.PI*Math.pow(m,9))*(m*m-p*p)*(7*p*p-3*m*m);return y}},{"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Particle":41,"../shapes/Shape":43}],35:[function(t,n,i){var s=t("../math/Vec3");n.exports=o;function o(v,x,w){w=w||{},this.restLength=typeof w.restLength=="number"?w.restLength:1,this.stiffness=w.stiffness||100,this.damping=w.damping||1,this.bodyA=v,this.bodyB=x,this.localAnchorA=new s,this.localAnchorB=new s,w.localAnchorA&&this.localAnchorA.copy(w.localAnchorA),w.localAnchorB&&this.localAnchorB.copy(w.localAnchorB),w.worldAnchorA&&this.setWorldAnchorA(w.worldAnchorA),w.worldAnchorB&&this.setWorldAnchorB(w.worldAnchorB)}o.prototype.setWorldAnchorA=function(v){this.bodyA.pointToLocalFrame(v,this.localAnchorA)},o.prototype.setWorldAnchorB=function(v){this.bodyB.pointToLocalFrame(v,this.localAnchorB)},o.prototype.getWorldAnchorA=function(v){this.bodyA.pointToWorldFrame(this.localAnchorA,v)},o.prototype.getWorldAnchorB=function(v){this.bodyB.pointToWorldFrame(this.localAnchorB,v)};var a=new s,l=new s,h=new s,u=new s,c=new s,f=new s,d=new s,p=new s,m=new s,y=new s,g=new s;o.prototype.applyForce=function(){var v=this.stiffness,x=this.damping,w=this.restLength,b=this.bodyA,M=this.bodyB,A=a,E=l,N=h,R=u,_=g,S=c,L=f,k=d,H=p,O=m,T=y;this.getWorldAnchorA(S),this.getWorldAnchorB(L),S.vsub(b.position,k),L.vsub(M.position,H),L.vsub(S,A);var V=A.norm();E.copy(A),E.normalize(),M.velocity.vsub(b.velocity,N),M.angularVelocity.cross(H,_),N.vadd(_,N),b.angularVelocity.cross(k,_),N.vsub(_,N),E.mult(-v*(V-w)-x*N.dot(E),R),b.force.vsub(R,b.force),M.force.vadd(R,M.force),k.cross(R,O),H.cross(R,T),b.torque.vsub(O,b.torque),M.torque.vadd(T,M.torque)}},{"../math/Vec3":30}],36:[function(t,n,i){var s=t("../math/Vec3"),o=t("../math/Transform"),a=t("../collision/RaycastResult"),l=t("../utils/Utils");n.exports=h;function h(f){f=l.defaults(f,{chassisConnectionPointLocal:new s,chassisConnectionPointWorld:new s,directionLocal:new s,directionWorld:new s,axleLocal:new s,axleWorld:new s,suspensionRestLength:1,suspensionMaxLength:2,radius:1,suspensionStiffness:100,dampingCompression:10,dampingRelaxation:10,frictionSlip:1e4,steering:0,rotation:0,deltaRotation:0,rollInfluence:.01,maxSuspensionForce:Number.MAX_VALUE,isFrontWheel:!0,clippedInvContactDotSuspension:1,suspensionRelativeVelocity:0,suspensionForce:0,skidInfo:0,suspensionLength:0,maxSuspensionTravel:1,useCustomSlidingRotationalSpeed:!1,customSlidingRotationalSpeed:-.1}),this.maxSuspensionTravel=f.maxSuspensionTravel,this.customSlidingRotationalSpeed=f.customSlidingRotationalSpeed,this.useCustomSlidingRotationalSpeed=f.useCustomSlidingRotationalSpeed,this.sliding=!1,this.chassisConnectionPointLocal=f.chassisConnectionPointLocal.clone(),this.chassisConnectionPointWorld=f.chassisConnectionPointWorld.clone(),this.directionLocal=f.directionLocal.clone(),this.directionWorld=f.directionWorld.clone(),this.axleLocal=f.axleLocal.clone(),this.axleWorld=f.axleWorld.clone(),this.suspensionRestLength=f.suspensionRestLength,this.suspensionMaxLength=f.suspensionMaxLength,this.radius=f.radius,this.suspensionStiffness=f.suspensionStiffness,this.dampingCompression=f.dampingCompression,this.dampingRelaxation=f.dampingRelaxation,this.frictionSlip=f.frictionSlip,this.steering=0,this.rotation=0,this.deltaRotation=0,this.rollInfluence=f.rollInfluence,this.maxSuspensionForce=f.maxSuspensionForce,this.engineForce=0,this.brake=0,this.isFrontWheel=f.isFrontWheel,this.clippedInvContactDotSuspension=1,this.suspensionRelativeVelocity=0,this.suspensionForce=0,this.skidInfo=0,this.suspensionLength=0,this.sideImpulse=0,this.forwardImpulse=0,this.raycastResult=new a,this.worldTransform=new o,this.isInContact=!1}var u=new s,c=new s,u=new s;h.prototype.updateWheel=function(f){var d=this.raycastResult;if(this.isInContact){var p=d.hitNormalWorld.dot(d.directionWorld);d.hitPointWorld.vsub(f.position,c),f.getVelocityAtWorldPoint(c,u);var m=d.hitNormalWorld.dot(u);if(p>=-.1)this.suspensionRelativeVelocity=0,this.clippedInvContactDotSuspension=1/.1;else{var y=-1/p;this.suspensionRelativeVelocity=m*y,this.clippedInvContactDotSuspension=y}}else d.suspensionLength=this.suspensionRestLength,this.suspensionRelativeVelocity=0,d.directionWorld.scale(-1,d.hitNormalWorld),this.clippedInvContactDotSuspension=1}},{"../collision/RaycastResult":10,"../math/Transform":29,"../math/Vec3":30,"../utils/Utils":53}],37:[function(t,n,i){n.exports=l;var s=t("./Shape"),o=t("../math/Vec3"),a=t("./ConvexPolyhedron");function l(c){s.call(this),this.type=s.types.BOX,this.halfExtents=c,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}l.prototype=new s,l.prototype.constructor=l,l.prototype.updateConvexPolyhedronRepresentation=function(){var c=this.halfExtents.x,f=this.halfExtents.y,d=this.halfExtents.z,p=o,m=[new p(-c,-f,-d),new p(c,-f,-d),new p(c,f,-d),new p(-c,f,-d),new p(-c,-f,d),new p(c,-f,d),new p(c,f,d),new p(-c,f,d)],y=[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]];new p(0,0,1),new p(0,1,0),new p(1,0,0);var g=new a(m,y);this.convexPolyhedronRepresentation=g,g.material=this.material},l.prototype.calculateLocalInertia=function(c,f){return f=f||new o,l.calculateInertia(this.halfExtents,c,f),f},l.calculateInertia=function(c,f,d){var p=c;d.x=1/12*f*(2*p.y*2*p.y+2*p.z*2*p.z),d.y=1/12*f*(2*p.x*2*p.x+2*p.z*2*p.z),d.z=1/12*f*(2*p.y*2*p.y+2*p.x*2*p.x)},l.prototype.getSideNormals=function(c,f){var d=c,p=this.halfExtents;if(d[0].set(p.x,0,0),d[1].set(0,p.y,0),d[2].set(0,0,p.z),d[3].set(-p.x,0,0),d[4].set(0,-p.y,0),d[5].set(0,0,-p.z),f!==void 0)for(var m=0;m!==d.length;m++)f.vmult(d[m],d[m]);return d},l.prototype.volume=function(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z},l.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=this.halfExtents.norm()};var h=new o;new o,l.prototype.forEachWorldCorner=function(c,f,d){for(var p=this.halfExtents,m=[[p.x,p.y,p.z],[-p.x,p.y,p.z],[-p.x,-p.y,p.z],[-p.x,-p.y,-p.z],[p.x,-p.y,-p.z],[p.x,p.y,-p.z],[-p.x,p.y,-p.z],[p.x,-p.y,p.z]],y=0;y<m.length;y++)h.set(m[y][0],m[y][1],m[y][2]),f.vmult(h,h),c.vadd(h,h),d(h.x,h.y,h.z)};var u=[new o,new o,new o,new o,new o,new o,new o,new o];l.prototype.calculateWorldAABB=function(c,f,d,p){var m=this.halfExtents;u[0].set(m.x,m.y,m.z),u[1].set(-m.x,m.y,m.z),u[2].set(-m.x,-m.y,m.z),u[3].set(-m.x,-m.y,-m.z),u[4].set(m.x,-m.y,-m.z),u[5].set(m.x,m.y,-m.z),u[6].set(-m.x,m.y,-m.z),u[7].set(m.x,-m.y,m.z);var y=u[0];f.vmult(y,y),c.vadd(y,y),p.copy(y),d.copy(y);for(var g=1;g<8;g++){var y=u[g];f.vmult(y,y),c.vadd(y,y);var v=y.x,x=y.y,w=y.z;v>p.x&&(p.x=v),x>p.y&&(p.y=x),w>p.z&&(p.z=w),v<d.x&&(d.x=v),x<d.y&&(d.y=x),w<d.z&&(d.z=w)}}},{"../math/Vec3":30,"./ConvexPolyhedron":38,"./Shape":43}],38:[function(t,n,i){n.exports=l;var s=t("./Shape"),o=t("../math/Vec3");t("../math/Quaternion");var a=t("../math/Transform");function l(Y,te,z){s.call(this),this.type=s.types.CONVEXPOLYHEDRON,this.vertices=Y||[],this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.faces=te||[],this.faceNormals=[],this.computeNormals(),this.worldFaceNormalsNeedsUpdate=!0,this.worldFaceNormals=[],this.uniqueEdges=[],this.uniqueAxes=z?z.slice():null,this.computeEdges(),this.updateBoundingSphereRadius()}l.prototype=new s,l.prototype.constructor=l;var h=new o;l.prototype.computeEdges=function(){var Y=this.faces,te=this.vertices;te.length;var z=this.uniqueEdges;z.length=0;for(var K=h,Z=0;Z!==Y.length;Z++)for(var Q=Y[Z],me=Q.length,ge=0;ge!==me;ge++){var se=(ge+1)%me;te[Q[ge]].vsub(te[Q[se]],K),K.normalize();for(var he=!1,xe=0;xe!==z.length;xe++)if(z[xe].almostEquals(K)||z[xe].almostEquals(K)){he=!0;break}he||z.push(K.clone())}},l.prototype.computeNormals=function(){this.faceNormals.length=this.faces.length;for(var Y=0;Y<this.faces.length;Y++){for(var te=0;te<this.faces[Y].length;te++)if(!this.vertices[this.faces[Y][te]])throw new Error("Vertex "+this.faces[Y][te]+" not found!");var z=this.faceNormals[Y]||new o;this.getFaceNormal(Y,z),z.negate(z),this.faceNormals[Y]=z;var K=this.vertices[this.faces[Y][0]];if(z.dot(K)<0){console.error(".faceNormals["+Y+"] = Vec3("+z.toString()+") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.");for(var te=0;te<this.faces[Y].length;te++)console.warn(".vertices["+this.faces[Y][te]+"] = Vec3("+this.vertices[this.faces[Y][te]].toString()+")")}}};var u=new o,c=new o;l.computeNormal=function(Y,te,z,K){te.vsub(Y,c),z.vsub(te,u),u.cross(c,K),K.isZero()||K.normalize()},l.prototype.getFaceNormal=function(Y,te){var z=this.faces[Y],K=this.vertices[z[0]],Z=this.vertices[z[1]],Q=this.vertices[z[2]];return l.computeNormal(K,Z,Q,te)};var f=new o;l.prototype.clipAgainstHull=function(Y,te,z,K,Z,Q,me,ge,se){for(var he=f,xe=-1,pe=-Number.MAX_VALUE,G=0;G<z.faces.length;G++){he.copy(z.faceNormals[G]),Z.vmult(he,he);var q=he.dot(Q);q>pe&&(pe=q,xe=G)}for(var B=[],D=z.faces[xe],$=D.length,ne=0;ne<$;ne++){var U=z.vertices[D[ne]],W=new o;W.copy(U),Z.vmult(W,W),K.vadd(W,W),B.push(W)}xe>=0&&this.clipFaceAgainstHull(Q,Y,te,B,me,ge,se)};var d=new o,p=new o,m=new o,y=new o,g=new o,v=new o;l.prototype.findSeparatingAxis=function(Y,te,z,K,Z,Q,me,ge){var se=d,he=p,xe=m,pe=y,G=g,q=v,B=Number.MAX_VALUE,D=this;if(D.uniqueAxes)for(var ne=0;ne!==D.uniqueAxes.length;ne++){z.vmult(D.uniqueAxes[ne],se);var W=D.testSepAxis(se,Y,te,z,K,Z);if(W===!1)return!1;W<B&&(B=W,Q.copy(se))}else for(var $=me?me.length:D.faces.length,ne=0;ne<$;ne++){var U=me?me[ne]:ne;se.copy(D.faceNormals[U]),z.vmult(se,se);var W=D.testSepAxis(se,Y,te,z,K,Z);if(W===!1)return!1;W<B&&(B=W,Q.copy(se))}if(Y.uniqueAxes)for(var ne=0;ne!==Y.uniqueAxes.length;ne++){Z.vmult(Y.uniqueAxes[ne],he);var W=D.testSepAxis(he,Y,te,z,K,Z);if(W===!1)return!1;W<B&&(B=W,Q.copy(he))}else for(var P=ge?ge.length:Y.faces.length,ne=0;ne<P;ne++){var U=ge?ge[ne]:ne;he.copy(Y.faceNormals[U]),Z.vmult(he,he);var W=D.testSepAxis(he,Y,te,z,K,Z);if(W===!1)return!1;W<B&&(B=W,Q.copy(he))}for(var C=0;C!==D.uniqueEdges.length;C++){z.vmult(D.uniqueEdges[C],pe);for(var ee=0;ee!==Y.uniqueEdges.length;ee++)if(Z.vmult(Y.uniqueEdges[ee],G),pe.cross(G,q),!q.almostZero()){q.normalize();var ae=D.testSepAxis(q,Y,te,z,K,Z);if(ae===!1)return!1;ae<B&&(B=ae,Q.copy(q))}}return K.vsub(te,xe),xe.dot(Q)>0&&Q.negate(Q),!0};var x=[],w=[];l.prototype.testSepAxis=function(Y,te,z,K,Z,Q){var me=this;l.project(me,Y,z,K,x),l.project(te,Y,Z,Q,w);var ge=x[0],se=x[1],he=w[0],xe=w[1];if(ge<xe||he<se)return!1;var pe=ge-xe,G=he-se,q=pe<G?pe:G;return q};var b=new o,M=new o;l.prototype.calculateLocalInertia=function(Y,te){this.computeLocalAABB(b,M);var z=M.x-b.x,K=M.y-b.y,Z=M.z-b.z;te.x=1/12*Y*(2*K*2*K+2*Z*2*Z),te.y=1/12*Y*(2*z*2*z+2*Z*2*Z),te.z=1/12*Y*(2*K*2*K+2*z*2*z)},l.prototype.getPlaneConstantOfFace=function(Y){var te=this.faces[Y],z=this.faceNormals[Y],K=this.vertices[te[0]],Z=-z.dot(K);return Z};var A=new o,E=new o,N=new o,R=new o,_=new o,S=new o,L=new o,k=new o;l.prototype.clipFaceAgainstHull=function(Y,te,z,K,Z,Q,me){for(var ge=A,se=E,he=N,xe=R,pe=_,G=S,q=L,B=k,D=this,$=[],ne=K,U=$,W=-1,P=Number.MAX_VALUE,C=0;C<D.faces.length;C++){ge.copy(D.faceNormals[C]),z.vmult(ge,ge);var ee=ge.dot(Y);ee<P&&(P=ee,W=C)}if(!(W<0)){var ae=D.faces[W];ae.connectedFaces=[];for(var le=0;le<D.faces.length;le++)for(var ce=0;ce<D.faces[le].length;ce++)ae.indexOf(D.faces[le][ce])!==-1&&le!==W&&ae.connectedFaces.indexOf(le)===-1&&ae.connectedFaces.push(le);ne.length;for(var ye=ae.length,we=0;we<ye;we++){var be=D.vertices[ae[we]],oe=D.vertices[ae[(we+1)%ye]];be.vsub(oe,se),he.copy(se),z.vmult(he,he),te.vadd(he,he),xe.copy(this.faceNormals[W]),z.vmult(xe,xe),te.vadd(xe,xe),he.cross(xe,pe),pe.negate(pe),G.copy(be),z.vmult(G,G),te.vadd(G,G),-G.dot(pe);var Qe;{var Ie=ae.connectedFaces[we];q.copy(this.faceNormals[Ie]);var Pe=this.getPlaneConstantOfFace(Ie);B.copy(q),z.vmult(B,B);var Qe=Pe-B.dot(te)}for(this.clipFaceAgainstPlane(ne,U,B,Qe);ne.length;)ne.shift();for(;U.length;)ne.push(U.shift())}q.copy(this.faceNormals[W]);var Pe=this.getPlaneConstantOfFace(W);B.copy(q),z.vmult(B,B);for(var Qe=Pe-B.dot(te),le=0;le<ne.length;le++){var Ge=B.dot(ne[le])+Qe;if(Ge<=Z&&(console.log("clamped: depth="+Ge+" to minDist="+(Z+"")),Ge=Z),Ge<=Q){var We=ne[le];if(Ge<=0){var Fe={point:We,normal:B,depth:Ge};me.push(Fe)}}}}},l.prototype.clipFaceAgainstPlane=function(Y,te,z,K){var Z,Q,me=Y.length;if(me<2)return te;var ge=Y[Y.length-1],se=Y[0];Z=z.dot(ge)+K;for(var he=0;he<me;he++){if(se=Y[he],Q=z.dot(se)+K,Z<0)if(Q<0){var xe=new o;xe.copy(se),te.push(xe)}else{var xe=new o;ge.lerp(se,Z/(Z-Q),xe),te.push(xe)}else if(Q<0){var xe=new o;ge.lerp(se,Z/(Z-Q),xe),te.push(xe),te.push(se)}ge=se,Z=Q}return te},l.prototype.computeWorldVertices=function(Y,te){for(var z=this.vertices.length;this.worldVertices.length<z;)this.worldVertices.push(new o);for(var K=this.vertices,Z=this.worldVertices,Q=0;Q!==z;Q++)te.vmult(K[Q],Z[Q]),Y.vadd(Z[Q],Z[Q]);this.worldVerticesNeedsUpdate=!1},new o,l.prototype.computeLocalAABB=function(Y,te){var z=this.vertices.length,K=this.vertices;Y.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),te.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(var Z=0;Z<z;Z++){var Q=K[Z];Q.x<Y.x?Y.x=Q.x:Q.x>te.x&&(te.x=Q.x),Q.y<Y.y?Y.y=Q.y:Q.y>te.y&&(te.y=Q.y),Q.z<Y.z?Y.z=Q.z:Q.z>te.z&&(te.z=Q.z)}},l.prototype.computeWorldFaceNormals=function(Y){for(var te=this.faceNormals.length;this.worldFaceNormals.length<te;)this.worldFaceNormals.push(new o);for(var z=this.faceNormals,K=this.worldFaceNormals,Z=0;Z!==te;Z++)Y.vmult(z[Z],K[Z]);this.worldFaceNormalsNeedsUpdate=!1},l.prototype.updateBoundingSphereRadius=function(){for(var Y=0,te=this.vertices,z=0,K=te.length;z!==K;z++){var Z=te[z].norm2();Z>Y&&(Y=Z)}this.boundingSphereRadius=Math.sqrt(Y)};var H=new o;l.prototype.calculateWorldAABB=function(Y,te,z,K){for(var Z=this.vertices.length,Q=this.vertices,me,ge,se,he,xe,pe,G=0;G<Z;G++){H.copy(Q[G]),te.vmult(H,H),Y.vadd(H,H);var q=H;q.x<me||me===void 0?me=q.x:(q.x>he||he===void 0)&&(he=q.x),q.y<ge||ge===void 0?ge=q.y:(q.y>xe||xe===void 0)&&(xe=q.y),q.z<se||se===void 0?se=q.z:(q.z>pe||pe===void 0)&&(pe=q.z)}z.set(me,ge,se),K.set(he,xe,pe)},l.prototype.volume=function(){return 4*Math.PI*this.boundingSphereRadius/3},l.prototype.getAveragePointLocal=function(Y){Y=Y||new o;for(var te=this.vertices.length,z=this.vertices,K=0;K<te;K++)Y.vadd(z[K],Y);return Y.mult(1/te,Y),Y},l.prototype.transformAllPoints=function(Y,te){var z=this.vertices.length,K=this.vertices;if(te){for(var Z=0;Z<z;Z++){var Q=K[Z];te.vmult(Q,Q)}for(var Z=0;Z<this.faceNormals.length;Z++){var Q=this.faceNormals[Z];te.vmult(Q,Q)}}if(Y)for(var Z=0;Z<z;Z++){var Q=K[Z];Q.vadd(Y,Q)}};var O=new o,T=new o,V=new o;l.prototype.pointIsInside=function(Y){var te=this.vertices.length,z=this.vertices,K=this.faces,Z=this.faceNormals,Q=null,me=this.faces.length,ge=O;this.getAveragePointLocal(ge);for(var se=0;se<me;se++){this.faces[se].length;var te=Z[se],he=z[K[se][0]],xe=T;Y.vsub(he,xe);var pe=te.dot(xe),G=V;ge.vsub(he,G);var q=te.dot(G);if(pe<0&&q>0||pe>0&&q<0)return!1}return Q?1:-1},new o;var F=new o,J=new o;l.project=function(Y,te,z,K,Z){var Q=Y.vertices.length,me=F,ge=0,se=0,he=J,xe=Y.vertices;he.setZero(),a.vectorToLocalFrame(z,K,te,me),a.pointToLocalFrame(z,K,he,he);var pe=he.dot(me);se=ge=xe[0].dot(me);for(var G=1;G<Q;G++){var q=xe[G].dot(me);q>ge&&(ge=q),q<se&&(se=q)}if(se-=pe,ge-=pe,se>ge){var B=se;se=ge,ge=B}Z[0]=ge,Z[1]=se}},{"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"./Shape":43}],39:[function(t,n,i){n.exports=l;var s=t("./Shape"),o=t("../math/Vec3");t("../math/Quaternion");var a=t("./ConvexPolyhedron");function l(h,u,c,f){var d=f,p=[],m=[],y=[],g=[],v=[],x=Math.cos,w=Math.sin;p.push(new o(u*x(0),u*w(0),-c*.5)),g.push(0),p.push(new o(h*x(0),h*w(0),c*.5)),v.push(1);for(var b=0;b<d;b++){var M=2*Math.PI/d*(b+1),A=2*Math.PI/d*(b+.5);b<d-1?(p.push(new o(u*x(M),u*w(M),-c*.5)),g.push(2*b+2),p.push(new o(h*x(M),h*w(M),c*.5)),v.push(2*b+3),y.push([2*b+2,2*b+3,2*b+1,2*b])):y.push([0,1,2*b+1,2*b]),(d%2==1||b<d/2)&&m.push(new o(x(A),w(A),0))}y.push(v),m.push(new o(0,0,1));for(var E=[],b=0;b<g.length;b++)E.push(g[g.length-b-1]);y.push(E),this.type=s.types.CONVEXPOLYHEDRON,a.call(this,p,y,m)}l.prototype=new a},{"../math/Quaternion":28,"../math/Vec3":30,"./ConvexPolyhedron":38,"./Shape":43}],40:[function(t,n,i){var s=t("./Shape"),o=t("./ConvexPolyhedron"),a=t("../math/Vec3"),l=t("../utils/Utils");n.exports=h;function h(u,c){c=l.defaults(c,{maxValue:null,minValue:null,elementSize:1}),this.data=u,this.maxValue=c.maxValue,this.minValue=c.minValue,this.elementSize=c.elementSize,c.minValue===null&&this.updateMinValue(),c.maxValue===null&&this.updateMaxValue(),this.cacheEnabled=!0,s.call(this),this.pillarConvex=new o,this.pillarOffset=new a,this.type=s.types.HEIGHTFIELD,this.updateBoundingSphereRadius(),this._cachedPillars={}}h.prototype=new s,h.prototype.update=function(){this._cachedPillars={}},h.prototype.updateMinValue=function(){for(var u=this.data,c=u[0][0],f=0;f!==u.length;f++)for(var d=0;d!==u[f].length;d++){var p=u[f][d];p<c&&(c=p)}this.minValue=c},h.prototype.updateMaxValue=function(){for(var u=this.data,c=u[0][0],f=0;f!==u.length;f++)for(var d=0;d!==u[f].length;d++){var p=u[f][d];p>c&&(c=p)}this.maxValue=c},h.prototype.setHeightValueAtIndex=function(u,c,f){var d=this.data;d[u][c]=f,this.clearCachedConvexTrianglePillar(u,c,!1),u>0&&(this.clearCachedConvexTrianglePillar(u-1,c,!0),this.clearCachedConvexTrianglePillar(u-1,c,!1)),c>0&&(this.clearCachedConvexTrianglePillar(u,c-1,!0),this.clearCachedConvexTrianglePillar(u,c-1,!1)),c>0&&u>0&&this.clearCachedConvexTrianglePillar(u-1,c-1,!0)},h.prototype.getRectMinMax=function(u,c,f,d,p){p=p||[];for(var m=this.data,y=this.minValue,g=u;g<=f;g++)for(var v=c;v<=d;v++){var x=m[g][v];x>y&&(y=x)}p[0]=this.minValue,p[1]=y},h.prototype.getIndexOfPosition=function(u,c,f,d){var p=this.elementSize,m=this.data,y=Math.floor(u/p),g=Math.floor(c/p);return f[0]=y,f[1]=g,d&&(y<0&&(y=0),g<0&&(g=0),y>=m.length-1&&(y=m.length-1),g>=m[0].length-1&&(g=m[0].length-1)),!(y<0||g<0||y>=m.length-1||g>=m[0].length-1)},h.prototype.getHeightAt=function(u,c,f){var d=[];this.getIndexOfPosition(u,c,d,f);var p=[];return this.getRectMinMax(d[0],d[1]+1,d[0],d[1]+1,p),(p[0]+p[1])/2},h.prototype.getCacheConvexTrianglePillarKey=function(u,c,f){return u+"_"+c+"_"+(f?1:0)},h.prototype.getCachedConvexTrianglePillar=function(u,c,f){return this._cachedPillars[this.getCacheConvexTrianglePillarKey(u,c,f)]},h.prototype.setCachedConvexTrianglePillar=function(u,c,f,d,p){this._cachedPillars[this.getCacheConvexTrianglePillarKey(u,c,f)]={convex:d,offset:p}},h.prototype.clearCachedConvexTrianglePillar=function(u,c,f){delete this._cachedPillars[this.getCacheConvexTrianglePillarKey(u,c,f)]},h.prototype.getConvexTrianglePillar=function(u,c,f){var d=this.pillarConvex,p=this.pillarOffset;if(this.cacheEnabled){var m=this.getCachedConvexTrianglePillar(u,c,f);if(m){this.pillarConvex=m.convex,this.pillarOffset=m.offset;return}d=new o,p=new a,this.pillarConvex=d,this.pillarOffset=p}var m=this.data,y=this.elementSize,g=d.faces;d.vertices.length=6;for(var v=0;v<6;v++)d.vertices[v]||(d.vertices[v]=new a);g.length=5;for(var v=0;v<5;v++)g[v]||(g[v]=[]);var x=d.vertices,w=(Math.min(m[u][c],m[u+1][c],m[u][c+1],m[u+1][c+1])-this.minValue)/2+this.minValue;f?(p.set((u+.75)*y,(c+.75)*y,w),x[0].set(.25*y,.25*y,m[u+1][c+1]-w),x[1].set(-.75*y,.25*y,m[u][c+1]-w),x[2].set(.25*y,-.75*y,m[u+1][c]-w),x[3].set(.25*y,.25*y,-w-1),x[4].set(-.75*y,.25*y,-w-1),x[5].set(.25*y,-.75*y,-w-1),g[0][0]=0,g[0][1]=1,g[0][2]=2,g[1][0]=5,g[1][1]=4,g[1][2]=3,g[2][0]=2,g[2][1]=5,g[2][2]=3,g[2][3]=0,g[3][0]=3,g[3][1]=4,g[3][2]=1,g[3][3]=0,g[4][0]=1,g[4][1]=4,g[4][2]=5,g[4][3]=2):(p.set((u+.25)*y,(c+.25)*y,w),x[0].set(-.25*y,-.25*y,m[u][c]-w),x[1].set(.75*y,-.25*y,m[u+1][c]-w),x[2].set(-.25*y,.75*y,m[u][c+1]-w),x[3].set(-.25*y,-.25*y,-w-1),x[4].set(.75*y,-.25*y,-w-1),x[5].set(-.25*y,.75*y,-w-1),g[0][0]=0,g[0][1]=1,g[0][2]=2,g[1][0]=5,g[1][1]=4,g[1][2]=3,g[2][0]=0,g[2][1]=2,g[2][2]=5,g[2][3]=3,g[3][0]=1,g[3][1]=0,g[3][2]=3,g[3][3]=4,g[4][0]=4,g[4][1]=5,g[4][2]=2,g[4][3]=1),d.computeNormals(),d.computeEdges(),d.updateBoundingSphereRadius(),this.setCachedConvexTrianglePillar(u,c,f,d,p)},h.prototype.calculateLocalInertia=function(u,c){return c=c||new a,c.set(0,0,0),c},h.prototype.volume=function(){return Number.MAX_VALUE},h.prototype.calculateWorldAABB=function(u,c,f,d){f.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),d.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)},h.prototype.updateBoundingSphereRadius=function(){var u=this.data,c=this.elementSize;this.boundingSphereRadius=new a(u.length*c,u[0].length*c,Math.max(Math.abs(this.maxValue),Math.abs(this.minValue))).norm()}},{"../math/Vec3":30,"../utils/Utils":53,"./ConvexPolyhedron":38,"./Shape":43}],41:[function(t,n,i){n.exports=a;var s=t("./Shape"),o=t("../math/Vec3");function a(){s.call(this),this.type=s.types.PARTICLE}a.prototype=new s,a.prototype.constructor=a,a.prototype.calculateLocalInertia=function(l,h){return h=h||new o,h.set(0,0,0),h},a.prototype.volume=function(){return 0},a.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=0},a.prototype.calculateWorldAABB=function(l,h,u,c){u.copy(l),c.copy(l)}},{"../math/Vec3":30,"./Shape":43}],42:[function(t,n,i){n.exports=a;var s=t("./Shape"),o=t("../math/Vec3");function a(){s.call(this),this.type=s.types.PLANE,this.worldNormal=new o,this.worldNormalNeedsUpdate=!0,this.boundingSphereRadius=Number.MAX_VALUE}a.prototype=new s,a.prototype.constructor=a,a.prototype.computeWorldNormal=function(h){var u=this.worldNormal;u.set(0,0,1),h.vmult(u,u),this.worldNormalNeedsUpdate=!1},a.prototype.calculateLocalInertia=function(h,u){return u=u||new o,u},a.prototype.volume=function(){return Number.MAX_VALUE};var l=new o;a.prototype.calculateWorldAABB=function(h,u,c,f){l.set(0,0,1),u.vmult(l,l);var d=Number.MAX_VALUE;c.set(-d,-d,-d),f.set(d,d,d),l.x===1&&(f.x=h.x),l.y===1&&(f.y=h.y),l.z===1&&(f.z=h.z),l.x===-1&&(c.x=h.x),l.y===-1&&(c.y=h.y),l.z===-1&&(c.z=h.z)},a.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=Number.MAX_VALUE}},{"../math/Vec3":30,"./Shape":43}],43:[function(t,n,i){n.exports=s;var s=t("./Shape");t("../math/Vec3"),t("../math/Quaternion"),t("../material/Material");function s(){this.id=s.idCounter++,this.type=0,this.boundingSphereRadius=0,this.collisionResponse=!0,this.material=null}s.prototype.constructor=s,s.prototype.updateBoundingSphereRadius=function(){throw"computeBoundingSphereRadius() not implemented for shape type "+this.type},s.prototype.volume=function(){throw"volume() not implemented for shape type "+this.type},s.prototype.calculateLocalInertia=function(o,a){throw"calculateLocalInertia() not implemented for shape type "+this.type},s.idCounter=0,s.types={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256}},{"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"./Shape":43}],44:[function(t,n,i){n.exports=a;var s=t("./Shape"),o=t("../math/Vec3");function a(l){if(s.call(this),this.radius=l!==void 0?Number(l):1,this.type=s.types.SPHERE,this.radius<0)throw new Error("The sphere radius cannot be negative.");this.updateBoundingSphereRadius()}a.prototype=new s,a.prototype.constructor=a,a.prototype.calculateLocalInertia=function(l,h){h=h||new o;var u=2*l*this.radius*this.radius/5;return h.x=u,h.y=u,h.z=u,h},a.prototype.volume=function(){return 4*Math.PI*this.radius/3},a.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=this.radius},a.prototype.calculateWorldAABB=function(l,h,u,c){for(var f=this.radius,d=["x","y","z"],p=0;p<d.length;p++){var m=d[p];u[m]=l[m]-f,c[m]=l[m]+f}}},{"../math/Vec3":30,"./Shape":43}],45:[function(t,n,i){n.exports=u;var s=t("./Shape"),o=t("../math/Vec3");t("../math/Quaternion");var a=t("../math/Transform"),l=t("../collision/AABB"),h=t("../utils/Octree");function u(E,N){s.call(this),this.type=s.types.TRIMESH,this.vertices=new Float32Array(E),this.indices=new Int16Array(N),this.normals=new Float32Array(N.length),this.aabb=new l,this.edges=null,this.scale=new o(1,1,1),this.tree=new h,this.updateEdges(),this.updateNormals(),this.updateAABB(),this.updateBoundingSphereRadius(),this.updateTree()}u.prototype=new s,u.prototype.constructor=u;var c=new o;u.prototype.updateTree=function(){var E=this.tree;E.reset(),E.aabb.copy(this.aabb);var N=this.scale;E.aabb.lowerBound.x*=1/N.x,E.aabb.lowerBound.y*=1/N.y,E.aabb.lowerBound.z*=1/N.z,E.aabb.upperBound.x*=1/N.x,E.aabb.upperBound.y*=1/N.y,E.aabb.upperBound.z*=1/N.z;for(var R=new l,_=new o,S=new o,L=new o,k=[_,S,L],H=0;H<this.indices.length/3;H++){var O=H*3;this._getUnscaledVertex(this.indices[O],_),this._getUnscaledVertex(this.indices[O+1],S),this._getUnscaledVertex(this.indices[O+2],L),R.setFromPoints(k),E.insert(R,H)}E.removeEmptyNodes()};var f=new l;u.prototype.getTrianglesInAABB=function(E,N){f.copy(E);var R=this.scale,_=R.x,S=R.y,L=R.z,k=f.lowerBound,H=f.upperBound;return k.x/=_,k.y/=S,k.z/=L,H.x/=_,H.y/=S,H.z/=L,this.tree.aabbQuery(f,N)},u.prototype.setScale=function(E){var N=this.scale.x===this.scale.y===this.scale.z,R=E.x===E.y===E.z;N&&R||this.updateNormals(),this.scale.copy(E),this.updateAABB(),this.updateBoundingSphereRadius()},u.prototype.updateNormals=function(){for(var E=c,N=this.normals,R=0;R<this.indices.length/3;R++){var _=R*3,S=this.indices[_],L=this.indices[_+1],k=this.indices[_+2];this.getVertex(S,g),this.getVertex(L,v),this.getVertex(k,x),u.computeNormal(v,g,x,E),N[_]=E.x,N[_+1]=E.y,N[_+2]=E.z}},u.prototype.updateEdges=function(){for(var E={},N=function(O,T){var V=S<L?S+"_"+L:L+"_"+S;E[V]=!0},R=0;R<this.indices.length/3;R++){var _=R*3,S=this.indices[_],L=this.indices[_+1];this.indices[_+2],N(),N(),N()}var k=Object.keys(E);this.edges=new Int16Array(k.length*2);for(var R=0;R<k.length;R++){var H=k[R].split("_");this.edges[2*R]=parseInt(H[0],10),this.edges[2*R+1]=parseInt(H[1],10)}},u.prototype.getEdgeVertex=function(E,N,R){var _=this.edges[E*2+(N?1:0)];this.getVertex(_,R)};var d=new o,p=new o;u.prototype.getEdgeVector=function(E,N){var R=d,_=p;this.getEdgeVertex(E,0,R),this.getEdgeVertex(E,1,_),_.vsub(R,N)};var m=new o,y=new o;u.computeNormal=function(E,N,R,_){N.vsub(E,y),R.vsub(N,m),m.cross(y,_),_.isZero()||_.normalize()};var g=new o,v=new o,x=new o;u.prototype.getVertex=function(E,N){var R=this.scale;return this._getUnscaledVertex(E,N),N.x*=R.x,N.y*=R.y,N.z*=R.z,N},u.prototype._getUnscaledVertex=function(E,N){var R=E*3,_=this.vertices;return N.set(_[R],_[R+1],_[R+2])},u.prototype.getWorldVertex=function(E,N,R,_){return this.getVertex(E,_),a.pointToWorldFrame(N,R,_,_),_},u.prototype.getTriangleVertices=function(E,N,R,_){var S=E*3;this.getVertex(this.indices[S],N),this.getVertex(this.indices[S+1],R),this.getVertex(this.indices[S+2],_)},u.prototype.getNormal=function(E,N){var R=E*3;return N.set(this.normals[R],this.normals[R+1],this.normals[R+2])};var w=new l;u.prototype.calculateLocalInertia=function(E,N){this.computeLocalAABB(w);var R=w.upperBound.x-w.lowerBound.x,_=w.upperBound.y-w.lowerBound.y,S=w.upperBound.z-w.lowerBound.z;return N.set(1/12*E*(2*_*2*_+2*S*2*S),1/12*E*(2*R*2*R+2*S*2*S),1/12*E*(2*_*2*_+2*R*2*R))};var b=new o;u.prototype.computeLocalAABB=function(E){var N=E.lowerBound,R=E.upperBound,_=this.vertices.length;this.vertices;var S=b;this.getVertex(0,S),N.copy(S),R.copy(S);for(var L=0;L!==_;L++)this.getVertex(L,S),S.x<N.x?N.x=S.x:S.x>R.x&&(R.x=S.x),S.y<N.y?N.y=S.y:S.y>R.y&&(R.y=S.y),S.z<N.z?N.z=S.z:S.z>R.z&&(R.z=S.z)},u.prototype.updateAABB=function(){this.computeLocalAABB(this.aabb)},u.prototype.updateBoundingSphereRadius=function(){for(var E=0,N=this.vertices,R=new o,_=0,S=N.length/3;_!==S;_++){this.getVertex(_,R);var L=R.norm2();L>E&&(E=L)}this.boundingSphereRadius=Math.sqrt(E)},new o;var M=new a,A=new l;u.prototype.calculateWorldAABB=function(E,N,R,_){var S=M,L=A;S.position=E,S.quaternion=N,this.aabb.toWorldFrame(S,L),R.copy(L.lowerBound),_.copy(L.upperBound)},u.prototype.volume=function(){return 4*Math.PI*this.boundingSphereRadius/3},u.createTorus=function(E,N,R,_,S){E=E||1,N=N||.5,R=R||8,_=_||6,S=S||Math.PI*2;for(var L=[],k=[],H=0;H<=R;H++)for(var O=0;O<=_;O++){var T=O/_*S,V=H/R*Math.PI*2,F=(E+N*Math.cos(V))*Math.cos(T),J=(E+N*Math.cos(V))*Math.sin(T),Y=N*Math.sin(V);L.push(F,J,Y)}for(var H=1;H<=R;H++)for(var O=1;O<=_;O++){var te=(_+1)*H+O-1,z=(_+1)*(H-1)+O-1,K=(_+1)*(H-1)+O,Z=(_+1)*H+O;k.push(te,z,Z),k.push(z,K,Z)}return new u(L,k)}},{"../collision/AABB":3,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../utils/Octree":50,"./Shape":43}],46:[function(t,n,i){n.exports=o,t("../math/Vec3"),t("../math/Quaternion");var s=t("./Solver");function o(){s.call(this),this.iterations=10,this.tolerance=1e-7}o.prototype=new s;var a=[],l=[],h=[];o.prototype.solve=function(u,c){var f=0,d=this.iterations,p=this.tolerance*this.tolerance,m=this.equations,y=m.length,g=c.bodies,v=g.length,x=u,w,b,M,A,E,N;if(y!==0)for(var R=0;R!==v;R++)g[R].updateSolveMassProperties();var _=l,S=h,L=a;_.length=y,S.length=y,L.length=y;for(var R=0;R!==y;R++){var k=m[R];L[R]=0,S[R]=k.computeB(x),_[R]=1/k.computeC()}if(y!==0){for(var R=0;R!==v;R++){var H=g[R],O=H.vlambda,T=H.wlambda;O.set(0,0,0),T&&T.set(0,0,0)}for(f=0;f!==d;f++){A=0;for(var V=0;V!==y;V++){var k=m[V];w=S[V],b=_[V],N=L[V],E=k.computeGWlambda(),M=b*(w-E-k.eps*N),N+M<k.minForce?M=k.minForce-N:N+M>k.maxForce&&(M=k.maxForce-N),L[V]+=M,A+=M>0?M:-M,k.addToWlambda(M)}if(A*A<p)break}for(var R=0;R!==v;R++){var H=g[R],F=H.velocity,J=H.angularVelocity;F.vadd(H.vlambda,F),J&&J.vadd(H.wlambda,J)}}return f}},{"../math/Quaternion":28,"../math/Vec3":30,"./Solver":47}],47:[function(t,n,i){n.exports=s;function s(){this.equations=[]}s.prototype.solve=function(o,a){return 0},s.prototype.addEquation=function(o){o.enabled&&this.equations.push(o)},s.prototype.removeEquation=function(o){var a=this.equations,l=a.indexOf(o);l!==-1&&a.splice(l,1)},s.prototype.removeAllEquations=function(){this.equations.length=0}},{}],48:[function(t,n,i){n.exports=a,t("../math/Vec3"),t("../math/Quaternion");var s=t("./Solver"),o=t("../objects/Body");function a(g){for(s.call(this),this.iterations=10,this.tolerance=1e-7,this.subsolver=g,this.nodes=[],this.nodePool=[];this.nodePool.length<128;)this.nodePool.push(this.createNode())}a.prototype=new s;var l=[],h=[],u={bodies:[]},c=o.STATIC;function f(g){for(var v=g.length,x=0;x!==v;x++){var w=g[x];if(!w.visited&&!(w.body.type&c))return w}return!1}var d=[];function p(g,v,x,w){for(d.push(g),g.visited=!0,v(g,x,w);d.length;)for(var b=d.pop(),M;M=f(b.children);)M.visited=!0,v(M,x,w),d.push(M)}function m(g,v,x){v.push(g.body);for(var w=g.eqs.length,b=0;b!==w;b++){var M=g.eqs[b];x.indexOf(M)===-1&&x.push(M)}}a.prototype.createNode=function(){return{body:null,children:[],eqs:[],visited:!1}},a.prototype.solve=function(g,v){for(var x=l,w=this.nodePool,b=v.bodies,M=this.equations,A=M.length,E=b.length,N=this.subsolver;w.length<E;)w.push(this.createNode());x.length=E;for(var R=0;R<E;R++)x[R]=w[R];for(var R=0;R!==E;R++){var _=x[R];_.body=b[R],_.children.length=0,_.eqs.length=0,_.visited=!1}for(var S=0;S!==A;S++){var L=M[S],R=b.indexOf(L.bi),k=b.indexOf(L.bj),H=x[R],O=x[k];H.children.push(O),H.eqs.push(L),O.children.push(H),O.eqs.push(L)}var T,V=0,F=h;N.tolerance=this.tolerance,N.iterations=this.iterations;for(var J=u;T=f(x);){F.length=0,J.bodies.length=0,p(T,m,J.bodies,F);var Y=F.length;F=F.sort(y);for(var R=0;R!==Y;R++)N.addEquation(F[R]);N.solve(g,J),N.removeAllEquations(),V++}return V};function y(g,v){return v.id-g.id}},{"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"./Solver":47}],49:[function(t,n,i){var s=function(){};n.exports=s,s.prototype={constructor:s,addEventListener:function(o,a){this._listeners===void 0&&(this._listeners={});var l=this._listeners;return l[o]===void 0&&(l[o]=[]),l[o].indexOf(a)===-1&&l[o].push(a),this},hasEventListener:function(o,a){if(this._listeners===void 0)return!1;var l=this._listeners;return l[o]!==void 0&&l[o].indexOf(a)!==-1},removeEventListener:function(o,a){if(this._listeners===void 0)return this;var l=this._listeners;if(l[o]===void 0)return this;var h=l[o].indexOf(a);return h!==-1&&l[o].splice(h,1),this},dispatchEvent:function(o){if(this._listeners===void 0)return this;var a=this._listeners,l=a[o.type];if(l!==void 0){o.target=this;for(var h=0,u=l.length;h<u;h++)l[h].call(this,o)}return this}}},{}],50:[function(t,n,i){var s=t("../collision/AABB"),o=t("../math/Vec3");n.exports=l;function a(c){c=c||{},this.root=c.root||null,this.aabb=c.aabb?c.aabb.clone():new s,this.data=[],this.children=[]}function l(c,f){f=f||{},f.root=null,f.aabb=c,a.call(this,f),this.maxDepth=typeof f.maxDepth!="undefined"?f.maxDepth:8}l.prototype=new a,a.prototype.reset=function(c,f){this.children.length=this.data.length=0},a.prototype.insert=function(c,f,d){var p=this.data;if(d=d||0,!this.aabb.contains(c))return!1;var m=this.children;if(d<(this.maxDepth||this.root.maxDepth)){var y=!1;m.length||(this.subdivide(),y=!0);for(var g=0;g!==8;g++)if(m[g].insert(c,f,d+1))return!0;y&&(m.length=0)}return p.push(f),!0};var h=new o;a.prototype.subdivide=function(){var c=this.aabb,f=c.lowerBound,d=c.upperBound,p=this.children;p.push(new a({aabb:new s({lowerBound:new o(0,0,0)})}),new a({aabb:new s({lowerBound:new o(1,0,0)})}),new a({aabb:new s({lowerBound:new o(1,1,0)})}),new a({aabb:new s({lowerBound:new o(1,1,1)})}),new a({aabb:new s({lowerBound:new o(0,1,1)})}),new a({aabb:new s({lowerBound:new o(0,0,1)})}),new a({aabb:new s({lowerBound:new o(1,0,1)})}),new a({aabb:new s({lowerBound:new o(0,1,0)})})),d.vsub(f,h),h.scale(.5,h);for(var m=this.root||this,y=0;y!==8;y++){var g=p[y];g.root=m;var v=g.aabb.lowerBound;v.x*=h.x,v.y*=h.y,v.z*=h.z,v.vadd(f,v),v.vadd(h,g.aabb.upperBound)}},a.prototype.aabbQuery=function(c,f){this.data,this.children;for(var d=[this];d.length;){var p=d.pop();p.aabb.overlaps(c)&&Array.prototype.push.apply(f,p.data),Array.prototype.push.apply(d,p.children)}return f};var u=new s;a.prototype.rayQuery=function(c,f,d){return c.getAABB(u),u.toLocalFrame(f,u),this.aabbQuery(u,d),d},a.prototype.removeEmptyNodes=function(){for(var c=[this];c.length;){for(var f=c.pop(),d=f.children.length-1;d>=0;d--)f.children[d].data.length||f.children.splice(d,1);Array.prototype.push.apply(c,f.children)}}},{"../collision/AABB":3,"../math/Vec3":30}],51:[function(t,n,i){n.exports=s;function s(){this.objects=[],this.type=Object}s.prototype.release=function(){for(var o=arguments.length,a=0;a!==o;a++)this.objects.push(arguments[a])},s.prototype.get=function(){return this.objects.length===0?this.constructObject():this.objects.pop()},s.prototype.constructObject=function(){throw new Error("constructObject() not implemented in this Pool subclass yet!")}},{}],52:[function(t,n,i){n.exports=s;function s(){this.data={keys:[]}}s.prototype.get=function(o,a){if(o>a){var l=a;a=o,o=l}return this.data[o+"-"+a]},s.prototype.set=function(o,a,l){if(o>a){var h=a;a=o,o=h}var u=o+"-"+a;this.get(o,a)||this.data.keys.push(u),this.data[u]=l},s.prototype.reset=function(){for(var o=this.data,a=o.keys;a.length>0;){var l=a.pop();delete o[l]}}},{}],53:[function(t,n,i){function s(){}n.exports=s,s.defaults=function(o,a){o=o||{};for(var l in a)l in o||(o[l]=a[l]);return o}},{}],54:[function(t,n,i){n.exports=a;var s=t("../math/Vec3"),o=t("./Pool");function a(){o.call(this),this.type=s}a.prototype=new o,a.prototype.constructObject=function(){return new s}},{"../math/Vec3":30,"./Pool":51}],55:[function(t,n,i){n.exports=p;var s=t("../collision/AABB"),o=t("../shapes/Shape"),a=t("../collision/Ray"),l=t("../math/Vec3"),h=t("../math/Transform");t("../shapes/ConvexPolyhedron");var u=t("../math/Quaternion");t("../solver/Solver");var c=t("../utils/Vec3Pool"),f=t("../equations/ContactEquation"),d=t("../equations/FrictionEquation");function p(Se){this.contactPointPool=[],this.frictionEquationPool=[],this.result=[],this.frictionResult=[],this.v3pool=new c,this.world=Se,this.currentContactMaterial=null,this.enableFrictionReduction=!1}p.prototype.createContactEquation=function(Se,Re,Le,De,j,ue){var fe;this.contactPointPool.length?(fe=this.contactPointPool.pop(),fe.bi=Se,fe.bj=Re):fe=new f(Se,Re),fe.enabled=Se.collisionResponse&&Re.collisionResponse&&Le.collisionResponse&&De.collisionResponse;var de=this.currentContactMaterial;fe.restitution=de.restitution,fe.setSpookParams(de.contactEquationStiffness,de.contactEquationRelaxation,this.world.dt);var ie=Le.material||Se.material,_e=De.material||Re.material;return ie&&_e&&ie.restitution>=0&&_e.restitution>=0&&(fe.restitution=ie.restitution*_e.restitution),fe.si=j||Le,fe.sj=ue||De,fe},p.prototype.createFrictionEquationsFromContact=function(Se,Re){var Le=Se.bi,De=Se.bj,j=Se.si,ue=Se.sj,fe=this.world,de=this.currentContactMaterial,ie=de.friction,_e=j.material||Le.material,Ce=ue.material||De.material;if(_e&&Ce&&_e.friction>=0&&Ce.friction>=0&&(ie=_e.friction*Ce.friction),ie>0){var Te=ie*fe.gravity.length(),Me=Le.invMass+De.invMass;Me>0&&(Me=1/Me);var Ee=this.frictionEquationPool,Ne=Ee.length?Ee.pop():new d(Le,De,Te*Me),Ue=Ee.length?Ee.pop():new d(Le,De,Te*Me);return Ne.bi=Ue.bi=Le,Ne.bj=Ue.bj=De,Ne.minForce=Ue.minForce=-Te*Me,Ne.maxForce=Ue.maxForce=Te*Me,Ne.ri.copy(Se.ri),Ne.rj.copy(Se.rj),Ue.ri.copy(Se.ri),Ue.rj.copy(Se.rj),Se.ni.tangents(Ne.t,Ue.t),Ne.setSpookParams(de.frictionEquationStiffness,de.frictionEquationRelaxation,fe.dt),Ue.setSpookParams(de.frictionEquationStiffness,de.frictionEquationRelaxation,fe.dt),Ne.enabled=Ue.enabled=Se.enabled,Re.push(Ne,Ue),!0}return!1};var m=new l,y=new l,g=new l;p.prototype.createFrictionFromAverage=function(Se){var Re=this.result[this.result.length-1];if(!(!this.createFrictionEquationsFromContact(Re,this.frictionResult)||Se===1)){var Le=this.frictionResult[this.frictionResult.length-2],De=this.frictionResult[this.frictionResult.length-1];m.setZero(),y.setZero(),g.setZero();var j=Re.bi;Re.bj;for(var ue=0;ue!==Se;ue++)Re=this.result[this.result.length-1-ue],Re.bodyA!==j?(m.vadd(Re.ni,m),y.vadd(Re.ri,y),g.vadd(Re.rj,g)):(m.vsub(Re.ni,m),y.vadd(Re.rj,y),g.vadd(Re.ri,g));var fe=1/Se;y.scale(fe,Le.ri),g.scale(fe,Le.rj),De.ri.copy(Le.ri),De.rj.copy(Le.rj),m.normalize(),m.tangents(Le.t,De.t)}};var v=new l,x=new l,w=new u,b=new u;p.prototype.getContacts=function(Se,Re,Le,De,j,ue,fe){this.contactPointPool=j,this.frictionEquationPool=fe,this.result=De,this.frictionResult=ue;for(var de=w,ie=b,_e=v,Ce=x,Te=0,Me=Se.length;Te!==Me;Te++){var Ee=Se[Te],Ne=Re[Te],Ue=null;Ee.material&&Ne.material&&(Ue=Le.getContactMaterial(Ee.material,Ne.material)||null);for(var Xe=0;Xe<Ee.shapes.length;Xe++){Ee.quaternion.mult(Ee.shapeOrientations[Xe],de),Ee.quaternion.vmult(Ee.shapeOffsets[Xe],_e),_e.vadd(Ee.position,_e);for(var Oe=Ee.shapes[Xe],st=0;st<Ne.shapes.length;st++){Ne.quaternion.mult(Ne.shapeOrientations[st],ie),Ne.quaternion.vmult(Ne.shapeOffsets[st],Ce),Ce.vadd(Ne.position,Ce);var qe=Ne.shapes[st];if(!(_e.distanceTo(Ce)>Oe.boundingSphereRadius+qe.boundingSphereRadius)){var bt=null;Oe.material&&qe.material&&(bt=Le.getContactMaterial(Oe.material,qe.material)||null),this.currentContactMaterial=bt||Ue||Le.defaultContactMaterial;var $e=this[Oe.type|qe.type];$e&&(Oe.type<qe.type?$e.call(this,Oe,qe,_e,Ce,de,ie,Ee,Ne,Oe,qe):$e.call(this,qe,Oe,Ce,_e,ie,de,Ne,Ee,Oe,qe))}}}}},p.prototype[o.types.BOX|o.types.BOX]=p.prototype.boxBox=function(Se,Re,Le,De,j,ue,fe,de){Se.convexPolyhedronRepresentation.material=Se.material,Re.convexPolyhedronRepresentation.material=Re.material,Se.convexPolyhedronRepresentation.collisionResponse=Se.collisionResponse,Re.convexPolyhedronRepresentation.collisionResponse=Re.collisionResponse,this.convexConvex(Se.convexPolyhedronRepresentation,Re.convexPolyhedronRepresentation,Le,De,j,ue,fe,de,Se,Re)},p.prototype[o.types.BOX|o.types.CONVEXPOLYHEDRON]=p.prototype.boxConvex=function(Se,Re,Le,De,j,ue,fe,de){Se.convexPolyhedronRepresentation.material=Se.material,Se.convexPolyhedronRepresentation.collisionResponse=Se.collisionResponse,this.convexConvex(Se.convexPolyhedronRepresentation,Re,Le,De,j,ue,fe,de,Se,Re)},p.prototype[o.types.BOX|o.types.PARTICLE]=p.prototype.boxParticle=function(Se,Re,Le,De,j,ue,fe,de){Se.convexPolyhedronRepresentation.material=Se.material,Se.convexPolyhedronRepresentation.collisionResponse=Se.collisionResponse,this.convexParticle(Se.convexPolyhedronRepresentation,Re,Le,De,j,ue,fe,de,Se,Re)},p.prototype[o.types.SPHERE]=p.prototype.sphereSphere=function(Se,Re,Le,De,j,ue,fe,de){var ie=this.createContactEquation(fe,de,Se,Re);De.vsub(Le,ie.ni),ie.ni.normalize(),ie.ri.copy(ie.ni),ie.rj.copy(ie.ni),ie.ri.mult(Se.radius,ie.ri),ie.rj.mult(-Re.radius,ie.rj),ie.ri.vadd(Le,ie.ri),ie.ri.vsub(fe.position,ie.ri),ie.rj.vadd(De,ie.rj),ie.rj.vsub(de.position,ie.rj),this.result.push(ie),this.createFrictionEquationsFromContact(ie,this.frictionResult)};var M=new l,A=new l,E=new l;p.prototype[o.types.PLANE|o.types.TRIMESH]=p.prototype.planeTrimesh=function(Se,Re,Le,De,j,ue,fe,de){var ie=new l,_e=M;_e.set(0,0,1),j.vmult(_e,_e);for(var Ce=0;Ce<Re.vertices.length/3;Ce++){Re.getVertex(Ce,ie);var Te=new l;Te.copy(ie),h.pointToWorldFrame(De,ue,Te,ie);var Me=A;ie.vsub(Le,Me);var Ee=_e.dot(Me);if(Ee<=0){var Ne=this.createContactEquation(fe,de,Se,Re);Ne.ni.copy(_e);var Ue=E;_e.scale(Me.dot(_e),Ue),ie.vsub(Ue,Ue),Ne.ri.copy(Ue),Ne.ri.vsub(fe.position,Ne.ri),Ne.rj.copy(ie),Ne.rj.vsub(de.position,Ne.rj),this.result.push(Ne),this.createFrictionEquationsFromContact(Ne,this.frictionResult)}}};var N=new l,R=new l;new l;var _=new l,S=new l,L=new l,k=new l,H=new l,O=new l,T=new l,V=new l,F=new l,J=new l,Y=new l,te=new s,z=[];p.prototype[o.types.SPHERE|o.types.TRIMESH]=p.prototype.sphereTrimesh=function(Se,Re,Le,De,j,ue,fe,de){var ie=L,_e=k,Ce=H,Te=O,Me=T,Ee=V,Ne=te,Ue=S,Xe=R,Oe=z;h.pointToLocalFrame(De,ue,Le,Me);var st=Se.radius;Ne.lowerBound.set(Me.x-st,Me.y-st,Me.z-st),Ne.upperBound.set(Me.x+st,Me.y+st,Me.z+st),Re.getTrianglesInAABB(Ne,Oe);for(var qe=_,bt=Se.radius*Se.radius,$e=0;$e<Oe.length;$e++)for(var at=0;at<3;at++)if(Re.getVertex(Re.indices[Oe[$e]*3+at],qe),qe.vsub(Me,Xe),Xe.norm2()<=bt){Ue.copy(qe),h.pointToWorldFrame(De,ue,Ue,qe),qe.vsub(Le,Xe);var et=this.createContactEquation(fe,de,Se,Re);et.ni.copy(Xe),et.ni.normalize(),et.ri.copy(et.ni),et.ri.scale(Se.radius,et.ri),et.ri.vadd(Le,et.ri),et.ri.vsub(fe.position,et.ri),et.rj.copy(qe),et.rj.vsub(de.position,et.rj),this.result.push(et),this.createFrictionEquationsFromContact(et,this.frictionResult)}for(var $e=0;$e<Oe.length;$e++)for(var at=0;at<3;at++){Re.getVertex(Re.indices[Oe[$e]*3+at],ie),Re.getVertex(Re.indices[Oe[$e]*3+(at+1)%3],_e),_e.vsub(ie,Ce),Me.vsub(_e,Ee);var $t=Ee.dot(Ce);Me.vsub(ie,Ee);var sn=Ee.dot(Ce);if(sn>0&&$t<0){Me.vsub(ie,Ee),Te.copy(Ce),Te.normalize(),sn=Ee.dot(Te),Te.scale(sn,Ee),Ee.vadd(ie,Ee);var _t=Ee.distanceTo(Me);if(_t<Se.radius){var et=this.createContactEquation(fe,de,Se,Re);Ee.vsub(Me,et.ni),et.ni.normalize(),et.ni.scale(Se.radius,et.ri),h.pointToWorldFrame(De,ue,Ee,Ee),Ee.vsub(de.position,et.rj),h.vectorToWorldFrame(ue,et.ni,et.ni),h.vectorToWorldFrame(ue,et.ri,et.ri),this.result.push(et),this.createFrictionEquationsFromContact(et,this.frictionResult)}}}for(var Wn=F,Ot=J,Bt=Y,Ai=N,$e=0,Yt=Oe.length;$e!==Yt;$e++){Re.getTriangleVertices(Oe[$e],Wn,Ot,Bt),Re.getNormal(Oe[$e],Ai),Me.vsub(Wn,Ee);var _t=Ee.dot(Ai);if(Ai.scale(_t,Ee),Me.vsub(Ee,Ee),_t=Ee.distanceTo(Me),a.pointInTriangle(Ee,Wn,Ot,Bt)&&_t<Se.radius){var et=this.createContactEquation(fe,de,Se,Re);Ee.vsub(Me,et.ni),et.ni.normalize(),et.ni.scale(Se.radius,et.ri),h.pointToWorldFrame(De,ue,Ee,Ee),Ee.vsub(de.position,et.rj),h.vectorToWorldFrame(ue,et.ni,et.ni),h.vectorToWorldFrame(ue,et.ri,et.ri),this.result.push(et),this.createFrictionEquationsFromContact(et,this.frictionResult)}}Oe.length=0};var K=new l,Z=new l;p.prototype[o.types.SPHERE|o.types.PLANE]=p.prototype.spherePlane=function(Se,Re,Le,De,j,ue,fe,de){var ie=this.createContactEquation(fe,de,Se,Re);if(ie.ni.set(0,0,1),ue.vmult(ie.ni,ie.ni),ie.ni.negate(ie.ni),ie.ni.normalize(),ie.ni.mult(Se.radius,ie.ri),Le.vsub(De,K),ie.ni.mult(ie.ni.dot(K),Z),K.vsub(Z,ie.rj),-K.dot(ie.ni)<=Se.radius){var _e=ie.ri,Ce=ie.rj;_e.vadd(Le,_e),_e.vsub(fe.position,_e),Ce.vadd(De,Ce),Ce.vsub(de.position,Ce),this.result.push(ie),this.createFrictionEquationsFromContact(ie,this.frictionResult)}};var Q=new l,me=new l,ge=new l;function se(Se,Re,Le){for(var De=null,j=Se.length,ue=0;ue!==j;ue++){var fe=Se[ue],de=Q;Se[(ue+1)%j].vsub(fe,de);var ie=me;de.cross(Re,ie);var _e=ge;Le.vsub(fe,_e);var Ce=ie.dot(_e);if(De===null||Ce>0&&De===!0||Ce<=0&&De===!1){De===null&&(De=Ce>0);continue}else return!1}return!0}var he=new l,xe=new l,pe=new l,G=new l,q=[new l,new l,new l,new l,new l,new l],B=new l,D=new l,$=new l,ne=new l;p.prototype[o.types.SPHERE|o.types.BOX]=p.prototype.sphereBox=function(Se,Re,Le,De,j,ue,fe,de){var ie=this.v3pool,_e=q;Le.vsub(De,he),Re.getSideNormals(_e,ue);for(var Ce=Se.radius,Te=!1,Me=D,Ee=$,Ne=ne,Ue=null,Xe=0,Oe=0,st=0,qe=null,bt=0,$e=_e.length;bt!==$e&&Te===!1;bt++){var at=xe;at.copy(_e[bt]);var et=at.norm();at.normalize();var $t=he.dot(at);if($t<et+Ce&&$t>0){var sn=pe,_t=G;sn.copy(_e[(bt+1)%3]),_t.copy(_e[(bt+2)%3]);var Wn=sn.norm(),Ot=_t.norm();sn.normalize(),_t.normalize();var Bt=he.dot(sn),Ai=he.dot(_t);if(Bt<Wn&&Bt>-Wn&&Ai<Ot&&Ai>-Ot){var bn=Math.abs($t-et-Ce);(qe===null||bn<qe)&&(qe=bn,Oe=Bt,st=Ai,Ue=et,Me.copy(at),Ee.copy(sn),Ne.copy(_t),Xe++)}}}if(Xe){Te=!0;var lt=this.createContactEquation(fe,de,Se,Re);Me.mult(-Ce,lt.ri),lt.ni.copy(Me),lt.ni.negate(lt.ni),Me.mult(Ue,Me),Ee.mult(Oe,Ee),Me.vadd(Ee,Me),Ne.mult(st,Ne),Me.vadd(Ne,lt.rj),lt.ri.vadd(Le,lt.ri),lt.ri.vsub(fe.position,lt.ri),lt.rj.vadd(De,lt.rj),lt.rj.vsub(de.position,lt.rj),this.result.push(lt),this.createFrictionEquationsFromContact(lt,this.frictionResult)}for(var Yt=ie.get(),Si=B,nr=0;nr!==2&&!Te;nr++)for(var zn=0;zn!==2&&!Te;zn++)for(var _n=0;_n!==2&&!Te;_n++)if(Yt.set(0,0,0),nr?Yt.vadd(_e[0],Yt):Yt.vsub(_e[0],Yt),zn?Yt.vadd(_e[1],Yt):Yt.vsub(_e[1],Yt),_n?Yt.vadd(_e[2],Yt):Yt.vsub(_e[2],Yt),De.vadd(Yt,Si),Si.vsub(Le,Si),Si.norm2()<Ce*Ce){Te=!0;var lt=this.createContactEquation(fe,de,Se,Re);lt.ri.copy(Si),lt.ri.normalize(),lt.ni.copy(lt.ri),lt.ri.mult(Ce,lt.ri),lt.rj.copy(Yt),lt.ri.vadd(Le,lt.ri),lt.ri.vsub(fe.position,lt.ri),lt.rj.vadd(De,lt.rj),lt.rj.vsub(de.position,lt.rj),this.result.push(lt),this.createFrictionEquationsFromContact(lt,this.frictionResult)}ie.release(Yt),Yt=null;for(var Sr=ie.get(),Ei=ie.get(),lt=ie.get(),hr=ie.get(),bn=ie.get(),Vs=_e.length,nr=0;nr!==Vs&&!Te;nr++)for(var zn=0;zn!==Vs&&!Te;zn++)if(nr%3!=zn%3){_e[zn].cross(_e[nr],Sr),Sr.normalize(),_e[nr].vadd(_e[zn],Ei),lt.copy(Le),lt.vsub(Ei,lt),lt.vsub(De,lt);var Ws=lt.dot(Sr);Sr.mult(Ws,hr);for(var _n=0;_n===nr%3||_n===zn%3;)_n++;bn.copy(Le),bn.vsub(hr,bn),bn.vsub(Ei,bn),bn.vsub(De,bn);var bS=Math.abs(Ws),MS=bn.norm();if(bS<_e[_n].norm()&&MS<Ce){Te=!0;var Xt=this.createContactEquation(fe,de,Se,Re);Ei.vadd(hr,Xt.rj),Xt.rj.copy(Xt.rj),bn.negate(Xt.ni),Xt.ni.normalize(),Xt.ri.copy(Xt.rj),Xt.ri.vadd(De,Xt.ri),Xt.ri.vsub(Le,Xt.ri),Xt.ri.normalize(),Xt.ri.mult(Ce,Xt.ri),Xt.ri.vadd(Le,Xt.ri),Xt.ri.vsub(fe.position,Xt.ri),Xt.rj.vadd(De,Xt.rj),Xt.rj.vsub(de.position,Xt.rj),this.result.push(Xt),this.createFrictionEquationsFromContact(Xt,this.frictionResult)}}ie.release(Sr,Ei,lt,hr,bn)};var U=new l,W=new l,P=new l,C=new l,ee=new l,ae=new l,le=new l,ce=new l,ye=new l,we=new l;p.prototype[o.types.SPHERE|o.types.CONVEXPOLYHEDRON]=p.prototype.sphereConvex=function(Se,Re,Le,De,j,ue,fe,de){var ie=this.v3pool;Le.vsub(De,U);for(var _e=Re.faceNormals,Ce=Re.faces,Te=Re.vertices,Me=Se.radius,Ee=0;Ee!==Te.length;Ee++){var Ne=Te[Ee],Ue=ee;ue.vmult(Ne,Ue),De.vadd(Ue,Ue);var Xe=C;if(Ue.vsub(Le,Xe),Xe.norm2()<Me*Me){st=!0;var Oe=this.createContactEquation(fe,de,Se,Re);Oe.ri.copy(Xe),Oe.ri.normalize(),Oe.ni.copy(Oe.ri),Oe.ri.mult(Me,Oe.ri),Ue.vsub(De,Oe.rj),Oe.ri.vadd(Le,Oe.ri),Oe.ri.vsub(fe.position,Oe.ri),Oe.rj.vadd(De,Oe.rj),Oe.rj.vsub(de.position,Oe.rj),this.result.push(Oe),this.createFrictionEquationsFromContact(Oe,this.frictionResult);return}}for(var st=!1,Ee=0,qe=Ce.length;Ee!==qe&&st===!1;Ee++){var bt=_e[Ee],$e=Ce[Ee],at=ae;ue.vmult(bt,at);var et=le;ue.vmult(Te[$e[0]],et),et.vadd(De,et);var $t=ce;at.mult(-Me,$t),Le.vadd($t,$t);var sn=ye;$t.vsub(et,sn);var _t=sn.dot(at),Wn=we;if(Le.vsub(et,Wn),_t<0&&Wn.dot(at)>0){for(var Ot=[],Bt=0,Ai=$e.length;Bt!==Ai;Bt++){var Yt=ie.get();ue.vmult(Te[$e[Bt]],Yt),De.vadd(Yt,Yt),Ot.push(Yt)}if(se(Ot,at,Le)){st=!0;var Oe=this.createContactEquation(fe,de,Se,Re);at.mult(-Me,Oe.ri),at.negate(Oe.ni);var Si=ie.get();at.mult(-_t,Si);var nr=ie.get();at.mult(-Me,nr),Le.vsub(De,Oe.rj),Oe.rj.vadd(nr,Oe.rj),Oe.rj.vadd(Si,Oe.rj),Oe.rj.vadd(De,Oe.rj),Oe.rj.vsub(de.position,Oe.rj),Oe.ri.vadd(Le,Oe.ri),Oe.ri.vsub(fe.position,Oe.ri),ie.release(Si),ie.release(nr),this.result.push(Oe),this.createFrictionEquationsFromContact(Oe,this.frictionResult);for(var Bt=0,zn=Ot.length;Bt!==zn;Bt++)ie.release(Ot[Bt]);return}else for(var Bt=0;Bt!==$e.length;Bt++){var _n=ie.get(),Sr=ie.get();ue.vmult(Te[$e[(Bt+1)%$e.length]],_n),ue.vmult(Te[$e[(Bt+2)%$e.length]],Sr),De.vadd(_n,_n),De.vadd(Sr,Sr);var Ei=W;Sr.vsub(_n,Ei);var lt=P;Ei.unit(lt);var hr=ie.get(),bn=ie.get();Le.vsub(_n,bn);var Vs=bn.dot(lt);lt.mult(Vs,hr),hr.vadd(_n,hr);var Ws=ie.get();if(hr.vsub(Le,Ws),Vs>0&&Vs*Vs<Ei.norm2()&&Ws.norm2()<Me*Me){var Oe=this.createContactEquation(fe,de,Se,Re);hr.vsub(De,Oe.rj),hr.vsub(Le,Oe.ni),Oe.ni.normalize(),Oe.ni.mult(Me,Oe.ri),Oe.rj.vadd(De,Oe.rj),Oe.rj.vsub(de.position,Oe.rj),Oe.ri.vadd(Le,Oe.ri),Oe.ri.vsub(fe.position,Oe.ri),this.result.push(Oe),this.createFrictionEquationsFromContact(Oe,this.frictionResult);for(var Bt=0,zn=Ot.length;Bt!==zn;Bt++)ie.release(Ot[Bt]);ie.release(_n),ie.release(Sr),ie.release(hr),ie.release(Ws),ie.release(bn);return}ie.release(_n),ie.release(Sr),ie.release(hr),ie.release(Ws),ie.release(bn)}for(var Bt=0,zn=Ot.length;Bt!==zn;Bt++)ie.release(Ot[Bt])}}},new l,new l,p.prototype[o.types.PLANE|o.types.BOX]=p.prototype.planeBox=function(Se,Re,Le,De,j,ue,fe,de){Re.convexPolyhedronRepresentation.material=Re.material,Re.convexPolyhedronRepresentation.collisionResponse=Re.collisionResponse,this.planeConvex(Se,Re.convexPolyhedronRepresentation,Le,De,j,ue,fe,de)};var be=new l,oe=new l,Ie=new l,Pe=new l;p.prototype[o.types.PLANE|o.types.CONVEXPOLYHEDRON]=p.prototype.planeConvex=function(Se,Re,Le,De,j,ue,fe,de){var ie=be,_e=oe;_e.set(0,0,1),j.vmult(_e,_e);for(var Ce=0,Te=Ie,Me=0;Me!==Re.vertices.length;Me++){ie.copy(Re.vertices[Me]),ue.vmult(ie,ie),De.vadd(ie,ie),ie.vsub(Le,Te);var Ee=_e.dot(Te);if(Ee<=0){var Ne=this.createContactEquation(fe,de,Se,Re),Ue=Pe;_e.mult(_e.dot(Te),Ue),ie.vsub(Ue,Ue),Ue.vsub(Le,Ne.ri),Ne.ni.copy(_e),ie.vsub(De,Ne.rj),Ne.ri.vadd(Le,Ne.ri),Ne.ri.vsub(fe.position,Ne.ri),Ne.rj.vadd(De,Ne.rj),Ne.rj.vsub(de.position,Ne.rj),this.result.push(Ne),Ce++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(Ne,this.frictionResult)}}this.enableFrictionReduction&&Ce&&this.createFrictionFromAverage(Ce)};var Qe=new l,Ge=new l;p.prototype[o.types.CONVEXPOLYHEDRON]=p.prototype.convexConvex=function(Se,Re,Le,De,j,ue,fe,de,ie,_e,Ce,Te){var Me=Qe;if(!(Le.distanceTo(De)>Se.boundingSphereRadius+Re.boundingSphereRadius)&&Se.findSeparatingAxis(Re,Le,j,De,ue,Me,Ce,Te)){var Ee=[],Ne=Ge;Se.clipAgainstHull(Le,j,Re,De,ue,Me,-100,100,Ee);for(var Ue=0,Xe=0;Xe!==Ee.length;Xe++){var Oe=this.createContactEquation(fe,de,Se,Re,ie,_e),st=Oe.ri,qe=Oe.rj;Me.negate(Oe.ni),Ee[Xe].normal.negate(Ne),Ne.mult(Ee[Xe].depth,Ne),Ee[Xe].point.vadd(Ne,st),qe.copy(Ee[Xe].point),st.vsub(Le,st),qe.vsub(De,qe),st.vadd(Le,st),st.vsub(fe.position,st),qe.vadd(De,qe),qe.vsub(de.position,qe),this.result.push(Oe),Ue++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(Oe,this.frictionResult)}this.enableFrictionReduction&&Ue&&this.createFrictionFromAverage(Ue)}};var We=new l,Fe=new l,I=new l;p.prototype[o.types.PLANE|o.types.PARTICLE]=p.prototype.planeParticle=function(Se,Re,Le,De,j,ue,fe,de){var ie=We;ie.set(0,0,1),fe.quaternion.vmult(ie,ie);var _e=Fe;De.vsub(fe.position,_e);var Ce=ie.dot(_e);if(Ce<=0){var Te=this.createContactEquation(de,fe,Re,Se);Te.ni.copy(ie),Te.ni.negate(Te.ni),Te.ri.set(0,0,0);var Me=I;ie.mult(ie.dot(De),Me),De.vsub(Me,Me),Te.rj.copy(Me),this.result.push(Te),this.createFrictionEquationsFromContact(Te,this.frictionResult)}};var re=new l;p.prototype[o.types.PARTICLE|o.types.SPHERE]=p.prototype.sphereParticle=function(Se,Re,Le,De,j,ue,fe,de){var ie=re;ie.set(0,0,1),De.vsub(Le,ie);var _e=ie.norm2();if(_e<=Se.radius*Se.radius){var Ce=this.createContactEquation(de,fe,Re,Se);ie.normalize(),Ce.rj.copy(ie),Ce.rj.mult(Se.radius,Ce.rj),Ce.ni.copy(ie),Ce.ni.negate(Ce.ni),Ce.ri.set(0,0,0),this.result.push(Ce),this.createFrictionEquationsFromContact(Ce,this.frictionResult)}};var ve=new u,Be=new l;new l;var Ze=new l,Ke=new l,Ft=new l;p.prototype[o.types.PARTICLE|o.types.CONVEXPOLYHEDRON]=p.prototype.convexParticle=function(Se,Re,Le,De,j,ue,fe,de){var ie=-1,_e=Ze,Ce=Ft,Te=null,Me=Be;if(Me.copy(De),Me.vsub(Le,Me),j.conjugate(ve),ve.vmult(Me,Me),Se.pointIsInside(Me)){Se.worldVerticesNeedsUpdate&&Se.computeWorldVertices(Le,j),Se.worldFaceNormalsNeedsUpdate&&Se.computeWorldFaceNormals(j);for(var Ee=0,Ne=Se.faces.length;Ee!==Ne;Ee++){var Ue=[Se.worldVertices[Se.faces[Ee][0]]],Xe=Se.worldFaceNormals[Ee];De.vsub(Ue[0],Ke);var Oe=-Xe.dot(Ke);(Te===null||Math.abs(Oe)<Math.abs(Te))&&(Te=Oe,ie=Ee,_e.copy(Xe))}if(ie!==-1){var st=this.createContactEquation(de,fe,Re,Se);_e.mult(Te,Ce),Ce.vadd(De,Ce),Ce.vsub(Le,Ce),st.rj.copy(Ce),_e.negate(st.ni),st.ri.set(0,0,0);var qe=st.ri,bt=st.rj;qe.vadd(De,qe),qe.vsub(de.position,qe),bt.vadd(Le,bt),bt.vsub(fe.position,bt),this.result.push(st),this.createFrictionEquationsFromContact(st,this.frictionResult)}else console.warn("Point found inside convex, but did not find penetrating face!")}},p.prototype[o.types.BOX|o.types.HEIGHTFIELD]=p.prototype.boxHeightfield=function(Se,Re,Le,De,j,ue,fe,de){Se.convexPolyhedronRepresentation.material=Se.material,Se.convexPolyhedronRepresentation.collisionResponse=Se.collisionResponse,this.convexHeightfield(Se.convexPolyhedronRepresentation,Re,Le,De,j,ue,fe,de)};var tr=new l,Dr=new l,ur=[0];p.prototype[o.types.CONVEXPOLYHEDRON|o.types.HEIGHTFIELD]=p.prototype.convexHeightfield=function(Se,Re,Le,De,j,ue,fe,de){var ie=Re.data,_e=Re.elementSize,Ce=Se.boundingSphereRadius,Te=Dr,Me=ur,Ee=tr;h.pointToLocalFrame(De,ue,Le,Ee);var Ne=Math.floor((Ee.x-Ce)/_e)-1,Ue=Math.ceil((Ee.x+Ce)/_e)+1,Xe=Math.floor((Ee.y-Ce)/_e)-1,Oe=Math.ceil((Ee.y+Ce)/_e)+1;if(!(Ue<0||Oe<0||Ne>ie.length||Xe>ie[0].length)){Ne<0&&(Ne=0),Ue<0&&(Ue=0),Xe<0&&(Xe=0),Oe<0&&(Oe=0),Ne>=ie.length&&(Ne=ie.length-1),Ue>=ie.length&&(Ue=ie.length-1),Oe>=ie[0].length&&(Oe=ie[0].length-1),Xe>=ie[0].length&&(Xe=ie[0].length-1);var st=[];Re.getRectMinMax(Ne,Xe,Ue,Oe,st);var qe=st[0],bt=st[1];if(!(Ee.z-Ce>bt||Ee.z+Ce<qe))for(var $e=Ne;$e<Ue;$e++)for(var at=Xe;at<Oe;at++)Re.getConvexTrianglePillar($e,at,!1),h.pointToWorldFrame(De,ue,Re.pillarOffset,Te),Le.distanceTo(Te)<Re.pillarConvex.boundingSphereRadius+Se.boundingSphereRadius&&this.convexConvex(Se,Re.pillarConvex,Le,Te,j,ue,fe,de,null,null,Me,null),Re.getConvexTrianglePillar($e,at,!0),h.pointToWorldFrame(De,ue,Re.pillarOffset,Te),Le.distanceTo(Te)<Re.pillarConvex.boundingSphereRadius+Se.boundingSphereRadius&&this.convexConvex(Se,Re.pillarConvex,Le,Te,j,ue,fe,de,null,null,Me,null)}};var Zr=new l,qt=new l;p.prototype[o.types.SPHERE|o.types.HEIGHTFIELD]=p.prototype.sphereHeightfield=function(Se,Re,Le,De,j,ue,fe,de){var ie=Re.data,_e=Se.radius,Ce=Re.elementSize,Te=qt,Me=Zr;h.pointToLocalFrame(De,ue,Le,Me);var Ee=Math.floor((Me.x-_e)/Ce)-1,Ne=Math.ceil((Me.x+_e)/Ce)+1,Ue=Math.floor((Me.y-_e)/Ce)-1,Xe=Math.ceil((Me.y+_e)/Ce)+1;if(!(Ne<0||Xe<0||Ee>ie.length||Xe>ie[0].length)){Ee<0&&(Ee=0),Ne<0&&(Ne=0),Ue<0&&(Ue=0),Xe<0&&(Xe=0),Ee>=ie.length&&(Ee=ie.length-1),Ne>=ie.length&&(Ne=ie.length-1),Xe>=ie[0].length&&(Xe=ie[0].length-1),Ue>=ie[0].length&&(Ue=ie[0].length-1);var Oe=[];Re.getRectMinMax(Ee,Ue,Ne,Xe,Oe);var st=Oe[0],qe=Oe[1];if(!(Me.z-_e>qe||Me.z+_e<st))for(var bt=this.result,$e=Ee;$e<Ne;$e++)for(var at=Ue;at<Xe;at++){var et=bt.length;Re.getConvexTrianglePillar($e,at,!1),h.pointToWorldFrame(De,ue,Re.pillarOffset,Te),Le.distanceTo(Te)<Re.pillarConvex.boundingSphereRadius+Se.boundingSphereRadius&&this.sphereConvex(Se,Re.pillarConvex,Le,Te,j,ue,fe,de),Re.getConvexTrianglePillar($e,at,!0),h.pointToWorldFrame(De,ue,Re.pillarOffset,Te),Le.distanceTo(Te)<Re.pillarConvex.boundingSphereRadius+Se.boundingSphereRadius&&this.sphereConvex(Se,Re.pillarConvex,Le,Te,j,ue,fe,de);var $t=bt.length-et;if($t>2)return}}}},{"../collision/AABB":3,"../collision/Ray":9,"../equations/ContactEquation":19,"../equations/FrictionEquation":21,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../shapes/ConvexPolyhedron":38,"../shapes/Shape":43,"../solver/Solver":47,"../utils/Vec3Pool":54}],56:[function(t,n,i){n.exports=w;var s=t("../shapes/Shape"),o=t("../math/Vec3"),a=t("../math/Quaternion"),l=t("../solver/GSSolver");t("../utils/Vec3Pool"),t("../equations/ContactEquation"),t("../equations/FrictionEquation");var h=t("./Narrowphase"),u=t("../utils/EventTarget"),c=t("../collision/ArrayCollisionMatrix"),f=t("../material/Material"),d=t("../material/ContactMaterial"),p=t("../objects/Body"),m=t("../utils/TupleDictionary"),y=t("../collision/RaycastResult"),g=t("../collision/AABB"),v=t("../collision/Ray"),x=t("../collision/NaiveBroadphase");function w(){u.apply(this),this.dt=-1,this.allowSleep=!1,this.contacts=[],this.frictionEquations=[],this.quatNormalizeSkip=0,this.quatNormalizeFast=!1,this.time=0,this.stepnumber=0,this.default_dt=1/60,this.nextId=0,this.gravity=new o,this.broadphase=new x,this.bodies=[],this.solver=new l,this.constraints=[],this.narrowphase=new h(this),this.collisionMatrix=new c,this.collisionMatrixPrevious=new c,this.materials=[],this.contactmaterials=[],this.contactMaterialTable=new m,this.defaultMaterial=new f("default"),this.defaultContactMaterial=new d(this.defaultMaterial,this.defaultMaterial,{friction:.3,restitution:0}),this.doProfiling=!1,this.profile={solve:0,makeContactConstraints:0,broadphase:0,integrate:0,narrowphase:0},this.subsystems=[],this.addBodyEvent={type:"addBody",body:null},this.removeBodyEvent={type:"removeBody",body:null}}w.prototype=new u,new g;var b=new v;if(w.prototype.getContactMaterial=function(V,F){return this.contactMaterialTable.get(V.id,F.id)},w.prototype.numObjects=function(){return this.bodies.length},w.prototype.collisionMatrixTick=function(){var V=this.collisionMatrixPrevious;this.collisionMatrixPrevious=this.collisionMatrix,this.collisionMatrix=V,this.collisionMatrix.reset()},w.prototype.add=w.prototype.addBody=function(V){this.bodies.indexOf(V)===-1&&(V.index=this.bodies.length,this.bodies.push(V),V.world=this,V.initPosition.copy(V.position),V.initVelocity.copy(V.velocity),V.timeLastSleepy=this.time,V instanceof p&&(V.initAngularVelocity.copy(V.angularVelocity),V.initQuaternion.copy(V.quaternion)),this.collisionMatrix.setNumObjects(this.bodies.length),this.addBodyEvent.body=V,this.dispatchEvent(this.addBodyEvent))},w.prototype.addConstraint=function(V){this.constraints.push(V)},w.prototype.removeConstraint=function(V){var F=this.constraints.indexOf(V);F!==-1&&this.constraints.splice(F,1)},w.prototype.rayTest=function(V,F,J){J instanceof y?this.raycastClosest(V,F,{skipBackfaces:!0},J):this.raycastAll(V,F,{skipBackfaces:!0},J)},w.prototype.raycastAll=function(V,F,J,Y){return J.mode=v.ALL,J.from=V,J.to=F,J.callback=Y,b.intersectWorld(this,J)},w.prototype.raycastAny=function(V,F,J,Y){return J.mode=v.ANY,J.from=V,J.to=F,J.result=Y,b.intersectWorld(this,J)},w.prototype.raycastClosest=function(V,F,J,Y){return J.mode=v.CLOSEST,J.from=V,J.to=F,J.result=Y,b.intersectWorld(this,J)},w.prototype.remove=function(V){V.world=null;var F=this.bodies.length-1,J=this.bodies,Y=J.indexOf(V);if(Y!==-1){J.splice(Y,1);for(var te=0;te!==J.length;te++)J[te].index=te;this.collisionMatrix.setNumObjects(F),this.removeBodyEvent.body=V,this.dispatchEvent(this.removeBodyEvent)}},w.prototype.removeBody=w.prototype.remove,w.prototype.addMaterial=function(V){this.materials.push(V)},w.prototype.addContactMaterial=function(V){this.contactmaterials.push(V),this.contactMaterialTable.set(V.materials[0].id,V.materials[1].id,V)},typeof performance=="undefined"&&(performance={}),!performance.now){var M=Date.now();performance.timing&&performance.timing.navigationStart&&(M=performance.timing.navigationStart),performance.now=function(){return Date.now()-M}}var A=new o;w.prototype.step=function(V,F,J){if(J=J||10,F=F||0,F===0)this.internalStep(V),this.time+=V;else{var Y=Math.floor((this.time+F)/V)-Math.floor(this.time/V);Y=Math.min(Y,J);for(var te=performance.now(),z=0;z!==Y&&(this.internalStep(V),!(performance.now()-te>V*1e3));z++);this.time+=F;for(var K=this.time%V,Z=K/V,Q=A,me=this.bodies,ge=0;ge!==me.length;ge++){var se=me[ge];se.type!==p.STATIC&&se.sleepState!==p.SLEEPING?(se.position.vsub(se.previousPosition,Q),Q.scale(Z,Q),se.position.vadd(Q,se.interpolatedPosition)):(se.interpolatedPosition.copy(se.position),se.interpolatedQuaternion.copy(se.quaternion))}}};var E={type:"postStep"},N={type:"preStep"},R={type:"collide",body:null,contact:null},_=[],S=[],L=[],k=[];new o,new o,new o,new o,new o,new o,new o,new o,new o,new a;var H=new a,O=new a,T=new o;w.prototype.internalStep=function(V){this.dt=V;var F=this.contacts,J=L,Y=k,te=this.numObjects(),z=this.bodies,K=this.solver,Z=this.gravity,Q=this.doProfiling,me=this.profile,ge=p.DYNAMIC,se,he=this.constraints,xe=S;Z.norm();var pe=Z.x,G=Z.y,q=Z.z,B=0;for(Q&&(se=performance.now()),B=0;B!==te;B++){var D=z[B];if(D.type&ge){var $=D.force,ne=D.mass;$.x+=ne*pe,$.y+=ne*G,$.z+=ne*q}}for(var B=0,U=this.subsystems.length;B!==U;B++)this.subsystems[B].update();Q&&(se=performance.now()),J.length=0,Y.length=0,this.broadphase.collisionPairs(this,J,Y),Q&&(me.broadphase=performance.now()-se);var W=he.length;for(B=0;B!==W;B++){var P=he[B];if(!P.collideConnected)for(var C=J.length-1;C>=0;C-=1)(P.bodyA===J[C]&&P.bodyB===Y[C]||P.bodyB===J[C]&&P.bodyA===Y[C])&&(J.splice(C,1),Y.splice(C,1))}this.collisionMatrixTick(),Q&&(se=performance.now());var ee=_,ae=F.length;for(B=0;B!==ae;B++)ee.push(F[B]);F.length=0;var le=this.frictionEquations.length;for(B=0;B!==le;B++)xe.push(this.frictionEquations[B]);this.frictionEquations.length=0,this.narrowphase.getContacts(J,Y,this,F,ee,this.frictionEquations,xe),Q&&(me.narrowphase=performance.now()-se),Q&&(se=performance.now());for(var B=0;B<this.frictionEquations.length;B++)K.addEquation(this.frictionEquations[B]);for(var ce=F.length,ye=0;ye!==ce;ye++){var P=F[ye],D=P.bi,we=P.bj;P.si,P.sj;var be;if(D.material&&we.material?be=this.getContactMaterial(D.material,we.material)||this.defaultContactMaterial:be=this.defaultContactMaterial,be.friction,D.material&&we.material&&(D.material.friction>=0&&we.material.friction>=0&&D.material.friction*we.material.friction,D.material.restitution>=0&&we.material.restitution>=0&&(P.restitution=D.material.restitution*we.material.restitution)),K.addEquation(P),D.allowSleep&&D.type===p.DYNAMIC&&D.sleepState===p.SLEEPING&&we.sleepState===p.AWAKE&&we.type!==p.STATIC){var oe=we.velocity.norm2()+we.angularVelocity.norm2(),Ie=Math.pow(we.sleepSpeedLimit,2);oe>=Ie*2&&(D._wakeUpAfterNarrowphase=!0)}if(we.allowSleep&&we.type===p.DYNAMIC&&we.sleepState===p.SLEEPING&&D.sleepState===p.AWAKE&&D.type!==p.STATIC){var Pe=D.velocity.norm2()+D.angularVelocity.norm2(),Qe=Math.pow(D.sleepSpeedLimit,2);Pe>=Qe*2&&(we._wakeUpAfterNarrowphase=!0)}this.collisionMatrix.set(D,we,!0),this.collisionMatrixPrevious.get(D,we)||(R.body=we,R.contact=P,D.dispatchEvent(R),R.body=D,we.dispatchEvent(R))}for(Q&&(me.makeContactConstraints=performance.now()-se,se=performance.now()),B=0;B!==te;B++){var D=z[B];D._wakeUpAfterNarrowphase&&(D.wakeUp(),D._wakeUpAfterNarrowphase=!1)}var W=he.length;for(B=0;B!==W;B++){var P=he[B];P.update();for(var C=0,Ge=P.equations.length;C!==Ge;C++){var We=P.equations[C];K.addEquation(We)}}K.solve(V,this),Q&&(me.solve=performance.now()-se),K.removeAllEquations();var Fe=Math.pow;for(B=0;B!==te;B++){var D=z[B];if(D.type&ge){var I=Fe(1-D.linearDamping,V),re=D.velocity;re.mult(I,re);var ve=D.angularVelocity;if(ve){var Be=Fe(1-D.angularDamping,V);ve.mult(Be,ve)}}}for(this.dispatchEvent(N),B=0;B!==te;B++){var D=z[B];D.preStep&&D.preStep.call(D)}Q&&(se=performance.now());var Ze=H,Ke=O,Ft=this.stepnumber,tr=p.DYNAMIC|p.KINEMATIC,Dr=Ft%(this.quatNormalizeSkip+1)==0,ur=this.quatNormalizeFast,Zr=V*.5;for(s.types.PLANE,s.types.CONVEXPOLYHEDRON,B=0;B!==te;B++){var qt=z[B],Se=qt.force,Re=qt.torque;if(qt.type&tr&&qt.sleepState!==p.SLEEPING){var Le=qt.velocity,De=qt.angularVelocity,j=qt.position,ue=qt.quaternion,fe=qt.invMass,de=qt.invInertiaWorld;Le.x+=Se.x*fe*V,Le.y+=Se.y*fe*V,Le.z+=Se.z*fe*V,qt.angularVelocity&&(de.vmult(Re,T),T.mult(V,T),T.vadd(De,De)),j.x+=Le.x*V,j.y+=Le.y*V,j.z+=Le.z*V,qt.angularVelocity&&(Ze.set(De.x,De.y,De.z,0),Ze.mult(ue,Ke),ue.x+=Zr*Ke.x,ue.y+=Zr*Ke.y,ue.z+=Zr*Ke.z,ue.w+=Zr*Ke.w,Dr&&(ur?ue.normalizeFast():ue.normalize())),qt.aabb&&(qt.aabbNeedsUpdate=!0),qt.updateInertiaWorld&&qt.updateInertiaWorld()}}for(this.clearForces(),this.broadphase.dirty=!0,Q&&(me.integrate=performance.now()-se),this.time+=V,this.stepnumber+=1,this.dispatchEvent(E),B=0;B!==te;B++){var D=z[B],ie=D.postStep;ie&&ie.call(D)}if(this.allowSleep)for(B=0;B!==te;B++)z[B].sleepTick(this.time)},w.prototype.clearForces=function(){for(var V=this.bodies,F=V.length,J=0;J!==F;J++){var Y=V[J];Y.force,Y.torque,Y.force.set(0,0,0),Y.torque.set(0,0,0)}}},{"../collision/AABB":3,"../collision/ArrayCollisionMatrix":4,"../collision/NaiveBroadphase":7,"../collision/Ray":9,"../collision/RaycastResult":10,"../equations/ContactEquation":19,"../equations/FrictionEquation":21,"../material/ContactMaterial":24,"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Shape":43,"../solver/GSSolver":46,"../utils/EventTarget":49,"../utils/TupleDictionary":52,"../utils/Vec3Pool":54,"./Narrowphase":55}]},{},[2])(2)})})(LH);const cS=0,DH=1,uS=2,Yf=2;class Xf{constructor(){}}function FH(r){const e=new Float32Array(6);return e[0]=r.min.x,e[1]=r.min.y,e[2]=r.min.z,e[3]=r.max.x,e[4]=r.max.y,e[5]=r.max.z,e}function bi(r,e){return e.min.x=r[0],e.min.y=r[1],e.min.z=r[2],e.max.x=r[3],e.max.y=r[4],e.max.z=r[5],e}function hS(r){let e=-1,t=-1/0;for(let n=0;n<3;n++){const i=r[n+3]-r[n];i>t&&(t=i,e=n)}return e}const OH=Math.pow(2,-24),fS=["x","y","z"],zH=new Rt;function UH(r){if(!r.index){const e=r.attributes.position.count,t=new(e>65535?Uint32Array:Uint16Array)(e);r.setIndex(new ut(t,1));for(let n=0;n<e;n++)t[n]=n}}function HH(r){if(!r.groups||!r.groups.length)return[{offset:0,count:r.index.count/3}];const e=[],t=new Set;for(const i of r.groups)t.add(i.start),t.add(i.start+i.count);const n=Array.from(t.values()).sort((i,s)=>i-s);for(let i=0;i<n.length-1;i++){const s=n[i],o=n[i+1];e.push({offset:s/3,count:(o-s)/3})}return e}function ml(r,e,t,n,i=null){let s=1/0,o=1/0,a=1/0,l=-1/0,h=-1/0,u=-1/0,c=1/0,f=1/0,d=1/0,p=-1/0,m=-1/0,y=-1/0;const g=i!==null;for(let v=e*6,x=(e+t)*6;v<x;v+=6){const w=r[v+0],b=r[v+1],M=w-b,A=w+b;M<s&&(s=M),A>l&&(l=A),g&&w<c&&(c=w),g&&w>p&&(p=w);const E=r[v+2],N=r[v+3],R=E-N,_=E+N;R<o&&(o=R),_>h&&(h=_),g&&E<f&&(f=E),g&&E>m&&(m=E);const S=r[v+4],L=r[v+5],k=S-L,H=S+L;k<a&&(a=k),H>u&&(u=H),g&&S<d&&(d=S),g&&S>y&&(y=S)}n[0]=s,n[1]=o,n[2]=a,n[3]=l,n[4]=h,n[5]=u,g&&(i[0]=c,i[1]=f,i[2]=d,i[3]=p,i[4]=m,i[5]=y)}function hv(r,e,t,n){let i=1/0,s=1/0,o=1/0,a=-1/0,l=-1/0,h=-1/0;for(let u=e*6,c=(e+t)*6;u<c;u+=6){const f=r[u+0];f<i&&(i=f),f>a&&(a=f);const d=r[u+2];d<s&&(s=d),d>l&&(l=d);const p=r[u+4];p<o&&(o=p),p>h&&(h=p)}n[0]=i,n[1]=s,n[2]=o,n[3]=a,n[4]=l,n[5]=h}function GH(r,e,t,n,i,s){let o=n,a=n+i-1;const l=s.pos,h=s.axis*2;for(;;){for(;o<=a&&e[o*6+h]<l;)o++;for(;o<=a&&e[a*6+h]>=l;)a--;if(o<a){for(let u=0;u<3;u++){let c=r[o*3+u];r[o*3+u]=r[a*3+u],r[a*3+u]=c;let f=e[o*6+u*2+0];e[o*6+u*2+0]=e[a*6+u*2+0],e[a*6+u*2+0]=f;let d=e[o*6+u*2+1];e[o*6+u*2+1]=e[a*6+u*2+1],e[a*6+u*2+1]=d}if(t)for(let u=0;u<3;u++){let c=t[u][o];t[u][o]=t[u][a],t[u][a]=c}o++,a--}else return o}}function kH(r,e,t,n,i,s,o){let a=-1,l=0;if(o===cS)a=hS(e),a!==-1&&(l=(e[a]+e[a+3])/2);else if(o===DH)a=hS(r),a!==-1&&(l=VH(t,i,s,a));else if(o===uS){const h=3,u=1,c=bi(r,zH),f=[c.max.x-c.min.x,c.max.y-c.min.y,c.max.z-c.min.z],d=2*(f[0]*f[1]+f[0]*f[2]+f[1]*f[2]),p=[[],[],[]];for(let v=i,x=i+s;v<x;v++)for(let w=0;w<3;w++)p[w].push(n[w][v]);p.forEach(v=>v.sort((x,w)=>x.p-w.p));const m=(v,x,w,b,M)=>h+u*(x/v*w+b/v*M),y=u*s;a=-1;let g=y;for(let v=0;v<3;v++){const x=(v+1)%3,w=(v+2)%3,b=c.min[fS[v]],M=c.max[fS[v]],A=p[v];let E=0,N=s;for(let R=0;R<A.length;R++){const _=A[R];E++,N--;const S=_.p-b,L=M-_.p;let k=f[x],H=f[x],O=f[w],T=f[w];const V=2*(k*O+k*S+O*S),F=2*(H*T+H*L+T*L),J=m(d,V,E,F,N);J<g&&(a=v,l=_.p,g=J)}}}return{axis:a,pos:l}}function VH(r,e,t,n){let i=0;for(let s=e,o=e+t;s<o;s++)i+=r[s*6+n*2];return i/t}function WH(r){const e=r.length/6,t=[new Array(e),new Array(e),new Array(e)];for(let n=0;n<e;n++)for(let i=0;i<3;i++)t[i][n]={p:r[n*6+i*2],tri:n};return t}function qH(r){const e=r.attributes.position.array,t=r.index.array,n=t.length/3,i=new Float32Array(n*6);for(let s=0;s<n;s++){const o=s*3,a=s*6,l=t[o+0]*3,h=t[o+1]*3,u=t[o+2]*3;for(let c=0;c<3;c++){const f=e[l+c],d=e[h+c],p=e[u+c];let m=f;d<m&&(m=d),p<m&&(m=p);let y=f;d>y&&(y=d),p>y&&(y=p);const g=(y-m)/2,v=c*2;i[a+v+0]=m+g,i[a+v+1]=g+(Math.abs(m)+g)*OH}}return i}function YH(r,e){function t(m,y,g,v=null,x=0){if(!f&&x>=a&&(f=!0,l&&(console.warn(`MeshBVH: Max depth of ${a} reached when generating BVH. Consider increasing maxDepth.`),console.warn(this,r))),g<=h||x>=a)return m.offset=y,m.count=g,m;const w=kH(m.boundingData,v,i,s,y,g,u);if(w.axis===-1)return m.offset=y,m.count=g,m;const b=GH(o,i,s,y,g,w);if(b===y||b===y+g)m.offset=y,m.count=g;else{m.splitAxis=w.axis;const M=new Xf,A=y,E=b-y;m.left=M,M.boundingData=new Float32Array(6),c?(ml(i,A,E,M.boundingData),M.continueGeneration=function(){delete this.continueGeneration,hv(i,A,E,n),t(M,A,E,n,x+1)}):(ml(i,A,E,M.boundingData,n),t(M,A,E,n,x+1));const N=new Xf,R=b,_=g-E;m.right=N,N.boundingData=new Float32Array(6),c?(ml(i,R,_,N.boundingData),N.continueGeneration=function(){delete this.continueGeneration,hv(i,R,_,n),t(N,R,_,n,x+1)}):(ml(i,R,_,N.boundingData,n),t(N,R,_,n,x+1))}return m}UH(r);const n=new Float32Array(6),i=qH(r),s=e.strategy===uS?WH(i):null,o=r.index.array,a=e.maxDepth,l=e.verbose,h=e.maxLeafTris,u=e.strategy,c=e.lazyGeneration;let f=!1;const d=[],p=HH(r);if(p.length===1){const m=new Xf,y=p[0];r.boundingBox!=null?(m.boundingData=FH(r.boundingBox),hv(i,y.offset,y.count,n)):(m.boundingData=new Float32Array(6),ml(i,y.offset,y.count,m.boundingData,n)),t(m,y.offset,y.count,n),d.push(m)}else for(let m of p){const y=new Xf;y.boundingData=new Float32Array(6),ml(i,m.offset,m.count,y.boundingData,n),t(y,m.offset,m.count,n),d.push(y)}if(r.boundingBox==null){const m=new Rt;r.boundingBox=new Rt;for(let y of d)r.boundingBox.union(bi(y.boundingData,m))}return d}class Mi{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(e,t){let n=1/0,i=-1/0;for(let s=0,o=e.length;s<o;s++){const l=e[s][t];n=Math.min(l,n),i=Math.max(l,i)}this.min=n,this.max=i}setFromPoints(e,t){let n=1/0,i=-1/0;for(let s=0,o=t.length;s<o;s++){const a=t[s],l=e.dot(a);n=Math.min(l,n),i=Math.max(l,i)}this.min=n,this.max=i}isSeparated(e){return this.min>e.max||e.min>this.max}}Mi.prototype.setFromBox=function(){const r=new X;return function(t,n){const i=n.min,s=n.max;let o=1/0,a=-1/0;for(let l=0;l<=1;l++)for(let h=0;h<=1;h++)for(let u=0;u<=1;u++){r.x=i.x*l+s.x*(1-l),r.y=i.y*h+s.y*(1-h),r.z=i.z*u+s.z*(1-u);const c=t.dot(r);o=Math.min(c,o),a=Math.max(c,a)}this.min=o,this.max=a}}();(function(){const r=new Mi;return function(t,n){const i=t.points,s=t.satAxes,o=t.satBounds,a=n.points,l=n.satAxes,h=n.satBounds;for(let u=0;u<3;u++){const c=o[u],f=s[u];if(r.setFromPoints(f,a),c.isSeparated(r))return!1}for(let u=0;u<3;u++){const c=h[u],f=l[u];if(r.setFromPoints(f,i),c.isSeparated(r))return!1}}})();const XH=function(){const r=new X,e=new X,t=new X;return function(i,s,o){const a=i.start,l=r,h=s.start,u=e;t.subVectors(a,h),r.subVectors(i.end,s.start),e.subVectors(s.end,s.start);const c=t.dot(u),f=u.dot(l),d=u.dot(u),p=t.dot(l),y=l.dot(l)*d-f*f;let g,v;y!==0?g=(c*f-p*d)/y:g=0,v=(c+g*f)/d,o.x=g,o.y=v}}(),fv=function(){const r=new Ae,e=new X,t=new X;return function(i,s,o,a){XH(i,s,r);let l=r.x,h=r.y;if(l>=0&&l<=1&&h>=0&&h<=1){i.at(l,o),s.at(h,a);return}else if(l>=0&&l<=1){h<0?s.at(0,a):s.at(1,a),i.closestPointToPoint(a,!0,o);return}else if(h>=0&&h<=1){l<0?i.at(0,o):i.at(1,o),s.closestPointToPoint(o,!0,a);return}else{let u;l<0?u=i.start:u=i.end;let c;h<0?c=s.start:c=s.end;const f=e,d=t;if(i.closestPointToPoint(c,!0,e),s.closestPointToPoint(u,!0,t),f.distanceToSquared(c)<=d.distanceToSquared(u)){o.copy(f),a.copy(c);return}else{o.copy(u),a.copy(d);return}}}}(),QH=function(){const r=new X,e=new X,t=new Hr,n=new Ui;return function(s,o){const{radius:a,center:l}=s,{a:h,b:u,c}=o;if(n.start=h,n.end=u,n.closestPointToPoint(l,!0,r).distanceTo(l)<=a||(n.start=h,n.end=c,n.closestPointToPoint(l,!0,r).distanceTo(l)<=a)||(n.start=u,n.end=c,n.closestPointToPoint(l,!0,r).distanceTo(l)<=a))return!0;const m=o.getPlane(t);if(Math.abs(m.distanceToPoint(l))<=a){const g=m.projectPoint(l,e);if(o.containsPoint(g))return!0}return!1}}();class cr extends jt{constructor(...e){super(...e);this.isSeparatingAxisTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new X),this.satBounds=new Array(4).fill().map(()=>new Mi),this.points=[this.a,this.b,this.c],this.sphere=new yr,this.needsUpdate=!1}intersectsSphere(e){return QH(e,this)}}cr.prototype.update=function(){const r=new Array(3);return function(){const t=this.a,n=this.b,i=this.c;r[0]=this.a,r[1]=this.b,r[2]=this.c;const s=this.satAxes,o=this.satBounds,a=s[0],l=o[0];this.getNormal(a),l.setFromPoints(a,r);const h=s[1],u=o[1];h.subVectors(t,n),u.setFromPoints(h,r);const c=s[2],f=o[2];c.subVectors(n,i),f.setFromPoints(c,r);const d=s[3],p=o[3];d.subVectors(i,t),p.setFromPoints(d,r),this.sphere.setFromPoints(this.points),this.needsUpdate=!1}}();cr.prototype.closestPointToSegment=function(){const r=new X,e=new X,t=new Ui;return function(i,s=null,o=null){this.needsUpdate&&this.update();const{start:a,end:l}=i,h=this.points;let u,c=1/0;for(let f=0;f<3;f++){const d=(f+1)%3;t.start.copy(h[f]),t.end.copy(h[d]),fv(t,i,r,e),u=r.distanceToSquared(e),u<c&&(c=u,s&&s.copy(r),o&&o.copy(e))}return this.closestPointToPoint(a,r),u=a.distanceToSquared(r),u<c&&(c=u,s&&s.copy(r),o&&o.copy(a)),this.closestPointToPoint(l,r),u=l.distanceToSquared(r),u<c&&(c=u,s&&s.copy(r),o&&o.copy(l)),Math.sqrt(c)}}();cr.prototype.intersectsTriangle=function(){const r=new cr,e=new Array(3),t=new Array(3),n=new Mi,i=new Mi,s=new X;return function(a){this.needsUpdate&&this.update(),a.isSeparatingAxisTriangle||(r.copy(a),r.update(),a=r);const l=this.satBounds,h=this.satAxes;t[0]=a.a,t[1]=a.b,t[2]=a.c;for(let f=0;f<4;f++){const d=l[f],p=h[f];if(n.setFromPoints(p,t),d.isSeparated(n))return!1}const u=a.satBounds,c=a.satAxes;e[0]=this.a,e[1]=this.b,e[2]=this.c;for(let f=0;f<4;f++){const d=u[f],p=c[f];if(n.setFromPoints(p,e),d.isSeparated(n))return!1}for(let f=0;f<4;f++){const d=h[f];for(let p=0;p<4;p++){const m=c[p];if(s.crossVectors(d,m),n.setFromPoints(s,e),i.setFromPoints(s,t),n.isSeparated(i))return!1}}return!0}}();cr.prototype.distanceToPoint=function(){const r=new X;return function(t){return this.closestPointToPoint(t,r),t.distanceTo(r)}}();cr.prototype.distanceToTriangle=function(){const r=new X,e=new X,t=["a","b","c"],n=new Ui,i=new Ui;return function(o,a=null,l=null){if(o.needsUpdate&&o.update(),this.needsUpdate&&this.update(),this.intersectsTriangle(o))return(a||l)&&(this.getMidpoint(r),o.closestPointToPoint(r,e),this.closestPointToPoint(e,r),a&&a.copy(r),l&&l.copy(e)),0;let h=1/0;for(let u=0;u<3;u++){let c;const f=t[u],d=o[f];this.closestPointToPoint(d,r),c=d.distanceToSquared(r),c<h&&(h=c,a&&a.copy(r),l&&l.copy(d));const p=this[f];o.closestPointToPoint(p,r),c=p.distanceToSquared(r),c<h&&(h=c,a&&a.copy(p),l&&l.copy(r))}for(let u=0;u<3;u++){const c=t[u],f=t[(u+1)%3];n.set(this[c],this[f]);for(let d=0;d<3;d++){const p=t[d],m=t[(d+1)%3];i.set(o[p],o[m]),fv(n,i,r,e);const y=r.distanceToSquared(e);y<h&&(h=y,a&&a.copy(r),l&&l.copy(e))}}return Math.sqrt(h)}}();class jr extends Rt{constructor(...e){super(...e);this.isOrientedBox=!0,this.matrix=new Ye,this.invMatrix=new Ye,this.points=new Array(8).fill().map(()=>new X),this.satAxes=new Array(3).fill().map(()=>new X),this.satBounds=new Array(3).fill().map(()=>new Mi),this.alignedSatBounds=new Array(3).fill().map(()=>new Mi),this.sphere=new yr}set(e,t,n){super.set(e,t),this.matrix=n}copy(e){super.copy(e),this.matrix.copy(e.matrix)}}jr.prototype.update=function(){return function(){const e=this.matrix,t=this.min,n=this.max,i=this.points;for(let h=0;h<=1;h++)for(let u=0;u<=1;u++)for(let c=0;c<=1;c++){const f=(1<<0)*h|(1<<1)*u|(1<<2)*c,d=i[f];d.x=h?n.x:t.x,d.y=u?n.y:t.y,d.z=c?n.z:t.z,d.applyMatrix4(e)}this.sphere.setFromPoints(this.points);const s=this.satBounds,o=this.satAxes,a=i[0];for(let h=0;h<3;h++){const u=o[h],c=s[h],f=1<<h,d=i[f];u.subVectors(a,d),c.setFromPoints(u,i)}const l=this.alignedSatBounds;l[0].setFromPointsField(i,"x"),l[1].setFromPointsField(i,"y"),l[2].setFromPointsField(i,"z"),this.invMatrix.copy(this.matrix).invert()}}();jr.prototype.intersectsBox=function(){const r=new Mi;return function(t){if(!t.intersectsSphere(this.sphere))return!1;const n=t.min,i=t.max,s=this.satBounds,o=this.satAxes,a=this.alignedSatBounds;if(r.min=n.x,r.max=i.x,a[0].isSeparated(r)||(r.min=n.y,r.max=i.y,a[1].isSeparated(r))||(r.min=n.z,r.max=i.z,a[2].isSeparated(r)))return!1;for(let l=0;l<3;l++){const h=o[l],u=s[l];if(r.setFromBox(h,t),u.isSeparated(r))return!1}return!0}}();jr.prototype.intersectsTriangle=function(){const r=new cr,e=new Array(3),t=new Mi,n=new Mi,i=new X;return function(o){o.isSeparatingAxisTriangle?o.needsUpdate&&o.update():(r.copy(o),r.update(),o=r);const a=this.satBounds,l=this.satAxes;e[0]=o.a,e[1]=o.b,e[2]=o.c;for(let f=0;f<3;f++){const d=a[f],p=l[f];if(t.setFromPoints(p,e),d.isSeparated(t))return!1}const h=o.satBounds,u=o.satAxes,c=this.points;for(let f=0;f<3;f++){const d=h[f],p=u[f];if(t.setFromPoints(p,c),d.isSeparated(t))return!1}for(let f=0;f<3;f++){const d=l[f];for(let p=0;p<4;p++){const m=u[p];if(i.crossVectors(d,m),t.setFromPoints(i,e),n.setFromPoints(i,c),t.isSeparated(n))return!1}}return!0}}();jr.prototype.closestPointToPoint=function(){return function(e,t){return t.copy(e).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),t}}();jr.prototype.distanceToPoint=function(){const r=new X;return function(t){return this.closestPointToPoint(t,r),t.distanceTo(r)}}();jr.prototype.distanceToBox=function(){const r=["x","y","z"],e=new Array(12).fill().map(()=>new Ui),t=new Array(12).fill().map(()=>new Ui),n=new X,i=new X;return function(o,a=0,l=null,h=null){if(this.intersectsBox(o))return(l||h)&&(o.getCenter(i),this.closestPointToPoint(i,n),o.closestPointToPoint(n,i),l&&l.copy(n),h&&h.copy(i)),0;const u=a*a,c=o.min,f=o.max,d=this.points;let p=1/0;for(let y=0;y<8;y++){const g=d[y];i.copy(g).clamp(c,f);const v=g.distanceToSquared(i);if(v<p&&(p=v,l&&l.copy(g),h&&h.copy(i),v<u))return Math.sqrt(v)}let m=0;for(let y=0;y<3;y++)for(let g=0;g<=1;g++)for(let v=0;v<=1;v++){const x=(y+1)%3,w=(y+2)%3,b=g<<x|v<<w,M=1<<y|g<<x|v<<w,A=d[b],E=d[M];e[m].set(A,E);const R=r[y],_=r[x],S=r[w],L=t[m],k=L.start,H=L.end;k[R]=c[R],k[_]=g?c[_]:f[_],k[S]=v?c[S]:f[_],H[R]=f[R],H[_]=g?c[_]:f[_],H[S]=v?c[S]:f[_],m++}for(let y=0;y<=1;y++)for(let g=0;g<=1;g++)for(let v=0;v<=1;v++){i.x=y?f.x:c.x,i.y=g?f.y:c.y,i.z=v?f.z:c.z,this.closestPointToPoint(i,n);const x=i.distanceToSquared(n);if(x<p&&(p=x,l&&l.copy(n),h&&h.copy(i),x<u))return Math.sqrt(x)}for(let y=0;y<12;y++){const g=e[y];for(let v=0;v<12;v++){const x=t[v];fv(g,x,n,i);const w=n.distanceToSquared(i);if(w<p&&(p=w,l&&l.copy(n),h&&h.copy(i),w<u))return Math.sqrt(w)}}return Math.sqrt(p)}}();function Ji(r,e,t,n){const i=r.a,s=r.b,o=r.c;let a=t.getX(e);i.x=n.getX(a),i.y=n.getY(a),i.z=n.getZ(a),a=t.getX(e+1),s.x=n.getX(a),s.y=n.getY(a),s.z=n.getZ(a),a=t.getX(e+2),o.x=n.getX(a),o.y=n.getY(a),o.z=n.getZ(a)}var Qf=new X,jf=new X,Zf=new X,dS=new Ae,pS=new Ae,mS=new Ae,gS=new X,Jf=new X;function jH(r,e,t,n,i,s,o,a){var l;if(e.side===zt?l=n.intersectTriangle(o,s,i,!0,a):l=n.intersectTriangle(i,s,o,e.side!==mr,a),l===null)return null;Jf.copy(a),Jf.applyMatrix4(r.matrixWorld);var h=t.ray.origin.distanceTo(Jf);return h<t.near||h>t.far?null:{distance:h,point:Jf.clone(),object:r}}function ZH(r,e,t,n,i,s,o,a){Qf.fromBufferAttribute(n,s),jf.fromBufferAttribute(n,o),Zf.fromBufferAttribute(n,a);var l=jH(r,r.material,e,t,Qf,jf,Zf,gS);if(l){i&&(dS.fromBufferAttribute(i,s),pS.fromBufferAttribute(i,o),mS.fromBufferAttribute(i,a),l.uv=jt.getUV(gS,Qf,jf,Zf,dS,pS,mS,new Ae));const h={a:s,b:o,c:a,normal:new X,materialIndex:0};jt.getNormal(Qf,jf,Zf,h.normal),l.face=h,l.faceIndex=s}return l}function vS(r,e,t,n,i,s){const o=i*3,a=e.index.getX(o),l=e.index.getX(o+1),h=e.index.getX(o+2),u=ZH(r,t,n,e.attributes.position,e.attributes.uv,a,l,h);return u?(u.faceIndex=i,s&&s.push(u),u):null}function yS(r,e,t,n,i,s,o){for(let a=i,l=i+s;a<l;a++)vS(r,e,t,n,a,o)}function xS(r,e,t,n,i,s){let o=1/0,a=null;for(let l=i,h=i+s;l<h;l++){const u=vS(r,e,t,n,l);u&&u.distance<o&&(a=u,o=u.distance)}return a}const gl=new Rt,Kf=new X,JH=["x","y","z"];function $f(r,e,t){return bi(r.boundingData,gl),e.intersectBox(gl,t)}function dv(r,e,t,n,i){r.continueGeneration&&r.continueGeneration(),!!r.count?yS(e,e.geometry,t,n,r.offset,r.count,i):($f(r.left,n,Kf)&&dv(r.left,e,t,n,i),$f(r.right,n,Kf)&&dv(r.right,e,t,n,i))}function pv(r,e,t,n){if(r.continueGeneration&&r.continueGeneration(),!!r.count)return xS(e,e.geometry,t,n,r.offset,r.count);{const s=r.splitAxis,o=JH[s],l=n.direction[o]>=0;let h,u;l?(h=r.left,u=r.right):(h=r.right,u=r.left);const f=$f(h,n,Kf)?pv(h,e,t,n):null;if(f){const m=f.point[o];if(l?m<=u.boundingData[s]:m>=u.boundingData[s+3])return f}const p=$f(u,n,Kf)?pv(u,e,t,n):null;return f&&p?f.distance<=p.distance?f:p:f||p||null}}const KH=function(){const r=new cr,e=new Rt,t=new Rt;function n(i,s,o,a,l,h,u){const c=o.index,f=o.attributes.position;for(let d=i*3,p=(s+i)*3;d<p;d+=3)if(Ji(u,d,c,f),u.needsUpdate=!0,a(u,d,d+1,d+2,l,h))return!0;return!1}return function i(s,o,a,l=null,h=null,u=0,c=r,f=e,d=t){function p(g){for(g.continueGeneration&&g.continueGeneration();!g.count;)g=g.left,g.continueGeneration&&g.continueGeneration();return g.offset}function m(g){for(g.continueGeneration&&g.continueGeneration();!g.count;)g=g.right,g.continueGeneration&&g.continueGeneration();return g.offset+g.count}if(s.continueGeneration&&s.continueGeneration(),!!s.count&&l){const g=o.geometry,v=s.offset,x=s.count;return n(v,x,g,l,!1,u,c)}else{const g=s.left,v=s.right;let x=g,w=v,b,M,A,E;if(h&&(A=f,E=d,bi(x.boundingData,A),bi(w.boundingData,E),b=h(A),M=h(E),M<b)){x=v,w=g;const H=b;b=M,M=H,A=E}A||(A=f,bi(x.boundingData,A));const N=!!x.count,R=a(A,N,b,u+1);let _;if(R===Yf){const H=o.geometry,O=p(x),V=m(x)-O;_=n(O,V,H,l,!0,u+1,c)}else _=R&&i(x,o,a,l,h,u+1,c,f,d);if(_)return!0;E=d,bi(w.boundingData,E);const S=!!w.count,L=a(E,S,M,u+1);let k;if(L===Yf){const H=o.geometry,O=p(w),V=m(w)-O;k=n(O,V,H,l,!0,u+1,c)}else k=L&&i(w,o,a,l,h,u+1,c,f,d);return!!k}}}(),$H=function(){const r=new cr,e=new cr,t=new Gt,n=new Ye,i=new jr,s=new jr;return function o(a,l,h,u,c=null){if(a.continueGeneration&&a.continueGeneration(),c===null&&(h.boundingBox||h.computeBoundingBox(),i.set(h.boundingBox.min,h.boundingBox.max,u),i.update(),c=i),!!a.count){const d=l.geometry,p=d.index,m=d.attributes.position,y=h.index,g=h.attributes.position,v=a.offset,x=a.count;if(n.copy(u).invert(),h.boundsTree){bi(a.boundingData,s),s.matrix.copy(n),s.update(),t.geometry=h;const w=h.boundsTree.shapecast(t,b=>s.intersectsBox(b),function(b){b.a.applyMatrix4(u),b.b.applyMatrix4(u),b.c.applyMatrix4(u),b.update();for(let M=v*3,A=(x+v)*3;M<A;M+=3)if(Ji(e,M,p,m),e.update(),b.intersectsTriangle(e))return!0;return!1});return t.geometry=null,w}else for(let w=v*3,b=x+v*3;w<b;w+=3){Ji(r,w,p,m),r.a.applyMatrix4(n),r.b.applyMatrix4(n),r.c.applyMatrix4(n),r.update();for(let M=0,A=y.count;M<A;M+=3)if(Ji(e,M,y,g),e.update(),r.intersectsTriangle(e))return!0}}else{const d=a.left,p=a.right;return bi(d.boundingData,gl),!!(c.intersectsBox(gl)&&o(d,l,h,u,c)||(bi(p.boundingData,gl),c.intersectsBox(gl)&&o(p,l,h,u,c)))}}}(),vl=new Rt,ed=new X,e5=["x","y","z"];function mv(r,e,t,n,i){let s=r*2,o=Us,a=Hs,l=Gs;a[s+15]===65535?yS(e,e.geometry,t,n,l[r+6],a[s+14],i):(td(r+8,o,n,ed)&&mv(r+8,e,t,n,i),td(l[r+6],o,n,ed)&&mv(l[r+6],e,t,n,i))}function gv(r,e,t,n){let i=r*2,s=Us,o=Hs,a=Gs;if(o[i+15]===65535)return xS(e,e.geometry,t,n,a[r+6],o[i+14]);{const h=a[r+7],u=e5[h],f=n.direction[u]>=0;let d,p;f?(d=r+8,p=a[r+6]):(d=a[r+6],p=r+8);const y=td(d,s,n,ed)?gv(d,e,t,n):null;if(y){const x=y.point[u];if(f?x<=s[p+h]:x>=s[p+h+3])return y}const v=td(p,s,n,ed)?gv(p,e,t,n):null;return y&&v?y.distance<=v.distance?y:v:y||v||null}}const t5=function(){const r=new cr,e=new Rt,t=new Rt;function n(i,s,o,a,l,h,u){const c=o.index,f=o.attributes.position;for(let d=i*3,p=(s+i)*3;d<p;d+=3)if(Ji(u,d,c,f),u.needsUpdate=!0,a(u,d,d+1,d+2,l,h))return!0;return!1}return function i(s,o,a,l=null,h=null,u=0,c=r,f=e,d=t){function p(b){let M=b*2,A=Hs,E=Gs;for(;A[M+15]!==65535;)b=b+8,M=b*2;return E[b+6]}function m(b){let M=b*2,A=Hs,E=Gs;for(;A[M+15]!==65535;)b=E[b+6],M=b*2;return E[b+6]+A[M+14]}let y=s*2,g=Us,v=Hs,x=Gs;if(v[y+15]===65535&&l){const b=o.geometry,M=x[s+6],A=v[y+14];return n(M,A,b,l,!1,u,c)}else{const b=s+8,M=x[s+6];let A=b,E=M,N,R,_,S;if(h&&(_=f,S=d,ks(A,g,_),ks(E,g,S),N=h(_),R=h(S),R<N)){A=M,E=b;const F=N;N=R,R=F,_=S}_||(_=f,ks(A,g,_));const L=v[A+15]===65535,k=a(_,L,N,u+1);let H;if(k===Yf){const F=o.geometry,J=p(A),te=m(A)-J;H=n(J,te,F,l,!0,u+1,c)}else H=k&&i(A,o,a,l,h,u+1,c,f,d);if(H)return!0;S=d,ks(E,g,S);const O=v[E+15]===65535,T=a(S,O,R,u+1);let V;if(T===Yf){const F=o.geometry,J=p(E),te=m(E)-J;V=n(J,te,F,l,!0,u+1,c)}else V=T&&i(E,o,a,l,h,u+1,c,f,d);return!!V}}}(),n5=function(){const r=new cr,e=new cr,t=new Gt,n=new Ye,i=new jr,s=new jr;return function o(a,l,h,u,c=null){let f=a*2,d=Us,p=Hs,m=Gs;if(c===null&&(h.boundingBox||h.computeBoundingBox(),i.set(h.boundingBox.min,h.boundingBox.max,u),i.update(),c=i),p[f+15]===65535){const g=l.geometry,v=g.index,x=g.attributes.position,w=h.index,b=h.attributes.position,M=m[a+6],A=p[f+14];if(n.copy(u).invert(),h.boundsTree){ks(a,d,s),s.matrix.copy(n),s.update(),t.geometry=h;const E=h.boundsTree.shapecast(t,N=>s.intersectsBox(N),function(N){N.a.applyMatrix4(u),N.b.applyMatrix4(u),N.c.applyMatrix4(u),N.update();for(let R=M*3,_=(A+M)*3;R<_;R+=3)if(Ji(e,R,v,x),e.update(),N.intersectsTriangle(e))return!0;return!1});return t.geometry=null,E}else for(let E=M*3,N=A+M*3;E<N;E+=3){Ji(r,E,v,x),r.a.applyMatrix4(n),r.b.applyMatrix4(n),r.c.applyMatrix4(n),r.update();for(let R=0,_=w.count;R<_;R+=3)if(Ji(e,R,w,b),e.update(),r.intersectsTriangle(e))return!0}}else{const g=a+8,v=m[a+6];return ks(g,d,vl),!!(c.intersectsBox(vl)&&o(g,l,h,u,c)||(ks(v,d,vl),c.intersectsBox(vl)&&o(v,l,h,u,c)))}}}();function td(r,e,t,n){return ks(r,e,vl),t.intersectBox(vl,n)}const vv=[];let nd,Us,Hs,Gs;function Yc(r){nd&&vv.push(nd),nd=r,Us=new Float32Array(r),Hs=new Uint16Array(r),Gs=new Uint32Array(r)}function rd(){nd=null,Us=null,Hs=null,Gs=null,vv.length&&Yc(vv.pop())}function ks(r,e,t){t.min.x=e[r],t.min.y=e[r+1],t.min.z=e[r+2],t.max.x=e[r+3],t.max.y=e[r+4],t.max.z=e[r+5]}const id=6*4+4+4,r5=65535,yv=Symbol("skip tree generation"),Ho=new jr,xv=new X,Ki=new cr,i5=new X,s5=new X;class sd{static serialize(e,t,n=!0){function i(p){p.continueGeneration&&p.continueGeneration(),p.count||(i(p.left),i(p.right))}function s(p){return p.count?1:1+s(p.left)+s(p.right)}function o(p,m){const y=p/4,g=p/2,v=!!m.count,x=m.boundingData;for(let w=0;w<6;w++)a[y+w]=x[w];if(v){const w=m.offset,b=m.count;return l[y+6]=w,h[g+14]=b,h[g+15]=r5,p+id}else{const w=m.left,b=m.right,M=m.splitAxis;let A;return A=o(p+id,w),l[y+6]=A/4,A=o(A,b),l[y+7]=M,A}}let a,l,h;const u=e._roots;let c;if(e._isPacked)c=u;else{c=[];for(let p=0;p<u.length;p++){const m=u[p];i(m);let y=s(m);const g=new ArrayBuffer(id*y);a=new Float32Array(g),l=new Uint32Array(g),h=new Uint16Array(g),o(0,m),c.push(g)}}const f=t.getIndex();return{roots:c,index:n?f.array.slice():f.array}}static deserialize(e,t,n=!0){const{index:i,roots:s}=e,o=new sd(t,{[yv]:!0});if(o._roots=s,o._isPacked=!0,n){const a=t.getIndex();if(a===null){const l=new ut(e.index,1,!1);t.setIndex(l)}else a.array!==i&&(a.array.set(i),a.needsUpdate=!0)}return o}constructor(e,t={}){if(e.isBufferGeometry){if(e.attributes.position.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the position attribute.");if(e.index&&e.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");t=Object.assign({strategy:cS,maxDepth:40,maxLeafTris:10,verbose:!0,lazyGeneration:!0,packData:!0,[yv]:!1},t),t.strategy=Math.max(0,Math.min(2,t.strategy)),this._isPacked=!1,this._roots=null,t[yv]||(this._roots=YH(e,t),!t.lazyGeneration&&t.packData&&(this._roots=sd.serialize(this,e,!1).roots,this._isPacked=!0))}traverse(e,t=0){if(this._isPacked){let o=function(a,l=0){const h=a*2,u=s[h+15];if(u){const c=i[a+6],f=s[h+14];e(l,u,new Float32Array(n,a*4,6),c,f)}else{const c=a+id/4,f=i[a+6],d=i[a+7];e(l,u,new Float32Array(n,a*4,6),d,!1)||(o(c,l+1),o(f,l+1))}};const n=this._roots[t],i=new Uint32Array(n),s=new Uint16Array(n);o(0)}else{let n=function(i,s=0){const o=!!i.count;o?e(s,o,i.boundingData,i.offset,i.count):e(s,o,i.boundingData,i.splitAxis,!!i.continueGeneration)||(i.left&&n(i.left,s+1),i.right&&n(i.right,s+1))};n(this._roots[t])}}raycast(e,t,n,i){const s=this._isPacked;for(const o of this._roots)s?(Yc(o),mv(0,e,t,n,i)):dv(o,e,t,n,i);s&&rd()}raycastFirst(e,t,n){const i=this._isPacked;let s=null;for(const o of this._roots){let a;i?(Yc(o),a=gv(0,e,t,n)):a=pv(o,e,t,n),a!=null&&(s==null||a.distance<s.distance)&&(s=a)}return i&&rd(),s}intersectsGeometry(e,t,n){const i=this._isPacked;let s=!1;for(const o of this._roots)if(i?(Yc(o),s=n5(0,e,t,n)):s=$H(o,e,t,n),s)break;return i&&rd(),s}shapecast(e,t,n=null,i=null){const s=this._isPacked;let o=!1;for(const a of this._roots)if(s?(Yc(a),o=t5(0,e,t,n,i)):o=KH(a,e,t,n,i),o)break;return s&&rd(),o}intersectsBox(e,t,n){return Ho.set(t.min,t.max,n),Ho.update(),this.shapecast(e,i=>Ho.intersectsBox(i),i=>Ho.intersectsTriangle(i))}intersectsSphere(e,t){return this.shapecast(e,n=>t.intersectsBox(n),n=>n.intersectsSphere(t))}closestPointToGeometry(e,t,n,i=null,s=null,o=0,a=1/0){t.boundingBox||t.computeBoundingBox(),Ho.set(t.boundingBox.min,t.boundingBox.max,n),Ho.update();const l=t.attributes.position,h=t.index;let u=null,c=null;i&&(u=i5),s&&(c=s5);let f=1/0;return this.shapecast(e,(d,p,m)=>m<f&&m<a,d=>{d.needsUpdate&&d.update();const p=d.sphere;for(let m=0,y=h.count;m<y;m+=3){Ji(Ki,m,h,l),Ki.a.applyMatrix4(n),Ki.b.applyMatrix4(n),Ki.c.applyMatrix4(n),Ki.sphere.setFromPoints(Ki.points);const g=Ki.sphere;if(g.center.distanceTo(p.center)-g.radius-p.radius>f)continue;Ki.update();const x=d.distanceToTriangle(Ki,u,c);if(x<f&&(i&&i.copy(u),s&&s.copy(c),f=x),x<o)return!0}return!1},d=>Ho.distanceToBox(d,Math.min(f,a))),f}distanceToGeometry(e,t,n,i,s){return this.closestPointToGeometry(e,t,n,null,null,i,s)}closestPointToPoint(e,t,n,i=0,s=1/0){let o=1/0;return this.shapecast(e,(a,l,h)=>h<o&&h<s,a=>{a.closestPointToPoint(t,xv);const l=t.distanceTo(xv);return l<o&&(n&&n.copy(xv),o=l),l<i},a=>a.distanceToPoint(t)),o}distanceToPoint(e,t,n,i){return this.closestPointToPoint(e,t,null,n,i)}}const z5=new gn({color:65416,transparent:!0,opacity:.3}),U5=new U1().geometry;let H5=new Rt;new Rt;new Rt;new X;const wv=new Pi,wS=new Ye,o5=Gt.prototype.raycast;function G5(r,e){if(this.geometry.boundsTree){if(this.material===void 0)return;if(wS.copy(this.matrixWorld).invert(),wv.copy(r.ray).applyMatrix4(wS),r.firstHitOnly===!0){const t=this.geometry.boundsTree.raycastFirst(this,r,wv);t&&e.push(t)}else this.geometry.boundsTree.raycast(this,r,wv,e)}else o5.call(this,r,e)}function k5(r){return this.boundsTree=new sd(this,r),this.boundsTree}function V5(){this.boundsTree=null}export{L5 as $,Em as A,Zt as B,y1 as C,$w as D,w5 as E,zb as F,S5 as G,GL as H,hc as I,Ec as J,Pb as K,ab as L,Gt as M,x5 as N,dt as O,ln as P,Sn as Q,IP as R,v5 as S,g5 as T,Ib as U,Ae as V,Nt as W,_c as X,R5 as Y,Ac as Z,cH as _,u5 as a,I5 as a0,$g as a1,Hf as a2,D5 as a3,N5 as a4,Zg as a5,B5 as a6,P5 as a7,_5 as a8,Hb as a9,is as aA,a_ as aB,l5 as aC,h5 as aD,p5 as aE,s_ as aF,qv as aG,Gd as aH,Sd as aI,m5 as aJ,Fi as aK,LH as aL,k5 as aM,V5 as aN,G5 as aO,zL as aa,T5 as ab,C5 as ac,WL as ad,V1 as ae,F5 as af,Ye as ag,Fw as ah,Mn as ai,ft as aj,ch as ak,lx as al,BH as am,Fr as an,Zi as ao,He as ap,ka as aq,rt as ar,je as as,gn as at,Kd as au,oi as av,O5 as aw,bm as ax,Lh as ay,d5 as az,xs as b,M5 as c,f5 as d,mc as e,A5 as f,b5 as g,y5 as h,aI as i,go as j,E5 as k,lo as l,X as m,mr as n,e1 as o,c5 as p,co as q,ir as r,tm as s,lb as t,OB as u,Oh as v,of as w,ot as x,rg as y,Sc as z};
